var RL=(r,s)=>()=>(s||r((s={exports:{}}).exports,s),s.exports);var bF=RL((Dn,On)=>{(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))p(_);new MutationObserver(_=>{for(const k of _)if(k.type==="childList")for(const b of k.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&p(b)}).observe(document,{childList:!0,subtree:!0});function d(_){const k={};return _.integrity&&(k.integrity=_.integrity),_.referrerpolicy&&(k.referrerPolicy=_.referrerpolicy),_.crossorigin==="use-credentials"?k.credentials="include":_.crossorigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function p(_){if(_.ep)return;_.ep=!0;const k=d(_);fetch(_.href,k)}})();function Dm(r,s){const d=Object.create(null),p=r.split(",");for(let _=0;_<p.length;_++)d[p[_]]=!0;return s?_=>!!d[_.toLowerCase()]:_=>!!d[_]}const AL="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xL=Dm(AL);function $k(r){return!!r||r===""}function Zs(r){if(qe(r)){const s={};for(let d=0;d<r.length;d++){const p=r[d],_=jt(p)?OL(p):Zs(p);if(_)for(const k in _)s[k]=_[k]}return s}else{if(jt(r))return r;if(Lt(r))return r}}const PL=/;(?![^(]*\))/g,DL=/:(.+)/;function OL(r){const s={};return r.split(PL).forEach(d=>{if(d){const p=d.split(DL);p.length>1&&(s[p[0].trim()]=p[1].trim())}}),s}function ec(r){let s="";if(jt(r))s=r;else if(qe(r))for(let d=0;d<r.length;d++){const p=ec(r[d]);p&&(s+=p+" ")}else if(Lt(r))for(const d in r)r[d]&&(s+=d+" ");return s.trim()}const tc=r=>jt(r)?r:r==null?"":qe(r)||Lt(r)&&(r.toString===Jk||!Ze(r.toString))?JSON.stringify(r,zk,2):String(r),zk=(r,s)=>s&&s.__v_isRef?zk(r,s.value):Ea(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((d,[p,_])=>(d[`${p} =>`]=_,d),{})}:Wk(s)?{[`Set(${s.size})`]:[...s.values()]}:Lt(s)&&!qe(s)&&!qk(s)?String(s):s,It={},wa=[],or=()=>{},NL=()=>!1,LL=/^on[^a-z]/,kl=r=>LL.test(r),Om=r=>r.startsWith("onUpdate:"),Wt=Object.assign,Nm=(r,s)=>{const d=r.indexOf(s);d>-1&&r.splice(d,1)},ML=Object.prototype.hasOwnProperty,ot=(r,s)=>ML.call(r,s),qe=Array.isArray,Ea=r=>Il(r)==="[object Map]",Wk=r=>Il(r)==="[object Set]",Ze=r=>typeof r=="function",jt=r=>typeof r=="string",Lm=r=>typeof r=="symbol",Lt=r=>r!==null&&typeof r=="object",Gk=r=>Lt(r)&&Ze(r.then)&&Ze(r.catch),Jk=Object.prototype.toString,Il=r=>Jk.call(r),UL=r=>Il(r).slice(8,-1),qk=r=>Il(r)==="[object Object]",Mm=r=>jt(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,hl=Dm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tl=r=>{const s=Object.create(null);return d=>s[d]||(s[d]=r(d))},VL=/-(\w)/g,xa=Tl(r=>r.replace(VL,(s,d)=>d?d.toUpperCase():"")),FL=/\B([A-Z])/g,Na=Tl(r=>r.replace(FL,"-$1").toLowerCase()),Kk=Tl(r=>r.charAt(0).toUpperCase()+r.slice(1)),Jp=Tl(r=>r?`on${Kk(r)}`:""),nc=(r,s)=>!Object.is(r,s),qp=(r,s)=>{for(let d=0;d<r.length;d++)r[d](s)},pl=(r,s,d)=>{Object.defineProperty(r,s,{configurable:!0,enumerable:!1,value:d})},Qk=r=>{const s=parseFloat(r);return isNaN(s)?r:s};let F1;const jL=()=>F1||(F1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let xn;class BL{constructor(s=!1){this.active=!0,this.effects=[],this.cleanups=[],!s&&xn&&(this.parent=xn,this.index=(xn.scopes||(xn.scopes=[])).push(this)-1)}run(s){if(this.active){const d=xn;try{return xn=this,s()}finally{xn=d}}}on(){xn=this}off(){xn=this.parent}stop(s){if(this.active){let d,p;for(d=0,p=this.effects.length;d<p;d++)this.effects[d].stop();for(d=0,p=this.cleanups.length;d<p;d++)this.cleanups[d]();if(this.scopes)for(d=0,p=this.scopes.length;d<p;d++)this.scopes[d].stop(!0);if(this.parent&&!s){const _=this.parent.scopes.pop();_&&_!==this&&(this.parent.scopes[this.index]=_,_.index=this.index)}this.active=!1}}}function HL(r,s=xn){s&&s.active&&s.effects.push(r)}function $L(){return xn}function zL(r){xn&&xn.cleanups.push(r)}const Um=r=>{const s=new Set(r);return s.w=0,s.n=0,s},Yk=r=>(r.w&Ri)>0,Xk=r=>(r.n&Ri)>0,WL=({deps:r})=>{if(r.length)for(let s=0;s<r.length;s++)r[s].w|=Ri},GL=r=>{const{deps:s}=r;if(s.length){let d=0;for(let p=0;p<s.length;p++){const _=s[p];Yk(_)&&!Xk(_)?_.delete(r):s[d++]=_,_.w&=~Ri,_.n&=~Ri}s.length=d}},am=new WeakMap;let $s=0,Ri=1;const sm=30;let rr;const lo=Symbol(""),cm=Symbol("");class Vm{constructor(s,d=null,p){this.fn=s,this.scheduler=d,this.active=!0,this.deps=[],this.parent=void 0,HL(this,p)}run(){if(!this.active)return this.fn();let s=rr,d=Ei;for(;s;){if(s===this)return;s=s.parent}try{return this.parent=rr,rr=this,Ei=!0,Ri=1<<++$s,$s<=sm?WL(this):j1(this),this.fn()}finally{$s<=sm&&GL(this),Ri=1<<--$s,rr=this.parent,Ei=d,this.parent=void 0,this.deferStop&&this.stop()}}stop(){rr===this?this.deferStop=!0:this.active&&(j1(this),this.onStop&&this.onStop(),this.active=!1)}}function j1(r){const{deps:s}=r;if(s.length){for(let d=0;d<s.length;d++)s[d].delete(r);s.length=0}}let Ei=!0;const Zk=[];function La(){Zk.push(Ei),Ei=!1}function Ma(){const r=Zk.pop();Ei=r===void 0?!0:r}function Nn(r,s,d){if(Ei&&rr){let p=am.get(r);p||am.set(r,p=new Map);let _=p.get(d);_||p.set(d,_=Um()),eI(_)}}function eI(r,s){let d=!1;$s<=sm?Xk(r)||(r.n|=Ri,d=!Yk(r)):d=!r.has(rr),d&&(r.add(rr),rr.deps.push(r))}function zr(r,s,d,p,_,k){const b=am.get(r);if(!b)return;let w=[];if(s==="clear")w=[...b.values()];else if(d==="length"&&qe(r))b.forEach((A,P)=>{(P==="length"||P>=p)&&w.push(A)});else switch(d!==void 0&&w.push(b.get(d)),s){case"add":qe(r)?Mm(d)&&w.push(b.get("length")):(w.push(b.get(lo)),Ea(r)&&w.push(b.get(cm)));break;case"delete":qe(r)||(w.push(b.get(lo)),Ea(r)&&w.push(b.get(cm)));break;case"set":Ea(r)&&w.push(b.get(lo));break}if(w.length===1)w[0]&&um(w[0]);else{const A=[];for(const P of w)P&&A.push(...P);um(Um(A))}}function um(r,s){const d=qe(r)?r:[...r];for(const p of d)p.computed&&B1(p);for(const p of d)p.computed||B1(p)}function B1(r,s){(r!==rr||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const JL=Dm("__proto__,__v_isRef,__isVue"),tI=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Lm)),qL=Fm(),KL=Fm(!1,!0),QL=Fm(!0),H1=YL();function YL(){const r={};return["includes","indexOf","lastIndexOf"].forEach(s=>{r[s]=function(...d){const p=st(this);for(let k=0,b=this.length;k<b;k++)Nn(p,"get",k+"");const _=p[s](...d);return _===-1||_===!1?p[s](...d.map(st)):_}}),["push","pop","shift","unshift","splice"].forEach(s=>{r[s]=function(...d){La();const p=st(this)[s].apply(this,d);return Ma(),p}}),r}function Fm(r=!1,s=!1){return function(p,_,k){if(_==="__v_isReactive")return!r;if(_==="__v_isReadonly")return r;if(_==="__v_isShallow")return s;if(_==="__v_raw"&&k===(r?s?fM:aI:s?oI:iI).get(p))return p;const b=qe(p);if(!r&&b&&ot(H1,_))return Reflect.get(H1,_,k);const w=Reflect.get(p,_,k);return(Lm(_)?tI.has(_):JL(_))||(r||Nn(p,"get",_),s)?w:Xt(w)?b&&Mm(_)?w:w.value:Lt(w)?r?Hm(w):El(w):w}}const XL=nI(),ZL=nI(!0);function nI(r=!1){return function(d,p,_,k){let b=d[p];if(rc(b)&&Xt(b)&&!Xt(_))return!1;if(!r&&!rc(_)&&(lm(_)||(_=st(_),b=st(b)),!qe(d)&&Xt(b)&&!Xt(_)))return b.value=_,!0;const w=qe(d)&&Mm(p)?Number(p)<d.length:ot(d,p),A=Reflect.set(d,p,_,k);return d===st(k)&&(w?nc(_,b)&&zr(d,"set",p,_):zr(d,"add",p,_)),A}}function eM(r,s){const d=ot(r,s);r[s];const p=Reflect.deleteProperty(r,s);return p&&d&&zr(r,"delete",s,void 0),p}function tM(r,s){const d=Reflect.has(r,s);return(!Lm(s)||!tI.has(s))&&Nn(r,"has",s),d}function nM(r){return Nn(r,"iterate",qe(r)?"length":lo),Reflect.ownKeys(r)}const rI={get:qL,set:XL,deleteProperty:eM,has:tM,ownKeys:nM},rM={get:QL,set(r,s){return!0},deleteProperty(r,s){return!0}},iM=Wt({},rI,{get:KL,set:ZL}),jm=r=>r,wl=r=>Reflect.getPrototypeOf(r);function nl(r,s,d=!1,p=!1){r=r.__v_raw;const _=st(r),k=st(s);d||(s!==k&&Nn(_,"get",s),Nn(_,"get",k));const{has:b}=wl(_),w=p?jm:d?zm:ic;if(b.call(_,s))return w(r.get(s));if(b.call(_,k))return w(r.get(k));r!==_&&r.get(s)}function rl(r,s=!1){const d=this.__v_raw,p=st(d),_=st(r);return s||(r!==_&&Nn(p,"has",r),Nn(p,"has",_)),r===_?d.has(r):d.has(r)||d.has(_)}function il(r,s=!1){return r=r.__v_raw,!s&&Nn(st(r),"iterate",lo),Reflect.get(r,"size",r)}function $1(r){r=st(r);const s=st(this);return wl(s).has.call(s,r)||(s.add(r),zr(s,"add",r,r)),this}function z1(r,s){s=st(s);const d=st(this),{has:p,get:_}=wl(d);let k=p.call(d,r);k||(r=st(r),k=p.call(d,r));const b=_.call(d,r);return d.set(r,s),k?nc(s,b)&&zr(d,"set",r,s):zr(d,"add",r,s),this}function W1(r){const s=st(this),{has:d,get:p}=wl(s);let _=d.call(s,r);_||(r=st(r),_=d.call(s,r)),p&&p.call(s,r);const k=s.delete(r);return _&&zr(s,"delete",r,void 0),k}function G1(){const r=st(this),s=r.size!==0,d=r.clear();return s&&zr(r,"clear",void 0,void 0),d}function ol(r,s){return function(p,_){const k=this,b=k.__v_raw,w=st(b),A=s?jm:r?zm:ic;return!r&&Nn(w,"iterate",lo),b.forEach((P,N)=>p.call(_,A(P),A(N),k))}}function al(r,s,d){return function(...p){const _=this.__v_raw,k=st(_),b=Ea(k),w=r==="entries"||r===Symbol.iterator&&b,A=r==="keys"&&b,P=_[r](...p),N=d?jm:s?zm:ic;return!s&&Nn(k,"iterate",A?cm:lo),{next(){const{value:$,done:W}=P.next();return W?{value:$,done:W}:{value:w?[N($[0]),N($[1])]:N($),done:W}},[Symbol.iterator](){return this}}}}function bi(r){return function(...s){return r==="delete"?!1:this}}function oM(){const r={get(k){return nl(this,k)},get size(){return il(this)},has:rl,add:$1,set:z1,delete:W1,clear:G1,forEach:ol(!1,!1)},s={get(k){return nl(this,k,!1,!0)},get size(){return il(this)},has:rl,add:$1,set:z1,delete:W1,clear:G1,forEach:ol(!1,!0)},d={get(k){return nl(this,k,!0)},get size(){return il(this,!0)},has(k){return rl.call(this,k,!0)},add:bi("add"),set:bi("set"),delete:bi("delete"),clear:bi("clear"),forEach:ol(!0,!1)},p={get(k){return nl(this,k,!0,!0)},get size(){return il(this,!0)},has(k){return rl.call(this,k,!0)},add:bi("add"),set:bi("set"),delete:bi("delete"),clear:bi("clear"),forEach:ol(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(k=>{r[k]=al(k,!1,!1),d[k]=al(k,!0,!1),s[k]=al(k,!1,!0),p[k]=al(k,!0,!0)}),[r,d,s,p]}const[aM,sM,cM,uM]=oM();function Bm(r,s){const d=s?r?uM:cM:r?sM:aM;return(p,_,k)=>_==="__v_isReactive"?!r:_==="__v_isReadonly"?r:_==="__v_raw"?p:Reflect.get(ot(d,_)&&_ in p?d:p,_,k)}const lM={get:Bm(!1,!1)},dM={get:Bm(!1,!0)},hM={get:Bm(!0,!1)},iI=new WeakMap,oI=new WeakMap,aI=new WeakMap,fM=new WeakMap;function pM(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mM(r){return r.__v_skip||!Object.isExtensible(r)?0:pM(UL(r))}function El(r){return rc(r)?r:$m(r,!1,rI,lM,iI)}function gM(r){return $m(r,!1,iM,dM,oI)}function Hm(r){return $m(r,!0,rM,hM,aI)}function $m(r,s,d,p,_){if(!Lt(r)||r.__v_raw&&!(s&&r.__v_isReactive))return r;const k=_.get(r);if(k)return k;const b=mM(r);if(b===0)return r;const w=new Proxy(r,b===2?p:d);return _.set(r,w),w}function Ca(r){return rc(r)?Ca(r.__v_raw):!!(r&&r.__v_isReactive)}function rc(r){return!!(r&&r.__v_isReadonly)}function lm(r){return!!(r&&r.__v_isShallow)}function sI(r){return Ca(r)||rc(r)}function st(r){const s=r&&r.__v_raw;return s?st(s):r}function cI(r){return pl(r,"__v_skip",!0),r}const ic=r=>Lt(r)?El(r):r,zm=r=>Lt(r)?Hm(r):r;function uI(r){Ei&&rr&&(r=st(r),eI(r.dep||(r.dep=Um())))}function lI(r,s){r=st(r),r.dep&&um(r.dep)}function Xt(r){return!!(r&&r.__v_isRef===!0)}function Kt(r){return vM(r,!1)}function vM(r,s){return Xt(r)?r:new _M(r,s)}class _M{constructor(s,d){this.__v_isShallow=d,this.dep=void 0,this.__v_isRef=!0,this._rawValue=d?s:st(s),this._value=d?s:ic(s)}get value(){return uI(this),this._value}set value(s){s=this.__v_isShallow?s:st(s),nc(s,this._rawValue)&&(this._rawValue=s,this._value=this.__v_isShallow?s:ic(s),lI(this))}}function Tn(r){return Xt(r)?r.value:r}const yM={get:(r,s,d)=>Tn(Reflect.get(r,s,d)),set:(r,s,d,p)=>{const _=r[s];return Xt(_)&&!Xt(d)?(_.value=d,!0):Reflect.set(r,s,d,p)}};function dI(r){return Ca(r)?r:new Proxy(r,yM)}class bM{constructor(s,d,p){this._object=s,this._key=d,this._defaultValue=p,this.__v_isRef=!0}get value(){const s=this._object[this._key];return s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}}function Wm(r,s,d){const p=r[s];return Xt(p)?p:new bM(r,s,d)}class SM{constructor(s,d,p,_){this._setter=d,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Vm(s,()=>{this._dirty||(this._dirty=!0,lI(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!_,this.__v_isReadonly=p}get value(){const s=st(this);return uI(s),(s._dirty||!s._cacheable)&&(s._dirty=!1,s._value=s.effect.run()),s._value}set value(s){this._setter(s)}}function kM(r,s,d=!1){let p,_;const k=Ze(r);return k?(p=r,_=or):(p=r.get,_=r.set),new SM(p,_,k||!_,d)}function Ci(r,s,d,p){let _;try{_=p?r(...p):r()}catch(k){Cl(k,s,d)}return _}function zn(r,s,d,p){if(Ze(r)){const k=Ci(r,s,d,p);return k&&Gk(k)&&k.catch(b=>{Cl(b,s,d)}),k}const _=[];for(let k=0;k<r.length;k++)_.push(zn(r[k],s,d,p));return _}function Cl(r,s,d,p=!0){const _=s?s.vnode:null;if(s){let k=s.parent;const b=s.proxy,w=d;for(;k;){const P=k.ec;if(P){for(let N=0;N<P.length;N++)if(P[N](r,b,w)===!1)return}k=k.parent}const A=s.appContext.config.errorHandler;if(A){Ci(A,null,10,[r,b,w]);return}}IM(r,d,_,p)}function IM(r,s,d,p=!0){console.error(r)}let ml=!1,dm=!1;const Pn=[];let $r=0;const Ws=[];let zs=null,ka=0;const Gs=[];let ki=null,Ia=0;const hI=Promise.resolve();let Gm=null,hm=null;function fI(r){const s=Gm||hI;return r?s.then(this?r.bind(this):r):s}function TM(r){let s=$r+1,d=Pn.length;for(;s<d;){const p=s+d>>>1;oc(Pn[p])<r?s=p+1:d=p}return s}function pI(r){(!Pn.length||!Pn.includes(r,ml&&r.allowRecurse?$r+1:$r))&&r!==hm&&(r.id==null?Pn.push(r):Pn.splice(TM(r.id),0,r),mI())}function mI(){!ml&&!dm&&(dm=!0,Gm=hI.then(_I))}function wM(r){const s=Pn.indexOf(r);s>$r&&Pn.splice(s,1)}function gI(r,s,d,p){qe(r)?d.push(...r):(!s||!s.includes(r,r.allowRecurse?p+1:p))&&d.push(r),mI()}function EM(r){gI(r,zs,Ws,ka)}function CM(r){gI(r,ki,Gs,Ia)}function Rl(r,s=null){if(Ws.length){for(hm=s,zs=[...new Set(Ws)],Ws.length=0,ka=0;ka<zs.length;ka++)zs[ka]();zs=null,ka=0,hm=null,Rl(r,s)}}function vI(r){if(Rl(),Gs.length){const s=[...new Set(Gs)];if(Gs.length=0,ki){ki.push(...s);return}for(ki=s,ki.sort((d,p)=>oc(d)-oc(p)),Ia=0;Ia<ki.length;Ia++)ki[Ia]();ki=null,Ia=0}}const oc=r=>r.id==null?1/0:r.id;function _I(r){dm=!1,ml=!0,Rl(r),Pn.sort((d,p)=>oc(d)-oc(p));const s=or;try{for($r=0;$r<Pn.length;$r++){const d=Pn[$r];d&&d.active!==!1&&Ci(d,null,14)}}finally{$r=0,Pn.length=0,vI(),ml=!1,Gm=null,(Pn.length||Ws.length||Gs.length)&&_I(r)}}function RM(r,s,...d){if(r.isUnmounted)return;const p=r.vnode.props||It;let _=d;const k=s.startsWith("update:"),b=k&&s.slice(7);if(b&&b in p){const N=`${b==="modelValue"?"model":b}Modifiers`,{number:$,trim:W}=p[N]||It;W&&(_=d.map(de=>de.trim())),$&&(_=d.map(Qk))}let w,A=p[w=Jp(s)]||p[w=Jp(xa(s))];!A&&k&&(A=p[w=Jp(Na(s))]),A&&zn(A,r,6,_);const P=p[w+"Once"];if(P){if(!r.emitted)r.emitted={};else if(r.emitted[w])return;r.emitted[w]=!0,zn(P,r,6,_)}}function yI(r,s,d=!1){const p=s.emitsCache,_=p.get(r);if(_!==void 0)return _;const k=r.emits;let b={},w=!1;if(!Ze(r)){const A=P=>{const N=yI(P,s,!0);N&&(w=!0,Wt(b,N))};!d&&s.mixins.length&&s.mixins.forEach(A),r.extends&&A(r.extends),r.mixins&&r.mixins.forEach(A)}return!k&&!w?(p.set(r,null),null):(qe(k)?k.forEach(A=>b[A]=null):Wt(b,k),p.set(r,b),b)}function Al(r,s){return!r||!kl(s)?!1:(s=s.slice(2).replace(/Once$/,""),ot(r,s[0].toLowerCase()+s.slice(1))||ot(r,Na(s))||ot(r,s))}let wn=null,xl=null;function gl(r){const s=wn;return wn=r,xl=r&&r.type.__scopeId||null,s}function AM(r){xl=r}function xM(){xl=null}function Ii(r,s=wn,d){if(!s||r._n)return r;const p=(..._)=>{p._d&&rk(-1);const k=gl(s),b=r(..._);return gl(k),p._d&&rk(1),b};return p._n=!0,p._c=!0,p._d=!0,p}function Kp(r){const{type:s,vnode:d,proxy:p,withProxy:_,props:k,propsOptions:[b],slots:w,attrs:A,emit:P,render:N,renderCache:$,data:W,setupState:de,ctx:X,inheritAttrs:ce}=r;let ge,be;const Ye=gl(r);try{if(d.shapeFlag&4){const Ae=_||p;ge=br(N.call(Ae,Ae,$,k,de,W,X)),be=A}else{const Ae=s;ge=br(Ae.length>1?Ae(k,{attrs:A,slots:w,emit:P}):Ae(k,null)),be=s.props?A:PM(A)}}catch(Ae){Ks.length=0,Cl(Ae,r,1),ge=wt(Gn)}let at=ge;if(be&&ce!==!1){const Ae=Object.keys(be),{shapeFlag:Xe}=at;Ae.length&&Xe&7&&(b&&Ae.some(Om)&&(be=DM(be,b)),at=Ai(at,be))}return d.dirs&&(at=Ai(at),at.dirs=at.dirs?at.dirs.concat(d.dirs):d.dirs),d.transition&&(at.transition=d.transition),ge=at,gl(Ye),ge}const PM=r=>{let s;for(const d in r)(d==="class"||d==="style"||kl(d))&&((s||(s={}))[d]=r[d]);return s},DM=(r,s)=>{const d={};for(const p in r)(!Om(p)||!(p.slice(9)in s))&&(d[p]=r[p]);return d};function OM(r,s,d){const{props:p,children:_,component:k}=r,{props:b,children:w,patchFlag:A}=s,P=k.emitsOptions;if(s.dirs||s.transition)return!0;if(d&&A>=0){if(A&1024)return!0;if(A&16)return p?J1(p,b,P):!!b;if(A&8){const N=s.dynamicProps;for(let $=0;$<N.length;$++){const W=N[$];if(b[W]!==p[W]&&!Al(P,W))return!0}}}else return(_||w)&&(!w||!w.$stable)?!0:p===b?!1:p?b?J1(p,b,P):!0:!!b;return!1}function J1(r,s,d){const p=Object.keys(s);if(p.length!==Object.keys(r).length)return!0;for(let _=0;_<p.length;_++){const k=p[_];if(s[k]!==r[k]&&!Al(d,k))return!0}return!1}function NM({vnode:r,parent:s},d){for(;s&&s.subTree===r;)(r=s.vnode).el=d,s=s.parent}const LM=r=>r.__isSuspense;function MM(r,s){s&&s.pendingBranch?qe(r)?s.effects.push(...r):s.effects.push(r):CM(r)}function fm(r,s){if(Yt){let d=Yt.provides;const p=Yt.parent&&Yt.parent.provides;p===d&&(d=Yt.provides=Object.create(p)),d[r]=s}}function Wn(r,s,d=!1){const p=Yt||wn;if(p){const _=p.parent==null?p.vnode.appContext&&p.vnode.appContext.provides:p.parent.provides;if(_&&r in _)return _[r];if(arguments.length>1)return d&&Ze(s)?s.call(p.proxy):s}}function bI(r,s){return Jm(r,null,s)}const q1={};function Ra(r,s,d){return Jm(r,s,d)}function Jm(r,s,{immediate:d,deep:p,flush:_,onTrack:k,onTrigger:b}=It){const w=Yt;let A,P=!1,N=!1;if(Xt(r)?(A=()=>r.value,P=lm(r)):Ca(r)?(A=()=>r,p=!0):qe(r)?(N=!0,P=r.some(be=>Ca(be)||lm(be)),A=()=>r.map(be=>{if(Xt(be))return be.value;if(Ca(be))return Ta(be);if(Ze(be))return Ci(be,w,2)})):Ze(r)?s?A=()=>Ci(r,w,2):A=()=>{if(!(w&&w.isUnmounted))return $&&$(),zn(r,w,3,[W])}:A=or,s&&p){const be=A;A=()=>Ta(be())}let $,W=be=>{$=ge.onStop=()=>{Ci(be,w,4)}};if(uc)return W=or,s?d&&zn(s,w,3,[A(),N?[]:void 0,W]):A(),or;let de=N?[]:q1;const X=()=>{if(!!ge.active)if(s){const be=ge.run();(p||P||(N?be.some((Ye,at)=>nc(Ye,de[at])):nc(be,de)))&&($&&$(),zn(s,w,3,[be,de===q1?void 0:de,W]),de=be)}else ge.run()};X.allowRecurse=!!s;let ce;_==="sync"?ce=X:_==="post"?ce=()=>kn(X,w&&w.suspense):ce=()=>EM(X);const ge=new Vm(A,ce);return s?d?X():de=ge.run():_==="post"?kn(ge.run.bind(ge),w&&w.suspense):ge.run(),()=>{ge.stop(),w&&w.scope&&Nm(w.scope.effects,ge)}}function UM(r,s,d){const p=this.proxy,_=jt(r)?r.includes(".")?SI(p,r):()=>p[r]:r.bind(p,p);let k;Ze(s)?k=s:(k=s.handler,d=s);const b=Yt;Pa(this);const w=Jm(_,k.bind(p),d);return b?Pa(b):fo(),w}function SI(r,s){const d=s.split(".");return()=>{let p=r;for(let _=0;_<d.length&&p;_++)p=p[d[_]];return p}}function Ta(r,s){if(!Lt(r)||r.__v_skip||(s=s||new Set,s.has(r)))return r;if(s.add(r),Xt(r))Ta(r.value,s);else if(qe(r))for(let d=0;d<r.length;d++)Ta(r[d],s);else if(Wk(r)||Ea(r))r.forEach(d=>{Ta(d,s)});else if(qk(r))for(const d in r)Ta(r[d],s);return r}function kI(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return hc(()=>{r.isMounted=!0}),CI(()=>{r.isUnmounting=!0}),r}const $n=[Function,Array],VM={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$n,onEnter:$n,onAfterEnter:$n,onEnterCancelled:$n,onBeforeLeave:$n,onLeave:$n,onAfterLeave:$n,onLeaveCancelled:$n,onBeforeAppear:$n,onAppear:$n,onAfterAppear:$n,onAppearCancelled:$n},setup(r,{slots:s}){const d=eg(),p=kI();let _;return()=>{const k=s.default&&qm(s.default(),!0);if(!k||!k.length)return;let b=k[0];if(k.length>1){for(const ce of k)if(ce.type!==Gn){b=ce;break}}const w=st(r),{mode:A}=w;if(p.isLeaving)return Qp(b);const P=K1(b);if(!P)return Qp(b);const N=ac(P,w,p,d);sc(P,N);const $=d.subTree,W=$&&K1($);let de=!1;const{getTransitionKey:X}=P.type;if(X){const ce=X();_===void 0?_=ce:ce!==_&&(_=ce,de=!0)}if(W&&W.type!==Gn&&(!oo(P,W)||de)){const ce=ac(W,w,p,d);if(sc(W,ce),A==="out-in")return p.isLeaving=!0,ce.afterLeave=()=>{p.isLeaving=!1,d.update()},Qp(b);A==="in-out"&&P.type!==Gn&&(ce.delayLeave=(ge,be,Ye)=>{const at=TI(p,W);at[String(W.key)]=W,ge._leaveCb=()=>{be(),ge._leaveCb=void 0,delete N.delayedLeave},N.delayedLeave=Ye})}return b}}},II=VM;function TI(r,s){const{leavingVNodes:d}=r;let p=d.get(s.type);return p||(p=Object.create(null),d.set(s.type,p)),p}function ac(r,s,d,p){const{appear:_,mode:k,persisted:b=!1,onBeforeEnter:w,onEnter:A,onAfterEnter:P,onEnterCancelled:N,onBeforeLeave:$,onLeave:W,onAfterLeave:de,onLeaveCancelled:X,onBeforeAppear:ce,onAppear:ge,onAfterAppear:be,onAppearCancelled:Ye}=s,at=String(r.key),Ae=TI(d,r),Xe=(He,Ge)=>{He&&zn(He,p,9,Ge)},Ke=(He,Ge)=>{const ze=Ge[1];Xe(He,Ge),qe(He)?He.every(ft=>ft.length<=1)&&ze():He.length<=1&&ze()},yt={mode:k,persisted:b,beforeEnter(He){let Ge=w;if(!d.isMounted)if(_)Ge=ce||w;else return;He._leaveCb&&He._leaveCb(!0);const ze=Ae[at];ze&&oo(r,ze)&&ze.el._leaveCb&&ze.el._leaveCb(),Xe(Ge,[He])},enter(He){let Ge=A,ze=P,ft=N;if(!d.isMounted)if(_)Ge=ge||A,ze=be||P,ft=Ye||N;else return;let Ie=!1;const rt=He._enterCb=Mt=>{Ie||(Ie=!0,Mt?Xe(ft,[He]):Xe(ze,[He]),yt.delayedLeave&&yt.delayedLeave(),He._enterCb=void 0)};Ge?Ke(Ge,[He,rt]):rt()},leave(He,Ge){const ze=String(r.key);if(He._enterCb&&He._enterCb(!0),d.isUnmounting)return Ge();Xe($,[He]);let ft=!1;const Ie=He._leaveCb=rt=>{ft||(ft=!0,Ge(),rt?Xe(X,[He]):Xe(de,[He]),He._leaveCb=void 0,Ae[ze]===r&&delete Ae[ze])};Ae[ze]=r,W?Ke(W,[He,Ie]):Ie()},clone(He){return ac(He,s,d,p)}};return yt}function Qp(r){if(Pl(r))return r=Ai(r),r.children=null,r}function K1(r){return Pl(r)?r.children?r.children[0]:void 0:r}function sc(r,s){r.shapeFlag&6&&r.component?sc(r.component.subTree,s):r.shapeFlag&128?(r.ssContent.transition=s.clone(r.ssContent),r.ssFallback.transition=s.clone(r.ssFallback)):r.transition=s}function qm(r,s=!1,d){let p=[],_=0;for(let k=0;k<r.length;k++){let b=r[k];const w=d==null?b.key:String(d)+String(b.key!=null?b.key:k);b.type===Qt?(b.patchFlag&128&&_++,p=p.concat(qm(b.children,s,w))):(s||b.type!==Gn)&&p.push(w!=null?Ai(b,{key:w}):b)}if(_>1)for(let k=0;k<p.length;k++)p[k].patchFlag=-2;return p}function Zt(r){return Ze(r)?{setup:r,name:r.name}:r}const Js=r=>!!r.type.__asyncLoader,Pl=r=>r.type.__isKeepAlive;function FM(r,s){wI(r,"a",s)}function jM(r,s){wI(r,"da",s)}function wI(r,s,d=Yt){const p=r.__wdc||(r.__wdc=()=>{let _=d;for(;_;){if(_.isDeactivated)return;_=_.parent}return r()});if(Dl(s,p,d),d){let _=d.parent;for(;_&&_.parent;)Pl(_.parent.vnode)&&BM(p,s,d,_),_=_.parent}}function BM(r,s,d,p){const _=Dl(s,r,p,!0);RI(()=>{Nm(p[s],_)},d)}function Dl(r,s,d=Yt,p=!1){if(d){const _=d[r]||(d[r]=[]),k=s.__weh||(s.__weh=(...b)=>{if(d.isUnmounted)return;La(),Pa(d);const w=zn(s,d,r,b);return fo(),Ma(),w});return p?_.unshift(k):_.push(k),k}}const Wr=r=>(s,d=Yt)=>(!uc||r==="sp")&&Dl(r,s,d),Ol=Wr("bm"),hc=Wr("m"),HM=Wr("bu"),EI=Wr("u"),CI=Wr("bum"),RI=Wr("um"),$M=Wr("sp"),zM=Wr("rtg"),WM=Wr("rtc");function GM(r,s=Yt){Dl("ec",r,s)}function to(r,s,d,p){const _=r.dirs,k=s&&s.dirs;for(let b=0;b<_.length;b++){const w=_[b];k&&(w.oldValue=k[b].value);let A=w.dir[p];A&&(La(),zn(A,d,8,[r.el,w,r,s]),Ma())}}const JM=Symbol();function qM(r,s,d,p){let _;const k=d&&d[p];if(qe(r)||jt(r)){_=new Array(r.length);for(let b=0,w=r.length;b<w;b++)_[b]=s(r[b],b,void 0,k&&k[b])}else if(typeof r=="number"){_=new Array(r);for(let b=0;b<r;b++)_[b]=s(b+1,b,void 0,k&&k[b])}else if(Lt(r))if(r[Symbol.iterator])_=Array.from(r,(b,w)=>s(b,w,void 0,k&&k[w]));else{const b=Object.keys(r);_=new Array(b.length);for(let w=0,A=b.length;w<A;w++){const P=b[w];_[w]=s(r[P],P,w,k&&k[w])}}else _=[];return d&&(d[p]=_),_}function ho(r,s,d={},p,_){if(wn.isCE||wn.parent&&Js(wn.parent)&&wn.parent.isCE)return wt("slot",s==="default"?null:{name:s},p&&p());let k=r[s];k&&k._c&&(k._d=!1),xt();const b=k&&AI(k(d)),w=Xm(Qt,{key:d.key||`_${s}`},b||(p?p():[]),b&&r._===1?64:-2);return!_&&w.scopeId&&(w.slotScopeIds=[w.scopeId+"-s"]),k&&k._c&&(k._d=!0),w}function AI(r){return r.some(s=>yl(s)?!(s.type===Gn||s.type===Qt&&!AI(s.children)):!0)?r:null}const pm=r=>r?BI(r)?tg(r)||r.proxy:pm(r.parent):null,vl=Wt(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>pm(r.parent),$root:r=>pm(r.root),$emit:r=>r.emit,$options:r=>PI(r),$forceUpdate:r=>r.f||(r.f=()=>pI(r.update)),$nextTick:r=>r.n||(r.n=fI.bind(r.proxy)),$watch:r=>UM.bind(r)}),KM={get({_:r},s){const{ctx:d,setupState:p,data:_,props:k,accessCache:b,type:w,appContext:A}=r;let P;if(s[0]!=="$"){const de=b[s];if(de!==void 0)switch(de){case 1:return p[s];case 2:return _[s];case 4:return d[s];case 3:return k[s]}else{if(p!==It&&ot(p,s))return b[s]=1,p[s];if(_!==It&&ot(_,s))return b[s]=2,_[s];if((P=r.propsOptions[0])&&ot(P,s))return b[s]=3,k[s];if(d!==It&&ot(d,s))return b[s]=4,d[s];mm&&(b[s]=0)}}const N=vl[s];let $,W;if(N)return s==="$attrs"&&Nn(r,"get",s),N(r);if(($=w.__cssModules)&&($=$[s]))return $;if(d!==It&&ot(d,s))return b[s]=4,d[s];if(W=A.config.globalProperties,ot(W,s))return W[s]},set({_:r},s,d){const{data:p,setupState:_,ctx:k}=r;return _!==It&&ot(_,s)?(_[s]=d,!0):p!==It&&ot(p,s)?(p[s]=d,!0):ot(r.props,s)||s[0]==="$"&&s.slice(1)in r?!1:(k[s]=d,!0)},has({_:{data:r,setupState:s,accessCache:d,ctx:p,appContext:_,propsOptions:k}},b){let w;return!!d[b]||r!==It&&ot(r,b)||s!==It&&ot(s,b)||(w=k[0])&&ot(w,b)||ot(p,b)||ot(vl,b)||ot(_.config.globalProperties,b)},defineProperty(r,s,d){return d.get!=null?r._.accessCache[s]=0:ot(d,"value")&&this.set(r,s,d.value,null),Reflect.defineProperty(r,s,d)}};let mm=!0;function QM(r){const s=PI(r),d=r.proxy,p=r.ctx;mm=!1,s.beforeCreate&&Q1(s.beforeCreate,r,"bc");const{data:_,computed:k,methods:b,watch:w,provide:A,inject:P,created:N,beforeMount:$,mounted:W,beforeUpdate:de,updated:X,activated:ce,deactivated:ge,beforeDestroy:be,beforeUnmount:Ye,destroyed:at,unmounted:Ae,render:Xe,renderTracked:Ke,renderTriggered:yt,errorCaptured:He,serverPrefetch:Ge,expose:ze,inheritAttrs:ft,components:Ie,directives:rt,filters:Mt}=s;if(P&&YM(P,p,null,r.appContext.config.unwrapInjectedRef),b)for(const he in b){const Te=b[he];Ze(Te)&&(p[he]=Te.bind(d))}if(_){const he=_.call(d,d);Lt(he)&&(r.data=El(he))}if(mm=!0,k)for(const he in k){const Te=k[he],Bt=Ze(Te)?Te.bind(d,d):Ze(Te.get)?Te.get.bind(d,d):or,Jr=!Ze(Te)&&Ze(Te.set)?Te.set.bind(d):or,Le=nn({get:Bt,set:Jr});Object.defineProperty(p,he,{enumerable:!0,configurable:!0,get:()=>Le.value,set:Ir=>Le.value=Ir})}if(w)for(const he in w)xI(w[he],p,d,he);if(A){const he=Ze(A)?A.call(d):A;Reflect.ownKeys(he).forEach(Te=>{fm(Te,he[Te])})}N&&Q1(N,r,"c");function z(he,Te){qe(Te)?Te.forEach(Bt=>he(Bt.bind(d))):Te&&he(Te.bind(d))}if(z(Ol,$),z(hc,W),z(HM,de),z(EI,X),z(FM,ce),z(jM,ge),z(GM,He),z(WM,Ke),z(zM,yt),z(CI,Ye),z(RI,Ae),z($M,Ge),qe(ze))if(ze.length){const he=r.exposed||(r.exposed={});ze.forEach(Te=>{Object.defineProperty(he,Te,{get:()=>d[Te],set:Bt=>d[Te]=Bt})})}else r.exposed||(r.exposed={});Xe&&r.render===or&&(r.render=Xe),ft!=null&&(r.inheritAttrs=ft),Ie&&(r.components=Ie),rt&&(r.directives=rt)}function YM(r,s,d=or,p=!1){qe(r)&&(r=gm(r));for(const _ in r){const k=r[_];let b;Lt(k)?"default"in k?b=Wn(k.from||_,k.default,!0):b=Wn(k.from||_):b=Wn(k),Xt(b)&&p?Object.defineProperty(s,_,{enumerable:!0,configurable:!0,get:()=>b.value,set:w=>b.value=w}):s[_]=b}}function Q1(r,s,d){zn(qe(r)?r.map(p=>p.bind(s.proxy)):r.bind(s.proxy),s,d)}function xI(r,s,d,p){const _=p.includes(".")?SI(d,p):()=>d[p];if(jt(r)){const k=s[r];Ze(k)&&Ra(_,k)}else if(Ze(r))Ra(_,r.bind(d));else if(Lt(r))if(qe(r))r.forEach(k=>xI(k,s,d,p));else{const k=Ze(r.handler)?r.handler.bind(d):s[r.handler];Ze(k)&&Ra(_,k,r)}}function PI(r){const s=r.type,{mixins:d,extends:p}=s,{mixins:_,optionsCache:k,config:{optionMergeStrategies:b}}=r.appContext,w=k.get(s);let A;return w?A=w:!_.length&&!d&&!p?A=s:(A={},_.length&&_.forEach(P=>_l(A,P,b,!0)),_l(A,s,b)),k.set(s,A),A}function _l(r,s,d,p=!1){const{mixins:_,extends:k}=s;k&&_l(r,k,d,!0),_&&_.forEach(b=>_l(r,b,d,!0));for(const b in s)if(!(p&&b==="expose")){const w=XM[b]||d&&d[b];r[b]=w?w(r[b],s[b]):s[b]}return r}const XM={data:Y1,props:io,emits:io,methods:io,computed:io,beforeCreate:fn,created:fn,beforeMount:fn,mounted:fn,beforeUpdate:fn,updated:fn,beforeDestroy:fn,beforeUnmount:fn,destroyed:fn,unmounted:fn,activated:fn,deactivated:fn,errorCaptured:fn,serverPrefetch:fn,components:io,directives:io,watch:e3,provide:Y1,inject:ZM};function Y1(r,s){return s?r?function(){return Wt(Ze(r)?r.call(this,this):r,Ze(s)?s.call(this,this):s)}:s:r}function ZM(r,s){return io(gm(r),gm(s))}function gm(r){if(qe(r)){const s={};for(let d=0;d<r.length;d++)s[r[d]]=r[d];return s}return r}function fn(r,s){return r?[...new Set([].concat(r,s))]:s}function io(r,s){return r?Wt(Wt(Object.create(null),r),s):s}function e3(r,s){if(!r)return s;if(!s)return r;const d=Wt(Object.create(null),r);for(const p in s)d[p]=fn(r[p],s[p]);return d}function t3(r,s,d,p=!1){const _={},k={};pl(k,Nl,1),r.propsDefaults=Object.create(null),DI(r,s,_,k);for(const b in r.propsOptions[0])b in _||(_[b]=void 0);d?r.props=p?_:gM(_):r.type.props?r.props=_:r.props=k,r.attrs=k}function n3(r,s,d,p){const{props:_,attrs:k,vnode:{patchFlag:b}}=r,w=st(_),[A]=r.propsOptions;let P=!1;if((p||b>0)&&!(b&16)){if(b&8){const N=r.vnode.dynamicProps;for(let $=0;$<N.length;$++){let W=N[$];if(Al(r.emitsOptions,W))continue;const de=s[W];if(A)if(ot(k,W))de!==k[W]&&(k[W]=de,P=!0);else{const X=xa(W);_[X]=vm(A,w,X,de,r,!1)}else de!==k[W]&&(k[W]=de,P=!0)}}}else{DI(r,s,_,k)&&(P=!0);let N;for(const $ in w)(!s||!ot(s,$)&&((N=Na($))===$||!ot(s,N)))&&(A?d&&(d[$]!==void 0||d[N]!==void 0)&&(_[$]=vm(A,w,$,void 0,r,!0)):delete _[$]);if(k!==w)for(const $ in k)(!s||!ot(s,$)&&!0)&&(delete k[$],P=!0)}P&&zr(r,"set","$attrs")}function DI(r,s,d,p){const[_,k]=r.propsOptions;let b=!1,w;if(s)for(let A in s){if(hl(A))continue;const P=s[A];let N;_&&ot(_,N=xa(A))?!k||!k.includes(N)?d[N]=P:(w||(w={}))[N]=P:Al(r.emitsOptions,A)||(!(A in p)||P!==p[A])&&(p[A]=P,b=!0)}if(k){const A=st(d),P=w||It;for(let N=0;N<k.length;N++){const $=k[N];d[$]=vm(_,A,$,P[$],r,!ot(P,$))}}return b}function vm(r,s,d,p,_,k){const b=r[d];if(b!=null){const w=ot(b,"default");if(w&&p===void 0){const A=b.default;if(b.type!==Function&&Ze(A)){const{propsDefaults:P}=_;d in P?p=P[d]:(Pa(_),p=P[d]=A.call(null,s),fo())}else p=A}b[0]&&(k&&!w?p=!1:b[1]&&(p===""||p===Na(d))&&(p=!0))}return p}function OI(r,s,d=!1){const p=s.propsCache,_=p.get(r);if(_)return _;const k=r.props,b={},w=[];let A=!1;if(!Ze(r)){const N=$=>{A=!0;const[W,de]=OI($,s,!0);Wt(b,W),de&&w.push(...de)};!d&&s.mixins.length&&s.mixins.forEach(N),r.extends&&N(r.extends),r.mixins&&r.mixins.forEach(N)}if(!k&&!A)return p.set(r,wa),wa;if(qe(k))for(let N=0;N<k.length;N++){const $=xa(k[N]);X1($)&&(b[$]=It)}else if(k)for(const N in k){const $=xa(N);if(X1($)){const W=k[N],de=b[$]=qe(W)||Ze(W)?{type:W}:W;if(de){const X=tk(Boolean,de.type),ce=tk(String,de.type);de[0]=X>-1,de[1]=ce<0||X<ce,(X>-1||ot(de,"default"))&&w.push($)}}}const P=[b,w];return p.set(r,P),P}function X1(r){return r[0]!=="$"}function Z1(r){const s=r&&r.toString().match(/^\s*function (\w+)/);return s?s[1]:r===null?"null":""}function ek(r,s){return Z1(r)===Z1(s)}function tk(r,s){return qe(s)?s.findIndex(d=>ek(d,r)):Ze(s)&&ek(s,r)?0:-1}const NI=r=>r[0]==="_"||r==="$stable",Km=r=>qe(r)?r.map(br):[br(r)],r3=(r,s,d)=>{if(s._n)return s;const p=Ii((..._)=>Km(s(..._)),d);return p._c=!1,p},LI=(r,s,d)=>{const p=r._ctx;for(const _ in r){if(NI(_))continue;const k=r[_];if(Ze(k))s[_]=r3(_,k,p);else if(k!=null){const b=Km(k);s[_]=()=>b}}},MI=(r,s)=>{const d=Km(s);r.slots.default=()=>d},i3=(r,s)=>{if(r.vnode.shapeFlag&32){const d=s._;d?(r.slots=st(s),pl(s,"_",d)):LI(s,r.slots={})}else r.slots={},s&&MI(r,s);pl(r.slots,Nl,1)},o3=(r,s,d)=>{const{vnode:p,slots:_}=r;let k=!0,b=It;if(p.shapeFlag&32){const w=s._;w?d&&w===1?k=!1:(Wt(_,s),!d&&w===1&&delete _._):(k=!s.$stable,LI(s,_)),b=s}else s&&(MI(r,s),b={default:1});if(k)for(const w in _)!NI(w)&&!(w in b)&&delete _[w]};function UI(){return{app:null,config:{isNativeTag:NL,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let a3=0;function s3(r,s){return function(p,_=null){Ze(p)||(p=Object.assign({},p)),_!=null&&!Lt(_)&&(_=null);const k=UI(),b=new Set;let w=!1;const A=k.app={_uid:a3++,_component:p,_props:_,_container:null,_context:k,_instance:null,version:C3,get config(){return k.config},set config(P){},use(P,...N){return b.has(P)||(P&&Ze(P.install)?(b.add(P),P.install(A,...N)):Ze(P)&&(b.add(P),P(A,...N))),A},mixin(P){return k.mixins.includes(P)||k.mixins.push(P),A},component(P,N){return N?(k.components[P]=N,A):k.components[P]},directive(P,N){return N?(k.directives[P]=N,A):k.directives[P]},mount(P,N,$){if(!w){const W=wt(p,_);return W.appContext=k,N&&s?s(W,P):r(W,P,$),w=!0,A._container=P,P.__vue_app__=A,tg(W.component)||W.component.proxy}},unmount(){w&&(r(null,A._container),delete A._container.__vue_app__)},provide(P,N){return k.provides[P]=N,A}};return A}}function _m(r,s,d,p,_=!1){if(qe(r)){r.forEach((W,de)=>_m(W,s&&(qe(s)?s[de]:s),d,p,_));return}if(Js(p)&&!_)return;const k=p.shapeFlag&4?tg(p.component)||p.component.proxy:p.el,b=_?null:k,{i:w,r:A}=r,P=s&&s.r,N=w.refs===It?w.refs={}:w.refs,$=w.setupState;if(P!=null&&P!==A&&(jt(P)?(N[P]=null,ot($,P)&&($[P]=null)):Xt(P)&&(P.value=null)),Ze(A))Ci(A,w,12,[b,N]);else{const W=jt(A),de=Xt(A);if(W||de){const X=()=>{if(r.f){const ce=W?N[A]:A.value;_?qe(ce)&&Nm(ce,k):qe(ce)?ce.includes(k)||ce.push(k):W?(N[A]=[k],ot($,A)&&($[A]=N[A])):(A.value=[k],r.k&&(N[r.k]=A.value))}else W?(N[A]=b,ot($,A)&&($[A]=b)):de&&(A.value=b,r.k&&(N[r.k]=b))};b?(X.id=-1,kn(X,d)):X()}}}const kn=MM;function c3(r){return u3(r)}function u3(r,s){const d=jL();d.__VUE__=!0;const{insert:p,remove:_,patchProp:k,createElement:b,createText:w,createComment:A,setText:P,setElementText:N,parentNode:$,nextSibling:W,setScopeId:de=or,cloneNode:X,insertStaticContent:ce}=r,ge=(L,B,ee,oe=null,ae=null,ue=null,me=!1,te=null,ie=!!B.dynamicChildren)=>{if(L===B)return;L&&!oo(L,B)&&(oe=qr(L),Jn(L,ae,ue,!0),L=null),B.patchFlag===-2&&(ie=!1,B.dynamicChildren=null);const{type:le,ref:Ce,shapeFlag:ke}=B;switch(le){case Ym:be(L,B,ee,oe);break;case Gn:Ye(L,B,ee,oe);break;case Yp:L==null&&at(B,ee,oe,me);break;case Qt:rt(L,B,ee,oe,ae,ue,me,te,ie);break;default:ke&1?Ke(L,B,ee,oe,ae,ue,me,te,ie):ke&6?Mt(L,B,ee,oe,ae,ue,me,te,ie):(ke&64||ke&128)&&le.process(L,B,ee,oe,ae,ue,me,te,ie,ne)}Ce!=null&&ae&&_m(Ce,L&&L.ref,ue,B||L,!B)},be=(L,B,ee,oe)=>{if(L==null)p(B.el=w(B.children),ee,oe);else{const ae=B.el=L.el;B.children!==L.children&&P(ae,B.children)}},Ye=(L,B,ee,oe)=>{L==null?p(B.el=A(B.children||""),ee,oe):B.el=L.el},at=(L,B,ee,oe)=>{[L.el,L.anchor]=ce(L.children,B,ee,oe,L.el,L.anchor)},Ae=({el:L,anchor:B},ee,oe)=>{let ae;for(;L&&L!==B;)ae=W(L),p(L,ee,oe),L=ae;p(B,ee,oe)},Xe=({el:L,anchor:B})=>{let ee;for(;L&&L!==B;)ee=W(L),_(L),L=ee;_(B)},Ke=(L,B,ee,oe,ae,ue,me,te,ie)=>{me=me||B.type==="svg",L==null?yt(B,ee,oe,ae,ue,me,te,ie):ze(L,B,ae,ue,me,te,ie)},yt=(L,B,ee,oe,ae,ue,me,te)=>{let ie,le;const{type:Ce,props:ke,shapeFlag:Ee,transition:We,patchFlag:et,dirs:ut}=L;if(L.el&&X!==void 0&&et===-1)ie=L.el=X(L.el);else{if(ie=L.el=b(L.type,ue,ke&&ke.is,ke),Ee&8?N(ie,L.children):Ee&16&&Ge(L.children,ie,null,oe,ae,ue&&Ce!=="foreignObject",me,te),ut&&to(L,null,oe,"created"),ke){for(const tt in ke)tt!=="value"&&!hl(tt)&&k(ie,tt,null,ke[tt],ue,L.children,oe,ae,qn);"value"in ke&&k(ie,"value",null,ke.value),(le=ke.onVnodeBeforeMount)&&vr(le,oe,L)}He(ie,L,L.scopeId,me,oe)}ut&&to(L,null,oe,"beforeMount");const lt=(!ae||ae&&!ae.pendingBranch)&&We&&!We.persisted;lt&&We.beforeEnter(ie),p(ie,B,ee),((le=ke&&ke.onVnodeMounted)||lt||ut)&&kn(()=>{le&&vr(le,oe,L),lt&&We.enter(ie),ut&&to(L,null,oe,"mounted")},ae)},He=(L,B,ee,oe,ae)=>{if(ee&&de(L,ee),oe)for(let ue=0;ue<oe.length;ue++)de(L,oe[ue]);if(ae){let ue=ae.subTree;if(B===ue){const me=ae.vnode;He(L,me,me.scopeId,me.slotScopeIds,ae.parent)}}},Ge=(L,B,ee,oe,ae,ue,me,te,ie=0)=>{for(let le=ie;le<L.length;le++){const Ce=L[le]=te?wi(L[le]):br(L[le]);ge(null,Ce,B,ee,oe,ae,ue,me,te)}},ze=(L,B,ee,oe,ae,ue,me)=>{const te=B.el=L.el;let{patchFlag:ie,dynamicChildren:le,dirs:Ce}=B;ie|=L.patchFlag&16;const ke=L.props||It,Ee=B.props||It;let We;ee&&no(ee,!1),(We=Ee.onVnodeBeforeUpdate)&&vr(We,ee,B,L),Ce&&to(B,L,ee,"beforeUpdate"),ee&&no(ee,!0);const et=ae&&B.type!=="foreignObject";if(le?ft(L.dynamicChildren,le,te,ee,oe,et,ue):me||Bt(L,B,te,null,ee,oe,et,ue,!1),ie>0){if(ie&16)Ie(te,B,ke,Ee,ee,oe,ae);else if(ie&2&&ke.class!==Ee.class&&k(te,"class",null,Ee.class,ae),ie&4&&k(te,"style",ke.style,Ee.style,ae),ie&8){const ut=B.dynamicProps;for(let lt=0;lt<ut.length;lt++){const tt=ut[lt],on=ke[tt],ar=Ee[tt];(ar!==on||tt==="value")&&k(te,tt,on,ar,ae,L.children,ee,oe,qn)}}ie&1&&L.children!==B.children&&N(te,B.children)}else!me&&le==null&&Ie(te,B,ke,Ee,ee,oe,ae);((We=Ee.onVnodeUpdated)||Ce)&&kn(()=>{We&&vr(We,ee,B,L),Ce&&to(B,L,ee,"updated")},oe)},ft=(L,B,ee,oe,ae,ue,me)=>{for(let te=0;te<B.length;te++){const ie=L[te],le=B[te],Ce=ie.el&&(ie.type===Qt||!oo(ie,le)||ie.shapeFlag&70)?$(ie.el):ee;ge(ie,le,Ce,null,oe,ae,ue,me,!0)}},Ie=(L,B,ee,oe,ae,ue,me)=>{if(ee!==oe){for(const te in oe){if(hl(te))continue;const ie=oe[te],le=ee[te];ie!==le&&te!=="value"&&k(L,te,le,ie,me,B.children,ae,ue,qn)}if(ee!==It)for(const te in ee)!hl(te)&&!(te in oe)&&k(L,te,ee[te],null,me,B.children,ae,ue,qn);"value"in oe&&k(L,"value",ee.value,oe.value)}},rt=(L,B,ee,oe,ae,ue,me,te,ie)=>{const le=B.el=L?L.el:w(""),Ce=B.anchor=L?L.anchor:w("");let{patchFlag:ke,dynamicChildren:Ee,slotScopeIds:We}=B;We&&(te=te?te.concat(We):We),L==null?(p(le,ee,oe),p(Ce,ee,oe),Ge(B.children,ee,Ce,ae,ue,me,te,ie)):ke>0&&ke&64&&Ee&&L.dynamicChildren?(ft(L.dynamicChildren,Ee,ee,ae,ue,me,te),(B.key!=null||ae&&B===ae.subTree)&&Qm(L,B,!0)):Bt(L,B,ee,Ce,ae,ue,me,te,ie)},Mt=(L,B,ee,oe,ae,ue,me,te,ie)=>{B.slotScopeIds=te,L==null?B.shapeFlag&512?ae.ctx.activate(B,ee,oe,me,ie):En(B,ee,oe,ae,ue,me,ie):z(L,B,ie)},En=(L,B,ee,oe,ae,ue,me)=>{const te=L.component=S3(L,oe,ae);if(Pl(L)&&(te.ctx.renderer=ne),k3(te),te.asyncDep){if(ae&&ae.registerDep(te,he),!L.el){const ie=te.subTree=wt(Gn);Ye(null,ie,B,ee)}return}he(te,L,B,ee,ae,ue,me)},z=(L,B,ee)=>{const oe=B.component=L.component;if(OM(L,B,ee))if(oe.asyncDep&&!oe.asyncResolved){Te(oe,B,ee);return}else oe.next=B,wM(oe.update),oe.update();else B.el=L.el,oe.vnode=B},he=(L,B,ee,oe,ae,ue,me)=>{const te=()=>{if(L.isMounted){let{next:Ce,bu:ke,u:Ee,parent:We,vnode:et}=L,ut=Ce,lt;no(L,!1),Ce?(Ce.el=et.el,Te(L,Ce,me)):Ce=et,ke&&qp(ke),(lt=Ce.props&&Ce.props.onVnodeBeforeUpdate)&&vr(lt,We,Ce,et),no(L,!0);const tt=Kp(L),on=L.subTree;L.subTree=tt,ge(on,tt,$(on.el),qr(on),L,ae,ue),Ce.el=tt.el,ut===null&&NM(L,tt.el),Ee&&kn(Ee,ae),(lt=Ce.props&&Ce.props.onVnodeUpdated)&&kn(()=>vr(lt,We,Ce,et),ae)}else{let Ce;const{el:ke,props:Ee}=B,{bm:We,m:et,parent:ut}=L,lt=Js(B);if(no(L,!1),We&&qp(We),!lt&&(Ce=Ee&&Ee.onVnodeBeforeMount)&&vr(Ce,ut,B),no(L,!0),ke&&za){const tt=()=>{L.subTree=Kp(L),za(ke,L.subTree,L,ae,null)};lt?B.type.__asyncLoader().then(()=>!L.isUnmounted&&tt()):tt()}else{const tt=L.subTree=Kp(L);ge(null,tt,ee,oe,L,ae,ue),B.el=tt.el}if(et&&kn(et,ae),!lt&&(Ce=Ee&&Ee.onVnodeMounted)){const tt=B;kn(()=>vr(Ce,ut,tt),ae)}(B.shapeFlag&256||ut&&Js(ut.vnode)&&ut.vnode.shapeFlag&256)&&L.a&&kn(L.a,ae),L.isMounted=!0,B=ee=oe=null}},ie=L.effect=new Vm(te,()=>pI(le),L.scope),le=L.update=()=>ie.run();le.id=L.uid,no(L,!0),le()},Te=(L,B,ee)=>{B.component=L;const oe=L.vnode.props;L.vnode=B,L.next=null,n3(L,B.props,oe,ee),o3(L,B.children,ee),La(),Rl(void 0,L.update),Ma()},Bt=(L,B,ee,oe,ae,ue,me,te,ie=!1)=>{const le=L&&L.children,Ce=L?L.shapeFlag:0,ke=B.children,{patchFlag:Ee,shapeFlag:We}=B;if(Ee>0){if(Ee&128){Le(le,ke,ee,oe,ae,ue,me,te,ie);return}else if(Ee&256){Jr(le,ke,ee,oe,ae,ue,me,te,ie);return}}We&8?(Ce&16&&qn(le,ae,ue),ke!==le&&N(ee,ke)):Ce&16?We&16?Le(le,ke,ee,oe,ae,ue,me,te,ie):qn(le,ae,ue,!0):(Ce&8&&N(ee,""),We&16&&Ge(ke,ee,oe,ae,ue,me,te,ie))},Jr=(L,B,ee,oe,ae,ue,me,te,ie)=>{L=L||wa,B=B||wa;const le=L.length,Ce=B.length,ke=Math.min(le,Ce);let Ee;for(Ee=0;Ee<ke;Ee++){const We=B[Ee]=ie?wi(B[Ee]):br(B[Ee]);ge(L[Ee],We,ee,null,ae,ue,me,te,ie)}le>Ce?qn(L,ae,ue,!0,!1,ke):Ge(B,ee,oe,ae,ue,me,te,ie,ke)},Le=(L,B,ee,oe,ae,ue,me,te,ie)=>{let le=0;const Ce=B.length;let ke=L.length-1,Ee=Ce-1;for(;le<=ke&&le<=Ee;){const We=L[le],et=B[le]=ie?wi(B[le]):br(B[le]);if(oo(We,et))ge(We,et,ee,null,ae,ue,me,te,ie);else break;le++}for(;le<=ke&&le<=Ee;){const We=L[ke],et=B[Ee]=ie?wi(B[Ee]):br(B[Ee]);if(oo(We,et))ge(We,et,ee,null,ae,ue,me,te,ie);else break;ke--,Ee--}if(le>ke){if(le<=Ee){const We=Ee+1,et=We<Ce?B[We].el:oe;for(;le<=Ee;)ge(null,B[le]=ie?wi(B[le]):br(B[le]),ee,et,ae,ue,me,te,ie),le++}}else if(le>Ee)for(;le<=ke;)Jn(L[le],ae,ue,!0),le++;else{const We=le,et=le,ut=new Map;for(le=et;le<=Ee;le++){const Ut=B[le]=ie?wi(B[le]):br(B[le]);Ut.key!=null&&ut.set(Ut.key,le)}let lt,tt=0;const on=Ee-et+1;let ar=!1,yc=0;const Kn=new Array(on);for(le=0;le<on;le++)Kn[le]=0;for(le=We;le<=ke;le++){const Ut=L[le];if(tt>=on){Jn(Ut,ae,ue,!0);continue}let Ln;if(Ut.key!=null)Ln=ut.get(Ut.key);else for(lt=et;lt<=Ee;lt++)if(Kn[lt-et]===0&&oo(Ut,B[lt])){Ln=lt;break}Ln===void 0?Jn(Ut,ae,ue,!0):(Kn[Ln-et]=le+1,Ln>=yc?yc=Ln:ar=!0,ge(Ut,B[Ln],ee,null,ae,ue,me,te,ie),tt++)}const bc=ar?l3(Kn):wa;for(lt=bc.length-1,le=on-1;le>=0;le--){const Ut=et+le,Ln=B[Ut],an=Ut+1<Ce?B[Ut+1].el:oe;Kn[le]===0?ge(null,Ln,ee,an,ae,ue,me,te,ie):ar&&(lt<0||le!==bc[lt]?Ir(Ln,ee,an,2):lt--)}}},Ir=(L,B,ee,oe,ae=null)=>{const{el:ue,type:me,transition:te,children:ie,shapeFlag:le}=L;if(le&6){Ir(L.component.subTree,B,ee,oe);return}if(le&128){L.suspense.move(B,ee,oe);return}if(le&64){me.move(L,B,ee,ne);return}if(me===Qt){p(ue,B,ee);for(let ke=0;ke<ie.length;ke++)Ir(ie[ke],B,ee,oe);p(L.anchor,B,ee);return}if(me===Yp){Ae(L,B,ee);return}if(oe!==2&&le&1&&te)if(oe===0)te.beforeEnter(ue),p(ue,B,ee),kn(()=>te.enter(ue),ae);else{const{leave:ke,delayLeave:Ee,afterLeave:We}=te,et=()=>p(ue,B,ee),ut=()=>{ke(ue,()=>{et(),We&&We()})};Ee?Ee(ue,et,ut):ut()}else p(ue,B,ee)},Jn=(L,B,ee,oe=!1,ae=!1)=>{const{type:ue,props:me,ref:te,children:ie,dynamicChildren:le,shapeFlag:Ce,patchFlag:ke,dirs:Ee}=L;if(te!=null&&_m(te,null,ee,L,!0),Ce&256){B.ctx.deactivate(L);return}const We=Ce&1&&Ee,et=!Js(L);let ut;if(et&&(ut=me&&me.onVnodeBeforeUnmount)&&vr(ut,B,L),Ce&6)vc(L.component,ee,oe);else{if(Ce&128){L.suspense.unmount(ee,oe);return}We&&to(L,null,B,"beforeUnmount"),Ce&64?L.type.remove(L,B,ee,ae,ne,oe):le&&(ue!==Qt||ke>0&&ke&64)?qn(le,B,ee,!1,!0):(ue===Qt&&ke&384||!ae&&Ce&16)&&qn(ie,B,ee),oe&&vo(L)}(et&&(ut=me&&me.onVnodeUnmounted)||We)&&kn(()=>{ut&&vr(ut,B,L),We&&to(L,null,B,"unmounted")},ee)},vo=L=>{const{type:B,el:ee,anchor:oe,transition:ae}=L;if(B===Qt){Tr(ee,oe);return}if(B===Yp){Xe(L);return}const ue=()=>{_(ee),ae&&!ae.persisted&&ae.afterLeave&&ae.afterLeave()};if(L.shapeFlag&1&&ae&&!ae.persisted){const{leave:me,delayLeave:te}=ae,ie=()=>me(ee,ue);te?te(L.el,ue,ie):ie()}else ue()},Tr=(L,B)=>{let ee;for(;L!==B;)ee=W(L),_(L),L=ee;_(B)},vc=(L,B,ee)=>{const{bum:oe,scope:ae,update:ue,subTree:me,um:te}=L;oe&&qp(oe),ae.stop(),ue&&(ue.active=!1,Jn(me,L,B,ee)),te&&kn(te,B),kn(()=>{L.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&L.asyncDep&&!L.asyncResolved&&L.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},qn=(L,B,ee,oe=!1,ae=!1,ue=0)=>{for(let me=ue;me<L.length;me++)Jn(L[me],B,ee,oe,ae)},qr=L=>L.shapeFlag&6?qr(L.component.subTree):L.shapeFlag&128?L.suspense.next():W(L.anchor||L.el),_c=(L,B,ee)=>{L==null?B._vnode&&Jn(B._vnode,null,null,!0):ge(B._vnode||null,L,B,null,null,null,ee),vI(),B._vnode=L},ne={p:ge,um:Jn,m:Ir,r:vo,mt:En,mc:Ge,pc:Bt,pbc:ft,n:qr,o:r};let $a,za;return s&&([$a,za]=s(ne)),{render:_c,hydrate:$a,createApp:s3(_c,$a)}}function no({effect:r,update:s},d){r.allowRecurse=s.allowRecurse=d}function Qm(r,s,d=!1){const p=r.children,_=s.children;if(qe(p)&&qe(_))for(let k=0;k<p.length;k++){const b=p[k];let w=_[k];w.shapeFlag&1&&!w.dynamicChildren&&((w.patchFlag<=0||w.patchFlag===32)&&(w=_[k]=wi(_[k]),w.el=b.el),d||Qm(b,w))}}function l3(r){const s=r.slice(),d=[0];let p,_,k,b,w;const A=r.length;for(p=0;p<A;p++){const P=r[p];if(P!==0){if(_=d[d.length-1],r[_]<P){s[p]=_,d.push(p);continue}for(k=0,b=d.length-1;k<b;)w=k+b>>1,r[d[w]]<P?k=w+1:b=w;P<r[d[k]]&&(k>0&&(s[p]=d[k-1]),d[k]=p)}}for(k=d.length,b=d[k-1];k-- >0;)d[k]=b,b=s[b];return d}const d3=r=>r.__isTeleport,qs=r=>r&&(r.disabled||r.disabled===""),nk=r=>typeof SVGElement<"u"&&r instanceof SVGElement,ym=(r,s)=>{const d=r&&r.to;return jt(d)?s?s(d):null:d},h3={__isTeleport:!0,process(r,s,d,p,_,k,b,w,A,P){const{mc:N,pc:$,pbc:W,o:{insert:de,querySelector:X,createText:ce,createComment:ge}}=P,be=qs(s.props);let{shapeFlag:Ye,children:at,dynamicChildren:Ae}=s;if(r==null){const Xe=s.el=ce(""),Ke=s.anchor=ce("");de(Xe,d,p),de(Ke,d,p);const yt=s.target=ym(s.props,X),He=s.targetAnchor=ce("");yt&&(de(He,yt),b=b||nk(yt));const Ge=(ze,ft)=>{Ye&16&&N(at,ze,ft,_,k,b,w,A)};be?Ge(d,Ke):yt&&Ge(yt,He)}else{s.el=r.el;const Xe=s.anchor=r.anchor,Ke=s.target=r.target,yt=s.targetAnchor=r.targetAnchor,He=qs(r.props),Ge=He?d:Ke,ze=He?Xe:yt;if(b=b||nk(Ke),Ae?(W(r.dynamicChildren,Ae,Ge,_,k,b,w),Qm(r,s,!0)):A||$(r,s,Ge,ze,_,k,b,w,!1),be)He||sl(s,d,Xe,P,1);else if((s.props&&s.props.to)!==(r.props&&r.props.to)){const ft=s.target=ym(s.props,X);ft&&sl(s,ft,null,P,0)}else He&&sl(s,Ke,yt,P,1)}},remove(r,s,d,p,{um:_,o:{remove:k}},b){const{shapeFlag:w,children:A,anchor:P,targetAnchor:N,target:$,props:W}=r;if($&&k(N),(b||!qs(W))&&(k(P),w&16))for(let de=0;de<A.length;de++){const X=A[de];_(X,s,d,!0,!!X.dynamicChildren)}},move:sl,hydrate:f3};function sl(r,s,d,{o:{insert:p},m:_},k=2){k===0&&p(r.targetAnchor,s,d);const{el:b,anchor:w,shapeFlag:A,children:P,props:N}=r,$=k===2;if($&&p(b,s,d),(!$||qs(N))&&A&16)for(let W=0;W<P.length;W++)_(P[W],s,d,2);$&&p(w,s,d)}function f3(r,s,d,p,_,k,{o:{nextSibling:b,parentNode:w,querySelector:A}},P){const N=s.target=ym(s.props,A);if(N){const $=N._lpa||N.firstChild;if(s.shapeFlag&16)if(qs(s.props))s.anchor=P(b(r),s,w(r),d,p,_,k),s.targetAnchor=$;else{s.anchor=b(r);let W=$;for(;W;)if(W=b(W),W&&W.nodeType===8&&W.data==="teleport anchor"){s.targetAnchor=W,N._lpa=s.targetAnchor&&b(s.targetAnchor);break}P($,s,N,d,p,_,k)}}return s.anchor&&b(s.anchor)}const p3=h3,Qt=Symbol(void 0),Ym=Symbol(void 0),Gn=Symbol(void 0),Yp=Symbol(void 0),Ks=[];let ir=null;function xt(r=!1){Ks.push(ir=r?null:[])}function m3(){Ks.pop(),ir=Ks[Ks.length-1]||null}let cc=1;function rk(r){cc+=r}function VI(r){return r.dynamicChildren=cc>0?ir||wa:null,m3(),cc>0&&ir&&ir.push(r),r}function Ft(r,s,d,p,_,k){return VI(_t(r,s,d,p,_,k,!0))}function Xm(r,s,d,p,_){return VI(wt(r,s,d,p,_,!0))}function yl(r){return r?r.__v_isVNode===!0:!1}function oo(r,s){return r.type===s.type&&r.key===s.key}const Nl="__vInternal",FI=({key:r})=>r!=null?r:null,fl=({ref:r,ref_key:s,ref_for:d})=>r!=null?jt(r)||Xt(r)||Ze(r)?{i:wn,r,k:s,f:!!d}:r:null;function _t(r,s=null,d=null,p=0,_=null,k=r===Qt?0:1,b=!1,w=!1){const A={__v_isVNode:!0,__v_skip:!0,type:r,props:s,key:s&&FI(s),ref:s&&fl(s),scopeId:xl,slotScopeIds:null,children:d,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:k,patchFlag:p,dynamicProps:_,dynamicChildren:null,appContext:null};return w?(Zm(A,d),k&128&&r.normalize(A)):d&&(A.shapeFlag|=jt(d)?8:16),cc>0&&!b&&ir&&(A.patchFlag>0||k&6)&&A.patchFlag!==32&&ir.push(A),A}const wt=g3;function g3(r,s=null,d=null,p=0,_=null,k=!1){if((!r||r===JM)&&(r=Gn),yl(r)){const w=Ai(r,s,!0);return d&&Zm(w,d),cc>0&&!k&&ir&&(w.shapeFlag&6?ir[ir.indexOf(r)]=w:ir.push(w)),w.patchFlag|=-2,w}if(E3(r)&&(r=r.__vccOpts),s){s=v3(s);let{class:w,style:A}=s;w&&!jt(w)&&(s.class=ec(w)),Lt(A)&&(sI(A)&&!qe(A)&&(A=Wt({},A)),s.style=Zs(A))}const b=jt(r)?1:LM(r)?128:d3(r)?64:Lt(r)?4:Ze(r)?2:0;return _t(r,s,d,p,_,b,k,!0)}function v3(r){return r?sI(r)||Nl in r?Wt({},r):r:null}function Ai(r,s,d=!1){const{props:p,ref:_,patchFlag:k,children:b}=r,w=s?jI(p||{},s):p;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:w,key:w&&FI(w),ref:s&&s.ref?d&&_?qe(_)?_.concat(fl(s)):[_,fl(s)]:fl(s):_,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:b,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:s&&r.type!==Qt?k===-1?16:k|16:k,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Ai(r.ssContent),ssFallback:r.ssFallback&&Ai(r.ssFallback),el:r.el,anchor:r.anchor}}function kr(r=" ",s=0){return wt(Ym,null,r,s)}function _3(r="",s=!1){return s?(xt(),Xm(Gn,null,r)):wt(Gn,null,r)}function br(r){return r==null||typeof r=="boolean"?wt(Gn):qe(r)?wt(Qt,null,r.slice()):typeof r=="object"?wi(r):wt(Ym,null,String(r))}function wi(r){return r.el===null||r.memo?r:Ai(r)}function Zm(r,s){let d=0;const{shapeFlag:p}=r;if(s==null)s=null;else if(qe(s))d=16;else if(typeof s=="object")if(p&65){const _=s.default;_&&(_._c&&(_._d=!1),Zm(r,_()),_._c&&(_._d=!0));return}else{d=32;const _=s._;!_&&!(Nl in s)?s._ctx=wn:_===3&&wn&&(wn.slots._===1?s._=1:(s._=2,r.patchFlag|=1024))}else Ze(s)?(s={default:s,_ctx:wn},d=32):(s=String(s),p&64?(d=16,s=[kr(s)]):d=8);r.children=s,r.shapeFlag|=d}function jI(...r){const s={};for(let d=0;d<r.length;d++){const p=r[d];for(const _ in p)if(_==="class")s.class!==p.class&&(s.class=ec([s.class,p.class]));else if(_==="style")s.style=Zs([s.style,p.style]);else if(kl(_)){const k=s[_],b=p[_];b&&k!==b&&!(qe(k)&&k.includes(b))&&(s[_]=k?[].concat(k,b):b)}else _!==""&&(s[_]=p[_])}return s}function vr(r,s,d,p=null){zn(r,s,7,[d,p])}const y3=UI();let b3=0;function S3(r,s,d){const p=r.type,_=(s?s.appContext:r.appContext)||y3,k={uid:b3++,vnode:r,type:p,parent:s,appContext:_,root:null,next:null,subTree:null,effect:null,update:null,scope:new BL(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(_.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:OI(p,_),emitsOptions:yI(p,_),emit:null,emitted:null,propsDefaults:It,inheritAttrs:p.inheritAttrs,ctx:It,data:It,props:It,attrs:It,slots:It,refs:It,setupState:It,setupContext:null,suspense:d,suspenseId:d?d.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return k.ctx={_:k},k.root=s?s.root:k,k.emit=RM.bind(null,k),r.ce&&r.ce(k),k}let Yt=null;const eg=()=>Yt||wn,Pa=r=>{Yt=r,r.scope.on()},fo=()=>{Yt&&Yt.scope.off(),Yt=null};function BI(r){return r.vnode.shapeFlag&4}let uc=!1;function k3(r,s=!1){uc=s;const{props:d,children:p}=r.vnode,_=BI(r);t3(r,d,_,s),i3(r,p);const k=_?I3(r,s):void 0;return uc=!1,k}function I3(r,s){const d=r.type;r.accessCache=Object.create(null),r.proxy=cI(new Proxy(r.ctx,KM));const{setup:p}=d;if(p){const _=r.setupContext=p.length>1?w3(r):null;Pa(r),La();const k=Ci(p,r,0,[r.props,_]);if(Ma(),fo(),Gk(k)){if(k.then(fo,fo),s)return k.then(b=>{ik(r,b,s)}).catch(b=>{Cl(b,r,0)});r.asyncDep=k}else ik(r,k,s)}else HI(r,s)}function ik(r,s,d){Ze(s)?r.type.__ssrInlineRender?r.ssrRender=s:r.render=s:Lt(s)&&(r.setupState=dI(s)),HI(r,d)}let ok;function HI(r,s,d){const p=r.type;if(!r.render){if(!s&&ok&&!p.render){const _=p.template;if(_){const{isCustomElement:k,compilerOptions:b}=r.appContext.config,{delimiters:w,compilerOptions:A}=p,P=Wt(Wt({isCustomElement:k,delimiters:w},b),A);p.render=ok(_,P)}}r.render=p.render||or}Pa(r),La(),QM(r),Ma(),fo()}function T3(r){return new Proxy(r.attrs,{get(s,d){return Nn(r,"get","$attrs"),s[d]}})}function w3(r){const s=p=>{r.exposed=p||{}};let d;return{get attrs(){return d||(d=T3(r))},slots:r.slots,emit:r.emit,expose:s}}function tg(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(dI(cI(r.exposed)),{get(s,d){if(d in s)return s[d];if(d in vl)return vl[d](r)}}))}function E3(r){return Ze(r)&&"__vccOpts"in r}const nn=(r,s)=>kM(r,s,uc);function xe(r,s,d){const p=arguments.length;return p===2?Lt(s)&&!qe(s)?yl(s)?wt(r,null,[s]):wt(r,s):wt(r,null,s):(p>3?d=Array.prototype.slice.call(arguments,2):p===3&&yl(d)&&(d=[d]),wt(r,s,d))}const C3="3.2.37",R3="http://www.w3.org/2000/svg",ao=typeof document<"u"?document:null,ak=ao&&ao.createElement("template"),A3={insert:(r,s,d)=>{s.insertBefore(r,d||null)},remove:r=>{const s=r.parentNode;s&&s.removeChild(r)},createElement:(r,s,d,p)=>{const _=s?ao.createElementNS(R3,r):ao.createElement(r,d?{is:d}:void 0);return r==="select"&&p&&p.multiple!=null&&_.setAttribute("multiple",p.multiple),_},createText:r=>ao.createTextNode(r),createComment:r=>ao.createComment(r),setText:(r,s)=>{r.nodeValue=s},setElementText:(r,s)=>{r.textContent=s},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>ao.querySelector(r),setScopeId(r,s){r.setAttribute(s,"")},cloneNode(r){const s=r.cloneNode(!0);return"_value"in r&&(s._value=r._value),s},insertStaticContent(r,s,d,p,_,k){const b=d?d.previousSibling:s.lastChild;if(_&&(_===k||_.nextSibling))for(;s.insertBefore(_.cloneNode(!0),d),!(_===k||!(_=_.nextSibling)););else{ak.innerHTML=p?`<svg>${r}</svg>`:r;const w=ak.content;if(p){const A=w.firstChild;for(;A.firstChild;)w.appendChild(A.firstChild);w.removeChild(A)}s.insertBefore(w,d)}return[b?b.nextSibling:s.firstChild,d?d.previousSibling:s.lastChild]}};function x3(r,s,d){const p=r._vtc;p&&(s=(s?[s,...p]:[...p]).join(" ")),s==null?r.removeAttribute("class"):d?r.setAttribute("class",s):r.className=s}function P3(r,s,d){const p=r.style,_=jt(d);if(d&&!_){for(const k in d)bm(p,k,d[k]);if(s&&!jt(s))for(const k in s)d[k]==null&&bm(p,k,"")}else{const k=p.display;_?s!==d&&(p.cssText=d):s&&r.removeAttribute("style"),"_vod"in r&&(p.display=k)}}const sk=/\s*!important$/;function bm(r,s,d){if(qe(d))d.forEach(p=>bm(r,s,p));else if(d==null&&(d=""),s.startsWith("--"))r.setProperty(s,d);else{const p=D3(r,s);sk.test(d)?r.setProperty(Na(p),d.replace(sk,""),"important"):r[p]=d}}const ck=["Webkit","Moz","ms"],Xp={};function D3(r,s){const d=Xp[s];if(d)return d;let p=xa(s);if(p!=="filter"&&p in r)return Xp[s]=p;p=Kk(p);for(let _=0;_<ck.length;_++){const k=ck[_]+p;if(k in r)return Xp[s]=k}return s}const uk="http://www.w3.org/1999/xlink";function O3(r,s,d,p,_){if(p&&s.startsWith("xlink:"))d==null?r.removeAttributeNS(uk,s.slice(6,s.length)):r.setAttributeNS(uk,s,d);else{const k=xL(s);d==null||k&&!$k(d)?r.removeAttribute(s):r.setAttribute(s,k?"":d)}}function N3(r,s,d,p,_,k,b){if(s==="innerHTML"||s==="textContent"){p&&b(p,_,k),r[s]=d==null?"":d;return}if(s==="value"&&r.tagName!=="PROGRESS"&&!r.tagName.includes("-")){r._value=d;const A=d==null?"":d;(r.value!==A||r.tagName==="OPTION")&&(r.value=A),d==null&&r.removeAttribute(s);return}let w=!1;if(d===""||d==null){const A=typeof r[s];A==="boolean"?d=$k(d):d==null&&A==="string"?(d="",w=!0):A==="number"&&(d=0,w=!0)}try{r[s]=d}catch{}w&&r.removeAttribute(s)}const[$I,L3]=(()=>{let r=Date.now,s=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(r=performance.now.bind(performance));const d=navigator.userAgent.match(/firefox\/(\d+)/i);s=!!(d&&Number(d[1])<=53)}return[r,s]})();let Sm=0;const M3=Promise.resolve(),U3=()=>{Sm=0},V3=()=>Sm||(M3.then(U3),Sm=$I());function F3(r,s,d,p){r.addEventListener(s,d,p)}function j3(r,s,d,p){r.removeEventListener(s,d,p)}function B3(r,s,d,p,_=null){const k=r._vei||(r._vei={}),b=k[s];if(p&&b)b.value=p;else{const[w,A]=H3(s);if(p){const P=k[s]=$3(p,_);F3(r,w,P,A)}else b&&(j3(r,w,b,A),k[s]=void 0)}}const lk=/(?:Once|Passive|Capture)$/;function H3(r){let s;if(lk.test(r)){s={};let d;for(;d=r.match(lk);)r=r.slice(0,r.length-d[0].length),s[d[0].toLowerCase()]=!0}return[Na(r.slice(2)),s]}function $3(r,s){const d=p=>{const _=p.timeStamp||$I();(L3||_>=d.attached-1)&&zn(z3(p,d.value),s,5,[p])};return d.value=r,d.attached=V3(),d}function z3(r,s){if(qe(s)){const d=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{d.call(r),r._stopped=!0},s.map(p=>_=>!_._stopped&&p&&p(_))}else return s}const dk=/^on[a-z]/,W3=(r,s,d,p,_=!1,k,b,w,A)=>{s==="class"?x3(r,p,_):s==="style"?P3(r,d,p):kl(s)?Om(s)||B3(r,s,d,p,b):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):G3(r,s,p,_))?N3(r,s,p,k,b,w,A):(s==="true-value"?r._trueValue=p:s==="false-value"&&(r._falseValue=p),O3(r,s,p,_))};function G3(r,s,d,p){return p?!!(s==="innerHTML"||s==="textContent"||s in r&&dk.test(s)&&Ze(d)):s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&r.tagName==="INPUT"||s==="type"&&r.tagName==="TEXTAREA"||dk.test(s)&&jt(d)?!1:s in r}const Si="transition",js="animation",Ll=(r,{slots:s})=>xe(II,WI(r),s);Ll.displayName="Transition";const zI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},J3=Ll.props=Wt({},II.props,zI),ro=(r,s=[])=>{qe(r)?r.forEach(d=>d(...s)):r&&r(...s)},hk=r=>r?qe(r)?r.some(s=>s.length>1):r.length>1:!1;function WI(r){const s={};for(const Ie in r)Ie in zI||(s[Ie]=r[Ie]);if(r.css===!1)return s;const{name:d="v",type:p,duration:_,enterFromClass:k=`${d}-enter-from`,enterActiveClass:b=`${d}-enter-active`,enterToClass:w=`${d}-enter-to`,appearFromClass:A=k,appearActiveClass:P=b,appearToClass:N=w,leaveFromClass:$=`${d}-leave-from`,leaveActiveClass:W=`${d}-leave-active`,leaveToClass:de=`${d}-leave-to`}=r,X=q3(_),ce=X&&X[0],ge=X&&X[1],{onBeforeEnter:be,onEnter:Ye,onEnterCancelled:at,onLeave:Ae,onLeaveCancelled:Xe,onBeforeAppear:Ke=be,onAppear:yt=Ye,onAppearCancelled:He=at}=s,Ge=(Ie,rt,Mt)=>{Ti(Ie,rt?N:w),Ti(Ie,rt?P:b),Mt&&Mt()},ze=(Ie,rt)=>{Ie._isLeaving=!1,Ti(Ie,$),Ti(Ie,de),Ti(Ie,W),rt&&rt()},ft=Ie=>(rt,Mt)=>{const En=Ie?yt:Ye,z=()=>Ge(rt,Ie,Mt);ro(En,[rt,z]),fk(()=>{Ti(rt,Ie?A:k),Br(rt,Ie?N:w),hk(En)||pk(rt,p,ce,z)})};return Wt(s,{onBeforeEnter(Ie){ro(be,[Ie]),Br(Ie,k),Br(Ie,b)},onBeforeAppear(Ie){ro(Ke,[Ie]),Br(Ie,A),Br(Ie,P)},onEnter:ft(!1),onAppear:ft(!0),onLeave(Ie,rt){Ie._isLeaving=!0;const Mt=()=>ze(Ie,rt);Br(Ie,$),JI(),Br(Ie,W),fk(()=>{!Ie._isLeaving||(Ti(Ie,$),Br(Ie,de),hk(Ae)||pk(Ie,p,ge,Mt))}),ro(Ae,[Ie,Mt])},onEnterCancelled(Ie){Ge(Ie,!1),ro(at,[Ie])},onAppearCancelled(Ie){Ge(Ie,!0),ro(He,[Ie])},onLeaveCancelled(Ie){ze(Ie),ro(Xe,[Ie])}})}function q3(r){if(r==null)return null;if(Lt(r))return[Zp(r.enter),Zp(r.leave)];{const s=Zp(r);return[s,s]}}function Zp(r){return Qk(r)}function Br(r,s){s.split(/\s+/).forEach(d=>d&&r.classList.add(d)),(r._vtc||(r._vtc=new Set)).add(s)}function Ti(r,s){s.split(/\s+/).forEach(p=>p&&r.classList.remove(p));const{_vtc:d}=r;d&&(d.delete(s),d.size||(r._vtc=void 0))}function fk(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let K3=0;function pk(r,s,d,p){const _=r._endId=++K3,k=()=>{_===r._endId&&p()};if(d)return setTimeout(k,d);const{type:b,timeout:w,propCount:A}=GI(r,s);if(!b)return p();const P=b+"end";let N=0;const $=()=>{r.removeEventListener(P,W),k()},W=de=>{de.target===r&&++N>=A&&$()};setTimeout(()=>{N<A&&$()},w+1),r.addEventListener(P,W)}function GI(r,s){const d=window.getComputedStyle(r),p=X=>(d[X]||"").split(", "),_=p(Si+"Delay"),k=p(Si+"Duration"),b=mk(_,k),w=p(js+"Delay"),A=p(js+"Duration"),P=mk(w,A);let N=null,$=0,W=0;s===Si?b>0&&(N=Si,$=b,W=k.length):s===js?P>0&&(N=js,$=P,W=A.length):($=Math.max(b,P),N=$>0?b>P?Si:js:null,W=N?N===Si?k.length:A.length:0);const de=N===Si&&/\b(transform|all)(,|$)/.test(d[Si+"Property"]);return{type:N,timeout:$,propCount:W,hasTransform:de}}function mk(r,s){for(;r.length<s.length;)r=r.concat(r);return Math.max(...s.map((d,p)=>gk(d)+gk(r[p])))}function gk(r){return Number(r.slice(0,-1).replace(",","."))*1e3}function JI(){return document.body.offsetHeight}const qI=new WeakMap,KI=new WeakMap,Q3={name:"TransitionGroup",props:Wt({},J3,{tag:String,moveClass:String}),setup(r,{slots:s}){const d=eg(),p=kI();let _,k;return EI(()=>{if(!_.length)return;const b=r.moveClass||`${r.name||"v"}-move`;if(!t4(_[0].el,d.vnode.el,b))return;_.forEach(X3),_.forEach(Z3);const w=_.filter(e4);JI(),w.forEach(A=>{const P=A.el,N=P.style;Br(P,b),N.transform=N.webkitTransform=N.transitionDuration="";const $=P._moveCb=W=>{W&&W.target!==P||(!W||/transform$/.test(W.propertyName))&&(P.removeEventListener("transitionend",$),P._moveCb=null,Ti(P,b))};P.addEventListener("transitionend",$)})}),()=>{const b=st(r),w=WI(b);let A=b.tag||Qt;_=k,k=s.default?qm(s.default()):[];for(let P=0;P<k.length;P++){const N=k[P];N.key!=null&&sc(N,ac(N,w,p,d))}if(_)for(let P=0;P<_.length;P++){const N=_[P];sc(N,ac(N,w,p,d)),qI.set(N,N.el.getBoundingClientRect())}return wt(A,null,k)}}},Y3=Q3;function X3(r){const s=r.el;s._moveCb&&s._moveCb(),s._enterCb&&s._enterCb()}function Z3(r){KI.set(r,r.el.getBoundingClientRect())}function e4(r){const s=qI.get(r),d=KI.get(r),p=s.left-d.left,_=s.top-d.top;if(p||_){const k=r.el.style;return k.transform=k.webkitTransform=`translate(${p}px,${_}px)`,k.transitionDuration="0s",r}}function t4(r,s,d){const p=r.cloneNode();r._vtc&&r._vtc.forEach(b=>{b.split(/\s+/).forEach(w=>w&&p.classList.remove(w))}),d.split(/\s+/).forEach(b=>b&&p.classList.add(b)),p.style.display="none";const _=s.nodeType===1?s:s.parentNode;_.appendChild(p);const{hasTransform:k}=GI(p);return _.removeChild(p),k}const n4=Wt({patchProp:W3},A3);let vk;function r4(){return vk||(vk=c3(n4))}const i4=(...r)=>{const s=r4().createApp(...r),{mount:d}=s;return s.mount=p=>{const _=o4(p);if(!_)return;const k=s._component;!Ze(k)&&!k.render&&!k.template&&(k.template=_.innerHTML),_.innerHTML="";const b=d(_,!1,_ instanceof SVGElement);return _ instanceof Element&&(_.removeAttribute("v-cloak"),_.setAttribute("data-v-app","")),b},s};function o4(r){return jt(r)?document.querySelector(r):r}var Bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},QI={exports:{}};(function(r,s){(function(d,p){r.exports=p()})(Bs,function(){function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(i){N(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function _(e){return(_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function k(e,t,n,i,o,c,a){try{var u=e[c](a),l=u.value}catch(h){return void n(h)}u.done?t(l):Promise.resolve(l).then(i,o)}function b(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){var c=e.apply(t,n);function a(l){k(c,i,o,a,u,"next",l)}function u(l){k(c,i,o,a,u,"throw",l)}a(void 0)})}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(e,t,n){return t&&A(e.prototype,t),n&&A(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function de(e,t){return(de=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(e,t)}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ce(e,t,n){return(ce=X()?Reflect.construct:function(i,o,c){var a=[null];a.push.apply(a,o);var u=new(Function.bind.apply(i,a));return c&&de(u,c.prototype),u}).apply(null,arguments)}function ge(e){var t=typeof Map=="function"?new Map:void 0;return(ge=function(n){if(n===null||(i=n,Function.toString.call(i).indexOf("[native code]")===-1))return n;var i;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(n))return t.get(n);t.set(n,o)}function o(){return ce(n,arguments,W(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),de(o,n)})(e)}function be(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(e)}function Ye(e){var t=X();return function(){var n,i=W(e);if(t){var o=W(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return be(this,n)}}function at(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=W(e))!==null;);return e}function Ae(){return(Ae=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(e,t,n){var i=at(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Xe(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,i){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var c,a,u=[],l=!0,h=!1;try{for(o=o.call(n);!(l=(c=o.next()).done)&&(u.push(c.value),!i||u.length!==i);l=!0);}catch(f){h=!0,a=f}finally{try{l||o.return==null||o.return()}finally{if(h)throw a}}return u}}(e,t)||yt(e,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ke(e){return function(t){if(Array.isArray(t))return He(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||yt(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function yt(e,t){if(e){if(typeof e=="string")return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?He(e,t):void 0}}function He(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ge(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=yt(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var l=n.next();return a=l.done,l},e:function(l){u=!0,c=l},f:function(){try{a||n.return==null||n.return()}finally{if(u)throw c}}}}function ze(e,t,n,i,o){var c={};return Object.keys(i).forEach(function(a){c[a]=i[a]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=n.slice().reverse().reduce(function(a,u){return u(e,t,a)||a},c),o&&c.initializer!==void 0&&(c.value=c.initializer?c.initializer.call(o):void 0,c.initializer=void 0),c.initializer===void 0&&(Object.defineProperty(e,t,c),c=null),c}var ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Bs<"u"?Bs:typeof self<"u"?self:{};function Ie(e,t){return e(t={exports:{}},t.exports),t.exports}var rt,Mt,En=function(e){return e&&e.Math==Math&&e},z=En(typeof globalThis=="object"&&globalThis)||En(typeof window=="object"&&window)||En(typeof self=="object"&&self)||En(typeof ft=="object"&&ft)||function(){return this}()||Function("return this")(),he=function(e){try{return!!e()}catch{return!0}},Te=!he(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Bt=!he(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Jr=Function.prototype.call,Le=Bt?Jr.bind(Jr):function(){return Jr.apply(Jr,arguments)},Ir={}.propertyIsEnumerable,Jn=Object.getOwnPropertyDescriptor,vo={f:Jn&&!Ir.call({1:2},1)?function(e){var t=Jn(this,e);return!!t&&t.enumerable}:Ir},Tr=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},vc=Function.prototype,qn=vc.bind,qr=vc.call,_c=Bt&&qn.bind(qr,qr),ne=Bt?function(e){return e&&_c(e)}:function(e){return e&&function(){return qr.apply(e,arguments)}},$a=ne({}.toString),za=ne("".slice),L=function(e){return za($a(e),8,-1)},B=z.Object,ee=ne("".split),oe=he(function(){return!B("z").propertyIsEnumerable(0)})?function(e){return L(e)=="String"?ee(e,""):B(e)}:B,ae=z.TypeError,ue=function(e){if(e==null)throw ae("Can't call method on "+e);return e},me=function(e){return oe(ue(e))},te=function(e){return typeof e=="function"},ie=function(e){return typeof e=="object"?e!==null:te(e)},le=function(e){return te(e)?e:void 0},Ce=function(e,t){return arguments.length<2?le(z[e]):z[e]&&z[e][t]},ke=ne({}.isPrototypeOf),Ee=Ce("navigator","userAgent")||"",We=z.process,et=z.Deno,ut=We&&We.versions||et&&et.version,lt=ut&&ut.v8;lt&&(Mt=(rt=lt.split("."))[0]>0&&rt[0]<4?1:+(rt[0]+rt[1])),!Mt&&Ee&&(!(rt=Ee.match(/Edge\/(\d+)/))||rt[1]>=74)&&(rt=Ee.match(/Chrome\/(\d+)/))&&(Mt=+rt[1]);var tt=Mt,on=!!Object.getOwnPropertySymbols&&!he(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&tt&&tt<41}),ar=on&&!Symbol.sham&&typeof Symbol.iterator=="symbol",yc=z.Object,Kn=ar?function(e){return typeof e=="symbol"}:function(e){var t=Ce("Symbol");return te(t)&&ke(t.prototype,yc(e))},bc=z.String,Ut=function(e){try{return bc(e)}catch{return"Object"}},Ln=z.TypeError,an=function(e){if(te(e))return e;throw Ln(Ut(e)+" is not a function")},Kr=function(e,t){var n=e[t];return n==null?void 0:an(n)},HT=z.TypeError,$T=Object.defineProperty,Hl=function(e,t){try{$T(z,e,{value:t,configurable:!0,writable:!0})}catch{z[e]=t}return t},Qr=z["__core-js_shared__"]||Hl("__core-js_shared__",{}),$l=Ie(function(e){(e.exports=function(t,n){return Qr[t]||(Qr[t]=n!==void 0?n:{})})("versions",[]).push({version:"3.22.5",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),zT=z.Object,sn=function(e){return zT(ue(e))},WT=ne({}.hasOwnProperty),Qe=Object.hasOwn||function(e,t){return WT(sn(e),t)},GT=0,JT=Math.random(),qT=ne(1 .toString),Wa=function(e){return"Symbol("+(e===void 0?"":e)+")_"+qT(++GT+JT,36)},Ga=$l("wks"),xi=z.Symbol,ug=xi&&xi.for,KT=ar?xi:xi&&xi.withoutSetter||Wa,ht=function(e){if(!Qe(Ga,e)||!on&&typeof Ga[e]!="string"){var t="Symbol."+e;on&&Qe(xi,e)?Ga[e]=xi[e]:Ga[e]=ar&&ug?ug(t):KT(t)}return Ga[e]},QT=z.TypeError,YT=ht("toPrimitive"),zl=function(e,t){if(!ie(e)||Kn(e))return e;var n,i=Kr(e,YT);if(i){if(t===void 0&&(t="default"),n=Le(i,e,t),!ie(n)||Kn(n))return n;throw QT("Can't convert object to primitive value")}return t===void 0&&(t="number"),function(o,c){var a,u;if(c==="string"&&te(a=o.toString)&&!ie(u=Le(a,o))||te(a=o.valueOf)&&!ie(u=Le(a,o))||c!=="string"&&te(a=o.toString)&&!ie(u=Le(a,o)))return u;throw HT("Can't convert object to primitive value")}(e,t)},_o=function(e){var t=zl(e,"string");return Kn(t)?t:t+""},Wl=z.document,XT=ie(Wl)&&ie(Wl.createElement),Ja=function(e){return XT?Wl.createElement(e):{}},lg=!Te&&!he(function(){return Object.defineProperty(Ja("div"),"a",{get:function(){return 7}}).a!=7}),dg=Object.getOwnPropertyDescriptor,Yr={f:Te?dg:function(e,t){if(e=me(e),t=_o(t),lg)try{return dg(e,t)}catch{}if(Qe(e,t))return Tr(!Le(vo.f,e,t),e[t])}},hg=Te&&he(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ZT=z.String,ew=z.TypeError,gt=function(e){if(ie(e))return e;throw ew(ZT(e)+" is not an object")},tw=z.TypeError,Gl=Object.defineProperty,nw=Object.getOwnPropertyDescriptor,Ht={f:Te?hg?function(e,t,n){if(gt(e),t=_o(t),gt(n),typeof e=="function"&&t==="prototype"&&"value"in n&&"writable"in n&&!n.writable){var i=nw(e,t);i&&i.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:i.configurable,enumerable:"enumerable"in n?n.enumerable:i.enumerable,writable:!1})}return Gl(e,t,n)}:Gl:function(e,t,n){if(gt(e),t=_o(t),gt(n),lg)try{return Gl(e,t,n)}catch{}if("get"in n||"set"in n)throw tw("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},Pt=Te?function(e,t,n){return Ht.f(e,t,Tr(1,n))}:function(e,t,n){return e[t]=n,e},fg=Function.prototype,rw=Te&&Object.getOwnPropertyDescriptor,Jl=Qe(fg,"name"),Xr={EXISTS:Jl,PROPER:Jl&&function(){}.name==="something",CONFIGURABLE:Jl&&(!Te||Te&&rw(fg,"name").configurable)},iw=ne(Function.toString);te(Qr.inspectSource)||(Qr.inspectSource=function(e){return iw(e)});var Sc,qa,kc,Ic=Qr.inspectSource,pg=z.WeakMap,ow=te(pg)&&/native code/.test(Ic(pg)),mg=$l("keys"),ql=function(e){return mg[e]||(mg[e]=Wa(e))},Tc={},Kl=z.TypeError,aw=z.WeakMap;if(ow||Qr.state){var Pi=Qr.state||(Qr.state=new aw),sw=ne(Pi.get),gg=ne(Pi.has),cw=ne(Pi.set);Sc=function(e,t){if(gg(Pi,e))throw new Kl("Object already initialized");return t.facade=e,cw(Pi,e,t),t},qa=function(e){return sw(Pi,e)||{}},kc=function(e){return gg(Pi,e)}}else{var yo=ql("state");Tc[yo]=!0,Sc=function(e,t){if(Qe(e,yo))throw new Kl("Object already initialized");return t.facade=e,Pt(e,yo,t),t},qa=function(e){return Qe(e,yo)?e[yo]:{}},kc=function(e){return Qe(e,yo)}}var Dt={set:Sc,get:qa,has:kc,enforce:function(e){return kc(e)?qa(e):Sc(e,{})},getterFor:function(e){return function(t){var n;if(!ie(t)||(n=qa(t)).type!==e)throw Kl("Incompatible receiver, "+e+" required");return n}}},Ql=Ie(function(e){var t=Xr.CONFIGURABLE,n=Dt.enforce,i=Dt.get,o=Object.defineProperty,c=Te&&!he(function(){return o(function(){},"length",{value:8}).length!==8}),a=String(String).split("String"),u=e.exports=function(l,h,f){if(String(h).slice(0,7)==="Symbol("&&(h="["+String(h).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),f&&f.getter&&(h="get "+h),f&&f.setter&&(h="set "+h),(!Qe(l,"name")||t&&l.name!==h)&&o(l,"name",{value:h,configurable:!0}),c&&f&&Qe(f,"arity")&&l.length!==f.arity&&o(l,"length",{value:f.arity}),f&&Qe(f,"constructor")&&f.constructor){if(Te)try{o(l,"prototype",{writable:!1})}catch{}}else l.prototype=void 0;var m=n(l);return Qe(m,"source")||(m.source=a.join(typeof h=="string"?h:"")),l};Function.prototype.toString=u(function(){return te(this)&&i(this).source||Ic(this)},"toString")}),bt=function(e,t,n,i){var o=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,a=!!i&&!!i.noTargetGet,u=i&&i.name!==void 0?i.name:t;return te(n)&&Ql(n,u,i),e===z?(c?e[t]=n:Hl(t,n),e):(o?!a&&e[t]&&(c=!0):delete e[t],c?e[t]=n:Pt(e,t,n),e)},uw=Math.ceil,lw=Math.floor,Qn=function(e){var t=+e;return t!=t||t===0?0:(t>0?lw:uw)(t)},dw=Math.max,hw=Math.min,cn=function(e,t){var n=Qn(e);return n<0?dw(n+t,0):hw(n,t)},fw=Math.min,sr=function(e){return e>0?fw(Qn(e),9007199254740991):0},un=function(e){return sr(e.length)},vg=function(e){return function(t,n,i){var o,c=me(t),a=un(c),u=cn(i,a);if(e&&n!=n){for(;a>u;)if((o=c[u++])!=o)return!0}else for(;a>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}},Ka={includes:vg(!0),indexOf:vg(!1)},pw=Ka.indexOf,_g=ne([].push),yg=function(e,t){var n,i=me(e),o=0,c=[];for(n in i)!Qe(Tc,n)&&Qe(i,n)&&_g(c,n);for(;t.length>o;)Qe(i,n=t[o++])&&(~pw(c,n)||_g(c,n));return c},wc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mw=wc.concat("length","prototype"),Zr={f:Object.getOwnPropertyNames||function(e){return yg(e,mw)}},bg={f:Object.getOwnPropertySymbols},gw=ne([].concat),vw=Ce("Reflect","ownKeys")||function(e){var t=Zr.f(gt(e)),n=bg.f;return n?gw(t,n(e)):t},_w=function(e,t,n){for(var i=vw(t),o=Ht.f,c=Yr.f,a=0;a<i.length;a++){var u=i[a];Qe(e,u)||n&&Qe(n,u)||o(e,u,c(t,u))}},yw=/#|\.prototype\./,Qa=function(e,t){var n=Sw[bw(e)];return n==Iw||n!=kw&&(te(t)?he(t):!!t)},bw=Qa.normalize=function(e){return String(e).replace(yw,".").toLowerCase()},Sw=Qa.data={},kw=Qa.NATIVE="N",Iw=Qa.POLYFILL="P",bo=Qa,Tw=Yr.f,Me=function(e,t){var n,i,o,c,a,u=e.target,l=e.global,h=e.stat;if(n=l?z:h?z[u]||Hl(u,{}):(z[u]||{}).prototype)for(i in t){if(c=t[i],o=e.noTargetGet?(a=Tw(n,i))&&a.value:n[i],!bo(l?i:u+(h?".":"#")+i,e.forced)&&o!==void 0){if(typeof c==typeof o)continue;_w(c,o)}(e.sham||o&&o.sham)&&Pt(c,"sham",!0),bt(n,i,c,e)}},ww=ne(ne.bind),Yn=function(e,t){return an(e),t===void 0?e:Bt?ww(e,t):function(){return e.apply(t,arguments)}},Di=Array.isArray||function(e){return L(e)=="Array"},Sg={};Sg[ht("toStringTag")]="z";var Yl=String(Sg)==="[object z]",Ew=ht("toStringTag"),Cw=z.Object,Rw=L(function(){return arguments}())=="Arguments",wr=Yl?L:function(e){var t,n,i;return e===void 0?"Undefined":e===null?"Null":typeof(n=function(o,c){try{return o[c]}catch{}}(t=Cw(e),Ew))=="string"?n:Rw?L(t):(i=L(t))=="Object"&&te(t.callee)?"Arguments":i},kg=function(){},Aw=[],Ig=Ce("Reflect","construct"),Xl=/^\s*(?:class|function)\b/,xw=ne(Xl.exec),Pw=!Xl.exec(kg),Ya=function(e){if(!te(e))return!1;try{return Ig(kg,Aw,e),!0}catch{return!1}},Tg=function(e){if(!te(e))return!1;switch(wr(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Pw||!!xw(Xl,Ic(e))}catch{return!0}};Tg.sham=!0;var Ec=!Ig||he(function(){var e;return Ya(Ya.call)||!Ya(Object)||!Ya(function(){e=!0})||e})?Tg:Ya,Dw=ht("species"),wg=z.Array,Zl=function(e,t){return new(function(n){var i;return Di(n)&&(i=n.constructor,(Ec(i)&&(i===wg||Di(i.prototype))||ie(i)&&(i=i[Dw])===null)&&(i=void 0)),i===void 0?wg:i}(e))(t===0?0:t)},Eg=ne([].push),ei=function(e){var t=e==1,n=e==2,i=e==3,o=e==4,c=e==6,a=e==7,u=e==5||c;return function(l,h,f,m){for(var g,v,I=sn(l),S=oe(I),y=Yn(h,f),E=un(S),C=0,x=m||Zl,U=t?x(l,E):n||a?x(l,0):void 0;E>C;C++)if((u||C in S)&&(v=y(g=S[C],C,I),e))if(t)U[C]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return C;case 2:Eg(U,g)}else switch(e){case 4:return!1;case 7:Eg(U,g)}return c?-1:i||o?o:U}},Cn={forEach:ei(0),map:ei(1),filter:ei(2),some:ei(3),every:ei(4),find:ei(5),findIndex:ei(6),filterReject:ei(7)},Ow=ht("species"),Xa=function(e){return tt>=51||!he(function(){var t=[];return(t.constructor={})[Ow]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Nw=Cn.map,Lw=Xa("map");Me({target:"Array",proto:!0,forced:!Lw},{map:function(e){return Nw(this,e,arguments.length>1?arguments[1]:void 0)}});var Mw=Cn.filter,Uw=Xa("filter");Me({target:"Array",proto:!0,forced:!Uw},{filter:function(e){return Mw(this,e,arguments.length>1?arguments[1]:void 0)}});var Vw=Yl?{}.toString:function(){return"[object "+wr(this)+"]"};Yl||bt(Object.prototype,"toString",Vw,{unsafe:!0});var Cg=Yr.f,Fw=he(function(){Cg(1)});Me({target:"Object",stat:!0,forced:!Te||Fw,sham:!Te},{getOwnPropertyDescriptor:function(e,t){return Cg(me(e),t)}}),Ie(function(e){var t=function(n){var i=Object.prototype,o=i.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},a=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function h(R,T,D){return Object.defineProperty(R,T,{value:D,enumerable:!0,configurable:!0,writable:!0}),R[T]}try{h({},"")}catch{h=function(T,D,O){return T[D]=O}}function f(R,T,D,O){var M=T&&T.prototype instanceof v?T:v,F=Object.create(M.prototype),re=new q(O||[]);return F._invoke=function(pe,ve,se){var Ne="suspendedStart";return function(_e,Je){if(Ne==="executing")throw new Error("Generator is already running");if(Ne==="completed"){if(_e==="throw")throw Je;return De()}for(se.method=_e,se.arg=Je;;){var $e=se.delegate;if($e){var Re=H($e,se);if(Re){if(Re===g)continue;return Re}}if(se.method==="next")se.sent=se._sent=se.arg;else if(se.method==="throw"){if(Ne==="suspendedStart")throw Ne="completed",se.arg;se.dispatchException(se.arg)}else se.method==="return"&&se.abrupt("return",se.arg);Ne="executing";var nt=m(pe,ve,se);if(nt.type==="normal"){if(Ne=se.done?"completed":"suspendedYield",nt.arg===g)continue;return{value:nt.arg,done:se.done}}nt.type==="throw"&&(Ne="completed",se.method="throw",se.arg=nt.arg)}}}(R,D,re),F}function m(R,T,D){try{return{type:"normal",arg:R.call(T,D)}}catch(O){return{type:"throw",arg:O}}}n.wrap=f;var g={};function v(){}function I(){}function S(){}var y={};h(y,a,function(){return this});var E=Object.getPrototypeOf,C=E&&E(E(K([])));C&&C!==i&&o.call(C,a)&&(y=C);var x=S.prototype=v.prototype=Object.create(y);function U(R){["next","throw","return"].forEach(function(T){h(R,T,function(D){return this._invoke(T,D)})})}function G(R,T){var D;this._invoke=function(O,M){function F(){return new T(function(re,pe){(function ve(se,Ne,_e,Je){var $e=m(R[se],R,Ne);if($e.type!=="throw"){var Re=$e.arg,nt=Re.value;return nt&&typeof nt=="object"&&o.call(nt,"__await")?T.resolve(nt.__await).then(function(At){ve("next",At,_e,Je)},function(At){ve("throw",At,_e,Je)}):T.resolve(nt).then(function(At){Re.value=At,_e(Re)},function(At){return ve("throw",At,_e,Je)})}Je($e.arg)})(O,M,re,pe)})}return D=D?D.then(F,F):F()}}function H(R,T){var D=R.iterator[T.method];if(D===void 0){if(T.delegate=null,T.method==="throw"){if(R.iterator.return&&(T.method="return",T.arg=void 0,H(R,T),T.method==="throw"))return g;T.method="throw",T.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var O=m(D,R.iterator,T.arg);if(O.type==="throw")return T.method="throw",T.arg=O.arg,T.delegate=null,g;var M=O.arg;return M?M.done?(T[R.resultName]=M.value,T.next=R.nextLoc,T.method!=="return"&&(T.method="next",T.arg=void 0),T.delegate=null,g):M:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,g)}function V(R){var T={tryLoc:R[0]};1 in R&&(T.catchLoc=R[1]),2 in R&&(T.finallyLoc=R[2],T.afterLoc=R[3]),this.tryEntries.push(T)}function j(R){var T=R.completion||{};T.type="normal",delete T.arg,R.completion=T}function q(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(V,this),this.reset(!0)}function K(R){if(R){var T=R[a];if(T)return T.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var D=-1,O=function M(){for(;++D<R.length;)if(o.call(R,D))return M.value=R[D],M.done=!1,M;return M.value=void 0,M.done=!0,M};return O.next=O}}return{next:De}}function De(){return{value:void 0,done:!0}}return I.prototype=S,h(x,"constructor",S),h(S,"constructor",I),I.displayName=h(S,l,"GeneratorFunction"),n.isGeneratorFunction=function(R){var T=typeof R=="function"&&R.constructor;return!!T&&(T===I||(T.displayName||T.name)==="GeneratorFunction")},n.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,S):(R.__proto__=S,h(R,l,"GeneratorFunction")),R.prototype=Object.create(x),R},n.awrap=function(R){return{__await:R}},U(G.prototype),h(G.prototype,u,function(){return this}),n.AsyncIterator=G,n.async=function(R,T,D,O,M){M===void 0&&(M=Promise);var F=new G(f(R,T,D,O),M);return n.isGeneratorFunction(T)?F:F.next().then(function(re){return re.done?re.value:F.next()})},U(x),h(x,l,"Generator"),h(x,a,function(){return this}),h(x,"toString",function(){return"[object Generator]"}),n.keys=function(R){var T=[];for(var D in R)T.push(D);return T.reverse(),function O(){for(;T.length;){var M=T.pop();if(M in R)return O.value=M,O.done=!1,O}return O.done=!0,O}},n.values=K,q.prototype={constructor:q,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!R)for(var T in this)T.charAt(0)==="t"&&o.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=void 0)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if(R.type==="throw")throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var T=this;function D(ve,se){return F.type="throw",F.arg=R,T.next=ve,se&&(T.method="next",T.arg=void 0),!!se}for(var O=this.tryEntries.length-1;O>=0;--O){var M=this.tryEntries[O],F=M.completion;if(M.tryLoc==="root")return D("end");if(M.tryLoc<=this.prev){var re=o.call(M,"catchLoc"),pe=o.call(M,"finallyLoc");if(re&&pe){if(this.prev<M.catchLoc)return D(M.catchLoc,!0);if(this.prev<M.finallyLoc)return D(M.finallyLoc)}else if(re){if(this.prev<M.catchLoc)return D(M.catchLoc,!0)}else{if(!pe)throw new Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return D(M.finallyLoc)}}}},abrupt:function(R,T){for(var D=this.tryEntries.length-1;D>=0;--D){var O=this.tryEntries[D];if(O.tryLoc<=this.prev&&o.call(O,"finallyLoc")&&this.prev<O.finallyLoc){var M=O;break}}M&&(R==="break"||R==="continue")&&M.tryLoc<=T&&T<=M.finallyLoc&&(M=null);var F=M?M.completion:{};return F.type=R,F.arg=T,M?(this.method="next",this.next=M.finallyLoc,g):this.complete(F)},complete:function(R,T){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&T&&(this.next=T),g},finish:function(R){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.finallyLoc===R)return this.complete(D.completion,D.afterLoc),j(D),g}},catch:function(R){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.tryLoc===R){var O=D.completion;if(O.type==="throw"){var M=O.arg;j(D)}return M}}throw new Error("illegal catch attempt")},delegateYield:function(R,T,D){return this.delegate={iterator:K(R),resultName:T,nextLoc:D},this.method==="next"&&(this.arg=void 0),g}},n}(e.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}});let Rg=!0,Ag=!0;function Za(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function So(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(a,u){if(a!==t)return o.apply(this,arguments);const l=h=>{const f=n(h);f&&(u.handleEvent?u.handleEvent(f):u(f))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(u,l),o.apply(this,[a,l])};const c=i.removeEventListener;i.removeEventListener=function(a,u){if(a!==t||!this._eventMap||!this._eventMap[t])return c.apply(this,arguments);if(!this._eventMap[t].has(u))return c.apply(this,arguments);const l=this._eventMap[t].get(u);return this._eventMap[t].delete(u),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,c.apply(this,[a,l])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(a){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),a&&this.addEventListener(t,this["_on"+t]=a)},enumerable:!0,configurable:!0})}function jw(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Rg=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Bw(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ag=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function ed(){if(typeof window=="object"){if(Rg)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Cc(e,t){Ag&&console.warn(e+" is deprecated, please use "+t+" instead.")}function xg(e){return Object.prototype.toString.call(e)==="[object Object]"}function Pg(e){return xg(e)?Object.keys(e).reduce(function(t,n){const i=xg(e[n]),o=i?Pg(e[n]):e[n],c=i&&!Object.keys(o).length;return o===void 0||c?t:Object.assign(t,{[n]:o})},{}):e}function Dg(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",o=new Map;if(t===null)return o;const c=[];return e.forEach(a=>{a.type==="track"&&a.trackIdentifier===t.id&&c.push(a)}),c.forEach(a=>{e.forEach(u=>{u.type===i&&u.trackId===a.id&&function l(h,f,m){f&&!m.has(f.id)&&(m.set(f.id,f),Object.keys(f).forEach(g=>{g.endsWith("Id")?l(h,h.get(f[g]),m):g.endsWith("Ids")&&f[g].forEach(v=>{l(h,h.get(v),m)})}))}(e,u,o)})}),o}const Og=ed;function Ng(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const u={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const h=typeof a[l]=="object"?a[l]:{ideal:a[l]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const f=function(m,g){return m?m+g.charAt(0).toUpperCase()+g.slice(1):g==="deviceId"?"sourceId":g};if(h.ideal!==void 0){u.optional=u.optional||[];let m={};typeof h.ideal=="number"?(m[f("min",l)]=h.ideal,u.optional.push(m),m={},m[f("max",l)]=h.ideal,u.optional.push(m)):(m[f("",l)]=h.ideal,u.optional.push(m))}h.exact!==void 0&&typeof h.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[f("",l)]=h.exact):["min","max"].forEach(m=>{h[m]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[f(m,l)]=h[m])})}),a.advanced&&(u.optional=(u.optional||[]).concat(a.advanced)),u},o=function(a,u){if(t.version>=61)return u(a);if((a=JSON.parse(JSON.stringify(a)))&&typeof a.audio=="object"){const l=function(h,f,m){f in h&&!(m in h)&&(h[m]=h[f],delete h[f])};l((a=JSON.parse(JSON.stringify(a))).audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=i(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const h=t.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||h)){let f;if(delete a.video.facingMode,l.exact==="environment"||l.ideal==="environment"?f=["back","rear"]:l.exact!=="user"&&l.ideal!=="user"||(f=["front"]),f)return n.mediaDevices.enumerateDevices().then(m=>{let g=(m=m.filter(v=>v.kind==="videoinput")).find(v=>f.some(I=>v.label.toLowerCase().includes(I)));return!g&&m.length&&f.includes("back")&&(g=m[m.length-1]),g&&(a.video.deviceId=l.exact?{exact:g.deviceId}:{ideal:g.deviceId}),a.video=i(a.video),Og("chrome: "+JSON.stringify(a)),u(a)})}a.video=i(a.video)}return Og("chrome: "+JSON.stringify(a)),u(a)},c=function(a){return t.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(a,u,l){o(a,h=>{n.webkitGetUserMedia(h,u,f=>{l&&l(c(f))})})}.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(u){return o(u,l=>a(l).then(h=>{if(l.audio&&!h.getAudioTracks().length||l.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(c(h))))}}}function Lg(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Mg(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let o;o=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):{track:i.track};const c=new Event("track");c.track=i.track,c.receiver=o,c.transceiver={receiver:o},c.streams=[n.stream],this.dispatchEvent(c)}),n.stream.getTracks().forEach(i=>{let o;o=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(a=>a.track&&a.track.id===i.id):{track:i};const c=new Event("track");c.track=i,c.receiver=o,c.transceiver={receiver:o},c.streams=[n.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else So(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function Ug(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(o,c){return{track:c,get dtmf(){return this._dtmf===void 0&&(c.kind==="audio"?this._dtmf=o.createDTMFSender(c):this._dtmf=null),this._dtmf},_pc:o}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,u){let l=o.apply(this,arguments);return l||(l=t(this,a),this._senders.push(l)),l};const c=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){c.apply(this,arguments);const u=this._senders.indexOf(a);u!==-1&&this._senders.splice(u,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(c=>{this._senders.push(t(this,c))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],i.apply(this,[o]),o.getTracks().forEach(c=>{const a=this._senders.find(u=>u.track===c);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Vg(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,i,o]=arguments;if(arguments.length>0&&typeof n=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof n!="function"))return t.apply(this,[]);const c=function(u){const l={};return u.result().forEach(h=>{const f={id:h.id,timestamp:h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[h.type]||h.type};h.names().forEach(m=>{f[m]=h.stat(m)}),l[f.id]=f}),l},a=function(u){return new Map(Object.keys(u).map(l=>[l,u[l]]))};if(arguments.length>=2){const u=function(l){i(a(c(l)))};return t.apply(this,[u,n])}return new Promise((u,l)=>{t.apply(this,[function(h){u(a(c(h)))},l])}).then(i,o)}}function Fg(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(c=>c._pc=this),o});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),e.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(c=>Dg(c,o.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),So(e,"track",i=>(i.receiver._pc=i.srcElement,i)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>Dg(o,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let i,o,c;return this.getSenders().forEach(a=>{a.track===n&&(i?c=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===n&&(o?c=!0:o=a),a.track===n)),c||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function jg(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(c,a){if(!a)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=t.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(u)===-1&&this._shimmedLocalStreams[a.id].push(u):this._shimmedLocalStreams[a.id]=[a,u],u};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const u=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[c.id]=[c].concat(u)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],i.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const u=this._shimmedLocalStreams[a].indexOf(c);u!==-1&&this._shimmedLocalStreams[a].splice(u,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),o.apply(this,arguments)}}function Bg(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return jg(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const h=n.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(f=>this._reverseStreams[f.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(f=>{if(this.getSenders().find(m=>m.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const f=new e.MediaStream(h.getTracks());this._streams[h.id]=f,this._reverseStreams[f.id]=h,h=f}i.apply(this,[h])};const o=e.RTCPeerConnection.prototype.removeStream;function c(h,f){let m=f.sdp;return Object.keys(h._reverseStreams||[]).forEach(g=>{const v=h._reverseStreams[g],I=h._streams[v.id];m=m.replace(new RegExp(I.id,"g"),v.id)}),new RTCSessionDescription({type:f.type,sdp:m})}function a(h,f){let m=f.sdp;return Object.keys(h._reverseStreams||[]).forEach(g=>{const v=h._reverseStreams[g],I=h._streams[v.id];m=m.replace(new RegExp(v.id,"g"),I.id)}),new RTCSessionDescription({type:f.type,sdp:m})}e.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},e.RTCPeerConnection.prototype.addTrack=function(h,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(I=>I===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(I=>I.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const v=this._streams[f.id];if(v)v.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const I=new e.MediaStream([h]);this._streams[f.id]=I,this._reverseStreams[I.id]=f,this.addStream(I)}return this.getSenders().find(I=>I.track===h)},["createOffer","createAnswer"].forEach(function(h){const f=e.RTCPeerConnection.prototype[h],m={[h](){const g=arguments;return arguments.length&&typeof arguments[0]=="function"?f.apply(this,[v=>{const I=c(this,v);g[0].apply(null,[I])},v=>{g[1]&&g[1].apply(null,v)},arguments[2]]):f.apply(this,arguments).then(v=>c(this,v))}};e.RTCPeerConnection.prototype[h]=m[h]});const u=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=a(this,arguments[0]),u.apply(this,arguments)):u.apply(this,arguments)};const l=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const h=l.get.apply(this);return h.type===""?h:c(this,h)}}),e.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(h._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let f;this._streams=this._streams||{},Object.keys(this._streams).forEach(m=>{this._streams[m].getTracks().find(g=>h.track===g)&&(f=this._streams[m])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function td(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=e.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=o[n]})}function Hg(e,t){So(e,"negotiationneeded",n=>{const i=n.target;if(!(t.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")||i.signalingState==="stable")return n})}var $g=Object.freeze({__proto__:null,shimMediaStream:Lg,shimOnTrack:Mg,shimGetSendersWithDtmf:Ug,shimGetStats:Vg,shimSenderReceiverGetStats:Fg,shimAddTrackRemoveTrackWithNative:jg,shimAddTrackRemoveTrack:Bg,shimPeerConnection:td,fixNegotiationNeeded:Hg,shimGetUserMedia:Ng,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof t=="function"?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(i=>{const o=n.video&&n.video.width,c=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(n.video.mandatory.maxWidth=o),c&&(n.video.mandatory.maxHeight=c),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),Ve=Ie(function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(function(i){return i.trim()})},t.splitSections=function(n){return n.split(`
m=`).map(function(i,o){return(o>0?"m="+i:i).trim()+`\r
`})},t.getDescription=function(n){var i=t.splitSections(n);return i&&i[0]},t.getMediaSections=function(n){var i=t.splitSections(n);return i.shift(),i},t.matchPrefix=function(n,i){return t.splitLines(n).filter(function(o){return o.indexOf(i)===0})},t.parseCandidate=function(n){for(var i,o={foundation:(i=n.indexOf("a=candidate:")===0?n.substring(12).split(" "):n.substring(10).split(" "))[0],component:parseInt(i[1],10),protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]},c=8;c<i.length;c+=2)switch(i[c]){case"raddr":o.relatedAddress=i[c+1];break;case"rport":o.relatedPort=parseInt(i[c+1],10);break;case"tcptype":o.tcpType=i[c+1];break;case"ufrag":o.ufrag=i[c+1],o.usernameFragment=i[c+1];break;default:o[i[c]]=i[c+1]}return o},t.writeCandidate=function(n){var i=[];i.push(n.foundation),i.push(n.component),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);var o=n.type;return i.push("typ"),i.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},t.parseIceOptions=function(n){return n.substr(14).split(" ")},t.parseRtpMap=function(n){var i=n.substr(9).split(" "),o={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),o.name=i[0],o.clockRate=parseInt(i[1],10),o.channels=i.length===3?parseInt(i[2],10):1,o.numChannels=o.channels,o},t.writeRtpMap=function(n){var i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);var o=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(o!==1?"/"+o:"")+`\r
`},t.parseExtmap=function(n){var i=n.substr(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1]}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+`\r
`},t.parseFmtp=function(n){for(var i,o={},c=n.substr(n.indexOf(" ")+1).split(";"),a=0;a<c.length;a++)o[(i=c[a].trim().split("="))[0].trim()]=i[1];return o},t.writeFmtp=function(n){var i="",o=n.payloadType;if(n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){var c=[];Object.keys(n.parameters).forEach(function(a){n.parameters[a]?c.push(a+"="+n.parameters[a]):c.push(a)}),i+="a=fmtp:"+o+" "+c.join(";")+`\r
`}return i},t.parseRtcpFb=function(n){var i=n.substr(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},t.writeRtcpFb=function(n){var i="",o=n.payloadType;return n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(function(c){i+="a=rtcp-fb:"+o+" "+c.type+(c.parameter&&c.parameter.length?" "+c.parameter:"")+`\r
`}),i},t.parseSsrcMedia=function(n){var i=n.indexOf(" "),o={ssrc:parseInt(n.substr(7,i-7),10)},c=n.indexOf(":",i);return c>-1?(o.attribute=n.substr(i+1,c-i-1),o.value=n.substr(c+1)):o.attribute=n.substr(i+1),o},t.parseSsrcGroup=function(n){var i=n.substr(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(function(o){return parseInt(o,10)})}},t.getMid=function(n){var i=t.matchPrefix(n,"a=mid:")[0];if(i)return i.substr(6)},t.parseFingerprint=function(n){var i=n.substr(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1]}},t.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:t.matchPrefix(n+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,i){var o="a=setup:"+i+`\r
`;return n.fingerprints.forEach(function(c){o+="a=fingerprint:"+c.algorithm+" "+c.value+`\r
`}),o},t.parseCryptoLine=function(n){var i=n.substr(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;var i=n.substr(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,i){return t.matchPrefix(n+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,i){var o=t.matchPrefix(n+i,"a=ice-ufrag:")[0],c=t.matchPrefix(n+i,"a=ice-pwd:")[0];return o&&c?{usernameFragment:o.substr(12),password:c.substr(10)}:null},t.writeIceParameters=function(n){return"a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`},t.parseRtpParameters=function(n){for(var i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=t.splitLines(n)[0].split(" "),c=3;c<o.length;c++){var a=o[c],u=t.matchPrefix(n,"a=rtpmap:"+a+" ")[0];if(u){var l=t.parseRtpMap(u),h=t.matchPrefix(n,"a=fmtp:"+a+" ");switch(l.parameters=h.length?t.parseFmtp(h[0]):{},l.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),i.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(l.name.toUpperCase())}}}return t.matchPrefix(n,"a=extmap:").forEach(function(f){i.headerExtensions.push(t.parseExtmap(f))}),i},t.writeRtpDescription=function(n,i){var o="";o+="m="+n+" ",o+=i.codecs.length>0?"9":"0",o+=" UDP/TLS/RTP/SAVPF ",o+=i.codecs.map(function(a){return a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType}).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(function(a){o+=t.writeRtpMap(a),o+=t.writeFmtp(a),o+=t.writeRtcpFb(a)});var c=0;return i.codecs.forEach(function(a){a.maxptime>c&&(c=a.maxptime)}),c>0&&(o+="a=maxptime:"+c+`\r
`),o+=`a=rtcp-mux\r
`,i.headerExtensions&&i.headerExtensions.forEach(function(a){o+=t.writeExtmap(a)}),o},t.parseRtpEncodingParameters=function(n){var i,o=[],c=t.parseRtpParameters(n),a=c.fecMechanisms.indexOf("RED")!==-1,u=c.fecMechanisms.indexOf("ULPFEC")!==-1,l=t.matchPrefix(n,"a=ssrc:").map(function(g){return t.parseSsrcMedia(g)}).filter(function(g){return g.attribute==="cname"}),h=l.length>0&&l[0].ssrc,f=t.matchPrefix(n,"a=ssrc-group:FID").map(function(g){return g.substr(17).split(" ").map(function(v){return parseInt(v,10)})});f.length>0&&f[0].length>1&&f[0][0]===h&&(i=f[0][1]),c.codecs.forEach(function(g){if(g.name.toUpperCase()==="RTX"&&g.parameters.apt){var v={ssrc:h,codecPayloadType:parseInt(g.parameters.apt,10)};h&&i&&(v.rtx={ssrc:i}),o.push(v),a&&((v=JSON.parse(JSON.stringify(v))).fec={ssrc:h,mechanism:u?"red+ulpfec":"red"},o.push(v))}}),o.length===0&&h&&o.push({ssrc:h});var m=t.matchPrefix(n,"b=");return m.length&&(m=m[0].indexOf("b=TIAS:")===0?parseInt(m[0].substr(7),10):m[0].indexOf("b=AS:")===0?1e3*parseInt(m[0].substr(5),10)*.95-16e3:void 0,o.forEach(function(g){g.maxBitrate=m})),o},t.parseRtcpParameters=function(n){var i={},o=t.matchPrefix(n,"a=ssrc:").map(function(u){return t.parseSsrcMedia(u)}).filter(function(u){return u.attribute==="cname"})[0];o&&(i.cname=o.value,i.ssrc=o.ssrc);var c=t.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=c.length>0,i.compound=c.length===0;var a=t.matchPrefix(n,"a=rtcp-mux");return i.mux=a.length>0,i},t.parseMsid=function(n){var i,o=t.matchPrefix(n,"a=msid:");if(o.length===1)return{stream:(i=o[0].substr(7).split(" "))[0],track:i[1]};var c=t.matchPrefix(n,"a=ssrc:").map(function(a){return t.parseSsrcMedia(a)}).filter(function(a){return a.attribute==="msid"});return c.length>0?{stream:(i=c[0].value.split(" "))[0],track:i[1]}:void 0},t.parseSctpDescription=function(n){var i,o=t.parseMLine(n),c=t.matchPrefix(n,"a=max-message-size:");c.length>0&&(i=parseInt(c[0].substr(19),10)),isNaN(i)&&(i=65536);var a=t.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:o.fmt,maxMessageSize:i};if(t.matchPrefix(n,"a=sctpmap:").length>0){var u=t.matchPrefix(n,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:i}}},t.writeSctpDescription=function(n,i){var o=[];return o=n.protocol!=="DTLS/SCTP"?["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&o.push("a=max-message-size:"+i.maxMessageSize+`\r
`),o.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(n,i,o){var c=i!==void 0?i:2;return`v=0\r
o=`+(o||"thisisadapterortc")+" "+(n||t.generateSessionId())+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.writeMediaSection=function(n,i,o,c){var a=t.writeRtpDescription(n.kind,i);if(a+=t.writeIceParameters(n.iceGatherer.getLocalParameters()),a+=t.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),o==="offer"?"actpass":"active"),a+="a=mid:"+n.mid+`\r
`,n.direction?a+="a="+n.direction+`\r
`:n.rtpSender&&n.rtpReceiver?a+=`a=sendrecv\r
`:n.rtpSender?a+=`a=sendonly\r
`:n.rtpReceiver?a+=`a=recvonly\r
`:a+=`a=inactive\r
`,n.rtpSender){var u="msid:"+c.id+" "+n.rtpSender.track.id+`\r
`;a+="a="+u,a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+u,n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+u,a+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+`\r
`,n.rtpSender&&n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+`\r
`),a},t.getDirection=function(n,i){for(var o=t.splitLines(n),c=0;c<o.length;c++)switch(o[c]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[c].substr(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substr(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){var i=t.splitLines(n)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(n){var i=t.matchPrefix(n,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;for(var i=t.splitLines(n),o=0;o<i.length;o++)if(i[o].length<2||i[o].charAt(1)!=="=")return!1;return!0},e.exports=t});function zg(e,t,n,i,o){var c=Ve.writeRtpDescription(e.kind,t);if(c+=Ve.writeIceParameters(e.iceGatherer.getLocalParameters()),c+=Ve.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),n==="offer"?"actpass":o||"active"),c+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?c+=`a=sendrecv\r
`:e.rtpSender?c+=`a=sendonly\r
`:e.rtpReceiver?c+=`a=recvonly\r
`:c+=`a=inactive\r
`,e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var u="msid:"+(i?i.id:"-")+" "+a+`\r
`;c+="a="+u,c+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+u,e.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+u,c+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return c+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+Ve.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+Ve.localCName+`\r
`),c}function Rc(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(c,a){c=parseInt(c,10);for(var u=0;u<a.length;u++)if(a[u].payloadType===c||a[u].preferredPayloadType===c)return a[u]},o=function(c,a,u,l){var h=i(c.parameters.apt,u),f=i(a.parameters.apt,l);return h&&f&&h.name.toLowerCase()===f.name.toLowerCase()};return e.codecs.forEach(function(c){for(var a=0;a<t.codecs.length;a++){var u=t.codecs[a];if(c.name.toLowerCase()===u.name.toLowerCase()&&c.clockRate===u.clockRate){if(c.name.toLowerCase()==="rtx"&&c.parameters&&u.parameters.apt&&!o(c,u,e.codecs,t.codecs))continue;(u=JSON.parse(JSON.stringify(u))).numChannels=Math.min(c.numChannels,u.numChannels),n.codecs.push(u),u.rtcpFeedback=u.rtcpFeedback.filter(function(l){for(var h=0;h<c.rtcpFeedback.length;h++)if(c.rtcpFeedback[h].type===l.type&&c.rtcpFeedback[h].parameter===l.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(c){for(var a=0;a<t.headerExtensions.length;a++){var u=t.headerExtensions[a];if(c.uri===u.uri){n.headerExtensions.push(u);break}}}),n}function Wg(e,t,n){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)!==-1}function nd(e,t){var n=e.getRemoteCandidates().find(function(i){return t.foundation===i.foundation&&t.ip===i.ip&&t.port===i.port&&t.priority===i.priority&&t.protocol===i.protocol&&t.type===i.type});return n||e.addRemoteCandidate(t),!n}function en(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var Hw=function(e,t){function n(a,u){u.addTrack(a),u.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:a}))}function i(a,u,l,h){var f=new Event("track");f.track=u,f.receiver=l,f.transceiver={receiver:l},f.streams=h,e.setTimeout(function(){a._dispatchEvent("track",f)})}var o=function(a){var u=this,l=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(f){u[f]=l[f].bind(l)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",a=JSON.parse(JSON.stringify(a||{})),this.usingBundle=a.bundlePolicy==="max-bundle",a.rtcpMuxPolicy==="negotiate")throw en("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require"),a.iceTransportPolicy){case"all":case"relay":break;default:a.iceTransportPolicy="all"}switch(a.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:a.bundlePolicy="balanced"}if(a.iceServers=function(f,m){var g=!1;return(f=JSON.parse(JSON.stringify(f))).filter(function(v){if(v&&(v.urls||v.url)){var I=v.urls||v.url;v.url&&!v.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var S=typeof I=="string";return S&&(I=[I]),I=I.filter(function(y){return y.indexOf("turn:")===0&&y.indexOf("transport=udp")!==-1&&y.indexOf("turn:[")===-1&&!g?(g=!0,!0):y.indexOf("stun:")===0&&m>=14393&&y.indexOf("?transport=udp")===-1}),delete v.url,v.urls=S?I[0]:I,!!I.length}})}(a.iceServers||[],t),this._iceGatherers=[],a.iceCandidatePoolSize)for(var h=a.iceCandidatePoolSize;h>0;h--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:a.iceServers,gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=0;this._config=a,this.transceivers=[],this._sdpSessionId=Ve.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(o.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(o.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),o.prototype.onicecandidate=null,o.prototype.onaddstream=null,o.prototype.ontrack=null,o.prototype.onremovestream=null,o.prototype.onsignalingstatechange=null,o.prototype.oniceconnectionstatechange=null,o.prototype.onconnectionstatechange=null,o.prototype.onicegatheringstatechange=null,o.prototype.onnegotiationneeded=null,o.prototype.ondatachannel=null,o.prototype._dispatchEvent=function(a,u){this._isClosed||(this.dispatchEvent(u),typeof this["on"+a]=="function"&&this["on"+a](u))},o.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)},o.prototype.getConfiguration=function(){return this._config},o.prototype.getLocalStreams=function(){return this.localStreams},o.prototype.getRemoteStreams=function(){return this.remoteStreams},o.prototype._createTransceiver=function(a,u){var l=this.transceivers.length>0,h={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&l)h.iceTransport=this.transceivers[0].iceTransport,h.dtlsTransport=this.transceivers[0].dtlsTransport;else{var f=this._createIceAndDtlsTransports();h.iceTransport=f.iceTransport,h.dtlsTransport=f.dtlsTransport}return u||this.transceivers.push(h),h},o.prototype.addTrack=function(a,u){if(this._isClosed)throw en("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var l;if(this.transceivers.find(function(f){return f.track===a}))throw en("InvalidAccessError","Track already exists.");for(var h=0;h<this.transceivers.length;h++)this.transceivers[h].track||this.transceivers[h].kind!==a.kind||(l=this.transceivers[h]);return l||(l=this._createTransceiver(a.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(u)===-1&&this.localStreams.push(u),l.track=a,l.stream=u,l.rtpSender=new e.RTCRtpSender(a,l.dtlsTransport),l.rtpSender},o.prototype.addStream=function(a){var u=this;if(t>=15025)a.getTracks().forEach(function(h){u.addTrack(h,a)});else{var l=a.clone();a.getTracks().forEach(function(h,f){var m=l.getTracks()[f];h.addEventListener("enabled",function(g){m.enabled=g.enabled})}),l.getTracks().forEach(function(h){u.addTrack(h,l)})}},o.prototype.removeTrack=function(a){if(this._isClosed)throw en("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var u=this.transceivers.find(function(h){return h.rtpSender===a});if(!u)throw en("InvalidAccessError","Sender was not created by this connection.");var l=u.stream;u.rtpSender.stop(),u.rtpSender=null,u.track=null,u.stream=null,this.transceivers.map(function(h){return h.stream}).indexOf(l)===-1&&this.localStreams.indexOf(l)>-1&&this.localStreams.splice(this.localStreams.indexOf(l),1),this._maybeFireNegotiationNeeded()},o.prototype.removeStream=function(a){var u=this;a.getTracks().forEach(function(l){var h=u.getSenders().find(function(f){return f.track===l});h&&u.removeTrack(h)})},o.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})},o.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})},o.prototype._createIceGatherer=function(a,u){var l=this;if(u&&a>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var h=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(h,"state",{value:"new",writable:!0}),this.transceivers[a].bufferedCandidateEvents=[],this.transceivers[a].bufferCandidates=function(f){var m=!f.candidate||Object.keys(f.candidate).length===0;h.state=m?"completed":"gathering",l.transceivers[a].bufferedCandidateEvents!==null&&l.transceivers[a].bufferedCandidateEvents.push(f)},h.addEventListener("localcandidate",this.transceivers[a].bufferCandidates),h},o.prototype._gather=function(a,u){var l=this,h=this.transceivers[u].iceGatherer;if(!h.onlocalcandidate){var f=this.transceivers[u].bufferedCandidateEvents;this.transceivers[u].bufferedCandidateEvents=null,h.removeEventListener("localcandidate",this.transceivers[u].bufferCandidates),h.onlocalcandidate=function(m){if(!(l.usingBundle&&u>0)){var g=new Event("icecandidate");g.candidate={sdpMid:a,sdpMLineIndex:u};var v=m.candidate,I=!v||Object.keys(v).length===0;if(I)h.state!=="new"&&h.state!=="gathering"||(h.state="completed");else{h.state==="new"&&(h.state="gathering"),v.component=1,v.ufrag=h.getLocalParameters().usernameFragment;var S=Ve.writeCandidate(v);g.candidate=Object.assign(g.candidate,Ve.parseCandidate(S)),g.candidate.candidate=S,g.candidate.toJSON=function(){return{candidate:g.candidate.candidate,sdpMid:g.candidate.sdpMid,sdpMLineIndex:g.candidate.sdpMLineIndex,usernameFragment:g.candidate.usernameFragment}}}var y=Ve.getMediaSections(l._localDescription.sdp);y[g.candidate.sdpMLineIndex]+=I?`a=end-of-candidates\r
`:"a="+g.candidate.candidate+`\r
`,l._localDescription.sdp=Ve.getDescription(l._localDescription.sdp)+y.join("");var E=l.transceivers.every(function(C){return C.iceGatherer&&C.iceGatherer.state==="completed"});l.iceGatheringState!=="gathering"&&(l.iceGatheringState="gathering",l._emitGatheringStateChange()),I||l._dispatchEvent("icecandidate",g),E&&(l._dispatchEvent("icecandidate",new Event("icecandidate")),l.iceGatheringState="complete",l._emitGatheringStateChange())}},e.setTimeout(function(){f.forEach(function(m){h.onlocalcandidate(m)})},0)}},o.prototype._createIceAndDtlsTransports=function(){var a=this,u=new e.RTCIceTransport(null);u.onicestatechange=function(){a._updateIceConnectionState(),a._updateConnectionState()};var l=new e.RTCDtlsTransport(u);return l.ondtlsstatechange=function(){a._updateConnectionState()},l.onerror=function(){Object.defineProperty(l,"state",{value:"failed",writable:!0}),a._updateConnectionState()},{iceTransport:u,dtlsTransport:l}},o.prototype._disposeIceAndDtlsTransports=function(a){var u=this.transceivers[a].iceGatherer;u&&(delete u.onlocalcandidate,delete this.transceivers[a].iceGatherer);var l=this.transceivers[a].iceTransport;l&&(delete l.onicestatechange,delete this.transceivers[a].iceTransport);var h=this.transceivers[a].dtlsTransport;h&&(delete h.ondtlsstatechange,delete h.onerror,delete this.transceivers[a].dtlsTransport)},o.prototype._transceive=function(a,u,l){var h=Rc(a.localCapabilities,a.remoteCapabilities);u&&a.rtpSender&&(h.encodings=a.sendEncodingParameters,h.rtcp={cname:Ve.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(h.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(h)),l&&a.rtpReceiver&&h.codecs.length>0&&(a.kind==="video"&&a.recvEncodingParameters&&t<15019&&a.recvEncodingParameters.forEach(function(f){delete f.rtx}),a.recvEncodingParameters.length?h.encodings=a.recvEncodingParameters:h.encodings=[{}],h.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(h.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(h.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(h))},o.prototype.setLocalDescription=function(a){var u,l,h=this;if(["offer","answer"].indexOf(a.type)===-1)return Promise.reject(en("TypeError",'Unsupported type "'+a.type+'"'));if(!Wg("setLocalDescription",a.type,h.signalingState)||h._isClosed)return Promise.reject(en("InvalidStateError","Can not set local "+a.type+" in state "+h.signalingState));if(a.type==="offer")u=Ve.splitSections(a.sdp),l=u.shift(),u.forEach(function(m,g){var v=Ve.parseRtpParameters(m);h.transceivers[g].localCapabilities=v}),h.transceivers.forEach(function(m,g){h._gather(m.mid,g)});else if(a.type==="answer"){u=Ve.splitSections(h._remoteDescription.sdp),l=u.shift();var f=Ve.matchPrefix(l,"a=ice-lite").length>0;u.forEach(function(m,g){var v=h.transceivers[g],I=v.iceGatherer,S=v.iceTransport,y=v.dtlsTransport,E=v.localCapabilities,C=v.remoteCapabilities;if(!(Ve.isRejected(m)&&Ve.matchPrefix(m,"a=bundle-only").length===0)&&!v.rejected){var x=Ve.getIceParameters(m,l),U=Ve.getDtlsParameters(m,l);f&&(U.role="server"),h.usingBundle&&g!==0||(h._gather(v.mid,g),S.state==="new"&&S.start(I,x,f?"controlling":"controlled"),y.state==="new"&&y.start(U));var G=Rc(E,C);h._transceive(v,G.codecs.length>0,!1)}})}return h._localDescription={type:a.type,sdp:a.sdp},a.type==="offer"?h._updateSignalingState("have-local-offer"):h._updateSignalingState("stable"),Promise.resolve()},o.prototype.setRemoteDescription=function(a){var u=this;if(["offer","answer"].indexOf(a.type)===-1)return Promise.reject(en("TypeError",'Unsupported type "'+a.type+'"'));if(!Wg("setRemoteDescription",a.type,u.signalingState)||u._isClosed)return Promise.reject(en("InvalidStateError","Can not set remote "+a.type+" in state "+u.signalingState));var l={};u.remoteStreams.forEach(function(S){l[S.id]=S});var h=[],f=Ve.splitSections(a.sdp),m=f.shift(),g=Ve.matchPrefix(m,"a=ice-lite").length>0,v=Ve.matchPrefix(m,"a=group:BUNDLE ").length>0;u.usingBundle=v;var I=Ve.matchPrefix(m,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!I&&I.substr(14).split(" ").indexOf("trickle")>=0,f.forEach(function(S,y){var E=Ve.splitLines(S),C=Ve.getKind(S),x=Ve.isRejected(S)&&Ve.matchPrefix(S,"a=bundle-only").length===0,U=E[0].substr(2).split(" ")[2],G=Ve.getDirection(S,m),H=Ve.parseMsid(S),V=Ve.getMid(S)||Ve.generateIdentifier();if(x||C==="application"&&(U==="DTLS/SCTP"||U==="UDP/DTLS/SCTP"))u.transceivers[y]={mid:V,kind:C,protocol:U,rejected:!0};else{var j,q,K,De,R,T,D,O,M;!x&&u.transceivers[y]&&u.transceivers[y].rejected&&(u.transceivers[y]=u._createTransceiver(C,!0));var F,re,pe=Ve.parseRtpParameters(S);x||(F=Ve.getIceParameters(S,m),(re=Ve.getDtlsParameters(S,m)).role="client"),D=Ve.parseRtpEncodingParameters(S);var ve=Ve.parseRtcpParameters(S),se=Ve.matchPrefix(S,"a=end-of-candidates",m).length>0,Ne=Ve.matchPrefix(S,"a=candidate:").map(function($e){return Ve.parseCandidate($e)}).filter(function($e){return $e.component===1});if((a.type==="offer"||a.type==="answer")&&!x&&v&&y>0&&u.transceivers[y]&&(u._disposeIceAndDtlsTransports(y),u.transceivers[y].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[y].iceTransport=u.transceivers[0].iceTransport,u.transceivers[y].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[y].rtpSender&&u.transceivers[y].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[y].rtpReceiver&&u.transceivers[y].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),a.type!=="offer"||x)a.type==="answer"&&!x&&(q=(j=u.transceivers[y]).iceGatherer,K=j.iceTransport,De=j.dtlsTransport,R=j.rtpReceiver,T=j.sendEncodingParameters,O=j.localCapabilities,u.transceivers[y].recvEncodingParameters=D,u.transceivers[y].remoteCapabilities=pe,u.transceivers[y].rtcpParameters=ve,Ne.length&&K.state==="new"&&(!g&&!se||v&&y!==0?Ne.forEach(function($e){nd(j.iceTransport,$e)}):K.setRemoteCandidates(Ne)),v&&y!==0||(K.state==="new"&&K.start(q,F,"controlling"),De.state==="new"&&De.start(re)),!Rc(j.localCapabilities,j.remoteCapabilities).codecs.filter(function($e){return $e.name.toLowerCase()==="rtx"}).length&&j.sendEncodingParameters[0].rtx&&delete j.sendEncodingParameters[0].rtx,u._transceive(j,G==="sendrecv"||G==="recvonly",G==="sendrecv"||G==="sendonly"),!R||G!=="sendrecv"&&G!=="sendonly"?delete j.rtpReceiver:(M=R.track,H?(l[H.stream]||(l[H.stream]=new e.MediaStream),n(M,l[H.stream]),h.push([M,R,l[H.stream]])):(l.default||(l.default=new e.MediaStream),n(M,l.default),h.push([M,R,l.default]))));else{(j=u.transceivers[y]||u._createTransceiver(C)).mid=V,j.iceGatherer||(j.iceGatherer=u._createIceGatherer(y,v)),Ne.length&&j.iceTransport.state==="new"&&(!se||v&&y!==0?Ne.forEach(function($e){nd(j.iceTransport,$e)}):j.iceTransport.setRemoteCandidates(Ne)),O=e.RTCRtpReceiver.getCapabilities(C),t<15019&&(O.codecs=O.codecs.filter(function($e){return $e.name!=="rtx"})),T=j.sendEncodingParameters||[{ssrc:1001*(2*y+2)}];var _e,Je=!1;G==="sendrecv"||G==="sendonly"?(Je=!j.rtpReceiver,R=j.rtpReceiver||new e.RTCRtpReceiver(j.dtlsTransport,C),Je&&(M=R.track,H&&H.stream==="-"||(H?(l[H.stream]||(l[H.stream]=new e.MediaStream,Object.defineProperty(l[H.stream],"id",{get:function(){return H.stream}})),Object.defineProperty(M,"id",{get:function(){return H.track}}),_e=l[H.stream]):(l.default||(l.default=new e.MediaStream),_e=l.default)),_e&&(n(M,_e),j.associatedRemoteMediaStreams.push(_e)),h.push([M,R,_e]))):j.rtpReceiver&&j.rtpReceiver.track&&(j.associatedRemoteMediaStreams.forEach(function($e){var Re=$e.getTracks().find(function(nt){return nt.id===j.rtpReceiver.track.id});Re&&function(nt,At){At.removeTrack(nt),At.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:nt}))}(Re,$e)}),j.associatedRemoteMediaStreams=[]),j.localCapabilities=O,j.remoteCapabilities=pe,j.rtpReceiver=R,j.rtcpParameters=ve,j.sendEncodingParameters=T,j.recvEncodingParameters=D,u._transceive(u.transceivers[y],!1,Je)}}}),u._dtlsRole===void 0&&(u._dtlsRole=a.type==="offer"?"active":"passive"),u._remoteDescription={type:a.type,sdp:a.sdp},a.type==="offer"?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(l).forEach(function(S){var y=l[S];if(y.getTracks().length){if(u.remoteStreams.indexOf(y)===-1){u.remoteStreams.push(y);var E=new Event("addstream");E.stream=y,e.setTimeout(function(){u._dispatchEvent("addstream",E)})}h.forEach(function(C){var x=C[0],U=C[1];y.id===C[2].id&&i(u,x,U,[y])})}}),h.forEach(function(S){S[2]||i(u,S[0],S[1],[])}),e.setTimeout(function(){u&&u.transceivers&&u.transceivers.forEach(function(S){S.iceTransport&&S.iceTransport.state==="new"&&S.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),S.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},o.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop(),a.dtlsTransport&&a.dtlsTransport.stop(),a.rtpSender&&a.rtpSender.stop(),a.rtpReceiver&&a.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},o.prototype._updateSignalingState=function(a){this.signalingState=a;var u=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",u)},o.prototype._maybeFireNegotiationNeeded=function(){var a=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,e.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var u=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",u)}},0))},o.prototype._updateIceConnectionState=function(){var a,u={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(h){h.iceTransport&&!h.rejected&&u[h.iceTransport.state]++}),a="new",u.failed>0?a="failed":u.checking>0?a="checking":u.disconnected>0?a="disconnected":u.new>0?a="new":u.connected>0?a="connected":u.completed>0&&(a="completed"),a!==this.iceConnectionState){this.iceConnectionState=a;var l=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",l)}},o.prototype._updateConnectionState=function(){var a,u={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(h){h.iceTransport&&h.dtlsTransport&&!h.rejected&&(u[h.iceTransport.state]++,u[h.dtlsTransport.state]++)}),u.connected+=u.completed,a="new",u.failed>0?a="failed":u.connecting>0?a="connecting":u.disconnected>0?a="disconnected":u.new>0?a="new":u.connected>0&&(a="connected"),a!==this.connectionState){this.connectionState=a;var l=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",l)}},o.prototype.createOffer=function(){var a=this;if(a._isClosed)return Promise.reject(en("InvalidStateError","Can not call createOffer after close"));var u=a.transceivers.filter(function(g){return g.kind==="audio"}).length,l=a.transceivers.filter(function(g){return g.kind==="video"}).length,h=arguments[0];if(h){if(h.mandatory||h.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");h.offerToReceiveAudio!==void 0&&(u=h.offerToReceiveAudio===!0?1:h.offerToReceiveAudio===!1?0:h.offerToReceiveAudio),h.offerToReceiveVideo!==void 0&&(l=h.offerToReceiveVideo===!0?1:h.offerToReceiveVideo===!1?0:h.offerToReceiveVideo)}for(a.transceivers.forEach(function(g){g.kind==="audio"?--u<0&&(g.wantReceive=!1):g.kind==="video"&&--l<0&&(g.wantReceive=!1)});u>0||l>0;)u>0&&(a._createTransceiver("audio"),u--),l>0&&(a._createTransceiver("video"),l--);var f=Ve.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.transceivers.forEach(function(g,v){var I=g.track,S=g.kind,y=g.mid||Ve.generateIdentifier();g.mid=y,g.iceGatherer||(g.iceGatherer=a._createIceGatherer(v,a.usingBundle));var E=e.RTCRtpSender.getCapabilities(S);t<15019&&(E.codecs=E.codecs.filter(function(x){return x.name!=="rtx"})),E.codecs.forEach(function(x){x.name==="H264"&&x.parameters["level-asymmetry-allowed"]===void 0&&(x.parameters["level-asymmetry-allowed"]="1"),g.remoteCapabilities&&g.remoteCapabilities.codecs&&g.remoteCapabilities.codecs.forEach(function(U){x.name.toLowerCase()===U.name.toLowerCase()&&x.clockRate===U.clockRate&&(x.preferredPayloadType=U.payloadType)})}),E.headerExtensions.forEach(function(x){(g.remoteCapabilities&&g.remoteCapabilities.headerExtensions||[]).forEach(function(U){x.uri===U.uri&&(x.id=U.id)})});var C=g.sendEncodingParameters||[{ssrc:1001*(2*v+1)}];I&&t>=15019&&S==="video"&&!C[0].rtx&&(C[0].rtx={ssrc:C[0].ssrc+1}),g.wantReceive&&(g.rtpReceiver=new e.RTCRtpReceiver(g.dtlsTransport,S)),g.localCapabilities=E,g.sendEncodingParameters=C}),a._config.bundlePolicy!=="max-compat"&&(f+="a=group:BUNDLE "+a.transceivers.map(function(g){return g.mid}).join(" ")+`\r
`),f+=`a=ice-options:trickle\r
`,a.transceivers.forEach(function(g,v){f+=zg(g,g.localCapabilities,"offer",g.stream,a._dtlsRole),f+=`a=rtcp-rsize\r
`,!g.iceGatherer||a.iceGatheringState==="new"||v!==0&&a.usingBundle||(g.iceGatherer.getLocalCandidates().forEach(function(I){I.component=1,f+="a="+Ve.writeCandidate(I)+`\r
`}),g.iceGatherer.state==="completed"&&(f+=`a=end-of-candidates\r
`))});var m=new e.RTCSessionDescription({type:"offer",sdp:f});return Promise.resolve(m)},o.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(en("InvalidStateError","Can not call createAnswer after close"));if(a.signalingState!=="have-remote-offer"&&a.signalingState!=="have-local-pranswer")return Promise.reject(en("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var u=Ve.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(u+="a=group:BUNDLE "+a.transceivers.map(function(f){return f.mid}).join(" ")+`\r
`),u+=`a=ice-options:trickle\r
`;var l=Ve.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(f,m){if(!(m+1>l)){if(f.rejected)return f.kind==="application"?f.protocol==="DTLS/SCTP"?u+=`m=application 0 DTLS/SCTP 5000\r
`:u+="m=application 0 "+f.protocol+` webrtc-datachannel\r
`:f.kind==="audio"?u+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:f.kind==="video"&&(u+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(u+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+f.mid+`\r
`);var g;f.stream&&(f.kind==="audio"?g=f.stream.getAudioTracks()[0]:f.kind==="video"&&(g=f.stream.getVideoTracks()[0]),g&&t>=15019&&f.kind==="video"&&!f.sendEncodingParameters[0].rtx&&(f.sendEncodingParameters[0].rtx={ssrc:f.sendEncodingParameters[0].ssrc+1}));var v=Rc(f.localCapabilities,f.remoteCapabilities);!v.codecs.filter(function(I){return I.name.toLowerCase()==="rtx"}).length&&f.sendEncodingParameters[0].rtx&&delete f.sendEncodingParameters[0].rtx,u+=zg(f,v,"answer",f.stream,a._dtlsRole),f.rtcpParameters&&f.rtcpParameters.reducedSize&&(u+=`a=rtcp-rsize\r
`)}});var h=new e.RTCSessionDescription({type:"answer",sdp:u});return Promise.resolve(h)},o.prototype.addIceCandidate=function(a){var u,l=this;return a&&a.sdpMLineIndex===void 0&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(h,f){if(!l._remoteDescription)return f(en("InvalidStateError","Can not add ICE candidate without a remote description"));if(a&&a.candidate!==""){var m=a.sdpMLineIndex;if(a.sdpMid){for(var g=0;g<l.transceivers.length;g++)if(l.transceivers[g].mid===a.sdpMid){m=g;break}}var v=l.transceivers[m];if(!v)return f(en("OperationError","Can not add ICE candidate"));if(v.rejected)return h();var I=Object.keys(a.candidate).length>0?Ve.parseCandidate(a.candidate):{};if(I.protocol==="tcp"&&(I.port===0||I.port===9)||I.component&&I.component!==1)return h();if((m===0||m>0&&v.iceTransport!==l.transceivers[0].iceTransport)&&!nd(v.iceTransport,I))return f(en("OperationError","Can not add ICE candidate"));var S=a.candidate.trim();S.indexOf("a=")===0&&(S=S.substr(2)),(u=Ve.getMediaSections(l._remoteDescription.sdp))[m]+="a="+(I.type?S:"end-of-candidates")+`\r
`,l._remoteDescription.sdp=Ve.getDescription(l._remoteDescription.sdp)+u.join("")}else for(var y=0;y<l.transceivers.length&&(l.transceivers[y].rejected||(l.transceivers[y].iceTransport.addRemoteCandidate({}),(u=Ve.getMediaSections(l._remoteDescription.sdp))[y]+=`a=end-of-candidates\r
`,l._remoteDescription.sdp=Ve.getDescription(l._remoteDescription.sdp)+u.join(""),!l.usingBundle));y++);h()})},o.prototype.getStats=function(a){if(a&&a instanceof e.MediaStreamTrack){var u=null;if(this.transceivers.forEach(function(h){h.rtpSender&&h.rtpSender.track===a?u=h.rtpSender:h.rtpReceiver&&h.rtpReceiver.track===a&&(u=h.rtpReceiver)}),!u)throw en("InvalidAccessError","Invalid selector.");return u.getStats()}var l=[];return this.transceivers.forEach(function(h){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(f){h[f]&&l.push(h[f].getStats())})}),Promise.all(l).then(function(h){var f=new Map;return h.forEach(function(m){m.forEach(function(g){f.set(g.id,g)})}),f})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){var u=e[a];if(u&&u.prototype&&u.prototype.getStats){var l=u.prototype.getStats;u.prototype.getStats=function(){return l.apply(this).then(function(h){var f=new Map;return Object.keys(h).forEach(function(m){var g;h[m].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(g=h[m]).type]||g.type,f.set(m,h[m])}),f})}}});var c=["createOffer","createAnswer"];return c.forEach(function(a){var u=o.prototype[a];o.prototype[a]=function(){var l=arguments;return typeof l[0]=="function"||typeof l[1]=="function"?u.apply(this,[arguments[2]]).then(function(h){typeof l[0]=="function"&&l[0].apply(null,[h])},function(h){typeof l[1]=="function"&&l[1].apply(null,[h])}):u.apply(this,arguments)}}),(c=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(a){var u=o.prototype[a];o.prototype[a]=function(){var l=arguments;return typeof l[1]=="function"||typeof l[2]=="function"?u.apply(this,arguments).then(function(){typeof l[1]=="function"&&l[1].apply(null)},function(h){typeof l[2]=="function"&&l[2].apply(null,[h])}):u.apply(this,arguments)}}),["getStats"].forEach(function(a){var u=o.prototype[a];o.prototype[a]=function(){var l=arguments;return typeof l[1]=="function"?u.apply(this,arguments).then(function(){typeof l[1]=="function"&&l[1].apply(null)}):u.apply(this,arguments)}}),o};function Gg(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(i){return n(i).catch(o=>Promise.reject(function(c){return{name:{PermissionDeniedError:"NotAllowedError"}[c.name]||c.name,message:c.message,constraint:c.constraint,toString(){return this.name}}}(o)))}}function Jg(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function rd(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(i){return i}),e.RTCSessionDescription||(e.RTCSessionDescription=function(i){return i}),t.version<15025)){const i=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(o){i.set.call(this,o);const c=new Event("enabled");c.enabled=o,this.dispatchEvent(c)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=Hw(e,t.version);e.RTCPeerConnection=function(i){return i&&i.iceServers&&(i.iceServers=function(o,c){let a=!1;return(o=JSON.parse(JSON.stringify(o))).filter(u=>{if(u&&(u.urls||u.url)){let l=u.urls||u.url;u.url&&!u.urls&&Cc("RTCIceServer.url","RTCIceServer.urls");const h=typeof l=="string";return h&&(l=[l]),l=l.filter(f=>{if(f.indexOf("stun:")===0)return!1;const m=f.startsWith("turn")&&!f.startsWith("turn:[")&&f.includes("transport=udp");return m&&!a?(a=!0,!0):m&&!a}),delete u.url,u.urls=h?l[0]:l,!!l.length}})}(i.iceServers,t.version),ed("ICE servers after filtering:",i.iceServers)),new n(i)},e.RTCPeerConnection.prototype=n.prototype}function qg(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var Kg=Object.freeze({__proto__:null,shimPeerConnection:rd,shimReplaceTrack:qg,shimGetUserMedia:Gg,shimGetDisplayMedia:Jg});function Qg(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(o,c,a){Cc("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(o).then(c,a)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const o=function(a,u,l){u in a&&!(l in a)&&(a[l]=a[u],delete a[u])},c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),o(a.audio,"autoGainControl","mozAutoGainControl"),o(a.audio,"noiseSuppression","mozNoiseSuppression")),c(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const u=a.apply(this,arguments);return o(u,"mozAutoGainControl","autoGainControl"),o(u,"mozNoiseSuppression","noiseSuppression"),u}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u,"autoGainControl","mozAutoGainControl"),o(u,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[u])}}}}function Yg(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function id(e,t){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const c=e.RTCPeerConnection.prototype[o],a={[o](){return arguments[0]=new(o==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};e.RTCPeerConnection.prototype[o]=a[o]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[o,c,a]=arguments;return i.apply(this,[o||null]).then(u=>{if(t.version<53&&!c)try{u.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;u.forEach((h,f)=>{u.set(f,Object.assign({},h,{type:n[h.type]||h.type}))})}return u}).then(c,a)}}function Xg(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Zg(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n}),So(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function ev(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){Cc("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function tv(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function nv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const n=arguments[1],i=n&&"sendEncodings"in n;i&&n.sendEncodings.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=t.apply(this,arguments);if(i){const{sender:c}=o,a=c.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=n.sendEncodings,c.sendEncodings=n.sendEncodings,this.setParametersPromises.push(c.setParameters(a).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return o})}function rv(e){if(typeof e!="object"||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const n=t.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function iv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ov(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var av=Object.freeze({__proto__:null,shimOnTrack:Yg,shimPeerConnection:id,shimSenderGetStats:Xg,shimReceiverGetStats:Zg,shimRemoveStream:ev,shimRTCDataChannel:tv,shimAddTransceiver:nv,shimGetParameters:rv,shimCreateOffer:iv,shimCreateAnswer:ov,shimGetUserMedia:Qg,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return n.video===!0?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function sv(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(i=>t.call(this,i,n)),n.getVideoTracks().forEach(i=>t.call(this,i,n))},e.RTCPeerConnection.prototype.addTrack=function(n,...i){return i&&i.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function cv(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,this.dispatchEvent(c)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(o)>=0)return;n._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,n.dispatchEvent(c)})}),t.apply(n,arguments)}}}function uv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,o=t.setLocalDescription,c=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(l,h){const f=arguments.length>=2?arguments[2]:arguments[0],m=n.apply(this,[f]);return h?(m.then(l,h),Promise.resolve()):m},t.createAnswer=function(l,h){const f=arguments.length>=2?arguments[2]:arguments[0],m=i.apply(this,[f]);return h?(m.then(l,h),Promise.resolve()):m};let u=function(l,h,f){const m=o.apply(this,[l]);return f?(m.then(h,f),Promise.resolve()):m};t.setLocalDescription=u,u=function(l,h,f){const m=c.apply(this,[l]);return f?(m.then(h,f),Promise.resolve()):m},t.setRemoteDescription=u,u=function(l,h,f){const m=a.apply(this,[l]);return f?(m.then(h,f),Promise.resolve()):m},t.addIceCandidate=u}function lv(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=o=>i(dv(o))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(n,i,o){t.mediaDevices.getUserMedia(n).then(i,o)}.bind(t))}function dv(e){return e&&e.video!==void 0?Object.assign({},e,{video:Pg(e.video)}):e}function hv(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const o=[];for(let c=0;c<n.iceServers.length;c++){let a=n.iceServers[c];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(Cc("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(n.iceServers[c])}n.iceServers=o}return new t(n,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function fv(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pv(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){n.offerToReceiveAudio!==void 0&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveAudio!==!0||i||this.addTransceiver("audio"),n.offerToReceiveVideo!==void 0&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const o=this.getTransceivers().find(c=>c.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):n.offerToReceiveVideo!==!0||o||this.addTransceiver("video")}return t.apply(this,arguments)}}function mv(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var gv=Object.freeze({__proto__:null,shimLocalStreamsAPI:sv,shimRemoteStreamsAPI:cv,shimCallbacksAPI:uv,shimGetUserMedia:lv,shimConstraints:dv,shimRTCIceServerUrls:hv,shimTrackEventTransceiver:fv,shimCreateOfferLegacy:pv,shimAudioContext:mv});function Ac(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const i=new t(n),o=Ve.parseCandidate(n.candidate),c=Object.assign(i,o);return c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new t(n)},e.RTCIceCandidate.prototype=t.prototype,So(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function es(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const n=function(u){if(!u||!u.sdp)return!1;const l=Ve.splitSections(u.sdp);return l.shift(),l.some(h=>{const f=Ve.parseMLine(h);return f&&f.kind==="application"&&f.protocol.indexOf("SCTP")!==-1})},i=function(u){const l=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const h=parseInt(l[1],10);return h!=h?-1:h},o=function(u){let l=65536;return t.browser==="firefox"&&(l=t.version<57?u===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),l},c=function(u,l){let h=65536;t.browser==="firefox"&&t.version===57&&(h=65535);const f=Ve.matchPrefix(u.sdp,"a=max-message-size:");return f.length>0?h=parseInt(f[0].substr(19),10):t.browser==="firefox"&&l!==-1&&(h=2147483637),h},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const u=i(arguments[0]),l=o(u),h=c(arguments[0],u);let f;f=l===0&&h===0?Number.POSITIVE_INFINITY:l===0||h===0?Math.max(l,h):Math.min(l,h);const m={};Object.defineProperty(m,"maxMessageSize",{get:()=>f}),this._sctp=m}return a.apply(this,arguments)}}function ts(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(i,o){const c=i.send;i.send=function(){const a=arguments[0],u=a.length||a.size||a.byteLength;if(i.readyState==="open"&&o.sctp&&u>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return c.apply(i,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return t(i,this),i},So(e,"datachannel",i=>(t(i.channel,i.target),i))}function od(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const c=o.target;if(c._lastConnectionState!==c.connectionState){c._lastConnectionState=c.connectionState;const a=new Event("connectionstatechange",o);c.dispatchEvent(a)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function ad(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function xc(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&n.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var $w=Object.freeze({__proto__:null,shimRTCIceCandidate:Ac,shimMaxMessageSize:es,shimSendThrowTypeError:ts,shimConnectionState:od,removeExtmapAllowMixed:ad,shimAddIceCandidateNullOrEmpty:xc});(function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=ed,i=function(c){const a={browser:null,version:null};if(c===void 0||!c.navigator)return a.browser="Not a browser.",a;const{navigator:u}=c;if(u.mozGetUserMedia)a.browser="firefox",a.version=Za(u.userAgent,/Firefox\/(\d+)\./,1);else if(u.webkitGetUserMedia||c.isSecureContext===!1&&c.webkitRTCPeerConnection&&!c.RTCIceGatherer)a.browser="chrome",a.version=Za(u.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(u.mediaDevices&&u.userAgent.match(/Edge\/(\d+).(\d+)$/))a.browser="edge",a.version=Za(u.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!c.RTCPeerConnection||!u.userAgent.match(/AppleWebKit\/(\d+)\./))return a.browser="Not a supported browser.",a;a.browser="safari",a.version=Za(u.userAgent,/AppleWebKit\/(\d+)\./,1),a.supportsUnifiedPlan=c.RTCRtpTransceiver&&"currentDirection"in c.RTCRtpTransceiver.prototype}return a}(e),o={browserDetails:i,commonShim:$w,extractVersion:Za,disableLog:jw,disableWarnings:Bw};switch(i.browser){case"chrome":if(!$g||!td||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=$g,xc(e,i),Ng(e,i),Lg(e),td(e,i),Mg(e),Bg(e,i),Ug(e),Vg(e),Fg(e),Hg(e,i),Ac(e),od(e),es(e,i),ts(e),ad(e,i);break;case"firefox":if(!av||!id||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=av,xc(e,i),Qg(e,i),id(e,i),Yg(e),ev(e),Xg(e),Zg(e),tv(e),nv(e),rv(e),iv(e),ov(e),Ac(e),od(e),es(e,i),ts(e);break;case"edge":if(!Kg||!rd||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),o;n("adapter.js shimming edge."),o.browserShim=Kg,Gg(e),Jg(e),rd(e,i),qg(e),es(e,i),ts(e);break;case"safari":if(!gv||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=gv,xc(e,i),hv(e),pv(e),uv(e),sv(e),cv(e),fv(e),lv(e),mv(e),Ac(e),es(e,i),ts(e),ad(e,i);break;default:n("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Pc,Oi=Object.keys||function(e){return yg(e,wc)},zw={f:Te&&!hg?Object.defineProperties:function(e,t){gt(e);for(var n,i=me(t),o=Oi(t),c=o.length,a=0;c>a;)Ht.f(e,n=o[a++],i[n]);return e}},sd=Ce("document","documentElement"),vv=ql("IE_PROTO"),cd=function(){},_v=function(e){return"<script>"+e+"<\/script>"},yv=function(e){e.write(_v("")),e.close();var t=e.parentWindow.Object;return e=null,t},Dc=function(){try{Pc=new ActiveXObject("htmlfile")}catch{}var e,t;Dc=typeof document<"u"?document.domain&&Pc?yv(Pc):((t=Ja("iframe")).style.display="none",sd.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(_v("document.F=Object")),e.close(),e.F):yv(Pc);for(var n=wc.length;n--;)delete Dc.prototype[wc[n]];return Dc()};Tc[vv]=!0;var ko=Object.create||function(e,t){var n;return e!==null?(cd.prototype=gt(e),n=new cd,cd.prototype=null,n[vv]=e):n=Dc(),t===void 0?n:zw.f(n,t)},ud=ht("unscopables"),ld=Array.prototype;ld[ud]==null&&Ht.f(ld,ud,{configurable:!0,value:ko(null)});var Ni,bv,Sv,Io=function(e){ld[ud][e]=!0},To={},kv=!he(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Iv=ql("IE_PROTO"),dd=z.Object,Ww=dd.prototype,cr=kv?dd.getPrototypeOf:function(e){var t=sn(e);if(Qe(t,Iv))return t[Iv];var n=t.constructor;return te(n)&&t instanceof n?n.prototype:t instanceof dd?Ww:null},hd=ht("iterator"),Tv=!1;[].keys&&("next"in(Sv=[].keys())?(bv=cr(cr(Sv)))!==Object.prototype&&(Ni=bv):Tv=!0),(Ni==null||he(function(){var e={};return Ni[hd].call(e)!==e}))&&(Ni={}),te(Ni[hd])||bt(Ni,hd,function(){return this});var fd={IteratorPrototype:Ni,BUGGY_SAFARI_ITERATORS:Tv},Gw=Ht.f,wv=ht("toStringTag"),ti=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Qe(e,wv)&&Gw(e,wv,{configurable:!0,value:t})},Jw=fd.IteratorPrototype,qw=function(){return this},Ev=function(e,t,n,i){var o=t+" Iterator";return e.prototype=ko(Jw,{next:Tr(+!i,n)}),ti(e,o,!1),To[o]=qw,e},Kw=z.String,Qw=z.TypeError,$t=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=ne(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch{}return function(i,o){return gt(i),function(c){if(typeof c=="object"||te(c))return c;throw Qw("Can't set "+Kw(c)+" as a prototype")}(o),t?e(i,o):i.__proto__=o,i}}():void 0),Yw=Xr.PROPER,Xw=Xr.CONFIGURABLE,Cv=fd.IteratorPrototype,Oc=fd.BUGGY_SAFARI_ITERATORS,ns=ht("iterator"),Zw=function(){return this},pd=function(e,t,n,i,o,c,a){Ev(n,t,i);var u,l,h,f=function(E){if(E===o&&S)return S;if(!Oc&&E in v)return v[E];switch(E){case"keys":case"values":case"entries":return function(){return new n(this,E)}}return function(){return new n(this)}},m=t+" Iterator",g=!1,v=e.prototype,I=v[ns]||v["@@iterator"]||o&&v[o],S=!Oc&&I||f(o),y=t=="Array"&&v.entries||I;if(y&&(u=cr(y.call(new e)))!==Object.prototype&&u.next&&(cr(u)!==Cv&&($t?$t(u,Cv):te(u[ns])||bt(u,ns,Zw)),ti(u,m,!0)),Yw&&o=="values"&&I&&I.name!=="values"&&(Xw?Pt(v,"name","values"):(g=!0,S=function(){return Le(I,this)})),o)if(l={values:f("values"),keys:c?S:f("keys"),entries:f("entries")},a)for(h in l)(Oc||g||!(h in v))&&bt(v,h,l[h]);else Me({target:t,proto:!0,forced:Oc||g},l);return v[ns]!==S&&bt(v,ns,S,{name:o}),To[t]=S,l},eE=Ht.f,tE=Dt.set,nE=Dt.getterFor("Array Iterator"),ni=pd(Array,"Array",function(e,t){tE(this,{type:"Array Iterator",target:me(e),index:0,kind:t})},function(){var e=nE(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):n=="keys"?{value:i,done:!1}:n=="values"?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}},"values"),Rv=To.Arguments=To.Array;if(Io("keys"),Io("values"),Io("entries"),Te&&Rv.name!=="values")try{eE(Rv,"name",{value:"values"})}catch{}var Li=function(e,t,n){var i=_o(t);i in e?Ht.f(e,i,Tr(0,n)):e[i]=n},rE=z.Array,iE=Math.max,Gt=function(e,t,n){for(var i=un(e),o=cn(t,i),c=cn(n===void 0?i:n,i),a=rE(iE(c-o,0)),u=0;o<c;o++,u++)Li(a,u,e[o]);return a.length=u,a},Av=Zr.f,xv=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Pv={f:function(e){return xv&&L(e)=="Window"?function(t){try{return Av(t)}catch{return Gt(xv)}}(e):Av(me(e))}},Dv=he(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),Nc=Object.isExtensible,md=he(function(){Nc(1)})||Dv?function(e){return!!ie(e)&&(!Dv||L(e)!="ArrayBuffer")&&(!Nc||Nc(e))}:Nc,oE=!he(function(){return Object.isExtensible(Object.preventExtensions({}))}),wo=Ie(function(e){var t=Ht.f,n=!1,i=Wa("meta"),o=0,c=function(u){t(u,i,{value:{objectID:"O"+o++,weakData:{}}})},a=e.exports={enable:function(){a.enable=function(){},n=!0;var u=Zr.f,l=ne([].splice),h={};h[i]=1,u(h).length&&(Zr.f=function(f){for(var m=u(f),g=0,v=m.length;g<v;g++)if(m[g]===i){l(m,g,1);break}return m},Me({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Pv.f}))},fastKey:function(u,l){if(!ie(u))return typeof u=="symbol"?u:(typeof u=="string"?"S":"P")+u;if(!Qe(u,i)){if(!md(u))return"F";if(!l)return"E";c(u)}return u[i].objectID},getWeakData:function(u,l){if(!Qe(u,i)){if(!md(u))return!0;if(!l)return!1;c(u)}return u[i].weakData},onFreeze:function(u){return oE&&n&&md(u)&&!Qe(u,i)&&c(u),u}};Tc[i]=!0}),aE=(wo.enable,wo.fastKey,wo.getWeakData,wo.onFreeze,ht("iterator")),sE=Array.prototype,gd=function(e){return e!==void 0&&(To.Array===e||sE[aE]===e)},cE=ht("iterator"),rs=function(e){if(e!=null)return Kr(e,cE)||Kr(e,"@@iterator")||To[wr(e)]},uE=z.TypeError,Eo=function(e,t){var n=arguments.length<2?rs(e):t;if(an(n))return gt(Le(n,e));throw uE(Ut(e)+" is not iterable")},vd=function(e,t,n){var i,o;gt(e);try{if(!(i=Kr(e,"return"))){if(t==="throw")throw n;return n}i=Le(i,e)}catch(c){o=!0,i=c}if(t==="throw")throw n;if(o)throw i;return gt(i),n},lE=z.TypeError,Lc=function(e,t){this.stopped=e,this.result=t},Ov=Lc.prototype,Mc=function(e,t,n){var i,o,c,a,u,l,h,f=n&&n.that,m=!(!n||!n.AS_ENTRIES),g=!(!n||!n.IS_ITERATOR),v=!(!n||!n.INTERRUPTED),I=Yn(t,f),S=function(E){return i&&vd(i,"normal",E),new Lc(!0,E)},y=function(E){return m?(gt(E),v?I(E[0],E[1],S):I(E[0],E[1])):v?I(E,S):I(E)};if(g)i=e;else{if(!(o=rs(e)))throw lE(Ut(e)+" is not iterable");if(gd(o)){for(c=0,a=un(e);a>c;c++)if((u=y(e[c]))&&ke(Ov,u))return u;return new Lc(!1)}i=Eo(e,o)}for(l=i.next;!(h=Le(l,i)).done;){try{u=y(h.value)}catch(E){vd(i,"throw",E)}if(typeof u=="object"&&u&&ke(Ov,u))return u}return new Lc(!1)},dE=z.TypeError,Mn=function(e,t){if(ke(t,e))return e;throw dE("Incorrect invocation")},Nv=ht("iterator"),Lv=!1;try{var hE=0,Mv={next:function(){return{done:!!hE++}},return:function(){Lv=!0}};Mv[Nv]=function(){return this},Array.from(Mv,function(){throw 2})}catch{}var _d=function(e,t){if(!t&&!Lv)return!1;var n=!1;try{var i={};i[Nv]=function(){return{next:function(){return{done:n=!0}}}},e(i)}catch{}return n},Uc=function(e,t,n){var i,o;return $t&&te(i=t.constructor)&&i!==n&&ie(o=i.prototype)&&o!==n.prototype&&$t(e,o),e},Uv=function(e,t,n){var i=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,c=i?"set":"add",a=z[e],u=a&&a.prototype,l=a,h={},f=function(y){var E=ne(u[y]);bt(u,y,y=="add"?function(C){return E(this,C===0?0:C),this}:y=="delete"?function(C){return!(o&&!ie(C))&&E(this,C===0?0:C)}:y=="get"?function(C){return o&&!ie(C)?void 0:E(this,C===0?0:C)}:y=="has"?function(C){return!(o&&!ie(C))&&E(this,C===0?0:C)}:function(C,x){return E(this,C===0?0:C,x),this})};if(bo(e,!te(a)||!(o||u.forEach&&!he(function(){new a().entries().next()}))))l=n.getConstructor(t,e,i,c),wo.enable();else if(bo(e,!0)){var m=new l,g=m[c](o?{}:-0,1)!=m,v=he(function(){m.has(1)}),I=_d(function(y){new a(y)}),S=!o&&he(function(){for(var y=new a,E=5;E--;)y[c](E,E);return!y.has(-0)});I||((l=t(function(y,E){Mn(y,u);var C=Uc(new a,y,l);return E!=null&&Mc(E,C[c],{that:C,AS_ENTRIES:i}),C})).prototype=u,u.constructor=l),(v||S)&&(f("delete"),f("has"),i&&f("get")),(S||g)&&f(c),o&&u.clear&&delete u.clear}return h[e]=l,Me({global:!0,constructor:!0,forced:l!=a},h),ti(l,e),o||n.setStrong(l,e,i),l},is=function(e,t,n){for(var i in t)bt(e,i,t[i],n);return e},Vv=ht("species"),os=function(e){var t=Ce(e),n=Ht.f;Te&&t&&!t[Vv]&&n(t,Vv,{configurable:!0,get:function(){return this}})},fE=Ht.f,Fv=wo.fastKey,jv=Dt.set,yd=Dt.getterFor,Bv={getConstructor:function(e,t,n,i){var o=e(function(h,f){Mn(h,c),jv(h,{type:t,index:ko(null),first:void 0,last:void 0,size:0}),Te||(h.size=0),f!=null&&Mc(f,h[i],{that:h,AS_ENTRIES:n})}),c=o.prototype,a=yd(t),u=function(h,f,m){var g,v,I=a(h),S=l(h,f);return S?S.value=m:(I.last=S={index:v=Fv(f,!0),key:f,value:m,previous:g=I.last,next:void 0,removed:!1},I.first||(I.first=S),g&&(g.next=S),Te?I.size++:h.size++,v!=="F"&&(I.index[v]=S)),h},l=function(h,f){var m,g=a(h),v=Fv(f);if(v!=="F")return g.index[v];for(m=g.first;m;m=m.next)if(m.key==f)return m};return is(c,{clear:function(){for(var h=a(this),f=h.index,m=h.first;m;)m.removed=!0,m.previous&&(m.previous=m.previous.next=void 0),delete f[m.index],m=m.next;h.first=h.last=void 0,Te?h.size=0:this.size=0},delete:function(h){var f=a(this),m=l(this,h);if(m){var g=m.next,v=m.previous;delete f.index[m.index],m.removed=!0,v&&(v.next=g),g&&(g.previous=v),f.first==m&&(f.first=g),f.last==m&&(f.last=v),Te?f.size--:this.size--}return!!m},forEach:function(h){for(var f,m=a(this),g=Yn(h,arguments.length>1?arguments[1]:void 0);f=f?f.next:m.first;)for(g(f.value,f.key,this);f&&f.removed;)f=f.previous},has:function(h){return!!l(this,h)}}),is(c,n?{get:function(h){var f=l(this,h);return f&&f.value},set:function(h,f){return u(this,h===0?0:h,f)}}:{add:function(h){return u(this,h=h===0?0:h,h)}}),Te&&fE(c,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,n){var i=t+" Iterator",o=yd(t),c=yd(i);pd(e,t,function(a,u){jv(this,{type:i,target:a,state:o(a),kind:u,last:void 0})},function(){for(var a=c(this),u=a.kind,l=a.last;l&&l.removed;)l=l.previous;return a.target&&(a.last=l=l?l.next:a.state.first)?u=="keys"?{value:l.key,done:!1}:u=="values"?{value:l.value,done:!1}:{value:[l.key,l.value],done:!1}:(a.target=void 0,{value:void 0,done:!0})},n?"entries":"values",!n,!0),os(t)}};Uv("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Bv);var pE=z.String,Fe=function(e){if(wr(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return pE(e)},mE=ne("".charAt),Hv=ne("".charCodeAt),gE=ne("".slice),$v=function(e){return function(t,n){var i,o,c=Fe(ue(t)),a=Qn(n),u=c.length;return a<0||a>=u?e?"":void 0:(i=Hv(c,a))<55296||i>56319||a+1===u||(o=Hv(c,a+1))<56320||o>57343?e?mE(c,a):i:e?gE(c,a,a+2):o-56320+(i-55296<<10)+65536}},bd={codeAt:$v(!1),charAt:$v(!0)},vE=bd.charAt,_E=Dt.set,yE=Dt.getterFor("String Iterator");pd(String,"String",function(e){_E(this,{type:"String Iterator",string:Fe(e),index:0})},function(){var e,t=yE(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=vE(n,i),t.index+=e.length,{value:e,done:!1})});var Vc={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Sd=Ja("span").classList,zv=Sd&&Sd.constructor&&Sd.constructor.prototype,Wv=zv===Object.prototype?void 0:zv,kd=ht("iterator"),Gv=ht("toStringTag"),Id=ni.values,Jv=function(e,t){if(e){if(e[kd]!==Id)try{Pt(e,kd,Id)}catch{e[kd]=Id}if(e[Gv]||Pt(e,Gv,t),Vc[t]){for(var n in ni)if(e[n]!==ni[n])try{Pt(e,n,ni[n])}catch{e[n]=ni[n]}}}};for(var Td in Vc)Jv(z[Td]&&z[Td].prototype,Td);Jv(Wv,"DOMTokenList");var qv=Function.prototype,Kv=qv.apply,Qv=qv.call,ri=typeof Reflect=="object"&&Reflect.apply||(Bt?Qv.bind(Kv):function(){return Qv.apply(Kv,arguments)}),ii=ne([].slice),bE=z.TypeError,Er=function(e,t){if(e<t)throw bE("Not enough arguments");return e},SE=/MSIE .\./.test(Ee),kE=z.Function,Yv=function(e){return SE?function(t,n){var i=Er(arguments.length,1)>2,o=te(t)?t:kE(t),c=i?ii(arguments,2):void 0;return e(i?function(){ri(o,this,c)}:o,n)}:e},Xv={setTimeout:Yv(z.setTimeout),setInterval:Yv(z.setInterval)},Zv=Xv.setInterval;Me({global:!0,bind:!0,forced:z.setInterval!==Zv},{setInterval:Zv});var e_=Xv.setTimeout;Me({global:!0,bind:!0,forced:z.setTimeout!==e_},{setTimeout:e_}),Uv("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Bv);var IE=Xa("splice"),TE=z.TypeError,wE=Math.max,EE=Math.min;Me({target:"Array",proto:!0,forced:!IE},{splice:function(e,t){var n,i,o,c,a,u,l=sn(this),h=un(l),f=cn(e,h),m=arguments.length;if(m===0?n=i=0:m===1?(n=0,i=h-f):(n=m-2,i=EE(wE(Qn(t),0),h-f)),h+n-i>9007199254740991)throw TE("Maximum allowed length exceeded");for(o=Zl(l,i),c=0;c<i;c++)(a=f+c)in l&&Li(o,c,l[a]);if(o.length=i,n<i){for(c=f;c<h-i;c++)u=c+n,(a=c+i)in l?l[u]=l[a]:delete l[u];for(c=h;c>h-i+n;c--)delete l[c-1]}else if(n>i)for(c=h-i;c>f;c--)u=c+n-1,(a=c+i-1)in l?l[u]=l[a]:delete l[u];for(c=0;c<n;c++)l[c+f]=arguments[c+2];return l.length=h-i+n,o}});var as=function(e,t){var n=[][e];return!!n&&he(function(){n.call(null,t||function(){return 1},1)})},CE=Cn.forEach,ss=as("forEach")?[].forEach:function(e){return CE(this,e,arguments.length>1?arguments[1]:void 0)};Me({target:"Array",proto:!0,forced:[].forEach!=ss},{forEach:ss});var t_=function(e){if(e&&e.forEach!==ss)try{Pt(e,"forEach",ss)}catch{e.forEach=ss}};for(var wd in Vc)Vc[wd]&&t_(z[wd]&&z[wd].prototype);t_(Wv);var RE=ne([].join),AE=oe!=Object,xE=as("join",",");Me({target:"Array",proto:!0,forced:AE||!xE},{join:function(e){return RE(me(this),e===void 0?",":e)}});var n_=ht("isConcatSpreadable"),r_=z.TypeError,PE=tt>=51||!he(function(){var e=[];return e[n_]=!1,e.concat()[0]!==e}),DE=Xa("concat"),OE=function(e){if(!ie(e))return!1;var t=e[n_];return t!==void 0?!!t:Di(e)};Me({target:"Array",proto:!0,arity:1,forced:!PE||!DE},{concat:function(e){var t,n,i,o,c,a=sn(this),u=Zl(a,0),l=0;for(t=-1,i=arguments.length;t<i;t++)if(OE(c=t===-1?a:arguments[t])){if(l+(o=un(c))>9007199254740991)throw r_("Maximum allowed index exceeded");for(n=0;n<o;n++,l++)n in c&&Li(u,l,c[n])}else{if(l>=9007199254740991)throw r_("Maximum allowed index exceeded");Li(u,l++,c)}return u.length=l,u}});var Ed=Date.prototype,NE=ne(Ed.toString),LE=ne(Ed.getTime);String(new Date(NaN))!="Invalid Date"&&bt(Ed,"toString",function(){var e=LE(this);return e==e?NE(this):"Invalid Date"});var i_=function(){var e=gt(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Cd=z.RegExp,Rd=he(function(){var e=Cd("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),ME=Rd||he(function(){return!Cd("a","y").sticky}),Fc={BROKEN_CARET:Rd||he(function(){var e=Cd("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),MISSED_STICKY:ME,UNSUPPORTED_Y:Rd},UE=z.RegExp,Ad=he(function(){var e=UE(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),VE=z.RegExp,xd=he(function(){var e=VE("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),FE=Dt.get,jE=$l("native-string-replace",String.prototype.replace),jc=RegExp.prototype.exec,Pd=jc,BE=ne("".charAt),HE=ne("".indexOf),$E=ne("".replace),Dd=ne("".slice),Od=function(){var e=/a/,t=/b*/g;return Le(jc,e,"a"),Le(jc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),o_=Fc.BROKEN_CARET,Nd=/()??/.exec("")[1]!==void 0;(Od||Nd||o_||Ad||xd)&&(Pd=function(e){var t,n,i,o,c,a,u,l=this,h=FE(l),f=Fe(e),m=h.raw;if(m)return m.lastIndex=l.lastIndex,t=Le(Pd,m,f),l.lastIndex=m.lastIndex,t;var g=h.groups,v=o_&&l.sticky,I=Le(i_,l),S=l.source,y=0,E=f;if(v&&(I=$E(I,"y",""),HE(I,"g")===-1&&(I+="g"),E=Dd(f,l.lastIndex),l.lastIndex>0&&(!l.multiline||l.multiline&&BE(f,l.lastIndex-1)!==`
`)&&(S="(?: "+S+")",E=" "+E,y++),n=new RegExp("^(?:"+S+")",I)),Nd&&(n=new RegExp("^"+S+"$(?!\\s)",I)),Od&&(i=l.lastIndex),o=Le(jc,v?n:l,E),v?o?(o.input=Dd(o.input,y),o[0]=Dd(o[0],y),o.index=l.lastIndex,l.lastIndex+=o[0].length):l.lastIndex=0:Od&&o&&(l.lastIndex=l.global?o.index+o[0].length:i),Nd&&o&&o.length>1&&Le(jE,o[0],n,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(o[c]=void 0)}),o&&g)for(o.groups=a=ko(null),c=0;c<g.length;c++)a[(u=g[c])[0]]=o[u[1]];return o});var cs=Pd;Me({target:"RegExp",proto:!0,forced:/./.exec!==cs},{exec:cs});var zE=ht("species"),Ld=RegExp.prototype,Bc=function(e,t,n,i){var o=ht(e),c=!he(function(){var h={};return h[o]=function(){return 7},""[e](h)!=7}),a=c&&!he(function(){var h=!1,f=/a/;return e==="split"&&((f={}).constructor={},f.constructor[zE]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return h=!0,null},f[o](""),!h});if(!c||!a||n){var u=ne(/./[o]),l=t(o,""[e],function(h,f,m,g,v){var I=ne(h),S=f.exec;return S===cs||S===Ld.exec?c&&!v?{done:!0,value:u(f,m,g)}:{done:!0,value:I(m,f,g)}:{done:!1}});bt(String.prototype,e,l[0]),bt(Ld,o,l[1])}i&&Pt(Ld[o],"sham",!0)},WE=bd.charAt,Md=function(e,t,n){return t+(n?WE(e,t).length:1)},GE=Math.floor,Ud=ne("".charAt),JE=ne("".replace),Vd=ne("".slice),qE=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,KE=/\$([$&'`]|\d{1,2})/g,QE=function(e,t,n,i,o,c){var a=n+e.length,u=i.length,l=KE;return o!==void 0&&(o=sn(o),l=qE),JE(c,l,function(h,f){var m;switch(Ud(f,0)){case"$":return"$";case"&":return e;case"`":return Vd(t,0,n);case"'":return Vd(t,a);case"<":m=o[Vd(f,1,-1)];break;default:var g=+f;if(g===0)return h;if(g>u){var v=GE(g/10);return v===0?h:v<=u?i[v-1]===void 0?Ud(f,1):i[v-1]+Ud(f,1):h}m=i[g-1]}return m===void 0?"":m})},YE=z.TypeError,Co=function(e,t){var n=e.exec;if(te(n)){var i=Le(n,e,t);return i!==null&&gt(i),i}if(L(e)==="RegExp")return Le(cs,e,t);throw YE("RegExp#exec called on incompatible receiver")},Fd=ht("replace"),XE=Math.max,ZE=Math.min,eC=ne([].concat),jd=ne([].push),a_=ne("".indexOf),s_=ne("".slice),tC="a".replace(/./,"$0")==="$0",c_=!!/./[Fd]&&/./[Fd]("a","$0")==="";Bc("replace",function(e,t,n){var i=c_?"$":"$0";return[function(o,c){var a=ue(this),u=o==null?void 0:Kr(o,Fd);return u?Le(u,o,a,c):Le(t,Fe(a),o,c)},function(o,c){var a=gt(this),u=Fe(o);if(typeof c=="string"&&a_(c,i)===-1&&a_(c,"$<")===-1){var l=n(t,a,u,c);if(l.done)return l.value}var h=te(c);h||(c=Fe(c));var f=a.global;if(f){var m=a.unicode;a.lastIndex=0}for(var g=[];;){var v=Co(a,u);if(v===null||(jd(g,v),!f))break;Fe(v[0])===""&&(a.lastIndex=Md(u,sr(a.lastIndex),m))}for(var I,S="",y=0,E=0;E<g.length;E++){for(var C=Fe((v=g[E])[0]),x=XE(ZE(Qn(v.index),u.length),0),U=[],G=1;G<v.length;G++)jd(U,(I=v[G])===void 0?I:String(I));var H=v.groups;if(h){var V=eC([C],U,x,u);H!==void 0&&jd(V,H);var j=Fe(ri(c,void 0,V))}else j=QE(C,u,x,U,H,c);x>=y&&(S+=s_(u,y,x)+j,y=x+C.length)}return S+s_(u,y)}]},!!he(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"})||!tC||c_);var nC=ht("iterator"),Bd=!he(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach(function(i,o){t.delete("b"),n+=o+i}),!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[nC]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||n!=="a1c3"||new URL("http://x",void 0).host!=="x"}),rC=Math.floor,Hd=function(e,t){var n=e.length,i=rC(n/2);return n<8?iC(e,t):oC(e,Hd(Gt(e,0,i),t),Hd(Gt(e,i),t),t)},iC=function(e,t){for(var n,i,o=e.length,c=1;c<o;){for(i=c,n=e[c];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==c++&&(e[i]=n)}return e},oC=function(e,t,n,i){for(var o=t.length,c=n.length,a=0,u=0;a<o||u<c;)e[a+u]=a<o&&u<c?i(t[a],n[u])<=0?t[a++]:n[u++]:a<o?t[a++]:n[u++];return e},u_=Hd,aC=ht("iterator"),l_=Dt.set,Xn=Dt.getterFor("URLSearchParams"),sC=Dt.getterFor("URLSearchParamsIterator"),cC=Object.getOwnPropertyDescriptor,$d=function(e){if(!Te)return z[e];var t=cC(z,e);return t&&t.value},d_=$d("fetch"),Hc=$d("Request"),us=$d("Headers"),zd=Hc&&Hc.prototype,h_=us&&us.prototype,uC=z.RegExp,lC=z.TypeError,f_=z.decodeURIComponent,dC=z.encodeURIComponent,hC=ne("".charAt),p_=ne([].join),Mi=ne([].push),Wd=ne("".replace),fC=ne([].shift),m_=ne([].splice),g_=ne("".split),pC=ne("".slice),mC=/\+/g,v_=Array(4),gC=function(e){return v_[e-1]||(v_[e-1]=uC("((?:%[\\da-f]{2}){"+e+"})","gi"))},vC=function(e){try{return f_(e)}catch{return e}},__=function(e){var t=Wd(e,mC," "),n=4;try{return f_(t)}catch{for(;n;)t=Wd(t,gC(n--),vC);return t}},_C=/[!'()~]|%20/g,yC={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},bC=function(e){return yC[e]},y_=function(e){return Wd(dC(e),_C,bC)},Gd=Ev(function(e,t){l_(this,{type:"URLSearchParamsIterator",iterator:Eo(Xn(e).entries),kind:t})},"Iterator",function(){var e=sC(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value=t==="keys"?i.key:t==="values"?i.value:[i.key,i.value]),n},!0),b_=function(e){this.entries=[],this.url=null,e!==void 0&&(ie(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?hC(e,0)==="?"?pC(e,1):e:Fe(e)))};b_.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,i,o,c,a,u,l=rs(e);if(l)for(n=(t=Eo(e,l)).next;!(i=Le(n,t)).done;){if(c=(o=Eo(gt(i.value))).next,(a=Le(c,o)).done||(u=Le(c,o)).done||!Le(c,o).done)throw lC("Expected sequence with length 2");Mi(this.entries,{key:Fe(a.value),value:Fe(u.value)})}else for(var h in e)Qe(e,h)&&Mi(this.entries,{key:h,value:Fe(e[h])})},parseQuery:function(e){if(e)for(var t,n,i=g_(e,"&"),o=0;o<i.length;)(t=i[o++]).length&&(n=g_(t,"="),Mi(this.entries,{key:__(fC(n)),value:__(p_(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],i=0;i<t.length;)e=t[i++],Mi(n,y_(e.key)+"="+y_(e.value));return p_(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var $c=function(){Mn(this,ls);var e=arguments.length>0?arguments[0]:void 0;l_(this,new b_(e))},ls=$c.prototype;if(is(ls,{append:function(e,t){Er(arguments.length,2);var n=Xn(this);Mi(n.entries,{key:Fe(e),value:Fe(t)}),n.updateURL()},delete:function(e){Er(arguments.length,1);for(var t=Xn(this),n=t.entries,i=Fe(e),o=0;o<n.length;)n[o].key===i?m_(n,o,1):o++;t.updateURL()},get:function(e){Er(arguments.length,1);for(var t=Xn(this).entries,n=Fe(e),i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){Er(arguments.length,1);for(var t=Xn(this).entries,n=Fe(e),i=[],o=0;o<t.length;o++)t[o].key===n&&Mi(i,t[o].value);return i},has:function(e){Er(arguments.length,1);for(var t=Xn(this).entries,n=Fe(e),i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){Er(arguments.length,1);for(var n,i=Xn(this),o=i.entries,c=!1,a=Fe(e),u=Fe(t),l=0;l<o.length;l++)(n=o[l]).key===a&&(c?m_(o,l--,1):(c=!0,n.value=u));c||Mi(o,{key:a,value:u}),i.updateURL()},sort:function(){var e=Xn(this);u_(e.entries,function(t,n){return t.key>n.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,n=Xn(this).entries,i=Yn(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)i((t=n[o++]).value,t.key,this)},keys:function(){return new Gd(this,"keys")},values:function(){return new Gd(this,"values")},entries:function(){return new Gd(this,"entries")}},{enumerable:!0}),bt(ls,aC,ls.entries,{name:"entries"}),bt(ls,"toString",function(){return Xn(this).serialize()},{enumerable:!0}),ti($c,"URLSearchParams"),Me({global:!0,constructor:!0,forced:!Bd},{URLSearchParams:$c}),!Bd&&te(us)){var SC=ne(h_.has),kC=ne(h_.set),S_=function(e){if(ie(e)){var t,n=e.body;if(wr(n)==="URLSearchParams")return t=e.headers?new us(e.headers):new us,SC(t,"content-type")||kC(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),ko(e,{body:Tr(0,Fe(n)),headers:Tr(0,t)})}return e};if(te(d_)&&Me({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(e){return d_(e,arguments.length>1?S_(arguments[1]):{})}}),te(Hc)){var Jd=function(e){return Mn(this,zd),new Hc(e,arguments.length>1?S_(arguments[1]):{})};zd.constructor=Jd,Jd.prototype=zd,Me({global:!0,constructor:!0,noTargetGet:!0,forced:!0},{Request:Jd})}}var k_={URLSearchParams:$c,getState:Xn},I_=Object.is||function(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t};Bc("search",function(e,t,n){return[function(i){var o=ue(this),c=i==null?void 0:Kr(i,e);return c?Le(c,i,o):new RegExp(i)[e](Fe(o))},function(i){var o=gt(this),c=Fe(i),a=n(t,o,c);if(a.done)return a.value;var u=o.lastIndex;I_(u,0)||(o.lastIndex=0);var l=Co(o,c);return I_(o.lastIndex,u)||(o.lastIndex=u),l===null?-1:l.index}]}),new Date().getTime();var qd=0,ln=function(){return new Date().getTime()+qd},T_=function(){var e=new Date;return e.setTime(ln()),e.toLocaleString()};Bc("match",function(e,t,n){return[function(i){var o=ue(this),c=i==null?void 0:Kr(i,e);return c?Le(c,i,o):new RegExp(i)[e](Fe(o))},function(i){var o=gt(this),c=Fe(i),a=n(t,o,c);if(a.done)return a.value;if(!o.global)return Co(o,c);var u=o.unicode;o.lastIndex=0;for(var l,h=[],f=0;(l=Co(o,c))!==null;){var m=Fe(l[0]);h[f]=m,m===""&&(o.lastIndex=Md(c,sr(o.lastIndex),u)),f++}return f===0?null:h}]});var IC=ht("match"),Kd=function(e){var t;return ie(e)&&((t=e[IC])!==void 0?!!t:L(e)=="RegExp")},w_=RegExp.prototype,E_=function(e){var t=e.flags;return t!==void 0||"flags"in w_||Qe(e,"flags")||!ke(w_,e)?t:Le(i_,e)},TC=Ht.f,wC=function(e,t,n){n in e||TC(e,n,{configurable:!0,get:function(){return t[n]},set:function(i){t[n]=i}})},EC=Zr.f,CC=Dt.enforce,RC=ht("match"),oi=z.RegExp,Ro=oi.prototype,AC=z.SyntaxError,xC=ne(Ro.exec),zc=ne("".charAt),C_=ne("".replace),R_=ne("".indexOf),PC=ne("".slice),DC=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ui=/a/g,Qd=/a/g,OC=new oi(Ui)!==Ui,A_=Fc.MISSED_STICKY,NC=Fc.UNSUPPORTED_Y,LC=Te&&(!OC||A_||Ad||xd||he(function(){return Qd[RC]=!1,oi(Ui)!=Ui||oi(Qd)==Qd||oi(Ui,"i")!="/a/i"}));if(bo("RegExp",LC)){for(var Vi=function(e,t){var n,i,o,c,a,u,l=ke(Ro,this),h=Kd(e),f=t===void 0,m=[],g=e;if(!l&&h&&f&&e.constructor===Vi)return e;if((h||ke(Ro,e))&&(e=e.source,f&&(t=E_(g))),e=e===void 0?"":Fe(e),t=t===void 0?"":Fe(t),g=e,Ad&&"dotAll"in Ui&&(i=!!t&&R_(t,"s")>-1)&&(t=C_(t,/s/g,"")),n=t,A_&&"sticky"in Ui&&(o=!!t&&R_(t,"y")>-1)&&NC&&(t=C_(t,/y/g,"")),xd&&(e=(c=function(v){for(var I,S=v.length,y=0,E="",C=[],x={},U=!1,G=!1,H=0,V="";y<=S;y++){if((I=zc(v,y))==="\\")I+=zc(v,++y);else if(I==="]")U=!1;else if(!U)switch(!0){case I==="[":U=!0;break;case I==="(":xC(DC,PC(v,y+1))&&(y+=2,G=!0),E+=I,H++;continue;case(I===">"&&G):if(V===""||Qe(x,V))throw new AC("Invalid capture group name");x[V]=!0,C[C.length]=[V,H],G=!1,V="";continue}G?V+=I:E+=I}return[E,C]}(e))[0],m=c[1]),a=Uc(oi(e,t),l?this:Ro,Vi),(i||o||m.length)&&(u=CC(a),i&&(u.dotAll=!0,u.raw=Vi(function(v){for(var I,S=v.length,y=0,E="",C=!1;y<=S;y++)(I=zc(v,y))!=="\\"?C||I!=="."?(I==="["?C=!0:I==="]"&&(C=!1),E+=I):E+="[\\s\\S]":E+=I+zc(v,++y);return E}(e),n)),o&&(u.sticky=!0),m.length&&(u.groups=m)),e!==g)try{Pt(a,"source",g===""?"(?:)":g)}catch{}return a},x_=EC(oi),P_=0;x_.length>P_;)wC(Vi,oi,x_[P_++]);Ro.constructor=Vi,Vi.prototype=Ro,bt(z,"RegExp",Vi,{constructor:!0})}os("RegExp");var MC=Xr.PROPER,D_=RegExp.prototype.toString,UC=he(function(){return D_.call({source:"a",flags:"b"})!="/a/b"}),VC=MC&&D_.name!="toString";(UC||VC)&&bt(RegExp.prototype,"toString",function(){var e=gt(this);return"/"+Fe(e.source)+"/"+Fe(E_(e))},{unsafe:!0});var O_=ne(1 .valueOf),Ao=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,N_=ne("".replace),Wc="["+Ao+"]",FC=RegExp("^"+Wc+Wc+"*"),jC=RegExp(Wc+Wc+"*$"),Yd=function(e){return function(t){var n=Fe(ue(t));return 1&e&&(n=N_(n,FC,"")),2&e&&(n=N_(n,jC,"")),n}},Gc={start:Yd(1),end:Yd(2),trim:Yd(3)},BC=Zr.f,HC=Yr.f,$C=Ht.f,zC=Gc.trim,ai=z.Number,Xd=ai.prototype,WC=z.TypeError,GC=ne("".slice),Jc=ne("".charCodeAt),JC=function(e){var t=zl(e,"number");return typeof t=="bigint"?t:qC(t)},qC=function(e){var t,n,i,o,c,a,u,l,h=zl(e,"number");if(Kn(h))throw WC("Cannot convert a Symbol value to a number");if(typeof h=="string"&&h.length>2){if(h=zC(h),(t=Jc(h,0))===43||t===45){if((n=Jc(h,2))===88||n===120)return NaN}else if(t===48){switch(Jc(h,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+h}for(a=(c=GC(h,2)).length,u=0;u<a;u++)if((l=Jc(c,u))<48||l>o)return NaN;return parseInt(c,i)}}return+h};if(bo("Number",!ai(" 0o1")||!ai("0b1")||ai("+0x1"))){for(var qc,xo=function(e){var t=arguments.length<1?0:ai(JC(e)),n=this;return ke(Xd,n)&&he(function(){O_(n)})?Uc(Object(t),n,xo):t},L_=Te?BC(ai):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Zd=0;L_.length>Zd;Zd++)Qe(ai,qc=L_[Zd])&&!Qe(xo,qc)&&$C(xo,qc,HC(ai,qc));xo.prototype=Xd,Xd.constructor=xo,bt(z,"Number",xo,{constructor:!0})}var KC=Ka.indexOf,eh=ne([].indexOf),M_=!!eh&&1/eh([1],1,-0)<0,QC=as("indexOf");Me({target:"Array",proto:!0,forced:M_||!QC},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return M_?eh(this,e,t)||0:KC(this,e,t)}});var YC=he(function(){cr(1)});Me({target:"Object",stat:!0,forced:YC,sham:!kv},{getPrototypeOf:function(e){return cr(sn(e))}});var XC=!he(function(){Reflect.apply(function(){})});Me({target:"Reflect",stat:!0,forced:XC},{apply:function(e,t,n){return ri(an(e),t,gt(n))}});var ZC=Xr.EXISTS,eR=Ht.f,U_=Function.prototype,tR=ne(U_.toString),V_=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,nR=ne(V_.exec);Te&&!ZC&&eR(U_,"name",{configurable:!0,get:function(){try{return nR(V_,tR(this))[1]}catch{return""}}});var F_=z.Date,rR=ne(F_.prototype.getTime);Me({target:"Date",stat:!0},{now:function(){return rR(new F_)}});var iR=z.TypeError,j_=function(e){if(Ec(e))return e;throw iR(Ut(e)+" is not a constructor")},oR=ht("species"),Kc=function(e,t){var n,i=gt(e).constructor;return i===void 0||(n=gt(i)[oR])==null?t:j_(n)},Po=Fc.UNSUPPORTED_Y,aR=Math.min,B_=[].push,sR=ne(/./.exec),Do=ne(B_),ds=ne("".slice);Bc("split",function(e,t,n){var i;return i="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(o,c){var a=Fe(ue(this)),u=c===void 0?4294967295:c>>>0;if(u===0)return[];if(o===void 0)return[a];if(!Kd(o))return Le(t,a,o,u);for(var l,h,f,m=[],g=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),v=0,I=new RegExp(o.source,g+"g");(l=Le(cs,I,a))&&!((h=I.lastIndex)>v&&(Do(m,ds(a,v,l.index)),l.length>1&&l.index<a.length&&ri(B_,m,Gt(l,1)),f=l[0].length,v=h,m.length>=u));)I.lastIndex===l.index&&I.lastIndex++;return v===a.length?!f&&sR(I,"")||Do(m,""):Do(m,ds(a,v)),m.length>u?Gt(m,0,u):m}:"0".split(void 0,0).length?function(o,c){return o===void 0&&c===0?[]:Le(t,this,o,c)}:t,[function(o,c){var a=ue(this),u=o==null?void 0:Kr(o,e);return u?Le(u,o,a,c):Le(i,Fe(a),o,c)},function(o,c){var a=gt(this),u=Fe(o),l=n(i,a,u,c,i!==t);if(l.done)return l.value;var h=Kc(a,RegExp),f=a.unicode,m=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Po?"g":"y"),g=new h(Po?"^(?:"+a.source+")":a,m),v=c===void 0?4294967295:c>>>0;if(v===0)return[];if(u.length===0)return Co(g,u)===null?[u]:[];for(var I=0,S=0,y=[];S<u.length;){g.lastIndex=Po?0:S;var E,C=Co(g,Po?ds(u,S):u);if(C===null||(E=aR(sr(g.lastIndex+(Po?S:0)),u.length))===I)S=Md(u,S,f);else{if(Do(y,ds(u,I,S)),y.length===v)return y;for(var x=1;x<=C.length-1;x++)if(Do(y,C[x]),y.length===v)return y;S=I=E}}return Do(y,ds(u,I)),y}]},!!he(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return n.length!==2||n[0]!=="a"||n[1]!=="b"}),Po);var hs,Oo,H_,th,Cr=L(z.process)=="process",$_=/(?:ipad|iphone|ipod).*applewebkit/i.test(Ee),nh=z.setImmediate,rh=z.clearImmediate,cR=z.process,ih=z.Dispatch,uR=z.Function,z_=z.MessageChannel,lR=z.String,oh=0,fs={};try{hs=z.location}catch{}var ah=function(e){if(Qe(fs,e)){var t=fs[e];delete fs[e],t()}},sh=function(e){return function(){ah(e)}},W_=function(e){ah(e.data)},G_=function(e){z.postMessage(lR(e),hs.protocol+"//"+hs.host)};nh&&rh||(nh=function(e){Er(arguments.length,1);var t=te(e)?e:uR(e),n=ii(arguments,1);return fs[++oh]=function(){ri(t,void 0,n)},Oo(oh),oh},rh=function(e){delete fs[e]},Cr?Oo=function(e){cR.nextTick(sh(e))}:ih&&ih.now?Oo=function(e){ih.now(sh(e))}:z_&&!$_?(th=(H_=new z_).port2,H_.port1.onmessage=W_,Oo=Yn(th.postMessage,th)):z.addEventListener&&te(z.postMessage)&&!z.importScripts&&hs&&hs.protocol!=="file:"&&!he(G_)?(Oo=G_,z.addEventListener("message",W_,!1)):Oo="onreadystatechange"in Ja("script")?function(e){sd.appendChild(Ja("script")).onreadystatechange=function(){sd.removeChild(this),ah(e)}}:function(e){setTimeout(sh(e),0)});var ps,Fi,ms,No,ch,uh,lh,J_,q_={set:nh,clear:rh},dR=/ipad|iphone|ipod/i.test(Ee)&&z.Pebble!==void 0,hR=/web0s(?!.*chrome)/i.test(Ee),fR=Yr.f,dh=q_.set,K_=z.MutationObserver||z.WebKitMutationObserver,Q_=z.document,Y_=z.process,Qc=z.Promise,X_=fR(z,"queueMicrotask"),Z_=X_&&X_.value;Z_||(ps=function(){var e,t;for(Cr&&(e=Y_.domain)&&e.exit();Fi;){t=Fi.fn,Fi=Fi.next;try{t()}catch(n){throw Fi?No():ms=void 0,n}}ms=void 0,e&&e.enter()},$_||Cr||hR||!K_||!Q_?!dR&&Qc&&Qc.resolve?((lh=Qc.resolve(void 0)).constructor=Qc,J_=Yn(lh.then,lh),No=function(){J_(ps)}):Cr?No=function(){Y_.nextTick(ps)}:(dh=Yn(dh,z),No=function(){dh(ps)}):(ch=!0,uh=Q_.createTextNode(""),new K_(ps).observe(uh,{characterData:!0}),No=function(){uh.data=ch=!ch}));var hh=Z_||function(e){var t={fn:e,next:void 0};ms&&(ms.next=t),Fi||(Fi=t,No()),ms=t},fh=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},ey=function(){this.head=null,this.tail=null};ey.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var ph,ty,ny,pR=ey,Rn=z.Promise,mR=typeof window=="object"&&typeof Deno!="object",gR=(Rn&&Rn.prototype,ht("species")),ry=!1,iy=te(z.PromiseRejectionEvent),ji={CONSTRUCTOR:bo("Promise",function(){var e=Ic(Rn),t=e!==String(Rn);if(!t&&tt===66)return!0;if(tt>=51&&/native code/.test(e))return!1;var n=new Rn(function(o){o(1)}),i=function(o){o(function(){},function(){})};return(n.constructor={})[gR]=i,!(ry=n.then(function(){})instanceof i)||!t&&mR&&!iy}),REJECTION_EVENT:iy,SUBCLASSING:ry},vR=function(e){var t,n;this.promise=new e(function(i,o){if(t!==void 0||n!==void 0)throw TypeError("Bad Promise constructor");t=i,n=o}),this.resolve=an(t),this.reject=an(n)},Lo={f:function(e){return new vR(e)}},oy=q_.set,ay=ji.CONSTRUCTOR,_R=ji.REJECTION_EVENT,yR=ji.SUBCLASSING,mh=Dt.getterFor("Promise"),bR=Dt.set,Mo=Rn&&Rn.prototype,Uo=Rn,Yc=Mo,sy=z.TypeError,gh=z.document,vh=z.process,_h=Lo.f,SR=_h,kR=!!(gh&&gh.createEvent&&z.dispatchEvent),cy=function(e){var t;return!(!ie(e)||!te(t=e.then))&&t},uy=function(e,t){var n,i,o,c=t.value,a=t.state==1,u=a?e.ok:e.fail,l=e.resolve,h=e.reject,f=e.domain;try{u?(a||(t.rejection===2&&TR(t),t.rejection=1),u===!0?n=c:(f&&f.enter(),n=u(c),f&&(f.exit(),o=!0)),n===e.promise?h(sy("Promise-chain cycle")):(i=cy(n))?Le(i,n,l,h):l(n)):h(c)}catch(m){f&&!o&&f.exit(),h(m)}},ly=function(e,t){e.notified||(e.notified=!0,hh(function(){for(var n,i=e.reactions;n=i.get();)uy(n,e);e.notified=!1,t&&!e.rejection&&IR(e)}))},dy=function(e,t,n){var i,o;kR?((i=gh.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),z.dispatchEvent(i)):i={promise:t,reason:n},!_R&&(o=z["on"+e])?o(i):e==="unhandledrejection"&&function(c,a){var u=z.console;u&&u.error&&(arguments.length==1?u.error(c):u.error(c,a))}("Unhandled promise rejection",n)},IR=function(e){Le(oy,z,function(){var t,n=e.facade,i=e.value;if(hy(e)&&(t=fh(function(){Cr?vh.emit("unhandledRejection",i,n):dy("unhandledrejection",n,i)}),e.rejection=Cr||hy(e)?2:1,t.error))throw t.value})},hy=function(e){return e.rejection!==1&&!e.parent},TR=function(e){Le(oy,z,function(){var t=e.facade;Cr?vh.emit("rejectionHandled",t):dy("rejectionhandled",t,e.value)})},Vo=function(e,t,n){return function(i){e(t,i,n)}},Fo=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ly(e,!0))},yh=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw sy("Promise can't be resolved itself");var i=cy(t);i?hh(function(){var o={done:!1};try{Le(i,t,Vo(yh,o,e),Vo(Fo,o,e))}catch(c){Fo(o,c,e)}}):(e.value=t,e.state=1,ly(e,!1))}catch(o){Fo({done:!1},o,e)}}};if(ay&&(Yc=(Uo=function(e){Mn(this,Yc),an(e),Le(ph,this);var t=mh(this);try{e(Vo(yh,t),Vo(Fo,t))}catch(n){Fo(t,n)}}).prototype,(ph=function(e){bR(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new pR,rejection:!1,state:0,value:void 0})}).prototype=bt(Yc,"then",function(e,t){var n=mh(this),i=_h(Kc(this,Uo));return n.parent=!0,i.ok=!te(e)||e,i.fail=te(t)&&t,i.domain=Cr?vh.domain:void 0,n.state==0?n.reactions.add(i):hh(function(){uy(i,n)}),i.promise}),ty=function(){var e=new ph,t=mh(e);this.promise=e,this.resolve=Vo(yh,t),this.reject=Vo(Fo,t)},Lo.f=_h=function(e){return e===Uo||e===void 0?new ty(e):SR(e)},te(Rn)&&Mo!==Object.prototype)){ny=Mo.then,yR||bt(Mo,"then",function(e,t){var n=this;return new Uo(function(i,o){Le(ny,n,i,o)}).then(e,t)},{unsafe:!0});try{delete Mo.constructor}catch{}$t&&$t(Mo,Yc)}Me({global:!0,constructor:!0,wrap:!0,forced:ay},{Promise:Uo}),ti(Uo,"Promise",!1),os("Promise");var fy=ji.CONSTRUCTOR||!_d(function(e){Rn.all(e).then(void 0,function(){})});Me({target:"Promise",stat:!0,forced:fy},{all:function(e){var t=this,n=Lo.f(t),i=n.resolve,o=n.reject,c=fh(function(){var a=an(t.resolve),u=[],l=0,h=1;Mc(e,function(f){var m=l++,g=!1;h++,Le(a,t,f).then(function(v){g||(g=!0,u[m]=v,--h||i(u))},o)}),--h||i(u)});return c.error&&o(c.value),n.promise}});var wR=ji.CONSTRUCTOR,py=Rn&&Rn.prototype;if(Me({target:"Promise",proto:!0,forced:wR,real:!0},{catch:function(e){return this.then(void 0,e)}}),te(Rn)){var my=Ce("Promise").prototype.catch;py.catch!==my&&bt(py,"catch",my,{unsafe:!0})}Me({target:"Promise",stat:!0,forced:fy},{race:function(e){var t=this,n=Lo.f(t),i=n.reject,o=fh(function(){var c=an(t.resolve);Mc(e,function(a){Le(c,t,a).then(n.resolve,i)})});return o.error&&i(o.value),n.promise}}),Me({target:"Promise",stat:!0,forced:ji.CONSTRUCTOR},{reject:function(e){var t=Lo.f(this);return Le(t.reject,void 0,e),t.promise}});var ER=ji.CONSTRUCTOR;Ce("Promise"),Me({target:"Promise",stat:!0,forced:ER},{resolve:function(e){return function(t,n){if(gt(t),ie(n)&&n.constructor===t)return n;var i=Lo.f(t);return(0,i.resolve)(n),i.promise}(this,e)}});var CR=Gc.trim,RR=ne("".charAt),Xc=z.parseFloat,gy=z.Symbol,vy=gy&&gy.iterator,_y=1/Xc(Ao+"-0")!=-1/0||vy&&!he(function(){Xc(Object(vy))})?function(e){var t=CR(Fe(e)),n=Xc(t);return n===0&&RR(t,0)=="-"?-0:n}:Xc;Me({global:!0,forced:parseFloat!=_y},{parseFloat:_y});var yy,Zc,we=window.navigator&&window.navigator.userAgent||"",by=/AppleWebKit\/([\d.]+)/i.exec(we),bh=(by&&parseFloat(by.pop()),/iPad/i.test(we)),Sy=navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/Macintosh/.test(we),Sh=/iPhone/i.test(we)&&!bh,AR=/iPod/i.test(we),jo=Sh||bh||AR||Sy,Bi=/Android/i.test(we);Bi&&function(){var e=we.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}();var Rr=(Bi&&/webkit/i.test(we),/Firefox/i.test(we)),ky=Rr&&function(){var e=we.match(/Firefox\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),eu=/Edge\//i.test(we),xR=eu&&function(){var e=we.match(/Edge\/(\d+)/i);if(e&&e[1])return e[1]}(),tu=/Edg\//i.test(we),Iy=tu&&function(){var e=we.match(/Edg\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),kh=/SogouMobileBrowser\//i.test(we),PR=kh&&function(){var e=we.match(/SogouMobileBrowser\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),Ih=/MetaSr\s/i.test(we),DR=Ih&&function(){var e=we.match(/MetaSr(\s\d+(\.\d+)+)/);return e&&e[1]?parseFloat(e[1]):null}(),Ar=/TBS\/\d+/i.test(we),OR=Ar&&function(){var e=we.match(/TBS\/(\d+)/i);if(e&&e[1])return e[1]}(),Th=/XWEB\/\d+/i.test(we),NR=Th&&function(){var e=we.match(/XWEB\/(\d+)/i);if(e&&e[1])return e[1]}(),wh=(/MSIE\s8\.0/.test(we),/MSIE\/\d+/i.test(we)&&function(){var e=/MSIE\s(\d+)\.\d/.exec(we),t=e&&parseFloat(e[1]);!t&&/Trident\/7.0/i.test(we)&&/rv:11.0/.test(we)&&(t=11)}(),/(micromessenger|webbrowser)/i.test(we)),LR=wh&&function(){var e=we.match(/MicroMessenger\/(\d+)/i);if(e&&e[1])return e[1]}(),Eh=!Ar&&/MQQBrowser\/\d+/i.test(we)&&/COVC\/\d+/i.test(we),Ch=!Ar&&/MQQBrowser\/\d+/i.test(we)&&!/COVC\/\d+/i.test(we),Ty=(Ch||Eh)&&function(){var e=we.match(/ MQQBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Rh=!Ar&&/ QQBrowser\/\d+/i.test(we),MR=Rh&&function(){var e=we.match(/ QQBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Ah=!Ar&&/QQBrowserLite\/\d+/i.test(we),UR=Ah&&function(){var e=we.match(/QQBrowserLite\/([\d.]+)/);return e&&e[1]?e[1]:null}(),xh=!Ar&&/MQBHD\/\d+/i.test(we),VR=xh&&function(){var e=we.match(/MQBHD\/([\d.]+)/);return e&&e[1]?e[1]:null}(),wy=/Windows/i.test(we),Ey=!jo&&/MAC OS X/i.test(we),Cy=!Bi&&/Linux/i.test(we),FR=(/MicroMessenger/i.test(we),/UCBrowser/i.test(we)),Ph=(/Electron/i.test(we),/MiuiBrowser/i.test(we)),jR=Ph&&function(){var e=we.match(/MiuiBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Dh=/HuaweiBrowser/i.test(we),Oh=/Huawei/i.test(we),BR=Dh&&function(){var e=we.match(/HuaweiBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Nh=/SamsungBrowser/i.test(we),HR=Nh&&function(){var e=we.match(/SamsungBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),nu=/HeyTapBrowser/i.test(we),$R=nu&&function(){var e=we.match(/HeyTapBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),ru=/VivoBrowser/i.test(we),zR=ru&&function(){var e=we.match(/VivoBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),iu=function(){var e=we.match(/Chrome\/(\d+)/);return e&&e[1]?Number(e[1]):null},WR=/Chrome/i.test(we),ou=!eu&&!Ih&&!kh&&!Ar&&!Th&&!tu&&!Rh&&!Ph&&!Dh&&!Nh&&!nu&&!ru&&/Chrome/i.test(we),GR=ou&&iu(),JR=ou&&function(){var e=we.match(/Chrome\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Bo=!WR&&!Ch&&!Eh&&!Ah&&!xh&&/Safari/i.test(we),Lh=function(){if(Bo){var e=we.match(/Version\/([\d.]+)/);if(e&&e[1])return e[1]}return""}(),qR=/Android.*(wv|.0.0.0)/.test(we),gs=function(){if(Sy)return Lh;if(jo){var e=we.match(/OS (\d+)_(\d+)/i);if(e&&e[1]){var t=e[1];return e[2]&&(t+=".".concat(e[2])),t}}return""}(),au=Lh==="15.1",su=gs==="15.1",KR=(yy=Number(gs.split(".")[0]))===14||yy===13,Ho=location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1",Hi=function(){if(fe(Zc))try{Zc=window.localStorage}catch(e){ye.warn(e),Zc=!1}return Zc},Mh=new Map([[Rr,["Firefox",ky]],[tu,["Edg",Iy]],[ou,["Chrome",JR]],[Bo,["Safari",Lh]],[Ar,["TBS",OR]],[Th,["XWEB",NR]],[wh&&Sh,["WeChat",LR]],[Rh,["QQ(Win)",MR]],[Ch,["QQ(Mobile)",Ty]],[Eh,["QQ(Mobile X5)",Ty]],[Ah,["QQ(Mac)",UR]],[xh,["QQ(iPad)",VR]],[Ph,["MI",jR]],[Dh,["HW",BR]],[Nh,["Samsung",HR]],[nu,["OPPO",$R]],[ru,["VIVO",zR]],[eu,["EDGE",xR]],[kh,["SogouMobile",PR]],[Ih,["Sogou",DR]]]);function $i(){var e="unknown",t="unknown";return Mh.get(!0)&&(e=Mh.get(!0)[0],t=Mh.get(!0)[1]),{name:e,version:t}}var QR=he(function(){Oi(1)});Me({target:"Object",stat:!0,forced:QR},{keys:function(e){return Oi(sn(e))}});var YR="canvas",Pe="audio",Ue="video",ur="auxiliary",cu="smallVideo",Ry="user",Ay="environment",pn="mute",lr="unmute",Ot="ended",si="playing",ci="pause",$o="error",Uh="loadeddata",vs="audioinput",Vh="videoinput",xy="detail",XR="text",Et="main",zi="backup",ZR="banned",eA="kick",tA="user_time_out",nA="room_disband",Py="sei-message",rA="wss://trtc.rtc.qq.com",iA="wss://webrtc.qq.com",uu="qcloud",oA="trtc",aA="webrtc",Dy="",Oy="jssdk_log",sA="jssdk_event",cA="jssdk_new_endreport",uA=function(e){return Dy=e},lA=1,dA=2,zo=20,Fh=21,dr="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",_s="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",hA=2,St=Et,Nt=ur,dn="DISCONNECTED",Ny="CONNECTING",Ly="RECONNECTING",mn="CONNECTED",fA="new",lu="connecting",My="failed",jh="closed",pA="disconnected",Uy="connected",mA="completed",Vy="join",gA="delta-join",Fy="rejoin",vA="leave",_A="delta-leave",jy="publish",yA="delta-publish",By="unpublish",Hy="subscribe",$y="unsubscribe",zy="uplink-connection",Wy="uplink-reconnection",Gy="downlink-connection",Jy="downlink-reconnection",du="setLocalDescription",qy="setRemoteDescription",Ky="iceConnectionState",ys="stream-initialize",Bh="websocketConnectionState",Qy="websocketReconnectionState",Yy="update-stream",Xy="recover-subscription",Zy="start-mix-transcode",e0="stop-mix-transcode",t0="player-error",n0="schedule",r0="load-worklet",Hh="unsubscribe",$h="subscribe_change",zh={MANUAL:"manual",PRESET_LAYOUT:"preset-layout"},i0={REMOTE:"$PLACE_HOLDER_REMOTE$"},o0={IT_AUDIO_VIDEO:0,IT_PICTURE:2,IT_CANVAS:3,IT_PURE_AUDIO:4,IT_PURE_VIDEO:5},Ct="string",Rt="number",An="boolean",bA="array",ui="object",li="add",Wi="remove",Wh={unknown:0,wifi:1,"4g":2,"3g":3,"2g":4,wired:5},a0=-1,bs=0,SA=1,kA="schedule.rtc.qq.com",IA="schedule.rtc.qcloud.com",TA="intl-schedule.rtc.qq.com",wA="intl-schedule.rtc.qcloud.com",EA="TRTC",CA="Client",Gh="LocalStream",Jh="RemoteStream",RA="Stream",s0="web.sdk.qcloud.com",AA="web.sdk.tencent.cn",xA="web.sdk.cloud.tencent.cn",Wo="https://".concat(s0,"/trtc/webrtc/doc"),qh="".concat(Wo,"/zh-cn/"),Un={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5},Go=Object.keys(Un),PA=["normal leave","timeout leave","kick","role change"],DA=/"/g,OA=ne("".replace),c0=function(e,t,n,i){var o=Fe(ue(e)),c="<"+t;return n!==""&&(c+=" "+n+'="'+OA(Fe(i),DA,"&quot;")+'"'),c+">"+o+"</"+t+">"},u0=function(e){return he(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})};Me({target:"String",proto:!0,forced:u0("link")},{link:function(e){return c0(this,"a","href",e)}}),Me({target:"Array",stat:!0},{isArray:Di});var NA="AVOID_REPEATED_CALL",LA="INVALID_PARAMETER_REQUIRED",l0="INVALID_PARAMETER_TYPE",MA="INVALID_PARAMETER_EMPTY",d0="INVALID_PARAMETER_INSTANCE",UA="INVALID_PARAMETER_RANGE",VA="API_CALL_TIMEOUT",FA="SIGNAL_CHANNEL_RECONNECTION_FAILED",jA="SIGNAL_CHANNEL_SETUP_FAILED",BA="ERROR_MESSAGE",HA="EXCHANGE_SDP_TIMEOUT",$A="DOWNLINK_RECONNECTION_FAILED",zA="EXCHANGE_SDP_FAILED",WA="UPLINK_RECONNECTION_FAILED",GA="AUDIO",JA="VIDEO",qA="INVALID_PURE_AUDIO",KA="INVALID_STREAMID",QA="INVALID_USER_DEFINE_RECORDID",YA="INVALID_USER_DEFINE_PUSH_ARGS",XA="INVALID_PROXY",ZA="INVALID_JOIN",ex="INVALID_ROOMID_STRING",tx="INVALID_ROOMID_INTEGER",nx="JOIN_ROOM_TIMEOUT",h0="JOIN_ROOM_FAILED",rx="REJOIN_ROOM_FAILED",ix="INVALID_DESTROY",ox="INVALID_PUBLISH",ax="INVALID_UNPUBLISH",sx="INVALID_AUDIENCE",cx="INVALID_INITIALIZE",ux="INVALID_DUPLICATE_PUBLISHING",Kh="INVALID_REMOTE_STREAM",lx="SUBSCRIBE_FAILED",dx="INVALID_ROLE",hx="INVALID_OPERATION_SWITCH_ROLE",fx="SWITCH_ROLE_TIMEOUT",px="SWITCH_ROLE_FAILED",mx="CLIENT_BANNED",gx="INVALID_OPERATION_START_PUBLISH_CDN",vx="INVALID_OPERATION_STOP_PUBLISH_CDN",_x="INVALID_STREAM_ID",f0="START_PUBLISH_CDN_FAILED",p0="STOP_PUBLISH_CDN_FAILED",yx="START_MIX_TRANSCODE",bx="STOP_MIX_TRANSCODE",Sx="INVALID_AUDIO_VOLUME",kx="ENABLE_SMALL_STREAM_PUBLISHED",Ix="DISABLE_SMALL_STREAM_PUBLISHED",Tx="NOT_SUPPORTED_SMALL_STREAM",wx="INVALID_SMALL_STREAM_PROFILE",Ex="INVALID_PARAMETER_REMOTE_STREAM",Cx="INVALID_SWITCH_DEVICE",Rx="INVALID_SWITCH_DEVICE_PUBLISHING",Qh="INVALID_REPLACE_TRACK",Ax="INVALID_INITIALIZE_LOCAL_STREAM",xx="INVALID_ADD_TRACK_REPETITIVE",Px="INVALID_ADD_TRACK_REMOVING",Dx="INVALID_ADD_TRACK_PUBLISHING",m0="INVALID_STREAM_INITIALIZED",Ox="INVALID_ADD_TRACK_NUMBER",Nx="INVALID_REMOVE_AUDIO_TRACK",Lx="INVALID_REMOVE_AUDIO_ADDING",Mx="INVALID_REMOVE_AUDIO_ON",Ux="INVALID_REMOVE_TRACK_PUBLISHING",Vx="INVALID_REMOVE_TRACK_NOT_PUBLISHING",Fx="INVALID_REMOVE_TRACK_NUMBER",jx="INVALID_REMOVE_TRACK_NOT_PUBLISHED",Bx="REPEAT_JOIN",Yh="CLIENT_DESTROYED",Hx="START_MIX_TRANSCODE_FAILED",$x="STOP_MIX_TRANSCODE_FAILED",zx="MIX_TRANSCODE_NOT_STARTED",Wx="CANNOT_LESS_THAN_ZERO",Gx="MIX_PARAMS_VIDEO_FRAMERATE",Jx="MIX_PARAMS_VIDEO_GOP",qx="MIX_PARAMS_AUDIO_BITRATE",Kx="MIX_PARAMS_USER_Z_ORDER",Qx="MIX_PARAMS_NOT_SELF",Yx="MIX_PARAMS_USER_STREAM",Xx="INVALID_ELEMENT_ID",Zx="INVALID_ELEMENT_ID_TYPE",eP="INVALID_CREATE_STREAM_SOURCE",tP="INVALID_CREATE_STREAM_SCREEN",nP="INVALID_CREATE_STREAM_AUDIO",rP="INVALID_CREATE_STREAM_SCREEN_AUDIO",g0="NOT_SUPPORTED_HTTP",v0="NOT_SUPPORTED_WEBRTC",iP="NOT_SUPPORTED_PROFILE",_0="NOT_SUPPORTED_H264ENCODE",y0="NOT_SUPPORTED_H264DECODE",oP="NOT_SUPPORTED_REPLACE_TRACK",aP="NOT_SUPPORTED_CAPTURE",sP="MICROPHONE_NOT_FOUND",cP="CAMERA_NOT_FOUND",b0="SIGNAL_RESPONSE_FAILED",uP="CATCH_HANDLER_ERROR",lP="API_NOT_EXIST",dP="STREAM_UNSUBSCRIBED",hP="SUBSCRIBE_ALL_FALSE",S0="SEI_NOT_SUPPORT",fP="SEI_DISABLED",pP="SEI_EMPTY",mP="SEI_OVERSIZE",gP="SEI_BEFORE_PUBLISH",vP="SEI_NOT_VIDEO",_P="CALL_FREQUENCY_LIMIT",di={AVOID_REPEATED_CALL:function(e){return"previous ".concat(e.name,"() is ongoing, please avoid repeated calls.")},INVALID_PARAMETER_REQUIRED:function(e){var t=e.key,n=e.rule,i=e.fnName,o=e.value;return"'".concat(t||n.name,"' is a required param when calling ").concat(i,"(), received: ").concat(o,".")},INVALID_PARAMETER_TYPE:function(e){var t=e.key,n=e.rule,i=e.fnName,o=e.value,c="".concat(t||n.name),a="";return a=Array.isArray(n.type)?n.type.join("|"):n.type,"'".concat(c,"' must be type of ").concat(a," when calling ").concat(i,"(), received type: ").concat(hi(o),".")},INVALID_PARAMETER_EMPTY:function(e){var t=e.key,n=e.rule,i=e.fnName,o=e.value;return"'".concat(t||n.name,"' cannot be '").concat(o,"' when calling ").concat(i,"().")},INVALID_PARAMETER_INSTANCE:function(e){var t=e.key,n=e.rule,i=e.fnName,o=e.value,c="".concat(t||n.name),a="".concat(n.instanceOf.name||n.instanceOf);return"'".concat(c,"' must be instanceof ").concat(a," when calling ").concat(i,"(), received type: ").concat(hi(o),".")},INVALID_PARAMETER_RANGE:function(e){var t=e.key,n=e.rule,i=e.fnName,o=e.value;return"'".concat(t||n.name,"' must be one of ").concat(n.values.join("|")," when calling ").concat(i,"(), received: ").concat(o,".")},API_CALL_TIMEOUT:function(e){return"".concat(e.commandDesc||e.command," timeout observed.")},SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:function(e){return"SignalChannel setup failure: (errorCode: ".concat(e.errorCode,", errorMsg: ").concat(e.errorMsg," }).")},ERROR_MESSAGE:function(e){var t="".concat(e.type," failed");return e.message&&(t="".concat(t,": ").concat(e.message,".")),t},EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:function(e){return"exchange sdp failed ".concat(e.errMsg,".")},UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",AUDIO:function(e){return e.error.toString()+" <audio>"},VIDEO:function(e){return e.error.toString()+" <video>"},INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:function(e){return"'".concat(e,"' must be validate string when useStringRoomId is true.")},INVALID_ROOMID_INTEGER:function(e){return"'".concat(e,"' must be an integer between [1, 4294967294] when useStringRoomId is false.")},INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED:function(e){var t=e.error,n=e.code;return"Failed to join room - ".concat(t," code: ").concat(n)},REJOIN_ROOM_FAILED:function(e){return"reJoin room: ".concat(e.roomId," failed, please check your network.")},INVALID_DESTROY:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:"no permission to publish() under live/".concat("audience",', please call switchRole("').concat("anchor",'") firstly before publish().'),INVALID_INITIALIZE:"cannot publish stream because stream is not initialized or is switching device.",INVALID_DUPLICATE_PUBLISHING:"duplicate publishing, please unpublish and then re-publish.",INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED:function(e){var t=e.message,n=e.stream;return"failed to subscribe ".concat(n.getUserId()," ").concat(n.getType()," stream, reason: ").concat(t,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as ".concat("anchor"," or ").concat("audience","."),INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:function(e){return"switchRole failed, errCode: ".concat(e.code," errMsg: ").concat(e.message,".")},CLIENT_BANNED:function(e){return"client was banned because of "+e.message+"."},INVALID_OPERATION_START_PUBLISH_CDN:"please call startPublishCDNStream() after join room and publish the local stream.",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:function(e){return"startPublishCDNStream failed, errMsg: ".concat(e.message,".")},STOP_PUBLISH_CDN_FAILED:function(e){return"stopPublishCDNStream failed, errMsg: ".concat(e.message,".")},INVALID_STREAM_ID:function(e){return"'".concat(e,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores.")},START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",INVALID_OPERATION_CHANGE_SMALL:"cannot switch to the small stream without subscribing to the video of remoteStream.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_PUBLISHING:"the track to be removed is not being publishing.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REMOVE_TRACK_NOT_PUBLISHED:function(e){return"try to replace ".concat(e.kind," track but there's no previous ").concat(e.kind," being published.")},START_MIX_TRANSCODE_FAILED:function(e){return"startMixTranscode failed, errMsg: ".concat(e.message,".")},STOP_MIX_TRANSCODE_FAILED:function(e){return"stopMixTranscode failed, errMsg: ".concat(e.message,".")},MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO:function(e){var t=e.key,n=e.rule,i=e.fnName;return e.value,"'".concat(t||n.name,"' cannot be less than 0 when calling ").concat(i,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:function(e){return"'".concat(e,"' is required and must be between 1 and 15.")},MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_ELEMENT_ID:function(e){var t=e.key,n=e.fnName;return"'".concat(t,"' is not found in the document object when calling ").concat(n,"().")},INVALID_ELEMENT_ID_TYPE:function(e){var t=e.key,n=e.fnName,i=e.type;return"the element corresponding to '".concat(t,"' must be instanceof HTMLDivElement when calling ").concat(n,"(), received: ").concat(i,".")},INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"http protocol does not support the ability to capture and publish streams, please use the https protocol.",NOT_SUPPORTED_WEBRTC:"your browser or environment does not support full WebRTC capabilities.",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser or environment does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_REPLACE_TRACK:"replaceTrack is not supported in this browser, please use switchDevice or addTrack instead.",NOT_SUPPORTED_CAPTURE:"Your browser or environment does not support screen sharing, please check whether the browser version.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone and the configuration on TRTC.createStream.",CAMERA_NOT_FOUND:"no camera detected, please check your camera and the configuration on TRTC.createStream.",SIGNAL_RESPONSE_FAILED:function(e){return"".concat(e.signalResponse," failed, response code is ").concat(e.code," , errMsg: ").concat(e.message,".")},CATCH_HANDLER_ERROR:function(e){var t=e.name,n=e.event;return"an error was caught on ".concat(t,".on('").concat(n,"', handler), please check your code on 'handler'.")},API_NOT_EXIST:function(e){var t=e.name;return"experimental api ".concat(t," does not exist.")},REPEAT_JOIN:function(e){return"[".concat(e,"] is calling client.join api or has already joined room, please avoid repeated join.")},STREAM_UNSUBSCRIBED:"stream has been unsubscribed, please call client.unsubscribe after last client.subscribe finished.",SUBSCRIBE_ALL_FALSE:"cannot subscribe when both audio & video are false, use client.unsubscribe() instead",CLIENT_DESTROYED:function(e){var t=e.funName;return"failed to call ".concat(t,"() because client was destroyed.")},SEI_NOT_SUPPORT:function(e){return"not support to sendSEIMessage".concat(e===!1?" without using h264 codec":"")},SEI_DISABLED:"SEI is disabled, to enable SEI: TRTC.createClient({ enableSEI: true })",SEI_EMPTY:"buffer cannot be empty",SEI_OVERSIZE:function(e){return"buffer size(".concat(e,") is over 1000 Bytes")},SEI_BEFORE_PUBLISH:"please call sendSEIMessage() after publish() success",SEI_NOT_VIDEO:"cannot send sei when localStream has not video.",CALL_FREQUENCY_LIMIT:function(e){var t=e.isSize,n=e.name,i=e.timesInSecond,o=e.maxSizeInSecond;return"api ".concat(n," call ").concat(t?"size":"times"," is over ").concat(t?o+" bytes":i," in a second.")}},k0=function(e,t){return t?Wo+"/"+e+"/"+t:Wo+"/"+e+"/index.html"},yP=function(){if(!Hi())return!1;var e=localStorage.getItem("trtc_error_assistance");e&&!function(t){var n=t.saveTime&&new Date().getTime()-t.saveTime>=6048e5,i=!t.saveVersion||t.saveVersion!=="4.14.1";return n||i}(JSON.parse(e))||(ye.info("init debug info"),function(){var t=new XMLHttpRequest;if(t.open("GET","https://web.sdk.qcloud.com/trtc/webrtc/download/error-message/0.0.2/script.js",!1),t.send(null),t.readyState===4&&t.status===200){var n=document.createElement("script");n.type="text/javascript",n.text=t.responseText,document.body.appendChild(n),localStorage.setItem("trtc_error_assistance",JSON.stringify({message:t.responseText,saveTime:new Date().getTime(),saveVersion:"4.14.1"})),document.body.removeChild(n)}}())};function Z(e){var t=e.key,n=e.data,i=e.link,o=e.addDocLink,c=o===void 0||o,a="",u="",l="";hr(di[t])?a=di[t](n):Jt(di[t])&&(a=di[t]);var h=function(){if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};var v=localStorage.getItem("trtc_error_assistance");if(v){v=JSON.parse(v);var I=document.createElement("script");I.type="text/javascript",I.text=v.message,document.body.appendChild(I);var S=window.TRTC_ERROR_INFO,y=window.TRTC_ERROR_LINK;return document.body.removeChild(I),{TRTC_ERROR_INFO:S,TRTC_ERROR_LINK:y}}return{}}(),f=h.TRTC_ERROR_INFO,m=h.TRTC_ERROR_LINK;i?l="".concat(i.className,".html#").concat(i.fnName):m&&m[t]&&(l=m[t]);var g=a;return Ji()&&(f&&f[t]&&(hr(f[t])?u=f[t](n):Jt(f[t])&&(u=f[t])),u&&(g=c?u+`
\u8BF7\u67E5\u770B\u6587\u6863: `+k0("zh-cn",l)+`

`:u+`

`,g+=a)),c&&(g+=` 
Refer to: `+k0("en",l)+`
`),g}var I0=function(){return function(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""}("trtc_env")},T0=function(e){return(e=Number(e))>0&&e<14e8},hu=function(e,t){var n;n=Dy||(T0(e)?"https://videoapi-sgp.im.qcloud.com":"https://yun.tim.qq.com");var i=Math.floor(Math.random()*Math.pow(2,31));return"".concat(n,"/v5/AVQualityReportSvc/C2S?random=").concat(i,"&sdkappid=").concat(e,"&cmdtype=").concat(t)};function Xh(){var e=navigator.userAgent,t=navigator.connection,n=e.match(/NetType\/\w+/)?e.match(/NetType\/\w+/)[0]:"";(n=n.toLowerCase().replace("nettype/",""))==="3gnet"&&(n="3g");var i=t&&t.type&&t.type.toLowerCase(),o=t&&t.effectiveType&&t.effectiveType.toLowerCase();o==="slow-2"&&(o="2g");var c=n||"unknown";if(i)switch(i){case"cellular":case"wimax":c=o||"unknown";break;case"wifi":c="wifi";break;case"ethernet":c="wired";break;case"none":case"other":case"unknown":c="unknown"}return c}var Gi=function(e){if(!e||_(e)!=="object"||Object.prototype.toString.call(e)!="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;var n=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Function.prototype.toString.call(n)===Function.prototype.toString.call(Object)};function fu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return e<=1?n:fu(e-1,n,t+n)}function Zh(e){var t=Math.round(e/2)+1;return t>6?13e3:1e3*fu(t)}var hr=function(e){return typeof e=="function"},fe=function(e){return e===void 0},Jt=function(e){return typeof e=="string"},xr=function(e){return typeof e=="number"},w0=function(e){return typeof e=="boolean"},E0=function(e){return hi(e)==="array"},C0=function(e){return hi(e)==="MediaStreamTrack".toLowerCase()};function hi(e){return Reflect.apply(Object.prototype.toString,e,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}function R0(e){var t={};return t.urls="turn:".concat(e.url),fe(e.username)||fe(e.credential)||(t.username=e.username,t.credential=e.credential,t.credentialType="password",fe(e.credentialType)||(t.credentialType=e.credentialType)),t}function qt(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}function ef(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"big";if(!Jt(e))return 0;var n=e.split(".");return t==="big"?(Number(n[0])<<24|Number(n[1])<<16|Number(n[2])<<8|Number(n[3]))>>>0:(Number(n[3])<<24|Number(n[2])<<16|Number(n[1])<<8|Number(n[0]))>>>0}var tf,nf,Ji=function(){var e=navigator.language||navigator.userLanguage;return(e=e.substr(0,2))==="zh"},A0=(tf=!1,nf=document.visibilityState,function(){document.visibilityState!==nf&&ye.info("visibility change: ".concat(document.visibilityState)),tf||(document.addEventListener("visibilitychange",function(){ye.info("visibility change: "+document.visibilityState),nf=document.visibilityState}),tf=!0)});window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var x0=function(){var e;return function(){return e||(e=new window.AudioContext,e.onstatechange=function(){ye.info("gain context state: ".concat(e.state)),e.state==="suspended"?(e.resume(),document.addEventListener("click",e.resume)):e.state==="interrupted"?e.resume():document.removeEventListener("click",e.resume)},e)}}(),bP=!!window.AudioWorkletNode,P0=function(e,t){var n=e.emit;return e.emit=function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];try{n.apply(e,o)}catch(u){var a=Z({key:uP,data:{name:t,event:o[0]},addDocLink:!1});ye.warn(a+`

`+u.stack)}},e},D0=function(e){return+e<10?"0".concat(e):e},SP=function(e){var t=e.match(/^\d+\.\d+\.\d+/)[0];if(!t)return e;var n=t.split("."),i=D0(n[1])+D0(n[2]);return n[1]-15>0&&(n[1]="15"),n[2]-15>0&&(n[2]="15"),n.join(".")+"."+i},O0=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}},Jo=Object.prototype.toString;function N0(e){return Jo.call(e)==="[object Array]"}function rf(e){return e===void 0}function L0(e){return e!==null&&typeof e=="object"}function M0(e){return Jo.call(e)==="[object Function]"}function pu(e,t){if(e!=null)if(typeof e!="object"&&(e=[e]),N0(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var Be={isArray:N0,isArrayBuffer:function(e){return Jo.call(e)==="[object ArrayBuffer]"},isBuffer:function(e){return e!==null&&!rf(e)&&e.constructor!==null&&!rf(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)},isFormData:function(e){return typeof FormData<"u"&&e instanceof FormData},isArrayBufferView:function(e){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return typeof e=="string"},isNumber:function(e){return typeof e=="number"},isObject:L0,isUndefined:rf,isDate:function(e){return Jo.call(e)==="[object Date]"},isFile:function(e){return Jo.call(e)==="[object File]"},isBlob:function(e){return Jo.call(e)==="[object Blob]"},isFunction:M0,isStream:function(e){return L0(e)&&M0(e.pipe)},isURLSearchParams:function(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:pu,merge:function e(){var t={};function n(c,a){typeof t[a]=="object"&&typeof c=="object"?t[a]=e(t[a],c):t[a]=c}for(var i=0,o=arguments.length;i<o;i++)pu(arguments[i],n);return t},deepMerge:function e(){var t={};function n(c,a){typeof t[a]=="object"&&typeof c=="object"?t[a]=e(t[a],c):t[a]=typeof c=="object"?e({},c):c}for(var i=0,o=arguments.length;i<o;i++)pu(arguments[i],n);return t},extend:function(e,t,n){return pu(t,function(i,o){e[o]=n&&typeof i=="function"?O0(i,n):i}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};function U0(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var V0=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(Be.isURLSearchParams(t))i=t.toString();else{var o=[];Be.forEach(t,function(a,u){a!=null&&(Be.isArray(a)?u+="[]":a=[a],Be.forEach(a,function(l){Be.isDate(l)?l=l.toISOString():Be.isObject(l)&&(l=JSON.stringify(l)),o.push(U0(u)+"="+U0(l))}))}),i=o.join("&")}if(i){var c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e};function mu(){this.handlers=[]}mu.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},mu.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},mu.prototype.forEach=function(e){Be.forEach(this.handlers,function(t){t!==null&&e(t)})};var F0=mu,of=function(e,t,n){return Be.forEach(n,function(i){e=i(e,t)}),e},j0=function(e){return!(!e||!e.__CANCEL__)},af=typeof Bs<"u"?Bs:typeof self<"u"?self:typeof window<"u"?window:{};function B0(){throw new Error("setTimeout has not been defined")}function H0(){throw new Error("clearTimeout has not been defined")}var fi=B0,pi=H0;function $0(e){if(fi===setTimeout)return setTimeout(e,0);if((fi===B0||!fi)&&setTimeout)return fi=setTimeout,setTimeout(e,0);try{return fi(e,0)}catch{try{return fi.call(null,e,0)}catch{return fi.call(this,e,0)}}}typeof af.setTimeout=="function"&&(fi=setTimeout),typeof af.clearTimeout=="function"&&(pi=clearTimeout);var qi,Pr=[],qo=!1,gu=-1;function kP(){qo&&qi&&(qo=!1,qi.length?Pr=qi.concat(Pr):gu=-1,Pr.length&&z0())}function z0(){if(!qo){var e=$0(kP);qo=!0;for(var t=Pr.length;t;){for(qi=Pr,Pr=[];++gu<t;)qi&&qi[gu].run();gu=-1,t=Pr.length}qi=null,qo=!1,function(n){if(pi===clearTimeout)return clearTimeout(n);if((pi===H0||!pi)&&clearTimeout)return pi=clearTimeout,clearTimeout(n);try{pi(n)}catch{try{return pi.call(null,n)}catch{return pi.call(this,n)}}}(e)}}function W0(e,t){this.fun=e,this.array=t}W0.prototype.run=function(){this.fun.apply(null,this.array)};function Ki(){}var IP=Ki,TP=Ki,wP=Ki,EP=Ki,CP=Ki,RP=Ki,AP=Ki,Ko=af.performance||{},xP=Ko.now||Ko.mozNow||Ko.msNow||Ko.oNow||Ko.webkitNow||function(){return new Date().getTime()},PP=new Date,G0={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Pr.push(new W0(e,t)),Pr.length!==1||qo||$0(z0)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:IP,addListener:TP,once:wP,off:EP,removeListener:CP,removeAllListeners:RP,emit:AP,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*xP.call(Ko),n=Math.floor(t),i=Math.floor(t%1*1e9);return e&&(n-=e[0],(i-=e[1])<0&&(n--,i+=1e9)),[n,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-PP)/1e3}},J0=function(e,t){Be.forEach(e,function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])})},vu=function(e,t,n,i,o){return function(c,a,u,l,h){return c.config=a,u&&(c.code=u),c.request=l,c.response=h,c.isAxiosError=!0,c.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},c}(new Error(e),t,n,i,o)},DP=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],OP=Be.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(o){var c=o;return t&&(n.setAttribute("href",c),c=n.href),n.setAttribute("href",c),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(o){var c=Be.isString(o)?i(o):o;return c.protocol===e.protocol&&c.host===e.host}}():function(){return!0},NP=Be.isStandardBrowserEnv()?{write:function(e,t,n,i,o,c){var a=[];a.push(e+"="+encodeURIComponent(t)),Be.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),Be.isString(i)&&a.push("path="+i),Be.isString(o)&&a.push("domain="+o),c===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},LP=function(e){return new Promise(function(t,n){var i=e.data,o=e.headers;Be.isFormData(i)&&delete o["Content-Type"];var c=new XMLHttpRequest;if(e.auth){var a=e.auth.username||"",u=e.auth.password||"";o.Authorization="Basic "+btoa(a+":"+u)}var l,h,f=(l=e.baseURL,h=e.url,l&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(h)?function(v,I){return I?v.replace(/\/+$/,"")+"/"+I.replace(/^\/+/,""):v}(l,h):h);if(c.open(e.method.toUpperCase(),V0(f,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,c.onreadystatechange=function(){if(c&&c.readyState===4&&(c.status!==0||c.responseURL&&c.responseURL.indexOf("file:")===0)){var v="getAllResponseHeaders"in c?function(S){var y,E,C,x={};return S&&Be.forEach(S.split(`
`),function(U){if(C=U.indexOf(":"),y=Be.trim(U.substr(0,C)).toLowerCase(),E=Be.trim(U.substr(C+1)),y){if(x[y]&&DP.indexOf(y)>=0)return;x[y]=y==="set-cookie"?(x[y]?x[y]:[]).concat([E]):x[y]?x[y]+", "+E:E}}),x}(c.getAllResponseHeaders()):null,I={data:e.responseType&&e.responseType!=="text"?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:v,config:e,request:c};(function(S,y,E){var C=E.config.validateStatus;!C||C(E.status)?S(E):y(vu("Request failed with status code "+E.status,E.config,null,E.request,E))})(t,n,I),c=null}},c.onabort=function(){c&&(n(vu("Request aborted",e,"ECONNABORTED",c)),c=null)},c.onerror=function(){n(vu("Network Error",e,null,c)),c=null},c.ontimeout=function(){var v="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(v=e.timeoutErrorMessage),n(vu(v,e,"ECONNABORTED",c)),c=null},Be.isStandardBrowserEnv()){var m=NP,g=(e.withCredentials||OP(f))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(o[e.xsrfHeaderName]=g)}if("setRequestHeader"in c&&Be.forEach(o,function(v,I){i===void 0&&I.toLowerCase()==="content-type"?delete o[I]:c.setRequestHeader(I,v)}),Be.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),e.responseType)try{c.responseType=e.responseType}catch(v){if(e.responseType!=="json")throw v}typeof e.onDownloadProgress=="function"&&c.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(v){c&&(c.abort(),n(v),c=null)}),i===void 0&&(i=null),c.send(i)})},MP={"Content-Type":"application/x-www-form-urlencoded"};function q0(e,t){!Be.isUndefined(e)&&Be.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var sf={adapter:function(){var e;return(typeof XMLHttpRequest<"u"||G0!==void 0&&Object.prototype.toString.call(G0)==="[object process]")&&(e=LP),e}(),transformRequest:[function(e,t){return J0(t,"Accept"),J0(t,"Content-Type"),Be.isFormData(e)||Be.isArrayBuffer(e)||Be.isBuffer(e)||Be.isStream(e)||Be.isFile(e)||Be.isBlob(e)?e:Be.isArrayBufferView(e)?e.buffer:Be.isURLSearchParams(e)?(q0(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Be.isObject(e)?(q0(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if(typeof e=="string")try{e=JSON.parse(e)}catch{}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Be.forEach(["delete","get","head"],function(e){sf.headers[e]={}}),Be.forEach(["post","put","patch"],function(e){sf.headers[e]=Be.merge(MP)});var K0=sf;function cf(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var UP=function(e){return cf(e),e.headers=e.headers||{},e.data=of(e.data,e.headers,e.transformRequest),e.headers=Be.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Be.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||K0.adapter)(e).then(function(t){return cf(e),t.data=of(t.data,t.headers,e.transformResponse),t},function(t){return j0(t)||(cf(e),t&&t.response&&(t.response.data=of(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})},uf=function(e,t){t=t||{};var n={},i=["url","method","params","data"],o=["headers","auth","proxy"],c=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];Be.forEach(i,function(l){t[l]!==void 0&&(n[l]=t[l])}),Be.forEach(o,function(l){Be.isObject(t[l])?n[l]=Be.deepMerge(e[l],t[l]):t[l]!==void 0?n[l]=t[l]:Be.isObject(e[l])?n[l]=Be.deepMerge(e[l]):e[l]!==void 0&&(n[l]=e[l])}),Be.forEach(c,function(l){t[l]!==void 0?n[l]=t[l]:e[l]!==void 0&&(n[l]=e[l])});var a=i.concat(o).concat(c),u=Object.keys(t).filter(function(l){return a.indexOf(l)===-1});return Be.forEach(u,function(l){t[l]!==void 0?n[l]=t[l]:e[l]!==void 0&&(n[l]=e[l])}),n};function Ss(e){this.defaults=e,this.interceptors={request:new F0,response:new F0}}Ss.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=uf(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[UP,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(i){t.unshift(i.fulfilled,i.rejected)}),this.interceptors.response.forEach(function(i){t.push(i.fulfilled,i.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},Ss.prototype.getUri=function(e){return e=uf(this.defaults,e),V0(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},Be.forEach(["delete","get","head","options"],function(e){Ss.prototype[e]=function(t,n){return this.request(Be.merge(n||{},{method:e,url:t}))}}),Be.forEach(["post","put","patch"],function(e){Ss.prototype[e]=function(t,n,i){return this.request(Be.merge(i||{},{method:e,url:t,data:n}))}});var _u=Ss;function lf(e){this.message=e}lf.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},lf.prototype.__CANCEL__=!0;var Q0=lf;function yu(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(i){t=i});var n=this;e(function(i){n.reason||(n.reason=new Q0(i),t(n.reason))})}yu.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},yu.source=function(){var e;return{token:new yu(function(t){e=t}),cancel:e}};var VP=yu;function Y0(e){var t=new _u(e),n=O0(_u.prototype.request,t);return Be.extend(n,_u.prototype,t),Be.extend(n,t),n}var fr=Y0(K0);fr.Axios=_u,fr.create=function(e){return Y0(uf(fr.defaults,e))},fr.Cancel=Q0,fr.CancelToken=VP,fr.isCancel=j0,fr.all=function(e){return Promise.all(e)},fr.spread=function(e){return function(t){return e.apply(null,t)}};var X0=fr,FP=fr;X0.default=FP;var bu=X0,mi=Ie(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function o(l,h,f){this.fn=l,this.context=h,this.once=f||!1}function c(l,h,f,m,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new o(f,m||l,g),I=n?n+h:h;return l._events[I]?l._events[I].fn?l._events[I]=[l._events[I],v]:l._events[I].push(v):(l._events[I]=v,l._eventsCount++),l}function a(l,h){--l._eventsCount==0?l._events=new i:delete l._events[h]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1)),u.prototype.eventNames=function(){var l,h,f=[];if(this._eventsCount===0)return f;for(h in l=this._events)t.call(l,h)&&f.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(l)):f},u.prototype.listeners=function(l){var h=n?n+l:l,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,g=f.length,v=new Array(g);m<g;m++)v[m]=f[m].fn;return v},u.prototype.listenerCount=function(l){var h=n?n+l:l,f=this._events[h];return f?f.fn?1:f.length:0},u.prototype.emit=function(l,h,f,m,g,v){var I=n?n+l:l;if(!this._events[I])return!1;var S,y,E=this._events[I],C=arguments.length;if(E.fn){switch(E.once&&this.removeListener(l,E.fn,void 0,!0),C){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,f),!0;case 4:return E.fn.call(E.context,h,f,m),!0;case 5:return E.fn.call(E.context,h,f,m,g),!0;case 6:return E.fn.call(E.context,h,f,m,g,v),!0}for(y=1,S=new Array(C-1);y<C;y++)S[y-1]=arguments[y];E.fn.apply(E.context,S)}else{var x,U=E.length;for(y=0;y<U;y++)switch(E[y].once&&this.removeListener(l,E[y].fn,void 0,!0),C){case 1:E[y].fn.call(E[y].context);break;case 2:E[y].fn.call(E[y].context,h);break;case 3:E[y].fn.call(E[y].context,h,f);break;case 4:E[y].fn.call(E[y].context,h,f,m);break;default:if(!S)for(x=1,S=new Array(C-1);x<C;x++)S[x-1]=arguments[x];E[y].fn.apply(E[y].context,S)}}return!0},u.prototype.on=function(l,h,f){return c(this,l,h,f,!1)},u.prototype.once=function(l,h,f){return c(this,l,h,f,!0)},u.prototype.removeListener=function(l,h,f,m){var g=n?n+l:l;if(!this._events[g])return this;if(!h)return a(this,g),this;var v=this._events[g];if(v.fn)v.fn!==h||m&&!v.once||f&&v.context!==f||a(this,g);else{for(var I=0,S=[],y=v.length;I<y;I++)(v[I].fn!==h||m&&!v[I].once||f&&v[I].context!==f)&&S.push(v[I]);S.length?this._events[g]=S.length===1?S[0]:S:a(this,g)}return this},u.prototype.removeAllListeners=function(l){var h;return l?(h=n?n+l:l,this._events[h]&&a(this,h)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,e.exports=u}),J=new mi,Su=1,df=2,hf=3,Qo=4,Yo=5,ff=20,pf=21,ku=22,mf=23,gf=24,vf=27,_f=28,Iu=29,Z0=30,yf=33,eb=31,bf=32,jP=100,tb=101,ks=102,Sf=103,Vn=110,Tu=111,kf=112,Dr=113,Or=114,BP=115,Is=116,If=120,Tf=121,wf=122,Ef=123,Ts=130,Cf=131,Rf=132,Af=133,xf=134,Pf=135,Df=136,Of=137,Nf=200,Lf=201,Mf=300,ws=301,Uf=302,Vf=303;function Xo(e){var t=e.retryFunction,n=e.settings,i=e.onError,o=e.onRetrying,c=e.context;return function(){for(var a=this,u=arguments.length,l=new Array(u),h=0;h<u;h++)l[h]=arguments[h];var f=n.retries||5,m=0,g=-1,v=0,I=function(){var S=b(regeneratorRuntime.mark(function y(E,C){var x,U,G,H;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.prev=0,x=c||a,V.next=4,t.apply(x,l);case 4:U=V.sent,m=0,E(U),V.next=14;break;case 9:V.prev=9,V.t0=V.catch(0),G=function(){clearTimeout(g),m=0,v=2,C(V.t0)},H=function(){v!==2&&m<f?(m++,v=1,hr(o)&&o(m,G),g=setTimeout(function(){g=-1,I(E,C)},fe(n.timeout)?1e3:n.timeout)):G()},hr(i)?i(V.t0,H,C):H();case 14:case"end":return V.stop()}},y,null,[[0,9]])}));return function(y,E){return S.apply(this,arguments)}}();return new Promise(I)}}var HP=P(function e(t){w(this,e),this.log=t.log,this.level=t.level,this.userId=t.userId,this.sdkAppId=t.sdkAppId,this.forAllJoinedClients=t.forAllJoinedClients,this.uploaded=!1}),$P=function(){function e(t){w(this,e),this.id_=t.id,this.userId_=t.userId,this.sdkAppId_=t.sdkAppId,this.type_=t.type,this.isLocal_=!w0(t.isLocal)||t.isLocal}return P(e,[{key:"setUserId",value:function(t){this.userId_=t}},{key:"setSdkAppId",value:function(t){this.sdkAppId_=t}},{key:"log",value:function(t,n){ye.log({log:"[".concat(this.isLocal_?"":"*").concat(this.id_,"] ").concat(this.type_?this.type_+" ":"").concat(n),level:t,forAllJoinedClients:fe(this.userId_),userId:this.userId_,sdkAppId:this.sdkAppId_})}},{key:"info",value:function(t){this.log(Un.INFO,t)}},{key:"debug",value:function(t){this.log(Un.DEBUG,t)}},{key:"warn",value:function(t){this.log(Un.WARN,t)}},{key:"error",value:function(t){this.log(Un.ERROR,t)}}]),e}(),ye=new(function(){function e(){var i=this;w(this,e),this.clients_=new Set,this.queue_=[],this.timeoutId_=-1,this.logLevel_=Un.DEBUG,this.logLevelToUpload_=Un.INFO,this.enableUploadLog_=!0,this.isAbleToUpload_=!1,this.startUpload(),this.checkURLParam(),J.on(Z0,function(o){var c=o.client;return i.clients_.add(c)}),J.on(yf,function(o){var c=o.client;return i.clients_.delete(c)}),J.on(eb,function(o){o&&Gi(o.config)&&Go[o.config.logLevelToUpload]&&(i.logLevelToUpload_=o.config.logLevelToUpload)}),J.on(Qo,this.setIsAbleToUpload,this),J.on(Yo,this.setIsAbleToUpload,this)}var t,n;return P(e,[{key:"getIsAbleToUpload",value:function(){return this.isAbleToUpload_}},{key:"setIsAbleToUpload",value:function(){this.isAbleToUpload_=!0,J.off(Qo,this.setIsAbleToUpload,this),J.off(Yo,this.setIsAbleToUpload,this)}},{key:"startUpload",value:(n=b(regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,this.upload();case 3:c.next=7;break;case 5:c.prev=5,c.t0=c.catch(0);case 7:this.timeoutId_=setTimeout(function(){return o.startUpload()},2e3);case 8:case"end":return c.stop()}},i,this,[[0,5]])})),function(){return n.apply(this,arguments)})},{key:"stopUpload",value:function(){this.timeoutId_!==-1&&(clearTimeout(this.timeoutId_),this.timeoutId_=-1)}},{key:"getLogsToUpload",value:function(){var i=this,o={map:new Map,splicedQueue:[]};if(this.queue_[0].forAllJoinedClients&&this.clients_.size===0)return o;for(var c=0,a=function(){if(c===50)return"break";var u=i.queue_[c];u.forAllJoinedClients?i.clients_.forEach(function(l){if(l.getIsJoined()){var h=l.getUserId(),f=l.getSDKAppId();o.map.has(h)?o.map.get(h).logs.push(u):o.map.set(h,{userId:h,sdkAppId:f,logs:[u]})}}):o.map.has(u.userId)?o.map.get(u.userId).logs.push(u):o.map.set(u.userId,{userId:u.userId,sdkAppId:u.sdkAppId,logs:[u]})};c<this.queue_.length&&a()!=="break";c++);return o.map.size>0&&(o.splicedQueue=this.queue_.splice(0,c)),o}},{key:"upload",value:(t=b(regeneratorRuntime.mark(function i(){var o,c,a,u,l,h,f,m,g,v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(this.queue_.length!==0&&this.isAbleToUpload_){I.next=2;break}return I.abrupt("return");case 2:if(o=this.getLogsToUpload(),c=o.map,a=o.splicedQueue,c.size!==0){I.next=5;break}return I.abrupt("return");case 5:I.prev=5,u=Ke(c.values()),l=0;case 8:if(!(l<u.length)){I.next=16;break}return h=u[l],f=h.userId,m=h.sdkAppId,g=h.logs,I.next=12,this.uploadLogWithRetry(JSON.stringify({timestamp:T_(),sdkAppId:String(m),userId:f,version:"4.14.1",log:g.map(function(S){return S.log}).join(`
`)}),m);case 12:g.forEach(function(S){return S.uploaded=!0});case 13:l++,I.next=8;break;case 16:I.next=20;break;case 18:I.prev=18,I.t0=I.catch(5);case 20:(v=a.filter(function(S){return!S.uploaded})).length>0&&(this.queue_=v.concat(this.queue_));case 22:case"end":return I.stop()}},i,this,[[5,18]])})),function(){return t.apply(this,arguments)})},{key:"uploadLogWithRetry",value:function(i,o){return Xo({retryFunction:function(){return bu.post(hu(o,Oy),i,{timeout:5e3})},settings:{retries:3,timeout:1e3},onError:function(c,a){a()}})()}},{key:"getPrefix",value:function(i){var o=new Date;return o.setTime(ln()),"[".concat(o.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(o.getMilliseconds(),"] <").concat(Go[i],">")}},{key:"getLogLevel",value:function(){return this.logLevel_}},{key:"setLogLevel",value:function(i){fe(Go[i])||(this.logLevel_!==i&&this.info("setLogLevel ".concat(i)),this.logLevel_=i)}},{key:"enableUploadLog",value:function(){this.enableUploadLog_=!0}},{key:"disableUploadLog",value:function(){this.enableUploadLog_=!1}},{key:"log",value:function(i){var o=i.log,c=i.level,a=i.forAllJoinedClients,u=a===void 0||a,l=i.userId,h=i.sdkAppId;if(o="".concat(this.getPrefix(c)," ").concat(o),this.enableUploadLog_&&c>=this.logLevelToUpload_&&this.queue_.push(new HP({log:o,level:c,userId:l,sdkAppId:h,forAllJoinedClients:u})),!(c<this.logLevel_)){var f=Go[c]?Go[c].toLowerCase():"info";console[f]("%cTRTC:%c%s","padding: 1px 4px;border-radius: 3px;color: #fff;background: #1E88E5;","display: inline",o)}}},{key:"debug",value:function(i){this.log({log:i,level:Un.DEBUG})}},{key:"info",value:function(i){this.log({log:i,level:Un.INFO})}},{key:"warn",value:function(i){this.log({log:i,level:Un.WARN})}},{key:"error",value:function(i){this.log({log:i,level:Un.ERROR})}},{key:"createLogger",value:function(i){return new $P(i)}},{key:"checkURLParam",value:function(){var i=new URLSearchParams(location.search).get("logLevelToUpload");Go[i]&&(this.logLevelToUpload_=i)}}]),e}()),nb=!0,zP=Math.floor,rb=Number.isInteger||function(e){return!ie(e)&&isFinite(e)&&zP(e)===e};Me({target:"Number",stat:!0},{isInteger:rb});var Ff,WP=z.TypeError,ib=function(e){if(Kd(e))throw WP("The method doesn't accept regular expressions");return e},GP=ht("match"),ob=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[GP]=!1,"/./"[e](t)}catch{}}return!1},JP=Yr.f,ab=ne("".startsWith),qP=ne("".slice),KP=Math.min,sb=ob("startsWith"),QP=!(sb||(Ff=JP(String.prototype,"startsWith"),!Ff||Ff.writable));Me({target:"String",proto:!0,forced:!QP&&!sb},{startsWith:function(e){var t=Fe(ue(this));ib(e);var n=sr(KP(arguments.length>1?arguments[1]:void 0,t.length)),i=Fe(e);return ab?ab(t,i,n):qP(t,n,n+i.length)===i}});var Zo=Object.assign,cb=Object.defineProperty,YP=ne([].concat),Es=!Zo||he(function(){if(Te&&Zo({b:1},Zo(cb({},"a",{enumerable:!0,get:function(){cb(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(i){t[i]=i}),Zo({},e)[n]!=7||Oi(Zo({},t)).join("")!="abcdefghijklmnopqrst"})?function(e,t){for(var n=sn(e),i=arguments.length,o=1,c=bg.f,a=vo.f;i>o;)for(var u,l=oe(arguments[o++]),h=c?YP(Oi(l),c(l)):Oi(l),f=h.length,m=0;f>m;)u=h[m++],Te&&!Le(a,l,u)||(n[u]=l[u]);return n}:Zo;Me({target:"Object",stat:!0,arity:2,forced:Object.assign!==Es},{assign:Es});var ub=z.Function,XP=ne([].concat),ZP=ne([].join),jf={},e2=function(e,t,n){if(!Qe(jf,t)){for(var i=[],o=0;o<t;o++)i[o]="a["+o+"]";jf[t]=ub("C,a","return new C("+ZP(i,",")+")")}return jf[t](e,n)},lb=Bt?ub.bind:function(e){var t=an(this),n=t.prototype,i=ii(arguments,1),o=function(){var c=XP(i,ii(arguments));return this instanceof o?e2(t,c.length,c):t.apply(e,c)};return ie(n)&&(o.prototype=n),o};Me({target:"Function",proto:!0,forced:Function.bind!==lb},{bind:lb});var t2=Cn.findIndex,db=!0;"findIndex"in[]&&Array(1).findIndex(function(){db=!1}),Me({target:"Array",proto:!0,forced:db},{findIndex:function(e){return t2(this,e,arguments.length>1?arguments[1]:void 0)}}),Io("findIndex");var n2=ne(vo.f),r2=ne([].push),hb=function(e){return function(t){for(var n,i=me(t),o=Oi(i),c=o.length,a=0,u=[];c>a;)n=o[a++],Te&&!n2(i,n)||r2(u,e?[n,i[n]]:i[n]);return u}},i2={entries:hb(!0),values:hb(!1)}.values;Me({target:"Object",stat:!0},{values:function(e){return i2(e)}});var o2=Ka.includes,a2=he(function(){return!Array(1).includes()});Me({target:"Array",proto:!0,forced:a2},{includes:function(e){return o2(this,e,arguments.length>1?arguments[1]:void 0)}}),Io("includes");var s2=ne("".indexOf);Me({target:"String",proto:!0,forced:!ob("includes")},{includes:function(e){return!!~s2(Fe(ue(this)),Fe(ib(e)),arguments.length>1?arguments[1]:void 0)}});var fb=1,pb=5,Bf=2,Cs=3,Hf=4,wu="DISCONNECTED",mb="CONNECTING",$f="RECONNECTING",Eu="CONNECTED",Nr={CLIENT_BANNED:9,CHANNEL_SETUP_RESULT:19,CHANNEL_RECONNECT_RESULT:514,JOIN_ROOM_RESULT:20,PEER_JOIN:4134,PEER_LEAVE:4135,STREAM_ADDED:16,STREAM_REMOVED:18,UPLINK_NETWORK_STATS:22,UPDATE_REMOTE_MUTE_STAT:23,PUBLISH_RESULT:4098,UNPUBLISH_RESULT:4100,SUBSCRIBE_RESULT:4102,UNSUBSCRIBE_RESULT:4104,SUBSCRIBE_CHANGE_RESULT:4106,MUTE_RESULT:4108,UPDATE_OFFER_RESULT:4128,START_PUBLISH_TENCENT_CDN_RES:1286,STOP_PUBLISH_TENCENT_CDN_RES:1288,START_PUBLISH_GIVEN_CDN_RES:777,STOP_PUBLISH_GIVEN_CDN_RES:779,START_MIX_TRANSCODE_RES:781,STOP_MIX_TRANSCODE_RES:783,USER_LIST_RES:4137,SWITCH_ROLE_RES:4110,UPDATE_CONSTRAINT_CONFIG_RES:772},c2=[Nr.UPDATE_REMOTE_MUTE_STAT,Nr.UPLINK_NETWORK_STATS,Nr.USER_LIST_RES,Nr.MUTE_RESULT],kt={CLIENT_BANNED:"client-banned",CHANNEL_SETUP_RESULT:"channel-setup-result",CHANNEL_RECONNECT_RESULT:"channel-reconnect-result",JOIN_ROOM_RESULT:"join-room-result",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",UPLINK_NETWORK_STATS:"uplink-network-stats",UPDATE_REMOTE_MUTE_STAT:"update-remote-mute-stat",PUBLISH_RESULT:"publish-result",UNPUBLISH_RESULT:"unpublish-result",SUBSCRIBE_RESULT:"subscribe-result",SUBSCRIBE_CHANGE_RESULT:"subscribe-change-result",UNSUBSCRIBE_RESULT:"unsubscribe-result",UPDATE_OFFER_RESULT:"update-offer-result",START_PUBLISH_TENCENT_CDN_RES:"start-publish-tencent-cdn-res",STOP_PUBLISH_TENCENT_CDN_RES:"stop-publish-tencent-cdn-res",START_PUBLISH_GIVEN_CDN_RES:"start-publish-given-cdn-res",STOP_PUBLISH_GIVEN_CDN_RES:"stop-publish-given-cdn-res",START_MIX_TRANSCODE_RES:"start-mix-transcode-res",STOP_MIX_TRANSCODE_RES:"stop-mix-transcode-res",USER_LIST_RES:"user-list-res",SWITCH_ROLE_RES:"switch_role_res",MUTE_RESULT:"mute-result",UPDATE_CONSTRAINT_CONFIG_RES:"update-contraint-config-res"},u2="publish_change",l2="join",d2="leave",h2="quality_report",f2="mute_uplink",p2="publish",gb="unpublish",m2="subscribe",g2="unsubscribe",v2="subscribe_change",_2="start_publishing",y2="stop_publishing",b2="start_push_user_cdn",S2="stop_push_user_cdn",k2="start_mcu_mix",I2="stop_mcu_mix",T2="get_user_list",w2="change_role",E2="update_constraint_config",Q={INVALID_PARAMETER:4096,INVALID_OPERATION:4097,NOT_SUPPORTED:4098,DEVICE_NOT_FOUND:4099,INITIALIZE_FAILED:4100,SIGNAL_CHANNEL_SETUP_FAILED:16385,SIGNAL_CHANNEL_ERROR:16386,ICE_TRANSPORT_ERROR:16387,JOIN_ROOM_FAILED:16388,CREATE_OFFER_FAILED:16389,SIGNAL_CHANNEL_RECONNECTION_FAILED:16390,UPLINK_RECONNECTION_FAILED:16391,DOWNLINK_RECONNECTION_FAILED:16392,REMOTE_STREAM_NOT_EXIST:16400,CLIENT_BANNED:16448,SERVER_TIMEOUT:16449,SUBSCRIPTION_TIMEOUT:16450,PLAY_NOT_ALLOWED:16451,DEVICE_AUTO_RECOVER_FAILED:16452,START_PUBLISH_CDN_FAILED:16453,STOP_PUBLISH_CDN_FAILED:16454,START_MIX_TRANSCODE_FAILED:16455,STOP_MIX_TRANSCODE_FAILED:16456,NOT_SUPPORTED_H264:16457,SWITCH_ROLE_FAILED:16458,API_CALL_TIMEOUT:16459,SCHEDULE_FAILED:16460,UNKNOWN:65535},Y=function(e){$(n,e);var t=Ye(n);function n(i){var o,c=i.name,a=c===void 0?"RtcError":c,u=i.message,l=i.code,h=l===void 0?Q.UNKNOWN:l,f=i.extraCode,m=f===void 0?0:f,g=i.constraint;w(this,n);var v="<".concat(function(I){for(var S in Q)if(Q[S]===I)return S;return"UNKNOWN"}(h)," 0x").concat(h.toString(16),">");return(o=t.call(this,u+"".concat(g?" constraint: ".concat(g):"")+"".concat(u.includes(v)?"":" "+v))).code_=h,o.extraCode_=m,o.name=a,o.message_=u,g&&(o.constraint=g),o}return P(n,[{key:"getCode",value:function(){return this.code_}},{key:"getExtraCode",value:function(){return this.extraCode_}}]),n}(ge(Error)),vb=32768,_b=32769,yb=32770,bb=32771,C2=32772,R2=32773,A2=32774,x2=32775,Sb=32777,P2=32778,zf=32779,D2=32780,O2=32781,N2=32782,L2=32783,M2=32784,U2=32785,V2=32786,F2=32787,j2=32788,B2=32789,H2=32790,$2=32791,z2=32792,W2=32793,G2=32794,J2=32795,q2=32796,K2=32797,Q2=32798,Y2=32799,X2=32800,Z2=32801,eD=32802,tD=32803,nD=32804,Rs=new Map,gn=function(e,t){var n=Rs.get(e);n||(Rs.set(e,[]),n=Rs.get(e)),n.push(t)},rD=function(e){var t=Rs.get(e),n=[];return t?(Rs.delete(e),n=t.map(function(i){return{uint32_event_id:i.eventId,uint64_date:i.timestamp,str_userid:i.remoteUserId,str_event_json:i.eventDesc}})):n=[],n},iD=Object.prototype.hasOwnProperty;function ea(e){if(e==null)return!0;if(typeof e=="boolean")return!1;if(typeof e=="number")return e===0;if(typeof e=="string"||typeof e=="function"||Array.isArray(e))return e.length===0;if(e instanceof Error)return e.message==="";if(Gi(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return e.size===0;case"[object Object]":for(var t in e)if(iD.call(e,t))return!1;return!0}return!1}var Se=new(function(){function e(){w(this,e);var t=$i(),n=t.name,i=t.version;this.roomIdMap_=new Map,this.configs_={sdkAppId:"",userId:"",version:"4.14.1",env:uu,browserVersion:n+i,ua:navigator.userAgent}}return P(e,[{key:"setConfig",value:function(t){var n=t.sdkAppId,i=t.env,o=t.userId,c=t.roomId;n!==this.configs_.sdkAppId&&(this.configs_.sdkAppId=String(n)),this.configs_.env=i,this.configs_.userId=o,this.roomIdMap_.set(o,String(c))}},{key:"logEvent",value:function(t){if(!Ho){var n=p(p(p({},t),this.configs_),{},{userId:t.userId||this.configs_.userId});fe(n.code)&&(n.code=n.result==="failed"?Q.UNKNOWN:0),this.sendRequest(hu(this.configs_.sdkAppId,sA),n)}}},{key:"logSuccessEvent",value:function(t){Ho||(this.logEvent(p(p({},t),{},{result:"success",roomId:this.roomIdMap_.get(t.userId)})),this.configs_.env===uu&&this.uploadEventToKibana(p(p({},t),{},{result:"success"})))}},{key:"logFailedEvent",value:function(t){if(!Ho){var n=t.eventType,i=t.code,o=t.error,c=t.userId,a={roomId:this.roomIdMap_.get(c),userId:c,eventType:n,result:"failed",code:i||(o instanceof Y?o.getExtraCode()||o.getCode():Q.UNKNOWN)};this.logEvent(a),this.configs_.env===uu&&this.uploadEventToKibana(p(p({},a),{},{error:o}))}}},{key:"uploadEventToKibana",value:function(t){var n="stat-".concat(t.eventType,"-").concat(t.result);t.eventType!=="delta-join"&&t.eventType!=="delta-leave"&&t.eventType!=="delta-publish"||(n="".concat(t.eventType,":").concat(t.delta)),this.uploadEvent({log:n,userId:t.userId}),t.result==="failed"&&(n="stat-".concat(t.eventType,"-").concat(t.result,"-").concat(t.code),this.uploadEvent({log:n,userId:t.userId,error:t.error}))}},{key:"uploadEvent",value:function(t){var n=t.log,i=t.userId,o=t.error,c={timestamp:T_(),sdkAppId:this.configs_.sdkAppId,userId:i||this.configs_.userId,version:this.configs_.version,log:n};o&&(c.errorInfo=o.message),this.sendRequest(hu(this.configs_.sdkAppId,Oy),c)}},{key:"sendRequest",value:function(t,n){var i=this;ye.getIsAbleToUpload()?bu.post(t,JSON.stringify(n)).catch(function(){}):setTimeout(function(){i.sendRequest(t,n)},1e3)}}]),e}()),oD=function(){function e(t){w(this,e),this.client_=t.client,this.sdkAppId_=t.sdkAppId,this.userId_=t.userId,this.userSig_=t.userSig,this.url_=t.url,this.backupUrl_=t.backupUrl;var n="?sdkAppId=".concat(encodeURIComponent(this.sdkAppId_),"&userId=").concat(encodeURIComponent(this.userId_),"&userSig=").concat(encodeURIComponent(this.userSig_));this.urlWithParam_="".concat(this.url_).concat(n),this.backupUrlWithParam_="".concat(this.backupUrl_).concat(n),this.isConnected_=!1,this.isConnecting_=!1,this.socketInUse_=null,this.socket_=null,this.backupSocket_=null,this.backupTimer_=-1,this.signalInfo_={},this.currentState_=wu,this.reconnectionCount_=0,this.reconnectionTimer_=-1,this.seq_=0,this.log_=ye.createLogger({id:"ws|"+this.userId_,userId:this.userId_,sdkAppId:this.sdkAppId_}),this.emitter_=new mi}return P(e,[{key:"connect",value:function(){var t=this;return new Promise(function(n,i){t.log_.info("connect to url: ".concat(t.urlWithParam_)),t.emitConnectionStateChanged(mb),t.socket_=new WebSocket(t.urlWithParam_),t.bindSocket(t.socket_),t.backupTimer_=setTimeout(function(){t.isConnected_||(t.log_.info("trying to connect to backupUrl"),t.tryConnectBackup())},5e3),t.once(Cs,n),t.once(Hf,i)})}},{key:"tryConnectBackup",value:function(){this.backupSocket_||(this.unbindAndCloseSocket(Et),this.log_.debug("try to connect to url: ".concat(this.backupUrlWithParam_)),this.backupSocket_=new WebSocket(this.backupUrlWithParam_),this.bindSocket(this.backupSocket_))}},{key:"bindSocket",value:function(t){t.onopen=this.onopen.bind(this),t.onclose=this.onclose.bind(this),t.onerror=this.onerror.bind(this),t.onmessage=this.onmessage.bind(this)}},{key:"unbindSocket",value:function(t){t.onopen=function(){},t.onclose=function(){},t.onerror=function(){},t.onmessage=function(){}}},{key:"unbindAndCloseSocket",value:function(t){if(t===Et){if(this.socket_){this.unbindSocket(this.socket_);try{this.socket_.close(1e3)}catch{}this.socket_=null}}else if(this.backupSocket_){this.unbindSocket(this.backupSocket_);try{this.backupSocket_.close(1e3)}catch{}this.backupSocket_=null}}},{key:"clearBackupTimer",value:function(){this.backupTimer_!==-1&&(clearTimeout(this.backupTimer_),this.backupTimer_=-1)}},{key:"clearReconnectionTimer",value:function(){this.reconnectionTimer_!==-1&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"onopen",value:function(t){if(!this.isConnected_){this.isConnected_=!0,this.isConnecting_=!1,this.clearBackupTimer(),t.target===this.socket_?(this.unbindAndCloseSocket(zi),this.socketInUse_=this.socket_):(this.unbindAndCloseSocket(Et),this.socketInUse_=this.backupSocket_);var n=t.target.url;this.log_.info("websocket[".concat(n,"] is connected")),this.currentState_===mb?this.addSignalEvent($2,"signal channel is connected"):this.currentState_===$f&&this.addSignalEvent(J2,"signal channel reconnect success"),this.emitConnectionStateChanged(Eu),this.emitter_.emit(Cs)}}},{key:"onclose",value:function(t){var n=t.target.url,i=t.target===this.socketInUse_;this.log_.info("websocket[".concat(n," InUse: ").concat(i,"] is closed with code: ").concat(t.code)),t.target===this.socketInUse_&&(this.isConnected_=!1,this.emitConnectionStateChanged(wu),this.addSignalEvent(H2,"signal channel is disconnected"),t.wasClean&&t.code===1e3||(this.log_.warn("onclose code:".concat(t.code," reason:").concat(t.reason)),this.log_.warn("close current websocket and schedule a reconnect timeout"),this.socketInUse_.onclose=function(){},this.socketInUse_.close(4011),this.socket_=this.backupSocket_=this.socketInUse_=null,this.reconnect(Et)))}},{key:"onerror",value:function(t){var n=t.target.url;this.log_.error("websocket[".concat(n,"] error observed")),this.isConnected_?t.target===this.socketInUse_&&(this.isConnected_=!1,this.unbindAndCloseSocket(Et),this.unbindAndCloseSocket(zi),this.socketInUse_=null,this.reconnect(Et)):(this.isReconnecting_||Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Bh,code:Q.UNKNOWN}),t.target==this.socket_?(this.unbindAndCloseSocket(Et),this.reconnect(zi)):(this.unbindAndCloseSocket(zi),this.reconnect(Et))),this.isConnecting_=!1,this.isConnected_=!1}},{key:"onmessage",value:function(t){if(this.isConnected_){var n=JSON.parse(t.data),i=n.cmd,o=n.data,c=Object.values(Nr),a=Object.keys(Nr)[c.indexOf(i)],u=kt[a];if(!c2.includes(i)){var l=t.target==this.socket_?this.url_:this.backupUrl_;this.log_.debug("websocket[".concat(l,"] received message: ").concat(t.data)),this.log_.info("Received event: [ ".concat(u||"unknown cmd: "+i," ]"))}switch(i){case Nr.CHANNEL_SETUP_RESULT:if(n.code===0)this.signalInfo_.clientIp=o.clientIp,this.signalInfo_.signalIp=o.signalInnerIp,this.signalInfo_.tinyId=n.tinyId,o.svrTime&&function(f){qd=f-new Date().getTime();var m=new Date;m.setTime(f),ye.info("baseTime from server: "+m+" offset: "+qd)}(o.svrTime),this.log_.info("ChannelSetup Success"),Se.logSuccessEvent({userId:this.userId_,eventType:Bh}),this.emitter_.emit(fb,{signalInfo:this.signalInfo_});else{var h=new Y({code:Q.SIGNAL_CHANNEL_SETUP_FAILED,extraCode:n.code,message:Z({key:jA,data:{errorCode:n.code,errorMsg:n.message}})});this.log_.error("".concat(n.code,", ").concat(n.message)),this.close(),Se.logFailedEvent({userId:this.userId_,eventType:Bh,error:h}),this.emitter_.emit(pb,h)}break;case Nr.JOIN_ROOM_RESULT:n.code===0&&(this.signalInfo_.relayIp=o.relayOuterIp,this.signalInfo_.relayInnerIp=o.relayInnerIp,this.signalInfo_.relayPort=o.relayPort,this.log_.info("signalIp:".concat(this.signalInfo_.signalIp," clientIp:").concat(this.signalInfo_.clientIp," relayIp: ").concat(this.signalInfo_.relayIp))),this.emitter_.emit(u,{data:n});break;case Nr.CHANNEL_RECONNECT_RESULT:n.code===0?(this.log_.warn("reconnect success"),this.stopReconnection(),Se.logSuccessEvent({userId:this.userId_,eventType:Qy}),this.client_.syncUserList(),this.client_.checkConnectionsToReconnect()):(this.log_.warn("reconnect failed, ".concat(n.code," ").concat(n.message)),this.client_.reJoin());break;default:this.emitter_.emit(u,{data:n})}}}},{key:"addSignalEvent",value:function(t,n){gn(this.userId_,{eventId:t,eventDesc:n,timestamp:ln(),userId:this.userId_,tinyId:this.signalInfo_.tinyId})}},{key:"reconnect",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Et;if(this.isConnecting_||this.reconnectionTimer_!==-1)this.log_.info("signal channel is reconnecting, ignoring current reconnection");else{if(this.reconnectionCount_>=30){this.log_.warn("SDK has tried reconnect signal channel for ".concat(30," times, but all failed. please check your network"));var i=new Y({code:Q.SIGNAL_CHANNEL_RECONNECTION_FAILED,message:Z({key:FA})});return Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Qy,error:i}),this.addSignalEvent(q2,"signal channel reconnect fail"),void this.emitter_.emit(Hf,i)}this.isConnecting_=!0,this.reconnectionCount_++,this.currentState_!==$f&&(this.emitConnectionStateChanged($f),this.addSignalEvent(G2,"signal channel is reconnecting")),this.log_.warn("reconnecting to ".concat(n," signal channel [").concat(this.reconnectionCount_,"/").concat(30,"]"));var o=this.getReconnectionUrl(n);n===Et?(this.socket_=new WebSocket(o),this.bindSocket(this.socket_)):(this.backupSocket_=new WebSocket(o),this.bindSocket(this.backupSocket_));var c=Zh(this.reconnectionCount_);this.reconnectionTimer_=setTimeout(function(){t.log_.warn("reconnect ".concat(n," signal channel timeout(").concat(c/1e3,"s), close and try again")),t.isConnecting_=!1,t.clearReconnectionTimer(),t.unbindAndCloseSocket(n),t.reconnect(n===Et?zi:Et)},c)}}},{key:"isConnected",value:function(){return this.isConnected_}},{key:"isReconnecting_",get:function(){return this.reconnectionTimer_!==-1}},{key:"getReconnectionUrl",value:function(t){var n=t===Et?this.urlWithParam_:this.backupUrlWithParam_;if(!ea(this.signalInfo_)&&n.indexOf("&rc=1")===-1){var i=this.client_.getRoomId(),o=this.client_.getUseStringRoomId();n+="&rc=1&relayInnerIp=".concat(this.signalInfo_.relayInnerIp,"&relayOuterIp=").concat(this.signalInfo_.relayIp,"&relayPort=").concat(this.signalInfo_.relayPort,"&roomId=").concat(i,"&useStringRoomId=").concat(o)}return n}},{key:"send",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isConnected_){var i={cmd:t,data:n,userId:this.userId_,tinyId:this.signalInfo_.tinyId,seq:++this.seq_};return this.socketInUse_.send(JSON.stringify(i)),i.seq}}},{key:"sendWaitForResponse",value:function(t){var n=this,i=t.command,o=t.data,c=t.timeout,a=c===void 0?5e3:c,u=t.responseCommand,l=t.commandDesc,h=t.enableLog,f=h===void 0||h;return new Promise(function(m,g){var v=setTimeout(function(){n.off(u,I);var y=new Y({code:Q.API_CALL_TIMEOUT,message:Z({key:VA,data:{commandDesc:l,command:i}})});f&&n.log_.warn(y),g(y)},a),I=function y(E){E.data.seq===S&&(clearTimeout(v),n.off(u,y),m(E))};n.on(u,I);var S=n.send(i,o)})}},{key:"sendWaitForResponseWithRetry",value:function(){var t=this,n=arguments.length<=0?void 0:arguments[0],i=n.commandDesc,o=n.retries,c=o===void 0?0:o,a=n.retryTimeout,u=a===void 0?0:a;return Xo({retryFunction:this.sendWaitForResponse,onRetrying:function(l){t.log_.warn("".concat(i," timeout observed, retrying [").concat(l,"/").concat(c,"]"))},settings:{retries:c,timeout:u},context:this}).apply(void 0,arguments)}},{key:"getCurrentState",value:function(){return this.currentState_}},{key:"getSignalInfo",value:function(){return this.signalInfo_}},{key:"stopReconnection",value:function(){this.isReconnecting_&&(this.reconnectionCount_=0,this.clearReconnectionTimer())}},{key:"close",value:function(){this.log_.info("close SignalChannel"),this.clearBackupTimer(),this.stopReconnection(),this.isConnecting_=!1,this.isConnected_=!1,this.socketInUse_=null,this.unbindAndCloseSocket(Et),this.unbindAndCloseSocket(zi),this.emitConnectionStateChanged(wu)}},{key:"on",value:function(t,n,i){this.emitter_.on(t,n,i)}},{key:"removeListener",value:function(t,n,i){this.emitter_.removeListener(t,n,i)}},{key:"once",value:function(t,n,i){this.emitter_.once(t,n,i)}},{key:"off",value:function(t,n,i){this.emitter_.off(t,n,i)}},{key:"emitConnectionStateChanged",value:function(t){t!==this.currentState_&&(this.emitter_.emit(Bf,{prevState:this.currentState_,state:t}),this.currentState_=t)}}]),e}(),aD=Cn.find,kb=!0;"find"in[]&&Array(1).find(function(){kb=!1}),Me({target:"Array",proto:!0,forced:kb},{find:function(e){return aD(this,e,arguments.length>1?arguments[1]:void 0)}}),Io("find");var Vt=Ie(function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(n){return n.encoding?"rtpmap:%d %s/%s/%s":n.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(n){return n.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(n){return n.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(n){return"extmap:%d"+(n.direction?"/%s":"%v")+(n["encrypt-uri"]?" %s":"%v")+" %s"+(n.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(n){return n.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(n){var i="candidate:%s %d %s %d %s %d typ %s";return i+=n.raddr!=null?" raddr %s rport %d":"%v%v",i+=n.tcptype!=null?" tcptype %s":"%v",n.generation!=null&&(i+=" generation %d"),i+=n["network-id"]!=null?" network-id %d":"%v",i+=n["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(n){var i="ssrc:%d";return n.attribute!=null&&(i+=" %s",n.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(n){return n.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(n){return n.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(n){return"imageattr:%s %s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(n){return"simulcast:%s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(n){return"ts-refclk:%s"+(n.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(n){var i="mediaclk:";return i+=n.id!=null?"id=%s %s":"%v%s",i+=n.mediaClockValue!=null?"=%s":"",i+=n.rateNumerator!=null?" rate=%s":"",i+=n.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(n){t[n].forEach(function(i){i.reg||(i.reg=/(.*)/),i.format||(i.format="%s")})})}),vn=(Vt.v,Vt.o,Vt.s,Vt.i,Vt.u,Vt.e,Vt.p,Vt.z,Vt.r,Vt.t,Vt.c,Vt.b,Vt.m,Vt.a,Ie(function(e,t){var n=function(a){return String(Number(a))===a?Number(a):a},i=function(a,u,l){var h=a.name&&a.names;a.push&&!u[a.push]?u[a.push]=[]:h&&!u[a.name]&&(u[a.name]={});var f=a.push?{}:h?u[a.name]:u;(function(m,g,v,I){if(I&&!v)g[I]=n(m[1]);else for(var S=0;S<v.length;S+=1)m[S+1]!=null&&(g[v[S]]=n(m[S+1]))})(l.match(a.reg),f,a.names,a.name),a.push&&u[a.push].push(f)},o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var u={},l=[],h=u;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(f){var m=f[0],g=f.slice(2);m==="m"&&(l.push({rtp:[],fmtp:[]}),h=l[l.length-1]);for(var v=0;v<(Vt[m]||[]).length;v+=1){var I=Vt[m][v];if(I.reg.test(g))return i(I,h,g)}}),u.media=l,u};var c=function(a,u){var l=u.split(/=(.+)/,2);return l.length===2?a[l[0]]=n(l[1]):l.length===1&&u.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(c,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var u=[],l=a.split(" ").map(n),h=0;h<l.length;h+=3)u.push({component:l[h],ip:l[h+1],port:l[h+2]});return u},t.parseImageAttributes=function(a){return a.split(" ").map(function(u){return u.substring(1,u.length-1).split(",").reduce(c,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(u){return u.split(",").map(function(l){var h,f=!1;return l[0]!=="~"?h=n(l):(h=n(l.substring(1,l.length)),f=!0),{scid:h,paused:f}})})}})),sD=(vn.parse,vn.parseParams,vn.parseFmtpConfig,vn.parsePayloads,vn.parseRemoteCandidates,vn.parseImageAttributes,vn.parseSimulcastStreamList,/%[sdv%]/g),cD=function(e){var t=1,n=arguments,i=n.length;return e.replace(sD,function(o){if(t>=i)return o;var c=n[t];switch(t+=1,o){case"%%":return"%";case"%s":return String(c);case"%d":return Number(c);case"%v":return""}})},As=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var c=t.names[o];t.name?i.push(n[t.name][c]):i.push(n[t.names[o]])}else i.push(n[t.name]);return cD.apply(null,i)},uD=["v","o","s","i","u","e","p","c","b","t","r","z","a"],lD=["i","c","b","a"],Wf={write:function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(c){c.payloads==null&&(c.payloads="")});var n=t.outerOrder||uD,i=t.innerOrder||lD,o=[];return n.forEach(function(c){Vt[c].forEach(function(a){a.name in e&&e[a.name]!=null?o.push(As(c,a,e)):a.push in e&&e[a.push]!=null&&e[a.push].forEach(function(u){o.push(As(c,a,u))})})}),e.media.forEach(function(c){o.push(As("m",Vt.m[0],c)),i.forEach(function(a){Vt[a].forEach(function(u){u.name in c&&c[u.name]!=null?o.push(As(a,u,c)):u.push in c&&c[u.push]!=null&&c[u.push].forEach(function(l){o.push(As(a,u,l))})})})}),o.join(`\r
`)+`\r
`},parse:vn.parse,parseParams:vn.parseParams,parseFmtpConfig:vn.parseFmtpConfig,parsePayloads:vn.parsePayloads,parseRemoteCandidates:vn.parseRemoteCandidates,parseImageAttributes:vn.parseImageAttributes,parseSimulcastStreamList:vn.parseSimulcastStreamList},Lr=function(e){return Wf.parse(e)},ta=function(e){return Wf.write(e)},dD=function(e){var t=Lr(e);return t.media.forEach(function(n){n.type===Pe&&n.fmtp.forEach(function(i){i.config+=";sprop-stereo=1;stereo=1"})}),ta(t)};function hD(e){var t=Lr(e);return t.media.forEach(function(n){if(n.type===Ue){var i=new Set;n.rtp.forEach(function(c){var a=c.payload;return c.codec==="H264"&&i.add(a)}),n.fmtp.forEach(function(c){var a=c.payload,u=c.config.match(/apt=(\d+)/);u&&u[1]&&i.has(Number(u[1]))&&i.add(a)});var o=function(c){var a=c.payload;return!i.has(a)};n.rtp=n.rtp.filter(o),n.rtcpFb=n.rtcpFb.filter(o),n.fmtp=n.fmtp.filter(o),n.payloads=n.payloads.split(" ").filter(function(c){return!i.has(Number(c))}).join(" ")}}),ta(t)}var Ib=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return(e=="x"?t:3&t|8).toString(16)})},zt=new(function(){function e(){w(this,e),this.intervalMap_=new Map}return P(e,[{key:"setInterval",value:function(t){function n(i,o){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}(function(t,n){var i=this,o=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(!window||!window.requestAnimationFrame)return setInterval(t,n);var c=Ib(),a=qt(),u=a;this.intervalMap_.set(c,{rafId:null,timeoutId:null,onVisibilityChange:null});var l=function m(){if(o&&document.hidden){if(t(),!i.intervalMap_.has(c))return;var g=setTimeout(m,n);i.setTimeoutId(c,g),a=qt(),u=a}else{if((u=qt())-a>=n&&(a=u,t(),!i.intervalMap_.has(c)))return;var v=requestAnimationFrame(m);i.setRafId(c,v)}},h=requestAnimationFrame(l);if(this.setRafId(c,h),o){var f=function(){if(document.hidden){var m=qt()-a;if(m>=n)l();else{var g=setTimeout(l,n-m);i.setTimeoutId(c,g)}}};document.addEventListener("visibilitychange",f),this.setOnVisibilityChange(c,f),document.hidden&&f()}return c})},{key:"clearInterval",value:function(t){if(this.intervalMap_.has(t)){var n=this.intervalMap_.get(t),i=n.rafId,o=n.timeoutId,c=n.onVisibilityChange;cancelAnimationFrame(i),clearTimeout(o),document.removeEventListener("visibilitychange",c),this.intervalMap_.delete(t)}}},{key:"setTimeoutId",value:function(t,n){if(this.intervalMap_.has(t)){var i=this.intervalMap_.get(t);i.timeoutId&&clearTimeout(i.timeoutId),i.timeoutId=n}}},{key:"setRafId",value:function(t,n){if(this.intervalMap_.has(t)){var i=this.intervalMap_.get(t);i.rafId&&cancelAnimationFrame(i.rafId),i.rafId=n}}},{key:"setOnVisibilityChange",value:function(t,n){this.intervalMap_.has(t)&&(this.intervalMap_.get(t).onVisibilityChange=n)}}]),e}()),na=new(function(){function e(){w(this,e),this.prefix_="TRTC",this.queue_=new Map,this.intervalId_=zt.setInterval(this.doFlush.bind(this),2e4),this.checkStorage()}return P(e,[{key:"getRealKey",value:function(t){return"".concat(this.prefix_,"_").concat(t)}},{key:"checkStorage",value:function(){var t=this;Hi()&&Object.keys(localStorage).filter(function(n){if(n.startsWith(t.prefix_)){var i=JSON.parse(localStorage.getItem(n));if(i&&i.expiresIn<Date.now())return!0}return!1}).forEach(function(n){return localStorage.removeItem(n)})}},{key:"doFlush",value:function(){if(Hi())try{var t,n=Ge(this.queue_);try{for(n.s();!(t=n.n()).done;){var i=Xe(t.value,2),o=i[0],c=i[1];localStorage.setItem(o,JSON.stringify(c))}}catch(a){n.e(a)}finally{n.f()}}catch(a){ye.warn(a)}}},{key:"getItem",value:function(t){if(!Hi())return null;try{var n=JSON.parse(localStorage.getItem(this.getRealKey(t)));return n&&n.expiresIn>=Date.now()?n.value:null}catch(i){ye.warn(i)}}},{key:"setItem",value:function(t,n){if(Hi())try{var i={expiresIn:Date.now()+6048e5,value:n};this.queue_.set(this.getRealKey(t),i)}catch(o){ye.warn(o)}}},{key:"deleteItem",value:function(t){if(!Hi())return!1;try{return t=this.getRealKey(t),this.queue_.delete(t),localStorage.removeItem(t),!0}catch(n){return ye.warn(n),!1}}},{key:"clear",value:function(){if(Hi())try{localStorage.clear()}catch(t){ye.warn(t)}}}]),e}()),pt={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isMediaDevicesSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1}},Tb=function(){return!FR&&!eu&&!(tu&&Iy<80)&&!(Rr&&ky<56)},Gf=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter(function(e){return e in window}).length>0},fD=function(){if(!navigator.mediaDevices)return!1;var e=["getUserMedia","enumerateDevices"];return e.filter(function(t){return t in navigator.mediaDevices}).length===e.length},pD=function(){var e=b(regeneratorRuntime.mark(function t(){var n,i,o,c,a,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!pt.detail.isH264EncodeSupported&&!pt.detail.isVp8EncodeSupported){l.next=2;break}return l.abrupt("return",{isH264EncodeSupported:pt.detail.isH264EncodeSupported,isVp8EncodeSupported:pt.detail.isVp8EncodeSupported});case 2:return n="",i=!1,o=!1,l.prev=5,c=new RTCPeerConnection,(a=document.createElement("canvas")).getContext("2d"),u=a.captureStream(0),c.addTrack(u.getVideoTracks()[0],u),l.next=13,c.createOffer();case 13:return(n=l.sent).sdp.toLowerCase().indexOf("h264")!==-1&&(i=!0),n.sdp.toLowerCase().indexOf("vp8")!==-1&&(o=!0),c.close(),pt.detail.isH264EncodeSupported=i,pt.detail.isVp8EncodeSupported=o,l.abrupt("return",{isH264EncodeSupported:pt.detail.isH264EncodeSupported,isVp8EncodeSupported:pt.detail.isVp8EncodeSupported});case 22:return l.prev=22,l.t0=l.catch(5),l.abrupt("return",{isH264EncodeSupported:!1,isVp8EncodeSupported:!1});case 25:case"end":return l.stop()}},t,null,[[5,22]])}));return function(){return e.apply(this,arguments)}}();function mD(){return wb.apply(this,arguments)}function wb(){return(wb=b(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var n=b(regeneratorRuntime.mark(function i(o){var c,a,u,l,h,f,m,g,v,I,S,y,E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return c={encode:!1,decode:!1},a=null,x.prev=2,u=document.createElement("canvas"),l=u.getContext("2d"),u.width=640,u.height=480,h=setInterval(function(){l.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))},33),f=-1,m=-1,a=function(){clearInterval(f),clearInterval(h),clearTimeout(m),v.close(),I.close(),g.getTracks().forEach(function(U){return U.stop()})},m=setTimeout(function(){a(),o(c)},3e3),g=u.captureStream(),v=new RTCPeerConnection({}),I=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0}),v.addEventListener("icecandidate",function(U){return I.addIceCandidate(U.candidate)}),I.addEventListener("icecandidate",function(U){return v.addIceCandidate(U.candidate)}),v.addTrack(g.getVideoTracks()[0],g),x.next=20,v.createOffer();case 20:return S=x.sent,x.next=23,v.setLocalDescription(S);case 23:return x.next=25,I.setRemoteDescription(S);case 25:return x.next=27,I.createAnswer();case 27:return y=x.sent,E=Lr(y.sdp),C=E.media[0].rtp.findIndex(function(U){return U.codec==="H264"}),E.media[0].rtp=[E.media[0].rtp[C]],E.media[0].fmtp=E.media[0].fmtp.filter(function(U){return U.payload===E.media[0].rtp[0].payload}),E.media[0].rtcpFb=E.media[0].rtcpFb.filter(function(U){return U.payload===E.media[0].rtp[0].payload}),y.sdp=ta(E),x.next=36,I.setLocalDescription(y);case 36:return x.next=38,v.setRemoteDescription(y);case 38:f=setInterval(b(regeneratorRuntime.mark(function U(){var G,H;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return c.encode&&c.decode&&(a(),o(c)),V.next=3,v.getStats();case 3:return G=V.sent,V.next=6,I.getStats();case 6:H=V.sent,c.encode||G.forEach(function(j){j.type==="outbound-rtp"&&j.mediaType===Ue&&j.framesEncoded>0&&(c.encode=!0)}),c.decode||H.forEach(function(j){j.type==="inbound-rtp"&&j.mediaType===Ue&&j.framesDecoded>0&&(c.decode=!0)});case 9:case"end":return V.stop()}},U)})),500),x.next=46;break;case 41:x.prev=41,x.t0=x.catch(2),a(),ye.warn(x.t0),o(c);case 46:case"end":return x.stop()}},i,null,[[2,41]])}));return function(i){return n.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},e)}))).apply(this,arguments)}var Eb=function(){var e=b(regeneratorRuntime.mark(function t(){var n,i,o,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!pt.detail.isH264DecodeSupported&&!pt.detail.isVp8DecodeSupported){a.next=2;break}return a.abrupt("return",{isH264DecodeSupported:pt.detail.isH264DecodeSupported,isVp8DecodeSupported:pt.detail.isVp8DecodeSupported});case 2:return n="",i=!1,o=!1,a.prev=5,c=new RTCPeerConnection,a.next=9,c.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1});case 9:return(n=a.sent).sdp.toLowerCase().indexOf("h264")!==-1&&(i=!0),n.sdp.toLowerCase().indexOf("vp8")!==-1&&(o=!0),c.close(),a.abrupt("return",{isH264DecodeSupported:i,isVp8DecodeSupported:o});case 16:return a.prev=16,a.t0=a.catch(5),a.abrupt("return",{isH264DecodeSupported:!1,isVp8DecodeSupported:!1});case 19:case"end":return a.stop()}},t,null,[[5,16]])}));return function(){return e.apply(this,arguments)}}(),Jf=function(e,t){var n=null;return function(){if(n)return n;for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(n=e.apply(t||this,o)).then(function(a){return n=null,a}).catch(function(a){throw n=null,a}),n}}(function(){var e=b(regeneratorRuntime.mark(function t(){var n,i,o,c,a,u,l,h,f,m,g,v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!pt.result){I.next=2;break}return I.abrupt("return",pt);case 2:return n=Tb(),i=Gf(),o=fD(),I.next=7,pD();case 7:return c=I.sent,a=c.isH264EncodeSupported,u=c.isVp8EncodeSupported,I.next=12,Eb();case 12:if(l=I.sent,h=l.isH264DecodeSupported,f=l.isVp8DecodeSupported,!(a&&h&&(nu||ru||qR)&&!Ar&&iu()<79)){I.next=23;break}return I.next=18,mD();case 18:m=I.sent,g=m.encode,v=m.decode,a=g,h=v;case 23:return pt.result=n&&i&&o&&(a||u)&&(h||f),pt.detail.isBrowserSupported=n,pt.detail.isWebRTCSupported=i,pt.detail.isMediaDevicesSupported=o,pt.detail.isH264EncodeSupported=a,pt.detail.isVp8EncodeSupported=u,pt.detail.isH264DecodeSupported=h,pt.detail.isVp8DecodeSupported=f,gD(),na.setItem("checkResult",{ua:navigator.userAgent,checkResult:pt}),I.abrupt("return",pt);case 34:case"end":return I.stop()}},t)}));return function(){return e.apply(this,arguments)}}());function gD(){Object.keys(pt.detail).findIndex(function(e){return!pt.detail[e]})>=0&&(ye.warn(Z({key:v0})),ye.info("".concat(navigator.userAgent," ").concat(JSON.stringify(pt.detail))))}var Cb=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},Rb=function(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype},Cu=function(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype},Ab=function(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype},vD=function(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype},xb=function(){return"RTCRtpSender"in window&&"replaceTrack"in window.RTCRtpSender.prototype},qf=function(){return"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype&&Cu()},ra=function(){return!!fe(navigator.mediaDevices)&&(ye.error(di.NOT_SUPPORTED_MEDIA),!0)},ia=function(){return location.protocol==="http:"&&!Ho&&(ye.warn(Z({key:g0})),!0)},Kf="RTCRtpSender"in window&&"createEncodedStreams"in window.RTCRtpSender.prototype&&iu()>=86,Qf=function(e){return!(e.type!=="candidate-pair"||!e.nominated||e.state!=="in-progress"&&e.state!=="succeeded")&&!(w0(e.selected)&&!e.selected)},Pb=new Map([[Bi,"Android"],[jo,"iOS"],[wy,"Windows"],[Ey,"MacOS"],[Cy,"Linux"]]),Yf=function(){var e="unknown";return Pb.get(!0)&&(e=Pb.get(!0)),e};function _D(){var e="";return screen.width&&(e+=(screen.width?screen.width*window.devicePixelRatio:"")+" * "+(screen.height?screen.height*window.devicePixelRatio:"")),e}function yD(){var e=!1;return(navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)&&(e=!0),e}function bD(){for(var e={isSupported:!1},t=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"],n=0;n<t.length;n++)if(t[n]in window){e.isSupported=!0;break}return e.isSupported}function Db(){return!wh&&!jo&&!(!Tb()||!("captureStream"in HTMLCanvasElement.prototype))}var oa=window.MediaStreamTrack&&"getSettings"in MediaStreamTrack.prototype,SD=window.MediaStreamTrack&&"getCapabilities"in MediaStreamTrack.prototype;(function(){ia();var e=na.getItem("checkResult");e&&e.ua===navigator.userAgent&&(pt=e.checkResult),Jf()})();var it={STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",STREAM_UPDATED:"stream-updated",STREAM_PUBLISHED:"stream-published",STREAM_SUBSCRIBED:"stream-subscribed",STREAM_UNSUBSCRIBED:"stream-unsubscribed",STATE_CHANGED:"state-changed",ERROR:"error",CONNECTION_STATE_CHANGED:"connection-state-changed",SEI_MESSAGE:Py},dt={STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",STREAM_UPDATED:"stream-updated",STREAM_SUBSCRIBED:"stream-subscribed",CONNECTION_STATE_CHANGED:"connection-state-changed",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",MUTE_AUDIO:"mute-audio",MUTE_VIDEO:"mute-video",UNMUTE_AUDIO:"unmute-audio",UNMUTE_VIDEO:"unmute-video",CLIENT_BANNED:"client-banned",NETWORK_QUALITY:"network-quality",AUDIO_VOLUME:"audio-volume",SEI_MESSAGE:Py,ERROR:"error"},Ob="player-state-changed",kD="screen-sharing-stopped",ID="connection-state-changed",TD="device-auto-recovered",Xf="error",_n="player-state-changed",wD=function(){function e(c){w(this,e);var a=c.getUserId();this.log_=ye.createLogger({id:a,userId:a,sdkAppId:c.getSDKAppId()}),this.prevReport_={},this.prevEncoderImplementation_="",this.prevQualityLimitationReason_="",this.prevDecoderImplementationMap_=new Map}var t,n,i,o;return P(e,[{key:"getSenderStats",value:(o=b(regeneratorRuntime.mark(function c(a){var u,l,h,f=this;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(u={audio:{bytesSent:0,packetsSent:0,audioLevel:0,totalAudioEnergy:0},video:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0,smallFramesEncoded:0,smallFPSCapture:0,smallFramesSent:0},rtt:0},l=a.getPeerConnection(),h=a.getSSRC(),!l){m.next=14;break}return m.prev=4,m.next=7,l.getStats();case 7:m.sent.forEach(function(g){if(g.type==="outbound-rtp")if(g.mediaType===Ue){if(!Rr&&fe(g.trackId))return;g.ssrc!==h.video||fe(g.encoderImplementation)||f.prevEncoderImplementation_===g.encoderImplementation||(f.log_.info("encoderImplementation change to ".concat(g.encoderImplementation)),f.prevEncoderImplementation_=g.encoderImplementation),g.ssrc!==h.video||fe(g.qualityLimitationReason)||f.prevQualityLimitationReason_===g.qualityLimitationReason||(f.log_.info("qualityLimitationReason change to ".concat(g.qualityLimitationReason)),f.prevQualityLimitationReason_=g.qualityLimitationReason);var v=a.getSSRC();g.ssrc===v.video?(u.video.bytesSent=g.bytesSent,u.video.packetsSent=g.packetsSent,u.video.framesEncoded=g.framesEncoded):(u.video.smallBytesSent=g.bytesSent,u.video.smallFramesEncoded=g.framesEncoded)}else g.mediaType===Pe&&(u.audio.bytesSent=g.bytesSent,u.audio.packetsSent=g.packetsSent);else if(g.type==="candidate-pair")Qf(g)&&xr(g.currentRoundTripTime)&&(u.rtt=Math.floor(1e3*g.currentRoundTripTime));else if(g.type==="track")if(fe(g.frameWidth)||(g.trackIdentifier===a.getLocalStreamVideoTrackId()?(u.video.frameWidth=g.frameWidth,u.video.frameHeight=g.frameHeight,u.video.framesSent=g.framesSent):(u.video.smallFrameWidth=g.frameWidth,u.video.smallFrameHeight=g.frameHeight,u.video.smallFramesSent=g.framesSent)),fe(g.audioLevel)){if(Bo){var I;u.audio.audioLevel=((I=a.getLocalStream())===null||I===void 0?void 0:I.getInternalAudioLevel())||0}}else u.audio.audioLevel=g.audioLevel||0;else g.type==="media-source"&&(g.kind===Pe?(u.audio.audioLevel=g.audioLevel||0,u.audio.totalAudioEnergy=g.totalAudioEnergy||0):g.kind===Ue&&(g.trackIdentifier===a.getLocalStreamVideoTrackId()?u.video.fpsCapture=g.framesPerSecond:u.video.smallFPSCapture=g.framesPerSecond))}),m.next=14;break;case 11:m.prev=11,m.t0=m.catch(4),this.log_.warn("failed to getStats on sender connection");case 14:return m.abrupt("return",u);case 15:case"end":return m.stop()}},c,this,[[4,11]])})),function(c){return o.apply(this,arguments)})},{key:"getReceiverStats",value:(i=b(regeneratorRuntime.mark(function c(a){var u,l,h=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(u={tinyId:a.getTinyId(),userId:a.getUserId(),rtt:0,hasAudio:!1,hasVideo:!1,hasAuxiliary:!1,audio:{bytesReceived:0,packetsReceived:0,packetsLost:0,jitter:0,audioLevel:0,totalAudioEnergy:0},video:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0},auxiliary:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0}},!(l=a.getPeerConnection())){f.next=13;break}return f.prev=3,f.next=6,l.getStats();case 6:f.sent.forEach(function(m){if(m.type==="inbound-rtp"){if(m.mediaType===Pe)u.audio.packetsReceived=m.packetsReceived,u.audio.bytesReceived=m.bytesReceived,u.audio.packetsLost=m.packetsLost,u.audio.jitter=m.jitter,u.hasAudio=!0;else if(m.mediaType===Ue){if(Rr&&m.bytesReceived===0)return;var g=a.getSSRC();m.ssrc===g.video&&(u.video.packetsReceived=m.packetsReceived,u.video.bytesReceived=m.bytesReceived,u.video.packetsLost=m.packetsLost,u.video.framesReceived=m.framesReceived,u.video.framesDecoded=m.framesDecoded,u.video.fpsDecoded=m.framesPerSecond,u.hasVideo=!0,!m.decoderImplementation||h.prevDecoderImplementationMap_.has(u.userId)&&h.prevDecoderImplementationMap_.get(u.userId)===m.decoderImplementation||(ye.info("[".concat(u.userId,"] decoderImplementation change to ").concat(m.decoderImplementation)),h.prevDecoderImplementationMap_.set(u.userId,m.decoderImplementation))),m.ssrc===g.auxiliary&&(u.auxiliary.packetsReceived=m.packetsReceived,u.auxiliary.bytesReceived=m.bytesReceived,u.auxiliary.packetsLost=m.packetsLost,u.auxiliary.framesReceived=m.framesReceived,u.auxiliary.framesDecoded=m.framesDecoded,u.auxiliary.fpsDecoded=m.framesPerSecond,u.hasAuxiliary=!0)}}else m.type==="track"?(fe(m.frameWidth)||(m.trackIdentifier===a.getMainStreamVideoTrackId()&&(u.video.frameWidth=m.frameWidth,u.video.frameHeight=m.frameHeight),m.trackIdentifier===a.getAuxStreamVideoTrackId()&&(u.auxiliary.frameWidth=m.frameWidth,u.auxiliary.frameHeight=m.frameHeight)),fe(m.audioLevel)||(u.audio.audioLevel=m.audioLevel||0,u.audio.totalAudioEnergy=m.totalAudioEnergy||0)):m.type==="candidate-pair"&&Qf(m)&&xr(m.currentRoundTripTime)&&(u.rtt=Math.floor(1e3*m.currentRoundTripTime))}),f.next=13;break;case 10:f.prev=10,f.t0=f.catch(3),this.log_.warn("failed to getStats on receiver connection");case 13:return f.abrupt("return",u);case 14:case"end":return f.stop()}},c,this,[[3,10]])})),function(c){return i.apply(this,arguments)})},{key:"getStats",value:(n=b(regeneratorRuntime.mark(function c(a,u){var l,h,f,m,g,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(l={},!a){S.next=5;break}return S.next=4,this.getSenderStats(a);case 4:l=S.sent;case 5:h=[],f=Ge(u),S.prev=7,f.s();case 9:if((m=f.n()).done){S.next=17;break}return(g=Xe(m.value,2))[0],v=g[1],S.next=13,this.getReceiverStats(v);case 13:I=S.sent,h.push(I);case 15:S.next=9;break;case 17:S.next=22;break;case 19:S.prev=19,S.t0=S.catch(7),f.e(S.t0);case 22:return S.prev=22,f.f(),S.finish(22);case 25:return S.abrupt("return",{senderStats:l,receiverStats:h});case 26:case"end":return S.stop()}},c,this,[[7,19,22,25]])})),function(c,a){return n.apply(this,arguments)})},{key:"getDifferenceValue",value:function(c,a){if(ea(c))return a;var u=a-c;return u<0?0:u}},{key:"prepareReport",value:function(c){var a=this,u=c.stats,l=c.report,h=c.freezeMap;if(!ea(u.senderStats)){var f={uint32_audio_level:1e8*u.senderStats.audio.audioLevel,uint32_audio_energy:1e6*u.senderStats.audio.totalAudioEnergy,uint32_audio_codec_bitrate:u.senderStats.audio.bytesSent,audioLevel:u.senderStats.audio.audioLevel},m=[],g={uint32_video_stream_type:2,uint32_video_codec_fps:u.senderStats.video.framesSent,uint32_video_capture_fps:u.senderStats.video.fpsCapture,uint32_video_width:u.senderStats.video.frameWidth,uint32_video_height:u.senderStats.video.frameHeight,uint32_video_codec_bitrate:u.senderStats.video.bytesSent,uint32_video_enc_fps:u.senderStats.video.framesEncoded};if(m.push(g),u.senderStats.video.smallBytesSent){var v={uint32_video_stream_type:3,uint32_video_codec_fps:u.senderStats.video.smallFramesSent||0,uint32_video_capture_fps:u.senderStats.video.smallFPSCapture||0,uint32_video_width:u.senderStats.video.smallFrameWidth||0,uint32_video_height:u.senderStats.video.smallFrameHeight||0,uint32_video_codec_bitrate:u.senderStats.video.smallBytesSent,uint32_video_enc_fps:u.senderStats.video.smallFramesEncoded||0};m.push(v)}var I={uint32_bitrate:"",uint32_rtt:u.senderStats.rtt};l.msg_up_stream_info={msg_audio_status:f,msg_video_status:m,msg_network_status:I}}l.msg_down_stream_info=[],u.receiverStats.forEach(function(H){var V={};if(V.msg_user_info={str_identifier:H.userId,uint64_tinyid:H.tinyId},V.msg_network_status={uint32_rtt:H.rtt},V.msg_video_status={},H.hasAudio){var j={uint32_audio_codec_bitrate:H.audio.bytesReceived,uint32_audio_total_bitrate:H.audio.bytesReceived,uint32_audio_level:1e8*H.audio.audioLevel,uint32_audio_energy:1e6*H.audio.totalAudioEnergy,uint32_audio_receive:H.audio.packetsReceived,uint32_audio_origin_lost:H.audio.packetsLost,audioLevel:H.audio.audioLevel};V.msg_audio_status=j}if(V.msg_video_status=[],H.hasVideo){var q=h.get(H.userId+"_"+St),K=q?q.duration:0,De={uint32_video_stream_type:2,uint32_video_receive_fps:H.video.framesReceived,uint32_video_width:H.video.frameWidth,uint32_video_height:H.video.frameHeight,uint32_video_codec_bitrate:H.video.bytesReceived,uint32_video_receive:H.video.packetsReceived,uint32_video_origin_lost:H.video.packetsLost,uint32_video_block_time:K,uint32_video_dec_fps:H.video.fpsDecoded};V.msg_video_status.push(De)}if(H.hasAuxiliary){var R=h.get(H.userId+"_"+Nt),T=R?R.duration:0,D={uint32_video_stream_type:7,uint32_video_receive_fps:H.auxiliary.framesReceived,uint32_video_width:H.auxiliary.frameWidth,uint32_video_height:H.auxiliary.frameHeight,uint32_video_codec_bitrate:H.auxiliary.bytesReceived,uint32_video_receive:H.auxiliary.packetsReceived+H.auxiliary.packetsLost,uint32_video_origin_lost:H.auxiliary.packetsLost,uint32_video_block_time:T,uint32_video_dec_fps:H.auxiliary.fpsDecoded};V.msg_video_status.push(D)}l.msg_down_stream_info.push(V)});var S=this.prevReport_;this.prevReport_=JSON.parse(JSON.stringify(l));var y=S.msg_up_stream_info.msg_audio_status,E=l.msg_up_stream_info.msg_audio_status,C=this.getDifferenceValue(y.uint32_audio_codec_bitrate,E.uint32_audio_codec_bitrate);E.uint32_audio_codec_bitrate=8*C/2;var x=S.msg_up_stream_info.msg_video_status;l.msg_up_stream_info.msg_video_status.forEach(function(H,V){var j=x[V],q=0,K=0,De=0;j&&(q=j.uint32_video_codec_bitrate,K=j.uint32_video_enc_fps,De=j.uint32_video_codec_fps);var R=a.getDifferenceValue(q,H.uint32_video_codec_bitrate);H.uint32_video_codec_bitrate=8*R/2,H.uint32_video_enc_fps=a.getDifferenceValue(K,H.uint32_video_enc_fps)/2,H.uint32_video_codec_fps=a.getDifferenceValue(De,H.uint32_video_codec_fps)/2});var U=l.msg_down_stream_info,G=S.msg_down_stream_info;return U.forEach(function(H){var V=G.find(function(T){return T.msg_user_info.uint64_tinyid===H.msg_user_info.uint64_tinyid});if(V){if(H.msg_audio_status&&V.msg_audio_status){var j=H.msg_audio_status,q=V.msg_audio_status;j.uint32_audio_origin_lost=a.getDifferenceValue(q.uint32_audio_origin_lost,j.uint32_audio_origin_lost),j.uint32_audio_receive=a.getDifferenceValue(q.uint32_audio_receive,j.uint32_audio_receive),j.uint32_audio_receive+=j.uint32_audio_origin_lost;var K=a.getDifferenceValue(q.uint32_audio_codec_bitrate,j.uint32_audio_codec_bitrate);j.uint32_audio_codec_bitrate=8*K/2,j.uint32_audio_total_bitrate=8*K/2}if(H.msg_video_status&&V.msg_video_status){var De=H.msg_video_status,R=V.msg_video_status;De.forEach(function(T,D){var O=R[D],M=0,F=0,re=0,pe=0;O&&(M=O.uint32_video_receive,F=O.uint32_video_origin_lost,re=O.uint32_video_codec_bitrate,pe=O.uint32_video_receive_fps),T.uint32_video_origin_lost=a.getDifferenceValue(F,T.uint32_video_origin_lost),T.uint32_video_receive=a.getDifferenceValue(M,T.uint32_video_receive)+T.uint32_video_origin_lost;var ve=a.getDifferenceValue(re,T.uint32_video_codec_bitrate);T.uint32_video_codec_bitrate=8*ve/2;var se=a.getDifferenceValue(pe,T.uint32_video_receive_fps);T.uint32_video_receive_fps=se/2})}}}),l.msg_up_stream_info.msg_network_status.uint32_bitrate=l.msg_up_stream_info.msg_audio_status.uint32_audio_codec_bitrate+l.msg_up_stream_info.msg_video_status[0].uint32_video_codec_bitrate,l}},{key:"getStatsReport",value:(t=b(regeneratorRuntime.mark(function c(a){var u,l,h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=a.uplinkConnection,l=a.downlinkConnections,h=a.freezeMap,f={msg_up_stream_info:{msg_audio_status:{uint32_audio_format:0,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_level:0,uint32_audio_energy:0,audioLevel:0},msg_video_status:[{uint32_video_stream_type:0,uint32_video_codec_fps:0,uint32_video_capture_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_codec_bitrate:0,uint32_video_receive:0,uint32_video_origin_lost:0,uint32_video_final_lost:0,uint32_video_enc_fps:0}],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0},msg_qos:[{uint32_video_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_bitrate:0,uint32_audio_bitrate:0,uint32_video_stream_type:0}]},msg_down_stream_info:[{msg_user_info:{str_identifier:"",uint64_tinyid:""},msg_audio_status:{uint32_audio_format:0,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_total_bitrate:0,uint32_audio_level:0,uint32_audio_energy:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_final_lost:0,audioLevel:0},msg_video_status:[{uint32_video_stream_type:0,uint32_video_receive_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_codec_bitrate:0,uint32_video_receive:0,uint32_video_origin_lost:0,uint32_video_block_time:0,uint32_video_dec_fps:0}],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0,uint32_jitter:0},msg_qos:[{uint32_video_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_bitrate:0,uint32_audio_bitrate:0,uint32_video_stream_type:0}]}]},JSON.stringify(this.prevReport_)==="{}"&&(this.prevReport_=JSON.parse(JSON.stringify(f))),g.next=5,this.getStats(u,l);case 5:return m=g.sent,this.prepareReport({stats:m,report:f,freezeMap:h}),g.abrupt("return",f);case 8:case"end":return g.stop()}},c,this)})),function(c){return t.apply(this,arguments)})}]),e}(),ED=function(){function e(i){var o=i.signalChannel,c=i.connections,a=i.client;w(this,e),this.client_=a,this.signalChannel_=o,this.connections_=c,this.client_=a,this.log_=ye.createLogger({id:"q|"+this.client_.getUserId(),userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId()}),this.uplinkConnection_=null,this.uplinkNetworkQuality_=0,this.uplinkRTT_=0,this.uplinkLoss_=0,this.downlinkNetworkQuality_=0,this.downlinkRTT_=0,this.downlinkLoss_=0,this.downlinkPrevStatMap_=new Map,this.downlinkLossAndRTTMap_=new Map,this.interval_=-1,this.emitter_=new mi,this.initialize()}var t,n;return P(e,[{key:"uplinkNetworkQuality",get:function(){return this.uplinkNetworkQuality_},set:function(i){i!==this.uplinkNetworkQuality_&&this.log_.info("uplink network quality change ".concat(this.uplinkNetworkQuality," -> ").concat(i,", rtt: ").concat(this.uplinkRTT_,", loss: ").concat(this.uplinkLoss_)),this.uplinkNetworkQuality_=i}},{key:"downlinkNetworkQuality",get:function(){return this.downlinkNetworkQuality_},set:function(i){if(i!==this.downlinkNetworkQuality_){var o=this.getAverageLossAndRTT(Ke(this.downlinkLossAndRTTMap_.values())),c=o.rtt,a=o.loss;this.log_.info("downlink network quality change ".concat(this.downlinkNetworkQuality," -> ").concat(i,", rtt: ").concat(c,", loss: ").concat(a))}this.downlinkNetworkQuality_=i}},{key:"initialize",value:function(){var i=this;this.signalChannel_.on(kt.UPLINK_NETWORK_STATS,function(o){i.handleUplinkNetworkQuality(o)}),this.signalChannel_.on(Bf,this.handleSignalConnectionStateChange.bind(this)),this.start()}},{key:"handleUplinkNetworkQuality",value:function(i){if(!this.uplinkConnection_)return this.uplinkNetworkQuality=0,this.uplinkLoss_=0,void(this.uplinkRTT_=0);var o=this.uplinkConnection_.getPeerConnection();if(o&&this.isPeerConnectionDisconnected(o))return this.uplinkNetworkQuality=6,this.uplinkLoss_=0,void(this.uplinkRTT_=0);if(i.data.code===0){var c=i.data.data,a=c.expectAudPkg+c.expectVidPkg,u=c.recvAudPkg+c.recvVidPkg,l=a-u,h=c.delay;if(h&&this.updateDelay(h),a===0&&u===0)return;this.uplinkLoss_=l<=0?0:Math.round(l/a*100),this.uplinkRTT_=c.rtt,this.uplinkNetworkQuality=this.getNetworkQuality(this.uplinkLoss_,this.uplinkRTT_)}}},{key:"handleDownlinkNetworkQuality",value:(n=b(regeneratorRuntime.mark(function i(){var o,c,a,u,l,h,f,m,g,v,I,S,y,E,C,x=this;return regeneratorRuntime.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(this.connections_&&this.connections_.size!==0){U.next=3;break}return this.downlinkNetworkQuality=0,U.abrupt("return");case 3:if(o=Ke(this.connections_.values()),c=o.filter(function(G){return G.getPeerConnection()&&G.getPeerConnection().connectionState===Uy}),o.filter(function(G){return G.getPeerConnection()&&x.isPeerConnectionDisconnected(G.getPeerConnection())}).length!==o.length){U.next=9;break}return this.downlinkNetworkQuality=6,U.abrupt("return");case 9:a=0;case 10:if(!(a<c.length)){U.next=31;break}return u=c[a].getPeerConnection(),U.next=14,this.getStat(u);case 14:if(l=U.sent,h=l.rtt,f=l.totalPacketsLost,m=l.totalPacketsReceived,this.downlinkPrevStatMap_.has(u)){U.next=21;break}return this.downlinkPrevStatMap_.set(u,{totalPacketsLost:f,totalPacketsReceived:m}),U.abrupt("continue",28);case 21:g=0,v=this.downlinkPrevStatMap_.get(u),I=f-v.totalPacketsLost,S=m-v.totalPacketsReceived,g=I<=0||S<0?0:Math.round(I/(I+S)*100),this.downlinkPrevStatMap_.set(u,{totalPacketsLost:f,totalPacketsReceived:m}),this.downlinkLossAndRTTMap_.set(u,{rtt:h,loss:g,userId:c[a].getUserId()});case 28:a++,U.next=10;break;case 31:if(Ke(this.downlinkPrevStatMap_.keys()).forEach(function(G){x.isPeerConnectionDisconnected(G)&&(x.downlinkPrevStatMap_.delete(G),x.downlinkLossAndRTTMap_.delete(G))}),this.downlinkLossAndRTTMap_.size!==0){U.next=34;break}return U.abrupt("return");case 34:y=this.getAverageLossAndRTT(Ke(this.downlinkLossAndRTTMap_.values())),E=y.rtt,C=y.loss,this.downlinkRTT_=E,this.downlinkLoss_=C,this.downlinkNetworkQuality=this.getNetworkQuality(C,E);case 38:case"end":return U.stop()}},i,this)})),function(){return n.apply(this,arguments)})},{key:"getStat",value:(t=b(regeneratorRuntime.mark(function i(o){var c,a,u,l;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(c={rtt:0,totalPacketsLost:0,totalPacketsReceived:0},o&&Rb()){h.next=3;break}return h.abrupt("return",c);case 3:a=o.getReceivers(),h.prev=4,u=0;case 6:if(!(u<a.length)){h.next=15;break}return l=a[u],h.next=10,l.getStats();case 10:h.sent.forEach(function(f){f.type==="candidate-pair"&&xr(f.currentRoundTripTime)&&(c.rtt=Math.round(1e3*f.currentRoundTripTime)),f.type!=="inbound-rtp"||f.mediaType!==Pe&&f.mediaType!==Ue||(c.totalPacketsLost+=f.packetsLost,c.totalPacketsReceived+=f.packetsReceived)});case 12:u++,h.next=6;break;case 15:return h.abrupt("return",c);case 18:return h.prev=18,h.t0=h.catch(4),h.abrupt("return",c);case 21:case"end":return h.stop()}},i,null,[[4,18]])})),function(i){return t.apply(this,arguments)})},{key:"getAverageLossAndRTT",value:function(i){var o={rtt:0,loss:0};return Array.isArray(i)&&i.length>0&&(i.forEach(function(c){o.rtt+=c.rtt,o.loss+=c.loss}),Object.keys(o).forEach(function(c){o[c]=Math.round(o[c]/i.length)})),o}},{key:"getNetworkQuality",value:function(i,o){return i>50||o>500?5:i>30||o>350?4:i>20||o>200?3:i>10||o>100?2:i>=0||o>=0?1:0}},{key:"handleSignalConnectionStateChange",value:function(i){i.state===wu?(this.uplinkRTT_=0,this.uplinkLoss_=0,this.uplinkNetworkQuality=6):i.state===Eu&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}},{key:"handleUplinkConnectionStateChange",value:function(i){var o=i.state;o===dn?(this.uplinkLoss_=0,this.uplinkRTT_=0,this.uplinkNetworkQuality=6):o===mn&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}},{key:"isPeerConnectionDisconnected",value:function(i){return!(!i||i.connectionState!==pA&&i.connectionState!==My&&i.connectionState!==jh)}},{key:"setUplinkConnection",value:function(i){this.uplinkConnection_=i,this.uplinkConnection_?this.uplinkConnection_.on(it.CONNECTION_STATE_CHANGED,this.handleUplinkConnectionStateChange.bind(this)):(this.uplinkNetworkQuality=0,this.uplinkRTT_=0,this.uplinkLoss_=0)}},{key:"start",value:function(){var i=this;this.interval_===-1?(this.log_.info("start network quality calculating"),this.interval_=zt.setInterval(function(){i.handleDownlinkNetworkQuality(),J.emit(Mf,{client:i.client_,uplinkNetworkQuality:i.uplinkNetworkQuality,downlinkNetworkQuality:i.downlinkNetworkQuality,uplinkRTT:i.uplinkRTT_,uplinkLoss:i.uplinkLoss_,downlinkRTT:i.downlinkRTT_,downlinkLoss:i.downlinkLoss_,downlinkLossAndRTTMap:i.downlinkLossAndRTTMap_}),i.emitter_.emit(dt.NETWORK_QUALITY,{uplinkNetworkQuality:i.uplinkNetworkQuality,downlinkNetworkQuality:i.downlinkNetworkQuality,uplinkRTT:i.uplinkRTT_,uplinkLoss:i.uplinkLoss_,downlinkRTT:i.downlinkRTT_,downlinkLoss:i.downlinkLoss_})},2e3)):this.log_.info("network quality calculating is already started")}},{key:"stop",value:function(){this.log_.info("stop network quality calculating"),this.interval_!==-1&&(zt.clearInterval(this.interval_),this.interval_=-1),this.downlinkLossAndRTTMap_.clear(),this.downlinkPrevStatMap_.clear()}},{key:"on",value:function(i,o){this.emitter_.on(i,o)}},{key:"updateDelay",value:function(i){var o=this;i.forEach(function(c){var a=c.srcTinyId,u=c.videoDelay,l=c.audioDelay,h=o.connections_.get(a);h&&h.setDelay({videoDelay:u,audioDelay:l})})}}]),e}(),CD=function(){function e(o){w(this,e),this.log_=ye.createLogger({id:o.client.getUserId(),userId:o.client.getUserId(),sdkAppId:o.client.getSDKAppId()}),this.localStream_=null,this.prevDevices_=[],this.initialize()}var t,n,i;return P(e,[{key:"initialize",value:(i=b(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:navigator.mediaDevices&&(this.onDeviceChange=this.onDeviceChange.bind(this),navigator.mediaDevices.addEventListener("devicechange",this.onDeviceChange));case 1:case"end":return c.stop()}},o,this)})),function(){return i.apply(this,arguments)})},{key:"destroy",value:function(){navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",this.onDeviceChange)}},{key:"onDeviceChange",value:(n=b(regeneratorRuntime.mark(function o(){var c,a,u,l=this;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.localStream_&&this.localStream_.getMediaStream()&&!this.localStream_.getScreen()){h.next=2;break}return h.abrupt("return");case 2:return h.next=4,vt.getDevices();case 4:c=h.sent,a=c.filter(function(f){return l.prevDevices_.findIndex(function(m){var g=m.deviceId;return f.deviceId===g})<0}),u=this.prevDevices_.filter(function(f){return c.findIndex(function(m){var g=m.deviceId;return f.deviceId===g})<0}),a.length>0&&this.handleDeviceAdded(this.prevDevices_,a),u.length>0&&this.handleDeviceRemoved(c,u),this.prevDevices_=c;case 10:case"end":return h.stop()}},o,this)})),function(){return n.apply(this,arguments)})},{key:"setLocalStream",value:(t=b(regeneratorRuntime.mark(function o(c){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!c){a.next=4;break}return a.next=3,vt.getDevices();case 3:this.prevDevices_=a.sent;case 4:this.localStream_=c;case 5:case"end":return a.stop()}},o,this)})),function(o){return t.apply(this,arguments)})},{key:"handleDeviceAdded",value:function(o,c){this.log_.warn("devicesAdded: ".concat(JSON.stringify(c))),this.localStream_.updateDeviceIdInUse();var a=c.filter(function(g){return g.kind===Vh}),u=c.filter(function(g){return g.kind===vs}),l=o.filter(function(g){return g.kind===Vh}),h=o.filter(function(g){return g.kind===vs}),f=a.length>0&&l.length===0&&this.localStream_.getVideo(),m=u.length>0&&h.length===0&&this.localStream_.getAudio();if(m&&f)return this.log_.info("new microphone and camera detected, but there was no device before."),void this.localStream_.updateStream({audio:!0,video:!0,cameraId:a[0].deviceId,microphoneId:u[0].deviceId});f&&(this.log_.info("new camera detected, but there was no camera before."),this.localStream_.updateStream({audio:!1,video:!0,cameraId:a[0].deviceId})),m&&(this.log_.info("new microphone detected, but there was no microphone before."),this.localStream_.updateStream({audio:!0,video:!1,microphoneId:u[0].deviceId}))}},{key:"handleDeviceRemoved",value:function(o,c){this.log_.warn("devicesRemoved: ".concat(JSON.stringify(c))),this.localStream_.updateDeviceIdInUse();var a=!1,u=!1,l=this.localStream_.getCameraId(),h=this.localStream_.getMicrophoneId();if(h==="default"){var f=this.localStream_.getMicrophoneGroupId(),m=o.filter(function(g){return g.deviceId==="default"&&g.kind===vs})[0];m&&m.groupId!==f&&(u=!0)}if(c.forEach(function(g){var v=g.deviceId;l.length>0&&v===l?a=!0:h.length>0&&v===h&&(u=!0)}),a&&u)return this.log_.warn("current camera and microphone in use is lost, cameraId: ".concat(l,", microphoneId: ").concat(h)),void((this.localStream_.getAudio()||this.localStream_.getVideo())&&this.localStream_.updateStream({video:!0,audio:!0}));a&&(this.log_.warn("current camera in use is lost, deviceId: ".concat(l)),this.localStream_.getVideo()&&this.localStream_.updateStream({video:!0,audio:!1})),u&&(this.log_.warn("current microphone in use is lost, deviceId: ".concat(h)),this.localStream_.getAudio()&&this.localStream_.updateStream({video:!1,audio:!0}))}}]),e}(),RD=z.RangeError,AD=z.RangeError,Nb=z.String,Lb=Math.floor,Zf=ne(function(e){var t=Fe(ue(this)),n="",i=Qn(e);if(i<0||i==1/0)throw RD("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}),Mb=ne("".slice),xs=ne(1 .toFixed),aa=function(e,t,n){return t===0?n:t%2==1?aa(e,t-1,n*e):aa(e*e,t/2,n)},sa=function(e,t,n){for(var i=-1,o=n;++i<6;)o+=t*e[i],e[i]=o%1e7,o=Lb(o/1e7)},ep=function(e,t){for(var n=6,i=0;--n>=0;)i+=e[n],e[n]=Lb(i/t),i=i%t*1e7},Ub=function(e){for(var t=6,n="";--t>=0;)if(n!==""||t===0||e[t]!==0){var i=Nb(e[t]);n=n===""?i:n+Zf("0",7-i.length)+i}return n},xD=he(function(){return xs(8e-5,3)!=="0.000"||xs(.9,0)!=="1"||xs(1.255,2)!=="1.25"||xs(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!he(function(){xs({})});Me({target:"Number",proto:!0,forced:xD},{toFixed:function(e){var t,n,i,o,c=O_(this),a=Qn(e),u=[0,0,0,0,0,0],l="",h="0";if(a<0||a>20)throw AD("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return Nb(c);if(c<0&&(l="-",c=-c),c>1e-21)if(n=(t=function(f){for(var m=0,g=f;g>=4096;)m+=12,g/=4096;for(;g>=2;)m+=1,g/=2;return m}(c*aa(2,69,1))-69)<0?c*aa(2,-t,1):c/aa(2,t,1),n*=4503599627370496,(t=52-t)>0){for(sa(u,0,n),i=a;i>=7;)sa(u,1e7,0),i-=7;for(sa(u,aa(10,i,1),0),i=t-1;i>=23;)ep(u,1<<23),i-=23;ep(u,1<<i),sa(u,1,1),ep(u,2),h=Ub(u)}else sa(u,0,n),sa(u,1<<-t,0),h=Ub(u)+Zf("0",a);return h=a>0?l+((o=h.length)<=a?"0."+Zf("0",a-o)+h:Mb(h,0,o-a)+"."+Mb(h,o-a)):l+h}});var Fn,jn=function(e,t,n){return n.get&&Ql(n.get,t,{getter:!0}),n.set&&Ql(n.set,t,{setter:!0}),Ht.f(e,t,n)},PD=function(e,t,n,i){try{return i?t(gt(n)[0],n[1]):t(n)}catch(o){vd(e,"throw",o)}},Vb=z.Array,ca=function(e){var t=sn(e),n=Ec(this),i=arguments.length,o=i>1?arguments[1]:void 0,c=o!==void 0;c&&(o=Yn(o,i>2?arguments[2]:void 0));var a,u,l,h,f,m,g=rs(t),v=0;if(!g||this==Vb&&gd(g))for(a=un(t),u=n?new this(a):Vb(a);a>v;v++)m=c?o(t[v],v):t[v],Li(u,v,m);else for(f=(h=Eo(t,g)).next,u=n?new this:[];!(l=Le(f,h)).done;v++)m=c?PD(h,o,[l.value,v],!0):l.value,Li(u,v,m);return u.length=v,u},DD=/[^\0-\u007E]/,Fb=/[.\u3002\uFF0E\uFF61]/g,jb="Overflow: input needs wider integers to process",Bb=z.RangeError,OD=ne(Fb.exec),ua=Math.floor,tp=String.fromCharCode,Hb=ne("".charCodeAt),$b=ne([].join),gi=ne([].push),ND=ne("".replace),LD=ne("".split),MD=ne("".toLowerCase),zb=function(e){return e+22+75*(e<26)},UD=function(e,t,n){var i=0;for(e=n?ua(e/700):e>>1,e+=ua(e/t);e>455;)e=ua(e/35),i+=36;return ua(i+36*e/(e+38))},VD=function(e){var t,n,i=[],o=(e=function(E){for(var C=[],x=0,U=E.length;x<U;){var G=Hb(E,x++);if(G>=55296&&G<=56319&&x<U){var H=Hb(E,x++);(64512&H)==56320?gi(C,((1023&G)<<10)+(1023&H)+65536):(gi(C,G),x--)}else gi(C,G)}return C}(e)).length,c=128,a=0,u=72;for(t=0;t<e.length;t++)(n=e[t])<128&&gi(i,tp(n));var l=i.length,h=l;for(l&&gi(i,"-");h<o;){var f=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=c&&n<f&&(f=n);var m=h+1;if(f-c>ua((2147483647-a)/m))throw Bb(jb);for(a+=(f-c)*m,c=f,t=0;t<e.length;t++){if((n=e[t])<c&&++a>2147483647)throw Bb(jb);if(n==c){for(var g=a,v=36;;){var I=v<=u?1:v>=u+26?26:v-u;if(g<I)break;var S=g-I,y=36-I;gi(i,tp(zb(I+S%y))),g=ua(S/y),v+=36}gi(i,tp(zb(g))),u=UD(a,m,h==l),a=0,h++}}a++,c++}return $b(i,"")},FD=bd.codeAt,jD=Dt.set,Ru=Dt.getterFor("URL"),BD=k_.URLSearchParams,HD=k_.getState,Ps=z.URL,np=z.TypeError,Au=z.parseInt,$D=Math.floor,Wb=Math.pow,Bn=ne("".charAt),Zn=ne(/./.exec),Ds=ne([].join),zD=ne(1 .toString),WD=ne([].pop),la=ne([].push),Gb=ne("".replace),GD=ne([].shift),JD=ne("".split),Os=ne("".slice),xu=ne("".toLowerCase),qD=ne([].unshift),Jb=/[a-z]/i,KD=/[\d+-.a-z]/i,rp=/\d/,QD=/^0x/i,YD=/^[0-7]+$/,XD=/^\d+$/,qb=/^[\da-f]+$/i,ZD=/[\0\t\n\r #%/:<>?@[\\\]^|]/,eO=/[\0\t\n\r #/:<>?@[\\\]^|]/,tO=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,nO=/[\t\n\r]/g,Ns=function(e){var t,n,i,o;if(typeof e=="number"){for(t=[],n=0;n<4;n++)qD(t,e%256),e=$D(e/256);return Ds(t,".")}if(typeof e=="object"){for(t="",i=function(c){for(var a=null,u=1,l=null,h=0,f=0;f<8;f++)c[f]!==0?(h>u&&(a=l,u=h),l=null,h=0):(l===null&&(l=f),++h);return h>u&&(a=l,u=h),a}(e),n=0;n<8;n++)o&&e[n]===0||(o&&(o=!1),i===n?(t+=n?":":"::",o=!0):(t+=zD(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},Pu={},Kb=Es({},Pu,{" ":1,'"':1,"<":1,">":1,"`":1}),Qb=Es({},Kb,{"#":1,"?":1,"{":1,"}":1}),ip=Es({},Qb,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),vi=function(e,t){var n=FD(e,0);return n>32&&n<127&&!Qe(t,e)?e:encodeURIComponent(e)},Du={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ls=function(e,t){var n;return e.length==2&&Zn(Jb,Bn(e,0))&&((n=Bn(e,1))==":"||!t&&n=="|")},Yb=function(e){var t;return e.length>1&&Ls(Os(e,0,2))&&(e.length==2||(t=Bn(e,2))==="/"||t==="\\"||t==="?"||t==="#")},rO=function(e){return e==="."||xu(e)==="%2e"},op={},Xb={},ap={},Zb={},eS={},sp={},tS={},nS={},Ou={},Nu={},cp={},up={},lp={},dp={},rS={},hp={},da={},pr={},iS={},Qi={},Mr={},fp=function(e,t,n){var i,o,c,a=Fe(e);if(t){if(o=this.parse(a))throw np(o);this.searchParams=null}else{if(n!==void 0&&(i=new fp(n,!0)),o=this.parse(a,null,i))throw np(o);(c=HD(new BD)).bindURL(this),this.searchParams=c}};fp.prototype={type:"URL",parse:function(e,t,n){var i,o,c,a,u,l=this,h=t||op,f=0,m="",g=!1,v=!1,I=!1;for(e=Fe(e),t||(l.scheme="",l.username="",l.password="",l.host=null,l.port=null,l.path=[],l.query=null,l.fragment=null,l.cannotBeABaseURL=!1,e=Gb(e,tO,"")),e=Gb(e,nO,""),i=ca(e);f<=i.length;){switch(o=i[f],h){case op:if(!o||!Zn(Jb,o)){if(t)return"Invalid scheme";h=ap;continue}m+=xu(o),h=Xb;break;case Xb:if(o&&(Zn(KD,o)||o=="+"||o=="-"||o=="."))m+=xu(o);else{if(o!=":"){if(t)return"Invalid scheme";m="",h=ap,f=0;continue}if(t&&(l.isSpecial()!=Qe(Du,m)||m=="file"&&(l.includesCredentials()||l.port!==null)||l.scheme=="file"&&!l.host))return;if(l.scheme=m,t)return void(l.isSpecial()&&Du[l.scheme]==l.port&&(l.port=null));m="",l.scheme=="file"?h=dp:l.isSpecial()&&n&&n.scheme==l.scheme?h=Zb:l.isSpecial()?h=nS:i[f+1]=="/"?(h=eS,f++):(l.cannotBeABaseURL=!0,la(l.path,""),h=iS)}break;case ap:if(!n||n.cannotBeABaseURL&&o!="#")return"Invalid scheme";if(n.cannotBeABaseURL&&o=="#"){l.scheme=n.scheme,l.path=Gt(n.path),l.query=n.query,l.fragment="",l.cannotBeABaseURL=!0,h=Mr;break}h=n.scheme=="file"?dp:sp;continue;case Zb:if(o!="/"||i[f+1]!="/"){h=sp;continue}h=Ou,f++;break;case eS:if(o=="/"){h=Nu;break}h=pr;continue;case sp:if(l.scheme=n.scheme,o==Fn)l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=Gt(n.path),l.query=n.query;else if(o=="/"||o=="\\"&&l.isSpecial())h=tS;else if(o=="?")l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=Gt(n.path),l.query="",h=Qi;else{if(o!="#"){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=Gt(n.path),l.path.length--,h=pr;continue}l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,l.path=Gt(n.path),l.query=n.query,l.fragment="",h=Mr}break;case tS:if(!l.isSpecial()||o!="/"&&o!="\\"){if(o!="/"){l.username=n.username,l.password=n.password,l.host=n.host,l.port=n.port,h=pr;continue}h=Nu}else h=Ou;break;case nS:if(h=Ou,o!="/"||Bn(m,f+1)!="/")continue;f++;break;case Ou:if(o!="/"&&o!="\\"){h=Nu;continue}break;case Nu:if(o=="@"){g&&(m="%40"+m),g=!0,c=ca(m);for(var S=0;S<c.length;S++){var y=c[S];if(y!=":"||I){var E=vi(y,ip);I?l.password+=E:l.username+=E}else I=!0}m=""}else if(o==Fn||o=="/"||o=="?"||o=="#"||o=="\\"&&l.isSpecial()){if(g&&m=="")return"Invalid authority";f-=ca(m).length+1,m="",h=cp}else m+=o;break;case cp:case up:if(t&&l.scheme=="file"){h=hp;continue}if(o!=":"||v){if(o==Fn||o=="/"||o=="?"||o=="#"||o=="\\"&&l.isSpecial()){if(l.isSpecial()&&m=="")return"Invalid host";if(t&&m==""&&(l.includesCredentials()||l.port!==null))return;if(a=l.parseHost(m))return a;if(m="",h=da,t)return;continue}o=="["?v=!0:o=="]"&&(v=!1),m+=o}else{if(m=="")return"Invalid host";if(a=l.parseHost(m))return a;if(m="",h=lp,t==up)return}break;case lp:if(!Zn(rp,o)){if(o==Fn||o=="/"||o=="?"||o=="#"||o=="\\"&&l.isSpecial()||t){if(m!=""){var C=Au(m,10);if(C>65535)return"Invalid port";l.port=l.isSpecial()&&C===Du[l.scheme]?null:C,m=""}if(t)return;h=da;continue}return"Invalid port"}m+=o;break;case dp:if(l.scheme="file",o=="/"||o=="\\")h=rS;else{if(!n||n.scheme!="file"){h=pr;continue}if(o==Fn)l.host=n.host,l.path=Gt(n.path),l.query=n.query;else if(o=="?")l.host=n.host,l.path=Gt(n.path),l.query="",h=Qi;else{if(o!="#"){Yb(Ds(Gt(i,f),""))||(l.host=n.host,l.path=Gt(n.path),l.shortenPath()),h=pr;continue}l.host=n.host,l.path=Gt(n.path),l.query=n.query,l.fragment="",h=Mr}}break;case rS:if(o=="/"||o=="\\"){h=hp;break}n&&n.scheme=="file"&&!Yb(Ds(Gt(i,f),""))&&(Ls(n.path[0],!0)?la(l.path,n.path[0]):l.host=n.host),h=pr;continue;case hp:if(o==Fn||o=="/"||o=="\\"||o=="?"||o=="#"){if(!t&&Ls(m))h=pr;else if(m==""){if(l.host="",t)return;h=da}else{if(a=l.parseHost(m))return a;if(l.host=="localhost"&&(l.host=""),t)return;m="",h=da}continue}m+=o;break;case da:if(l.isSpecial()){if(h=pr,o!="/"&&o!="\\")continue}else if(t||o!="?")if(t||o!="#"){if(o!=Fn&&(h=pr,o!="/"))continue}else l.fragment="",h=Mr;else l.query="",h=Qi;break;case pr:if(o==Fn||o=="/"||o=="\\"&&l.isSpecial()||!t&&(o=="?"||o=="#")){if((u=xu(u=m))===".."||u==="%2e."||u===".%2e"||u==="%2e%2e"?(l.shortenPath(),o=="/"||o=="\\"&&l.isSpecial()||la(l.path,"")):rO(m)?o=="/"||o=="\\"&&l.isSpecial()||la(l.path,""):(l.scheme=="file"&&!l.path.length&&Ls(m)&&(l.host&&(l.host=""),m=Bn(m,0)+":"),la(l.path,m)),m="",l.scheme=="file"&&(o==Fn||o=="?"||o=="#"))for(;l.path.length>1&&l.path[0]==="";)GD(l.path);o=="?"?(l.query="",h=Qi):o=="#"&&(l.fragment="",h=Mr)}else m+=vi(o,Qb);break;case iS:o=="?"?(l.query="",h=Qi):o=="#"?(l.fragment="",h=Mr):o!=Fn&&(l.path[0]+=vi(o,Pu));break;case Qi:t||o!="#"?o!=Fn&&(o=="'"&&l.isSpecial()?l.query+="%27":l.query+=o=="#"?"%23":vi(o,Pu)):(l.fragment="",h=Mr);break;case Mr:o!=Fn&&(l.fragment+=vi(o,Kb))}f++}},parseHost:function(e){var t,n,i;if(Bn(e,0)=="["){if(Bn(e,e.length-1)!="]"||!(t=function(o){var c,a,u,l,h,f,m,g=[0,0,0,0,0,0,0,0],v=0,I=null,S=0,y=function(){return Bn(o,S)};if(y()==":"){if(Bn(o,1)!=":")return;S+=2,I=++v}for(;y();){if(v==8)return;if(y()!=":"){for(c=a=0;a<4&&Zn(qb,y());)c=16*c+Au(y(),16),S++,a++;if(y()=="."){if(a==0||(S-=a,v>6))return;for(u=0;y();){if(l=null,u>0){if(!(y()=="."&&u<4))return;S++}if(!Zn(rp,y()))return;for(;Zn(rp,y());){if(h=Au(y(),10),l===null)l=h;else{if(l==0)return;l=10*l+h}if(l>255)return;S++}g[v]=256*g[v]+l,++u!=2&&u!=4||v++}if(u!=4)return;break}if(y()==":"){if(S++,!y())return}else if(y())return;g[v++]=c}else{if(I!==null)return;S++,I=++v}}if(I!==null)for(f=v-I,v=7;v!=0&&f>0;)m=g[v],g[v--]=g[I+f-1],g[I+--f]=m;else if(v!=8)return;return g}(Os(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=function(o){var c,a,u=[],l=LD(ND(MD(o),Fb,"."),".");for(c=0;c<l.length;c++)a=l[c],gi(u,OD(DD,a)?"xn--"+VD(a):a);return $b(u,".")}(e),Zn(ZD,e)||(t=function(o){var c,a,u,l,h,f,m,g=JD(o,".");if(g.length&&g[g.length-1]==""&&g.length--,(c=g.length)>4)return o;for(a=[],u=0;u<c;u++){if((l=g[u])=="")return o;if(h=10,l.length>1&&Bn(l,0)=="0"&&(h=Zn(QD,l)?16:8,l=Os(l,h==8?1:2)),l==="")f=0;else{if(!Zn(h==10?XD:h==8?YD:qb,l))return o;f=Au(l,h)}la(a,f)}for(u=0;u<c;u++)if(f=a[u],u==c-1){if(f>=Wb(256,5-c))return null}else if(f>255)return null;for(m=WD(a),u=0;u<a.length;u++)m+=a[u]*Wb(256,3-u);return m}(e))===null)return"Invalid host";this.host=t}else{if(Zn(eO,e))return"Invalid host";for(t="",n=ca(e),i=0;i<n.length;i++)t+=vi(n[i],Pu);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return Qe(Du,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||this.scheme=="file"&&t==1&&Ls(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,i=e.password,o=e.host,c=e.port,a=e.path,u=e.query,l=e.fragment,h=t+":";return o!==null?(h+="//",e.includesCredentials()&&(h+=n+(i?":"+i:"")+"@"),h+=Ns(o),c!==null&&(h+=":"+c)):t=="file"&&(h+="//"),h+=e.cannotBeABaseURL?a[0]:a.length?"/"+Ds(a,"/"):"",u!==null&&(h+="?"+u),l!==null&&(h+="#"+l),h},setHref:function(e){var t=this.parse(e);if(t)throw np(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new ha(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+Ns(this.host)+(t!==null?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Fe(e)+":",op)},getUsername:function(){return this.username},setUsername:function(e){var t=ca(Fe(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=vi(t[n],ip)}},getPassword:function(){return this.password},setPassword:function(e){var t=ca(Fe(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=vi(t[n],ip)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?Ns(e):Ns(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,cp)},getHostname:function(){var e=this.host;return e===null?"":Ns(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,up)},getPort:function(){var e=this.port;return e===null?"":Fe(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Fe(e))==""?this.port=null:this.parse(e,lp))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Ds(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,da))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Fe(e))==""?this.query=null:(Bn(e,0)=="?"&&(e=Os(e,1)),this.query="",this.parse(e,Qi)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Fe(e))!=""?(Bn(e,0)=="#"&&(e=Os(e,1)),this.fragment="",this.parse(e,Mr)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ha=function(e){var t=Mn(this,hn),n=Er(arguments.length,1)>1?arguments[1]:void 0,i=jD(t,new fp(e,!1,n));Te||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},hn=ha.prototype,Hn=function(e,t){return{get:function(){return Ru(this)[e]()},set:t&&function(n){return Ru(this)[t](n)},configurable:!0,enumerable:!0}};if(Te&&(jn(hn,"href",Hn("serialize","setHref")),jn(hn,"origin",Hn("getOrigin")),jn(hn,"protocol",Hn("getProtocol","setProtocol")),jn(hn,"username",Hn("getUsername","setUsername")),jn(hn,"password",Hn("getPassword","setPassword")),jn(hn,"host",Hn("getHost","setHost")),jn(hn,"hostname",Hn("getHostname","setHostname")),jn(hn,"port",Hn("getPort","setPort")),jn(hn,"pathname",Hn("getPathname","setPathname")),jn(hn,"search",Hn("getSearch","setSearch")),jn(hn,"searchParams",Hn("getSearchParams")),jn(hn,"hash",Hn("getHash","setHash"))),bt(hn,"toJSON",function(){return Ru(this).serialize()},{enumerable:!0}),bt(hn,"toString",function(){return Ru(this).serialize()},{enumerable:!0}),Ps){var oS=Ps.createObjectURL,aS=Ps.revokeObjectURL;oS&&bt(ha,"createObjectURL",Yn(oS,Ps)),aS&&bt(ha,"revokeObjectURL",Yn(aS,Ps))}ti(ha,"URL"),Me({global:!0,constructor:!0,forced:!Bd,sham:!Te},{URL:ha});var Lu,pp,Ms,iO=new Blob(["class VolumeMeter extends AudioWorkletProcessor{constructor(){super();this.volume=0;this.intervalTime=200;this.tick=this.intervalTime;this.isStop=false;this.port.onmessage=event=>{const{data}=event;switch(data.name){case'setIntervalTime':this.intervalTime=data.intervalTime;break;case'stop':this.isStop=true;break}}}process(inputs){const input=inputs[0];if(this.isStop){return false}if(input.length>0){const firstChannel=input[0];let sum=0;let rms;for(let i=0;i<firstChannel.length;++i){sum+=firstChannel[i]*firstChannel[i]}rms=Math.sqrt(sum/firstChannel.length);this.volume=Math.max(rms,this.volume*0.95);this.tick-=firstChannel.length;if(this.tick<0){this.tick+=(this.intervalTime/1000)*sampleRate;this.port.postMessage({volume:this.volume})}}return true}}registerProcessor('volume-meter',VolumeMeter);"],{type:"application/javascript"}),sS=!1,oO=function(){function e(n){w(this,e),this.context_=n.context,this.addModuleToContext()}var t;return P(e,[{key:"addModuleToContext",value:(t=b(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,this.context_.audioWorklet.addModule(URL.createObjectURL(iO));case 3:ye.info("worklet addModule success"),J.emit(Uf),sS=!0,i.next=12;break;case 8:i.prev=8,i.t0=i.catch(0),ye.info("worklet addModule catch error. ".concat(i.t0.message)),J.emit(Vf);case 12:case"end":return i.stop()}},n,this,[[0,8]])})),function(){return t.apply(this,arguments)})},{key:"initWorkletSuccess",get:function(){return sS}}]),e}(),aO=function(){function e(t){w(this,e);var n=t.track,i=t.log,o=t.stream;this.volume_=0,this.log_=i,this.track_=n,this.stream_=o,Lu||(Lu=new window.AudioContext),this.audioCtx_=Lu,this.destination_=this.audioCtx_.destination;var c=new MediaStream;c.addTrack(this.track_),this.streamSource_=this.audioCtx_.createMediaStreamSource(c),this.audioWorkletNode_=null,this.scriptProcessorNode_=null,this.interval_=200,J.on(ws,this.resume,this),J.on(bf,this.handleAudioLevelInterval,this),bP?(J.on(Uf,this.initAudioWorklet,this),J.on(Vf,this.initScriptProcessor,this),this.preload()):this.initScriptProcessor()}return P(e,[{key:"preload",value:function(){pp?pp.initWorkletSuccess&&this.initAudioWorklet():pp=new oO({context:Lu})}},{key:"initAudioWorklet",value:function(){var t=this;if(!this.audioWorkletNode_)try{this.audioWorkletNode_=new AudioWorkletNode(this.audioCtx_,"volume-meter"),this.audioWorkletNode_.port.onmessage=function(n){t.volume_=n.data.volume||0},this.streamSource_.connect(this.audioWorkletNode_).connect(this.destination_),this.handleAudioLevelInterval({interval:this.interval_}),Se.logSuccessEvent({userId:this.stream_.getUserId(),eventType:r0})}catch{Se.logFailedEvent({userId:this.stream_.getUserId(),eventType:r0}),this.initScriptProcessor()}}},{key:"initScriptProcessor",value:function(){var t=this;if(!this.scriptProcessorNode_)try{this.scriptProcessorNode_=this.audioCtx_.createScriptProcessor(2048,1,1),this.scriptProcessorNode_.onaudioprocess=function(n){for(var i=n.inputBuffer.getChannelData(0),o=0,c=0;c<i.length;++c)o+=i[c]*i[c];t.volume_=Math.sqrt(o/i.length)||0},this.streamSource_.connect(this.scriptProcessorNode_),this.scriptProcessorNode_.connect(this.destination_)}catch(n){this.log_.error("volumeMeter init script processor error: "+n)}}},{key:"destroy",value:function(){this.streamSource_&&this.streamSource_.disconnect(),this.scriptProcessorNode_&&(this.scriptProcessorNode_.onaudioprocess=null,this.scriptProcessorNode_.disconnect()),this.audioWorkletNode_&&(this.audioWorkletNode_.port.postMessage({name:"stop"}),this.audioWorkletNode_.port.onmessage=null,this.audioWorkletNode_.disconnect()),this.audioWorkletNode_=null,this.scriptProcessorNode_=null,this.audioCtx_=null,J.off(ws,this.resume,this),J.off(bf,this.handleAudioLevelInterval,this),J.off(Uf,this.initAudioWorklet,this),J.off(Vf,this.initScriptProcessor,this)}},{key:"resume",value:function(){this.audioCtx_&&this.audioCtx_.resume()}},{key:"getInternalAudioLevel",value:function(){return this.volume_}},{key:"getCalculatedVolume",value:function(){return this.volume_.toFixed(2)}},{key:"handleAudioLevelInterval",value:function(t){var n=t.interval;this.interval_=n,this.audioWorkletNode_&&this.audioWorkletNode_.port.postMessage({name:"setIntervalTime",intervalTime:n})}}]),e}(),sO=function(){function e(c){w(this,e),this.stream_=c.stream,this.userId_=c.stream.getUserId(),this.log_=this.stream_.getLogger(),this.track_=c.track,c.gainedTrack&&(this.gainedTrack_=c.gainedTrack),this.div_=c.div,this.muted_=c.muted,this.outputDeviceId_=c.outputDeviceId,this.volume_=c.volume,this.pausedRetryCount_=5,this.emitter_=new mi,this.initializeElement(),this.state_="NONE",this.volumeMeter_=new aO({stream:this.stream_,track:this.gainedTrack_||this.track_,log:this.log_})}var t,n,i,o;return P(e,[{key:"isPlaying",get:function(){return this.state_==="PLAYING"}},{key:"initializeElement",value:function(){if(this.isAudioElementInit()){var c=new MediaStream;c.addTrack(this.gainedTrack_||this.track_);var a=document.createElement(Pe);a.srcObject=c,a.muted=this.muted_,a.setAttribute("id","audio_".concat(this.stream_.getId())),a.setAttribute("autoplay","autoplay"),a.setAttribute("playsinline","playsinline"),this.div_.appendChild(a),this.element_=a}this.handleEvents()}},{key:"setMuted",value:function(c){this.element_&&(this.element_.muted=c,this.muted_=c)}},{key:"play",value:(o=b(regeneratorRuntime.mark(function c(){var a;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.outputDeviceId_||!this.element_){u.next=3;break}return u.next=3,this.element_.setSinkId(this.outputDeviceId_);case 3:if(this.setVolume(this.volume_),u.prev=4,!this.element_){u.next=8;break}return u.next=8,this.element_.play();case 8:u.next=16;break;case 10:if(u.prev=10,u.t0=u.catch(4),this.log_.warn("<audio> play() error: "+u.t0),!(a=u.t0.toString()+" <audio>").startsWith("NotAllowedError")){u.next=16;break}throw new Y({code:Q.PLAY_NOT_ALLOWED,message:a});case 16:case"end":return u.stop()}},c,this,[[4,10]])})),function(){return o.apply(this,arguments)})},{key:"handleEvents",value:function(){this.handleElementEvent=this.handleElementEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.element_&&(this.element_.addEventListener(si,this.handleElementEvent),this.element_.addEventListener(Ot,this.handleElementEvent),this.element_.addEventListener(ci,this.handleElementEvent),this.element_.addEventListener($o,this.handleElementEvent)),this.track_.addEventListener(Ot,this.handleTrackEvent),this.track_.addEventListener(pn,this.handleTrackEvent),this.track_.addEventListener(lr,this.handleTrackEvent),this.track_.readyState===Ot&&this.handleTrackEvent({type:Ot}),this.track_.muted&&this.handleTrackEvent({type:pn})}},{key:"handleElementEvent",value:(i=b(regeneratorRuntime.mark(function c(a){var u,l,h,f,m,g,v,I=this;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:u=a.type,S.t0=u,S.next=S.t0===si?4:S.t0===Ot?9:S.t0===ci?12:S.t0===$o?20:31;break;case 4:return this.log_.info("stream - audio player is starting playing"),this.state_="PLAYING",J.emit(Sf,{stream:this.stream_}),this.emitter_.emit(_n,{state:this.state_,reason:si}),S.abrupt("break",31);case 9:return this.log_.info("stream - audio player is ended"),this.state_!=="STOPPED"&&(this.state_="STOPPED",this.emitter_.emit(_n,{state:this.state_,reason:Ot})),S.abrupt("break",31);case 12:return this.log_.info("stream - audio player is paused"),this.state_="PAUSED",this.emitter_.emit(_n,{state:this.state_,reason:ci}),(l=this.div_&&document.getElementById(this.div_.id))||this.log_.warn("audio container is not in DOM"),h=iu(),this.pausedRetryCount_>0&&(xr(h)&&h<=70||!l)&&(this.resume(),this.pausedRetryCount_--),S.abrupt("break",31);case 20:if(!this.element_||!this.element_.error){S.next=30;break}return f="".concat(Yf(),"/").concat($i().name,"/").concat($i().version),S.next=24,vt.getSpeakers();case 24:m=S.sent,g=m[0].label,(v=m.find(function(y){return y.deviceId===I.outputDeviceId_}))&&(g=v.label),this.log_.error("stream - audio player error observed. code: ".concat(this.element_.error.code," message: ").concat(this.element_.error.message," deviceInfo: ").concat(f," speaker: ").concat(g)),Se.uploadEvent("stat-".concat(this.stream_.getType(),"-audio-").concat(t0,"-").concat(this.element_.error.code,"-").concat(f,"-").concat(g),this.element_.error);case 30:return S.abrupt("break",31);case 31:case"end":return S.stop()}},c,this)})),function(c){return i.apply(this,arguments)})},{key:"handleTrackEvent",value:function(c){var a=c.type;switch(a){case Ot:this.log_.info("stream - audio player track is ended"),this.state_!=="STOPPED"&&(this.state_="STOPPED",this.emitter_.emit(_n,{state:this.state_,reason:Ot})),J.emit(Of,{stream:this.stream_,type:a});break;case pn:this.log_.info("stream - audio track is unable to provide media output"),this.stream_.isRemote()||A0(),this.state_!=="PAUSED"&&(this.state_="PAUSED",this.emitter_.emit(_n,{state:this.state_,reason:pn})),J.emit(Df,{stream:this.stream_,type:a});break;case lr:this.log_.info("stream - audio track is able to provide media output"),this.state_==="PAUSED"&&(this.state_="PLAYING",this.emitter_.emit(_n,{state:this.state_,reason:lr}))}}},{key:"unbindEvents",value:function(){this.element_&&(this.element_.removeEventListener(si,this.handleElementEvent),this.element_.removeEventListener(Ot,this.handleElementEvent),this.element_.removeEventListener(ci,this.handleElementEvent),this.element_.removeEventListener($o,this.handleElementEvent)),this.track_&&(this.track_.removeEventListener(Ot,this.handleTrackEvent),this.track_.removeEventListener(pn,this.handleTrackEvent),this.track_.removeEventListener(lr,this.handleTrackEvent))}},{key:"setSinkId",value:(n=b(regeneratorRuntime.mark(function c(a){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.outputDeviceId_===a){u.next=5;break}if(!this.element_){u.next=4;break}return u.next=4,this.element_.setSinkId(a);case 4:this.outputDeviceId_=a;case 5:case"end":return u.stop()}},c,this)})),function(c){return n.apply(this,arguments)})},{key:"setVolume",value:function(c){this.element_&&(this.log_.info("stream - audioElement setVolume to : ".concat(c)),this.element_.volume=c)}},{key:"getAudioLevel",value:function(){return this.volumeMeter_.getCalculatedVolume()}},{key:"getInternalAudioLevel",value:function(){return this.volumeMeter_.getInternalAudioLevel()}},{key:"stop",value:function(){this.unbindEvents(),this.element_&&(this.div_.removeChild(this.element_),this.element_.srcObject=null,this.element_=null),this.volumeMeter_&&(this.volumeMeter_.destroy(),this.volumeMeter_=null)}},{key:"resume",value:(t=b(regeneratorRuntime.mark(function c(){var a;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,this.volumeMeter_&&this.volumeMeter_.resume(),!this.element_){u.next=5;break}return u.next=5,this.element_.play();case 5:u.next=13;break;case 7:if(u.prev=7,u.t0=u.catch(0),this.log_.warn("<audio> play() error: "+u.t0),!(a=Z({key:GA,data:{error:u.t0}})).startsWith("NotAllowedError")){u.next=13;break}throw new Y({code:Q.PLAY_NOT_ALLOWED,message:a});case 13:case"end":return u.stop()}},c,this,[[0,7]])})),function(){return t.apply(this,arguments)})},{key:"on",value:function(c,a){this.emitter_.on(c,a)}},{key:"isAudioElementInit",value:function(){return!(gs==="15.2"||gs==="15.3"||gs==="15.4")||this.stream_.getType()!=="local"||!this.muted_||(this.log_.info("audioElement is muted."),!1)}}]),e}(),cO=Xr.PROPER,uO=Gc.trim;Me({target:"String",proto:!0,forced:(Ms="trim",he(function(){return!!Ao[Ms]()||"\u200B\x85\u180E"[Ms]()!=="\u200B\x85\u180E"||cO&&Ao[Ms].name!==Ms}))},{trim:function(){return uO(this)}});var mp="".concat("trtc_autoplay","_mask"),fa="".concat("trtc_autoplay","_wrapper"),cS="".concat("trtc_autoplay","_header"),gp="".concat("trtc_autoplay","_content"),Mu="".concat("trtc_autoplay","_action_wrapper"),vp="".concat("trtc_autoplay","_question"),_p="".concat("trtc_autoplay","_collapse"),Uu="".concat("trtc_autoplay","_action_confirm"),uS="".concat("trtc_autoplay","_detail"),lO="".concat("dialog","-show"),dO="".concat("dialog","-1"),hO="".concat("dialog","-2"),lS=!1,dS=function(){return!!document.querySelector(".".concat(fa))},hS="".concat(Wo,"/").concat(Ji()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),fS="<br><a href='".concat(hS,"' target='_blank'>").concat(Ji()?"\u5176\u4ED6\u65B9\u6848\uFF1F":"Any other solution?","</a>"),fO="".concat(Ji()?"\u6D4F\u89C8\u5668\u81EA\u52A8\u64AD\u653E\u7B56\u7565\uFF1A\u5728\u7528\u6237\u4E0E\u9875\u9762\u4EA7\u751F\u4EA4\u4E92\uFF08\u70B9\u51FB\u3001\u89E6\u6478\uFF09\u4E4B\u524D\uFF0C\u6D4F\u89C8\u5668\u7981\u6B62\u64AD\u653E\u6709\u58F0\u5A92\u4F53\u3002\u8BE5\u5F39\u7A97\u7528\u4E8E\u5E2E\u52A9\u7528\u6237\u6062\u590D\u97F3\u89C6\u9891\u64AD\u653E\u3002".concat(fS):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat(fS)),pS=function(){function e(){if(w(this,e),this.dialogNode_=null,this.bodyPosition_="",this.content="\u97F3\u89C6\u9891\u64AD\u653E\u88AB\u6D4F\u89C8\u5668\u62E6\u622A\uFF0C\u8BF7\u70B9\u51FB\u201C\u6062\u590D\u64AD\u653E\u201D\u3002",Ji()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!lS){var t=document.createElement("style");t.innerHTML=".".concat(mp,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(mp," div:not(.").concat(Mu,"){display:block !important;}.").concat(fa,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(fa," a{color:").concat("#2473E8",";}.").concat(cS,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(gp,"{margin:8px 0;}.").concat(Mu,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat(_p,"{margin-right:auto;cursor:pointer}.").concat(vp,"{height:100%;line-height:16px;cursor:pointer;}.").concat(Uu,"{margin-left:8px;color:#fff;background:").concat("#2473E8",";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(Uu,":hover{opacity:0.9;}.").concat(_p,",.").concat(Uu,",.").concat(gp,",.").concat(vp,"{font-size:14px;}@media screen and (max-width:750px){.").concat(fa,"{width:80vw;}}"),document.head.appendChild(t),lS=!0}this.showDetail_=!1,this.isCollapseClicked_=!1,this.isQuestionClicked_=!1,this.addDiaLog()}return P(e,[{key:"createDiaLog",value:function(){var t=document.createElement("template");t.innerHTML='<div class="'.concat(mp,`"><div class='`).concat(fa,"'><div class='").concat(cS,"'>").concat(location.host,"</div><div class='").concat(gp,"'>").concat(this.content,"</div><div class='").concat(uS,`' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">`).concat(fO,"</div><div class='").concat(Mu,"'></div></div></div>").trim();var n=document.createElement("button");n.className=Uu,n.innerText=Ji()?"\u6062\u590D\u64AD\u653E":"Resume",n.onclick=this.onConfirm.bind(this);var i=document.createElement("div");i.className=vp,i.innerHTML=`<?xml version="1.0" encoding="UTF-8"?>
    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>
    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>
    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>
    </svg>
    `,i.onclick=this.onQuestionClick.bind(this);var o=document.createElement("div");o.className=_p,o.innerText="".concat(Ji()?"\u8BE6\u60C5 >":"Detail >"),o.onclick=this.onCollapseClick.bind(this);var c=t.content.firstChild,a=c.querySelector(".".concat(Mu));return a.appendChild(o),a.appendChild(i),a.appendChild(n),c}},{key:"addDiaLog",value:function(){dS()||(this.dialogNode_=this.createDiaLog(),document.body.appendChild(this.dialogNode_),this.dialogNode_.onclick=this.onConfirm.bind(this),this.dialogNode_.querySelector(".".concat(fa)).onclick=function(t){return t.stopPropagation()},this.bodyPosition_=document.body.style.position,document.body.style.position="fixed",ye.warn("show autoplay dialog"),Se.uploadEvent({log:lO}))}},{key:"deleteDiaLog",value:function(){this.dialogNode_&&(document.body.removeChild(this.dialogNode_),document.body.style.position=this.bodyPosition_,this.dialogNode_=null)}},{key:"onConfirm",value:function(){ye.warn("confirm clicked, try resume stream"),J.emit(ws),this.deleteDiaLog()}},{key:"onCollapseClick",value:function(){var t=this.dialogNode_.querySelector(".".concat(uS));t.style.visibility="".concat(this.showDetail_?"hidden":"visible"),t.style.height="".concat(this.showDetail_?0:"fit-content"),this.showDetail_=!this.showDetail_,this.isCollapseClicked_||Se.uploadEvent({log:dO}),this.isCollapseClicked_=!0}},{key:"onQuestionClick",value:function(){window.open(hS,"_blank"),this.isQuestionClicked_||Se.uploadEvent({log:hO}),this.isQuestionClicked_=!0}}]),e}(),mS=function(){function e(i){w(this,e),this.stream_=i.stream,this.userId_=i.stream.getUserId(),this.log_=this.stream_.getLogger(),this.track_=i.track,this.div_=i.div,this.muted_=i.muted,this.objectFit_=i.objectFit,this.mirror_=i.mirror,this.emitter_=new mi,this.initializeElement(),this.state_="NONE",this.pausedRetryCount_=5}var t,n;return P(e,[{key:"isPlaying",get:function(){return this.state_==="PLAYING"}},{key:"initializeElement",value:function(){var i=new MediaStream;i.addTrack(this.track_);var o=document.createElement(Ue);o.srcObject=i,o.muted=!0;var c="width: 100%; height: 100%; object-fit: ".concat(this.objectFit_,";");this.mirror_&&(c+="transform: scaleX(-1);"),o.setAttribute("id","video_".concat(this.stream_.getId())),o.setAttribute("style",c),o.setAttribute("autoplay","autoplay"),o.setAttribute("playsinline","playsinline"),this.div_&&this.div_.appendChild(o),this.element_=o,this.handleEvents()}},{key:"setRect",value:function(i){var o=i.width,c=i.height;this.element_&&(this.element_.style.width=o+"px",this.element_.style.height=c+"px")}},{key:"setMirror",value:function(i){this.element_&&(this.element_.style.transform=i?"scaleX(-1)":"",this.mirror_=i)}},{key:"setObjectFit",value:function(i){this.element_&&(this.element_.style.objectFit="".concat(i),this.objectFit_=i)}},{key:"play",value:(n=b(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,this.element_.play();case 3:c.next=11;break;case 5:if(c.prev=5,c.t0=c.catch(0),this.log_.warn("<video> play() error: "+c.t0),!(o=c.t0.toString()+" <video>").startsWith("NotAllowedError")){c.next=11;break}throw new Y({code:Q.PLAY_NOT_ALLOWED,message:o});case 11:case"end":return c.stop()}},i,this,[[0,5]])})),function(){return n.apply(this,arguments)})},{key:"handleEvents",value:function(){this.handleElementEvent=this.handleElementEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.element_.addEventListener(si,this.handleElementEvent),this.element_.addEventListener(Ot,this.handleElementEvent),this.element_.addEventListener(ci,this.handleElementEvent),this.element_.addEventListener($o,this.handleElementEvent),this.element_.addEventListener(Uh,this.handleElementEvent),this.track_.addEventListener(Ot,this.handleTrackEvent),this.track_.addEventListener(pn,this.handleTrackEvent),this.track_.addEventListener(lr,this.handleTrackEvent),this.track_.readyState===Ot&&this.handleTrackEvent({type:Ot}),this.track_.muted&&this.handleTrackEvent({type:pn})}},{key:"handleElementEvent",value:function(i){switch(i.type){case si:this.log_.info("stream - video player is starting playing"),this.state_="PLAYING",J.emit(ks,{stream:this.stream_}),this.emitter_.emit(_n,{state:this.state_,reason:si});break;case Ot:this.log_.info("stream - video player is ended"),this.state_!=="STOPPED"&&(this.state_="STOPPED",this.emitter_.emit(_n,{state:this.state_,reason:Ot}));break;case ci:this.log_.info("stream - video player is paused"),this.div_&&!document.getElementById(this.div_.id)&&this.log_.warn("video container is not in DOM"),this.state_="PAUSED",this.emitter_.emit(_n,{state:this.state_,reason:ci}),this.pausedRetryCount_>0&&!dS()&&(this.log_.info("auto resume when video paused"),this.resume(),this.pausedRetryCount_--);break;case $o:if(this.element_&&this.element_.error){var o="".concat(Yf(),"/").concat($i().name,"/").concat($i().version);this.log_.error("stream - video player error observed. code: ".concat(this.element_.error.code," message: ").concat(this.element_.error.message," deviceInfo: ").concat(o)),Se.uploadEvent("stat-".concat(this.stream_.getType(),"-video-").concat(t0,"-").concat(this.element_.error.code,"-").concat(o),this.element_.error)}break;case Uh:J.emit(Af,{stream:this.stream_})}}},{key:"handleTrackEvent",value:function(i){var o=i.type;switch(o){case Ot:this.log_.info("stream - video player track is ended"),J.emit(Pf,{stream:this.stream_,type:o}),this.state_!=="STOPPED"&&(this.state_="STOPPED",this.emitter_.emit(_n,{state:this.state_,reason:Ot}));break;case pn:this.log_.info("stream - video track is unable to provide media output"),this.stream_.isRemote()||A0(),J.emit(Ts,{stream:this.stream_,type:o}),this.state_!=="PAUSED"&&(this.state_="PAUSED",this.emitter_.emit(_n,{state:this.state_,reason:pn}));break;case lr:this.log_.info("stream - video track is able to provide media output"),J.emit(Cf,{stream:this.stream_}),this.state_==="PAUSED"&&(this.state_="PLAYING",this.emitter_.emit(_n,{state:this.state_,reason:lr}))}}},{key:"unbindEvents",value:function(){this.element_&&(this.element_.removeEventListener(si,this.handleElementEvent),this.element_.removeEventListener(Ot,this.handleElementEvent),this.element_.removeEventListener(ci,this.handleElementEvent),this.element_.removeEventListener($o,this.handleElementEvent),this.element_.removeEventListener(Uh,this.handleElementEvent)),this.track_&&(this.track_.removeEventListener(Ot,this.handleTrackEvent),this.track_.removeEventListener(pn,this.handleTrackEvent),this.track_.removeEventListener(lr,this.handleTrackEvent))}},{key:"stop",value:function(){this.unbindEvents(),this.div_&&this.div_.removeChild(this.element_),this.element_.srcObject=null,this.element_=null}},{key:"resume",value:(t=b(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,this.element_.play();case 3:c.next=11;break;case 5:if(c.prev=5,c.t0=c.catch(0),this.log_.warn("<video> play() error: "+c.t0),!(o=Z({key:JA,data:{error:c.t0}})).startsWith("NotAllowedError")){c.next=11;break}throw new Y({code:Q.PLAY_NOT_ALLOWED,message:o});case 11:case"end":return c.stop()}},i,this,[[0,5]])})),function(){return t.apply(this,arguments)})},{key:"getVideoFrame",value:function(){var i=document.createElement("canvas");return i.width=this.element_.videoWidth,i.height=this.element_.videoHeight,i.getContext("2d").drawImage(this.element_,0,0),i.toDataURL("image/png")}},{key:"on",value:function(i,o){this.emitter_.on(i,o)}},{key:"getElement",value:function(){return this.element_?this.element_:null}}]),e}(),yp=typeof ArrayBuffer<"u"&&typeof DataView<"u",pO=z.RangeError,pa=function(e){if(e===void 0)return 0;var t=Qn(e),n=sr(t);if(t!==n)throw pO("Wrong length or index");return n},mO=z.Array,gO=Math.abs,Ur=Math.pow,vO=Math.floor,_O=Math.log,yO=Math.LN2,bO=function(e,t,n){var i,o,c,a=mO(n),u=8*n-t-1,l=(1<<u)-1,h=l>>1,f=t===23?Ur(2,-24)-Ur(2,-77):0,m=e<0||e===0&&1/e<0?1:0,g=0;for((e=gO(e))!=e||e===1/0?(o=e!=e?1:0,i=l):(i=vO(_O(e)/yO),e*(c=Ur(2,-i))<1&&(i--,c*=2),(e+=i+h>=1?f/c:f*Ur(2,1-h))*c>=2&&(i++,c/=2),i+h>=l?(o=0,i=l):i+h>=1?(o=(e*c-1)*Ur(2,t),i+=h):(o=e*Ur(2,h-1)*Ur(2,t),i=0));t>=8;)a[g++]=255&o,o/=256,t-=8;for(i=i<<t|o,u+=t;u>0;)a[g++]=255&i,i/=256,u-=8;return a[--g]|=128*m,a},SO=function(e,t){var n,i=e.length,o=8*i-t-1,c=(1<<o)-1,a=c>>1,u=o-7,l=i-1,h=e[l--],f=127&h;for(h>>=7;u>0;)f=256*f+e[l--],u-=8;for(n=f&(1<<-u)-1,f>>=-u,u+=t;u>0;)n=256*n+e[l--],u-=8;if(f===0)f=1-a;else{if(f===c)return n?NaN:h?-1/0:1/0;n+=Ur(2,t),f-=a}return(h?-1:1)*n*Ur(2,f-t)},gS=function(e){for(var t=sn(this),n=un(t),i=arguments.length,o=cn(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,a=c===void 0?n:cn(c,n);a>o;)t[o++]=e;return t},kO=Zr.f,IO=Ht.f,TO=Xr.PROPER,vS=Xr.CONFIGURABLE,ma=Dt.get,_S=Dt.set,er=z.ArrayBuffer,tr=er,ga=tr&&tr.prototype,Vr=z.DataView,Yi=Vr&&Vr.prototype,yS=Object.prototype,wO=z.Array,Vu=z.RangeError,EO=ne(gS),CO=ne([].reverse),bS=bO,SS=SO,kS=function(e){return[255&e]},IS=function(e){return[255&e,e>>8&255]},TS=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},wS=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},RO=function(e){return bS(e,23,4)},AO=function(e){return bS(e,52,8)},Fu=function(e,t){IO(e.prototype,t,{get:function(){return ma(this)[t]}})},_i=function(e,t,n,i){var o=pa(n),c=ma(e);if(o+t>c.byteLength)throw Vu("Wrong index");var a=ma(c.buffer).bytes,u=o+c.byteOffset,l=Gt(a,u,u+t);return i?l:CO(l)},yi=function(e,t,n,i,o,c){var a=pa(n),u=ma(e);if(a+t>u.byteLength)throw Vu("Wrong index");for(var l=ma(u.buffer).bytes,h=a+u.byteOffset,f=i(+o),m=0;m<t;m++)l[h+m]=f[c?m:t-m-1]};if(yp){var ES=TO&&er.name!=="ArrayBuffer";if(he(function(){er(1)})&&he(function(){new er(-1)})&&!he(function(){return new er,new er(1.5),new er(NaN),ES&&!vS}))ES&&vS&&Pt(er,"name","ArrayBuffer");else{(tr=function(e){return Mn(this,ga),new er(pa(e))}).prototype=ga;for(var bp,CS=kO(er),RS=0;CS.length>RS;)(bp=CS[RS++])in tr||Pt(tr,bp,er[bp]);ga.constructor=tr}$t&&cr(Yi)!==yS&&$t(Yi,yS);var ju=new Vr(new tr(2)),AS=ne(Yi.setInt8);ju.setInt8(0,2147483648),ju.setInt8(1,2147483649),!ju.getInt8(0)&&ju.getInt8(1)||is(Yi,{setInt8:function(e,t){AS(this,e,t<<24>>24)},setUint8:function(e,t){AS(this,e,t<<24>>24)}},{unsafe:!0})}else ga=(tr=function(e){Mn(this,ga);var t=pa(e);_S(this,{bytes:EO(wO(t),0),byteLength:t}),Te||(this.byteLength=t)}).prototype,Yi=(Vr=function(e,t,n){Mn(this,Yi),Mn(e,ga);var i=ma(e).byteLength,o=Qn(t);if(o<0||o>i)throw Vu("Wrong offset");if(o+(n=n===void 0?i-o:sr(n))>i)throw Vu("Wrong length");_S(this,{buffer:e,byteLength:n,byteOffset:o}),Te||(this.buffer=e,this.byteLength=n,this.byteOffset=o)}).prototype,Te&&(Fu(tr,"byteLength"),Fu(Vr,"buffer"),Fu(Vr,"byteLength"),Fu(Vr,"byteOffset")),is(Yi,{getInt8:function(e){return _i(this,1,e)[0]<<24>>24},getUint8:function(e){return _i(this,1,e)[0]},getInt16:function(e){var t=_i(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=_i(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return wS(_i(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return wS(_i(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return SS(_i(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return SS(_i(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){yi(this,1,e,kS,t)},setUint8:function(e,t){yi(this,1,e,kS,t)},setInt16:function(e,t){yi(this,2,e,IS,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){yi(this,2,e,IS,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){yi(this,4,e,TS,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){yi(this,4,e,TS,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){yi(this,4,e,RO,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){yi(this,8,e,AO,t,arguments.length>2?arguments[2]:void 0)}});ti(tr,"ArrayBuffer"),ti(Vr,"DataView");var va={ArrayBuffer:tr,DataView:Vr},Sp=va.ArrayBuffer,kp=va.DataView,xS=kp.prototype,PS=ne(Sp.prototype.slice),xO=ne(xS.getUint8),PO=ne(xS.setUint8),DO=he(function(){return!new Sp(2).slice(1,void 0).byteLength});Me({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:DO},{slice:function(e,t){if(PS&&t===void 0)return PS(gt(this),e);for(var n=gt(this).byteLength,i=cn(e,n),o=cn(t===void 0?n:t,n),c=new(Kc(this,Sp))(sr(o-i)),a=new kp(this),u=new kp(c),l=0;i<o;)PO(u,l++,xO(a,i++));return c}}),Me({global:!0,constructor:!0,forced:!yp},{DataView:va.DataView});var OO=ne([].reverse),DS=[1,2];Me({target:"Array",proto:!0,forced:String(DS)===String(DS.reverse())},{reverse:function(){return Di(this)&&(this.length=this.length),OO(this)}});var NO=z.TypeError,OS=function(e){return function(t,n,i,o){an(n);var c=sn(t),a=oe(c),u=un(c),l=e?u-1:0,h=e?-1:1;if(i<2)for(;;){if(l in a){o=a[l],l+=h;break}if(l+=h,e?l<0:u<=l)throw NO("Reduce of empty array with no initial value")}for(;e?l>=0:u>l;l+=h)l in a&&(o=n(o,a[l],l,c));return o}},Ip={left:OS(!1),right:OS(!0)},LO=Ip.left,MO=as("reduce");Me({target:"Array",proto:!0,forced:!MO||!Cr&&tt>79&&tt<83},{reduce:function(e){var t=arguments.length;return LO(this,e,t,t>1?arguments[1]:void 0)}});var NS=va.ArrayBuffer,UO=z.ArrayBuffer;Me({global:!0,constructor:!0,forced:UO!==NS},{ArrayBuffer:NS}),os("ArrayBuffer");var VO=Xa("slice"),FO=ht("species"),Tp=z.Array,jO=Math.max;Me({target:"Array",proto:!0,forced:!VO},{slice:function(e,t){var n,i,o,c=me(this),a=un(c),u=cn(e,a),l=cn(t===void 0?a:t,a);if(Di(c)&&(n=c.constructor,(Ec(n)&&(n===Tp||Di(n.prototype))||ie(n)&&(n=n[FO])===null)&&(n=void 0),n===Tp||n===void 0))return ii(c,u,l);for(i=new(n===void 0?Tp:n)(jO(l-u,0)),o=0;u<l;u++,o++)u in c&&Li(i,o,c[u]);return i.length=o,i}});var BO=Gc.trim,Us=z.parseInt,LS=z.Symbol,MS=LS&&LS.iterator,US=/^[+-]?0x/i,HO=ne(US.exec),VS=Us(Ao+"08")!==8||Us(Ao+"0x16")!==22||MS&&!he(function(){Us(Object(MS))})?function(e,t){var n=BO(Fe(e));return Us(n,t>>>0||(HO(US,n)?16:10))}:Us;Me({global:!0,forced:parseInt!=VS},{parseInt:VS});var yn,_a,Bu,$O=Ht.f,Hu=z.Int8Array,wp=Hu&&Hu.prototype,FS=z.Uint8ClampedArray,jS=FS&&FS.prototype,mr=Hu&&cr(Hu),nr=wp&&cr(wp),zO=Object.prototype,Ep=z.TypeError,BS=ht("toStringTag"),Cp=Wa("TYPED_ARRAY_TAG"),Rp=Wa("TYPED_ARRAY_CONSTRUCTOR"),Fr=yp&&!!$t&&wr(z.opera)!=="Opera",HS=!1,jr={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ap={BigInt64Array:8,BigUint64Array:8},$S=function(e){if(!ie(e))return!1;var t=wr(e);return Qe(jr,t)||Qe(Ap,t)};for(yn in jr)(Bu=(_a=z[yn])&&_a.prototype)?Pt(Bu,Rp,_a):Fr=!1;for(yn in Ap)(Bu=(_a=z[yn])&&_a.prototype)&&Pt(Bu,Rp,_a);if((!Fr||!te(mr)||mr===Function.prototype)&&(mr=function(){throw Ep("Incorrect invocation")},Fr))for(yn in jr)z[yn]&&$t(z[yn],mr);if((!Fr||!nr||nr===zO)&&(nr=mr.prototype,Fr))for(yn in jr)z[yn]&&$t(z[yn].prototype,nr);if(Fr&&cr(jS)!==nr&&$t(jS,nr),Te&&!Qe(nr,BS))for(yn in HS=!0,$O(nr,BS,{get:function(){return ie(this)?this[Cp]:void 0}}),jr)z[yn]&&Pt(z[yn],Cp,yn);var Oe={NATIVE_ARRAY_BUFFER_VIEWS:Fr,TYPED_ARRAY_CONSTRUCTOR:Rp,TYPED_ARRAY_TAG:HS&&Cp,aTypedArray:function(e){if($S(e))return e;throw Ep("Target is not a typed array")},aTypedArrayConstructor:function(e){if(te(e)&&(!$t||ke(mr,e)))return e;throw Ep(Ut(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,i){if(Te){if(n)for(var o in jr){var c=z[o];if(c&&Qe(c.prototype,e))try{delete c.prototype[e]}catch{try{c.prototype[e]=t}catch{}}}nr[e]&&!n||bt(nr,e,n?t:Fr&&wp[e]||t,i)}},exportTypedArrayStaticMethod:function(e,t,n){var i,o;if(Te){if($t){if(n){for(i in jr)if((o=z[i])&&Qe(o,e))try{delete o[e]}catch{}}if(mr[e]&&!n)return;try{return bt(mr,e,n?t:Fr&&mr[e]||t)}catch{}}for(i in jr)!(o=z[i])||o[e]&&!n||bt(o,e,t)}},isView:function(e){if(!ie(e))return!1;var t=wr(e);return t==="DataView"||Qe(jr,t)||Qe(Ap,t)},isTypedArray:$S,TypedArray:mr,TypedArrayPrototype:nr},WO=Oe.NATIVE_ARRAY_BUFFER_VIEWS,GO=z.ArrayBuffer,Xi=z.Int8Array,JO=!WO||!he(function(){Xi(1)})||!he(function(){new Xi(-1)})||!_d(function(e){new Xi,new Xi(null),new Xi(1.5),new Xi(e)},!0)||he(function(){return new Xi(new GO(2),1,void 0).length!==1}),qO=z.RangeError,KO=z.RangeError,$u=function(e,t){var n=function(i){var o=Qn(i);if(o<0)throw qO("The argument can't be less than 0");return o}(e);if(n%t)throw KO("Wrong offset");return n},QO=Oe.aTypedArrayConstructor,zS=function(e){var t,n,i,o,c,a,u=j_(this),l=sn(e),h=arguments.length,f=h>1?arguments[1]:void 0,m=f!==void 0,g=rs(l);if(g&&!gd(g))for(a=(c=Eo(l,g)).next,l=[];!(o=Le(a,c)).done;)l.push(o.value);for(m&&h>2&&(f=Yn(f,arguments[2])),n=un(l),i=new(QO(u))(n),t=0;n>t;t++)i[t]=m?f(l[t],t):l[t];return i};Ie(function(e){var t=Zr.f,n=Cn.forEach,i=Dt.get,o=Dt.set,c=Ht.f,a=Yr.f,u=Math.round,l=z.RangeError,h=va.ArrayBuffer,f=h.prototype,m=va.DataView,g=Oe.NATIVE_ARRAY_BUFFER_VIEWS,v=Oe.TYPED_ARRAY_CONSTRUCTOR,I=Oe.TYPED_ARRAY_TAG,S=Oe.TypedArray,y=Oe.TypedArrayPrototype,E=Oe.aTypedArrayConstructor,C=Oe.isTypedArray,x=function(q,K){E(q);for(var De=0,R=K.length,T=new q(R);R>De;)T[De]=K[De++];return T},U=function(q,K){c(q,K,{get:function(){return i(this)[K]}})},G=function(q){var K;return ke(f,q)||(K=wr(q))=="ArrayBuffer"||K=="SharedArrayBuffer"},H=function(q,K){return C(q)&&!Kn(K)&&K in q&&rb(+K)&&K>=0},V=function(q,K){return K=_o(K),H(q,K)?Tr(2,q[K]):a(q,K)},j=function(q,K,De){return K=_o(K),!(H(q,K)&&ie(De)&&Qe(De,"value"))||Qe(De,"get")||Qe(De,"set")||De.configurable||Qe(De,"writable")&&!De.writable||Qe(De,"enumerable")&&!De.enumerable?c(q,K,De):(q[K]=De.value,q)};Te?(g||(Yr.f=V,Ht.f=j,U(y,"buffer"),U(y,"byteOffset"),U(y,"byteLength"),U(y,"length")),Me({target:"Object",stat:!0,forced:!g},{getOwnPropertyDescriptor:V,defineProperty:j}),e.exports=function(q,K,De){var R=q.match(/\d+$/)[0]/8,T=q+(De?"Clamped":"")+"Array",D="get"+q,O="set"+q,M=z[T],F=M,re=F&&F.prototype,pe={},ve=function(Ne,_e){c(Ne,_e,{get:function(){return function(Je,$e){var Re=i(Je);return Re.view[D]($e*R+Re.byteOffset,!0)}(this,_e)},set:function(Je){return function($e,Re,nt){var At=i($e);De&&(nt=(nt=u(nt))<0?0:nt>255?255:255&nt),At.view[O](Re*R+At.byteOffset,nt,!0)}(this,_e,Je)},enumerable:!0})};g?JO&&(F=K(function(Ne,_e,Je,$e){return Mn(Ne,re),Uc(ie(_e)?G(_e)?$e!==void 0?new M(_e,$u(Je,R),$e):Je!==void 0?new M(_e,$u(Je,R)):new M(_e):C(_e)?x(F,_e):Le(zS,F,_e):new M(pa(_e)),Ne,F)}),$t&&$t(F,S),n(t(M),function(Ne){Ne in F||Pt(F,Ne,M[Ne])}),F.prototype=re):(F=K(function(Ne,_e,Je,$e){Mn(Ne,re);var Re,nt,At,V1=0,tl=0;if(ie(_e)){if(!G(_e))return C(_e)?x(F,_e):Le(zS,F,_e);Re=_e,tl=$u(Je,R);var Gp=_e.byteLength;if($e===void 0){if(Gp%R||(nt=Gp-tl)<0)throw l("Wrong length")}else if((nt=sr($e)*R)+tl>Gp)throw l("Wrong length");At=nt/R}else At=pa(_e),Re=new h(nt=At*R);for(o(Ne,{buffer:Re,byteOffset:tl,byteLength:nt,length:At,view:new m(Re)});V1<At;)ve(Ne,V1++)}),$t&&$t(F,S),re=F.prototype=ko(y)),re.constructor!==F&&Pt(re,"constructor",F),Pt(re,v,F),I&&Pt(re,I,T);var se=F!=M;pe[T]=F,Me({global:!0,constructor:!0,forced:se,sham:!g},pe),"BYTES_PER_ELEMENT"in F||Pt(F,"BYTES_PER_ELEMENT",R),"BYTES_PER_ELEMENT"in re||Pt(re,"BYTES_PER_ELEMENT",R),os(T)}):e.exports=function(){}})("Uint8",function(e){return function(t,n,i){return e(this,t,n,i)}});var YO=Math.min,XO=ne([].copyWithin||function(e,t){var n=sn(this),i=un(n),o=cn(e,i),c=cn(t,i),a=arguments.length>2?arguments[2]:void 0,u=YO((a===void 0?i:cn(a,i))-c,i-o),l=1;for(c<o&&o<c+u&&(l=-1,c+=u-1,o+=u-1);u-- >0;)c in n?n[o]=n[c]:delete n[o],o+=l,c+=l;return n}),ZO=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("copyWithin",function(e,t){return XO(ZO(this),e,t,arguments.length>2?arguments[2]:void 0)});var eN=Cn.every,tN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("every",function(e){return eN(tN(this),e,arguments.length>1?arguments[1]:void 0)});var nN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("fill",function(e){var t=arguments.length;return Le(gS,nN(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)});var rN=Oe.TYPED_ARRAY_CONSTRUCTOR,iN=Oe.aTypedArrayConstructor,zu=function(e){return iN(Kc(e,e[rN]))},oN=function(e,t){return function(n,i){for(var o=0,c=un(i),a=new n(c);c>o;)a[o]=i[o++];return a}(zu(e),t)},aN=Cn.filter,sN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("filter",function(e){var t=aN(sN(this),e,arguments.length>1?arguments[1]:void 0);return oN(this,t)});var cN=Cn.find,uN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("find",function(e){return cN(uN(this),e,arguments.length>1?arguments[1]:void 0)});var lN=Cn.findIndex,dN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("findIndex",function(e){return lN(dN(this),e,arguments.length>1?arguments[1]:void 0)});var hN=Cn.forEach,fN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("forEach",function(e){hN(fN(this),e,arguments.length>1?arguments[1]:void 0)});var pN=Ka.includes,mN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("includes",function(e){return pN(mN(this),e,arguments.length>1?arguments[1]:void 0)});var gN=Ka.indexOf,vN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("indexOf",function(e){return gN(vN(this),e,arguments.length>1?arguments[1]:void 0)});var xp=ht("iterator"),WS=z.Uint8Array,_N=ne(ni.values),yN=ne(ni.keys),bN=ne(ni.entries),Pp=Oe.aTypedArray,Wu=Oe.exportTypedArrayMethod,ya=WS&&WS.prototype,Gu=!he(function(){ya[xp].call([1])}),GS=!!ya&&ya.values&&ya[xp]===ya.values&&ya.values.name==="values",JS=function(){return _N(Pp(this))};Wu("entries",function(){return bN(Pp(this))},Gu),Wu("keys",function(){return yN(Pp(this))},Gu),Wu("values",JS,Gu||!GS,{name:"values"}),Wu(xp,JS,Gu||!GS,{name:"values"});var SN=Oe.aTypedArray,kN=Oe.exportTypedArrayMethod,IN=ne([].join);kN("join",function(e){return IN(SN(this),e)});var TN=Math.min,Dp=[].lastIndexOf,qS=!!Dp&&1/[1].lastIndexOf(1,-0)<0,wN=as("lastIndexOf"),EN=qS||!wN?function(e){if(qS)return ri(Dp,this,arguments)||0;var t=me(this),n=un(t),i=n-1;for(arguments.length>1&&(i=TN(i,Qn(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:Dp,CN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("lastIndexOf",function(e){var t=arguments.length;return ri(EN,CN(this),t>1?[e,arguments[1]]:[e])});var RN=Cn.map,AN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("map",function(e){return RN(AN(this),e,arguments.length>1?arguments[1]:void 0,function(t,n){return new(zu(t))(n)})});var xN=Ip.left,PN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("reduce",function(e){var t=arguments.length;return xN(PN(this),e,t,t>1?arguments[1]:void 0)});var DN=Ip.right,ON=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("reduceRight",function(e){var t=arguments.length;return DN(ON(this),e,t,t>1?arguments[1]:void 0)});var NN=Oe.aTypedArray,LN=Oe.exportTypedArrayMethod,MN=Math.floor;LN("reverse",function(){for(var e,t=NN(this).length,n=MN(t/2),i=0;i<n;)e=this[i],this[i++]=this[--t],this[t]=e;return this});var UN=z.RangeError,Op=z.Int8Array,KS=Op&&Op.prototype,QS=KS&&KS.set,VN=Oe.aTypedArray,FN=Oe.exportTypedArrayMethod,Np=!he(function(){var e=new Uint8ClampedArray(2);return Le(QS,e,{length:1,0:3},1),e[1]!==3}),jN=Np&&Oe.NATIVE_ARRAY_BUFFER_VIEWS&&he(function(){var e=new Op(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});FN("set",function(e){VN(this);var t=$u(arguments.length>1?arguments[1]:void 0,1),n=sn(e);if(Np)return Le(QS,this,n,t);var i=this.length,o=un(n),c=0;if(o+t>i)throw UN("Wrong length");for(;c<o;)this[t+c]=n[c++]},!Np||jN);var BN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("slice",function(e,t){for(var n=ii(BN(this),e,t),i=zu(this),o=0,c=n.length,a=new i(c);c>o;)a[o]=n[o++];return a},he(function(){new Int8Array(1).slice()}));var HN=Cn.some,$N=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("some",function(e){return HN($N(this),e,arguments.length>1?arguments[1]:void 0)});var YS=Ee.match(/firefox\/(\d+)/i),XS=!!YS&&+YS[1],zN=/MSIE|Trident/.test(Ee),ZS=Ee.match(/AppleWebKit\/(\d+)\./),e1=!!ZS&&+ZS[1],WN=Oe.aTypedArray,GN=Oe.exportTypedArrayMethod,Vs=z.Uint16Array,ba=Vs&&ne(Vs.prototype.sort),JN=!(!ba||he(function(){ba(new Vs(2),null)})&&he(function(){ba(new Vs(2),{})})),t1=!!ba&&!he(function(){if(tt)return tt<74;if(XS)return XS<67;if(zN)return!0;if(e1)return e1<602;var e,t,n=new Vs(516),i=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,i[e]=e-2*t+3;for(ba(n,function(o,c){return(o/4|0)-(c/4|0)}),e=0;e<516;e++)if(n[e]!==i[e])return!0});GN("sort",function(e){return e!==void 0&&an(e),t1?ba(this,e):u_(WN(this),function(t){return function(n,i){return t!==void 0?+t(n,i)||0:i!=i?-1:n!=n?1:n===0&&i===0?1/n>0&&1/i<0?1:-1:n>i}}(e))},!t1||JN);var qN=Oe.aTypedArray;(0,Oe.exportTypedArrayMethod)("subarray",function(e,t){var n=qN(this),i=n.length,o=cn(e,i);return new(zu(n))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,sr((t===void 0?i:cn(t,i))-o))});var Ju=z.Int8Array,n1=Oe.aTypedArray,KN=Oe.exportTypedArrayMethod,r1=[].toLocaleString,QN=!!Ju&&he(function(){r1.call(new Ju(1))});KN("toLocaleString",function(){return ri(r1,QN?ii(n1(this)):n1(this),ii(arguments))},he(function(){return[1,2].toLocaleString()!=new Ju([1,2]).toLocaleString()})||!he(function(){Ju.prototype.toLocaleString.call([1,2])}));var YN=Oe.exportTypedArrayMethod,i1=z.Uint8Array,XN=i1&&i1.prototype||{},qu=[].toString,ZN=ne([].join);he(function(){qu.call({})})&&(qu=function(){return ZN(this)});var eL=XN.toString!=qu;YN("toString",qu,eL);var tL=function(){function e(t,n,i){w(this,e),this.isUplink_=i,this.connection_=t,this.log_=n,this.seiMessageList_=[],this.seiPayloadType_=243,this.senderOrReceiver_=null,this.abortController_=null,this.abortMap_=new Map,this.onSEIMessage=null}return P(e,[{key:"isRunning",get:function(){return!!this.abortController_}},{key:"start",value:function(t){this.senderOrReceiver_=t;var n=t.createEncodedStreams(),i=n.readable,o=n.writable,c=new TransformStream({transform:this.isUplink_?this.encodeVideoFrame.bind(this):this.decodeVideoFrame.bind(this)});this.abortController_=new AbortController,i.pipeThrough(c).pipeTo(o,{signal:this.abortController_.signal}).catch(function(){})}},{key:"restart",value:function(t){this.stop(),this.start(t)}},{key:"stop",value:function(){var t;(t=this.abortController_)===null||t===void 0||t.abort(),this.abortController_=null}},{key:"destory",value:function(){this.stop(),this.abortMap_.forEach(function(t){return t.abort()}),this.abortMap_.clear(),this.log_=null,this.onSEIMessage=null,this.senderOrReceiver_=null,this.connection_=null}},{key:"handleEncodedStreams",value:function(){var t=this;try{var n=this.connection_.getPeerConnection();if(this.clearUnusedSenderOrReceiver(n),this.isUplink_){var i,o=(i=this.connection_.getLocalStream())===null||i===void 0?void 0:i.getVideoTrack();n.getSenders().forEach(function(c){t.abortMap_.has(c)||c===t.senderOrReceiver_||(c.track&&c.track===o?t.isRunning?t.restart(c):t.start(c):t.pipeSenderOrReceiver(c))})}else n.getReceivers().forEach(function(c,a){var u;t.abortMap_.has(c)||c===t.senderOrReceiver_||(a===1&&((u=c.track)===null||u===void 0?void 0:u.kind)===Ue?t.isRunning?t.restart(c):t.start(c):t.pipeSenderOrReceiver(c))})}catch(c){this.log_.warn(c)}}},{key:"pipeSenderOrReceiver",value:function(t){var n=t.createEncodedStreams(),i=n.readable,o=n.writable,c=new AbortController;this.abortMap_.set(t,c),i.pipeTo(o,{signal:c.signal}).catch(function(){})}},{key:"clearUnusedSenderOrReceiver",value:function(t){var n=this;this.abortMap_.forEach(function(i,o){(n.isUplink_?t.getSenders():t.getReceivers()).find(function(c){return c===o})||(i.abort(),n.abortMap_.delete(o))})}},{key:"push",value:function(t,n){n&&n.seiPayloadType&&(this.seiPayloadType_=n.seiPayloadType),this.seiMessageList_.push(t)}},{key:"hasSEI",value:function(t){var n=new DataView(t);return n.getInt32(0)===1&&n.getInt8(4)===6}},{key:"isEmptyFrame",value:function(t){return t.type==="empty"||t.data.byteLength===0}},{key:"getNaluCount",value:function(t){for(var n=0,i=0,o=new DataView(t),c=0;c<t.byteLength;c++)switch(o.getUint8(c)){case 0:n++;break;case 1:n!==2&&n!==3||i++,n=0;break;default:n=0}return i}},{key:"encodeVideoFrame",value:function(t,n){try{if(this.connection_.isH264&&this.seiMessageList_.length>0&&!this.isEmptyFrame(t)){var i=9-this.getNaluCount(t.data);if(i<=0)return;for(var o=this.seiMessageList_.splice(0,i).reverse().map(this.encodeSEINalu.bind(this)),c=o.reduce(function(v,I){return v+I.dataView.byteLength},0),a=new ArrayBuffer(c+t.data.byteLength),u=new DataView(a),l=new DataView(t.data),h=0,f=0;f<o.length;f++)for(var m=0;m<o[f].dataView.byteLength;m++)u.setInt8(h++,o[f].dataView.getInt8(m));for(var g=0;g<t.data.byteLength;g++)u.setInt8(h++,l.getInt8(g));t.data=a,this.log_.debug("".concat(o.length," sei sent"))}}catch(v){this.log_.warn(v)}n.enqueue(t)}},{key:"decodeVideoFrame",value:function(t,n){var i=this;try{if(this.connection_.isH264&&!this.isEmptyFrame(t)&&this.hasSEI(t.data)){for(var o=[],c=new DataView(t.data),a=0,u=-1,l=-1,h=0;h<t.data.byteLength;h++){var f=c.getUint8(h);if(f===0)a++;else if(f===1){if(a===2||a===3){var m=h-a;if(u===-1?u=m:l===-1&&(l=m,o.push(new o1(new DataView(c.buffer.slice(u,l)))),u=m,l=-1),c.getUint8(h+1)!==6){t.data=new DataView(c.buffer.slice(m)).buffer;break}}a=0}else a=0}this.log_.debug("".concat(o.length," sei received")),hr(this.onSEIMessage)&&o.reverse().forEach(function(g){i.onSEIMessage({seiPayloadType:g.seiPayloadType,data:g.seiPayload.buffer})})}}catch(g){this.log_.warn(g)}n.enqueue(t)}},{key:"encodeSEINalu",value:function(t){var n=t.byteLength,i=parseInt(n/255),o=n%255,c=[];c.push(0,0,0,1,6,this.seiPayloadType_);for(var a=0;a<i;a++)c.push(255);c.push(o);var u=new DataView(t);return c.push.apply(c,Ke(new Uint8Array(u.buffer))),c.push(128),new o1(new DataView(new Uint8Array(c).buffer),!0)}}]),e}(),o1=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];w(this,e),this.dataView=t,this.isSEI&&(n?this.addPreventionByte():this.removePreventionByte())}return P(e,[{key:"addPreventionByte",value:function(){for(var t=this.seiPayloadStartIndex,n=this.dataView.byteLength-2,i=[],o=0,c=t;c<=n;c++){var a=this.dataView.getInt8(c);switch(a){case 0:case 1:case 2:case 3:o===2&&(i.push(3),o=0),a==0?o++:o=0,i.push(a);break;default:o=0,i.push(a)}}i.push(this.dataView.getInt8(this.dataView.byteLength-1));var u=new DataView(new Uint8Array([].concat(Ke(new Uint8Array(this.dataView.buffer).slice(0,t)),i)).buffer);this.dataView=u}},{key:"removePreventionByte",value:function(){for(var t=this.seiPayloadStartIndex,n=this.dataView.byteLength-1,i=[],o=0,c=t;c<=n;c++)switch(this.dataView.getInt8(c)){case 0:o++,i.push(this.dataView.getInt8(c));break;case 3:o!==2&&i.push(this.dataView.getInt8(c)),o=0;break;default:i.push(this.dataView.getInt8(c)),o=0}var a=new DataView(new Uint8Array([].concat(Ke(new Uint8Array(this.dataView.buffer).slice(0,t)),i)).buffer);this.dataView=a}},{key:"isSEI",get:function(){return this.dataView.getUint8(4)===6}},{key:"seiPayloadStartIndex",get:function(){for(var t=6,n=6;n<this.dataView.buffer.byteLength&&(t++,this.dataView.getUint8(n)===255);n++);return t}},{key:"seiPayloadType",get:function(){return this.isSEI?this.dataView.getUint8(5):null}},{key:"seiPayload",get:function(){if(!this.isSEI)return null;for(var t=0,n=6,i=6;i<this.dataView.buffer.byteLength;i++){var o=this.dataView.getUint8(i);if(n++,o!==255){t+=o;break}t+=255}for(var c=new ArrayBuffer(t),a=new DataView(c),u=0;u<c.byteLength;u++,n++)a.setInt8(u,this.dataView.getInt8(n));return a}}]),e}(),Lp=function(){function e(n){w(this,e),this.userId_=n.userId,this.tinyId_=n.tinyId,this.client_=n.client,this.sdpSemantics_=n.client.getSdpSemantics(),this.isUplink_=n.isUplink,this.log_=ye.createLogger({id:"n|"+this.userId_,userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId(),isLocal:this.isUplink_}),this.signalChannel_=n.signalChannel,this.peerConnection_=null,this.connectTimer_=-1,this.isErrorObserved_=!1,this.emitter_=new mi,this.currentState_=dn,this.waitForPeerConnectionConnectedPromise_=null,this.isReconnecting_=!1,this.reconnectionCount_=0,this.reconnectionTimer_=-1,this.isFirstConnection_=!0,this.delay_={audioDelay:0,videoDelay:0},this.enableSEI_=n.enableSEI,this.enableSEI_&&Kf&&(this.sei_=new tL(this,this.log_,this.isUplink_))}var t;return P(e,[{key:"initialize",value:function(){var n={encodedInsertableStreams:this.enableSEI_&&Kf,iceServers:this.client_.getIceServers(),iceTransportPolicy:this.client_.getIceTransportPolicy(),sdpSemantics:this.sdpSemantics_,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"};this.peerConnection_=new RTCPeerConnection(n),this.peerConnection_.onconnectionstatechange=this.onConnectionStateChange.bind(this)}},{key:"close",value:function(){this.log_.info("closing connection"),this.closePeerConnection(),this.sei_&&(this.sei_.destory(),this.sei_=null)}},{key:"closePeerConnection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.peerConnection_&&(this.peerConnection_.onconnectionstatechange=function(){},this.peerConnection_.close(),this.peerConnection_=null,n&&this.emitConnectionStateChangedEvent(dn))}},{key:"getDTLSTransportState",value:function(){if(!this.peerConnection_)return"unknown";var n=null;if(this.isUplink_){if(!Cu()||this.peerConnection_.getSenders().length===0)return"unknown";n=this.peerConnection_.getSenders()[0].transport}else{if(!Rb()||this.peerConnection_.getReceivers().length===0)return"unknown";n=this.peerConnection_.getReceivers()[0].transport}return n?n.state:"unknown"}},{key:"onConnectionStateChange",value:function(n){var i=this.peerConnection_.iceConnectionState,o=this.getDTLSTransportState();if(this.log_.info("onConnectionStateChange() connectionState: "+n.target.connectionState),this.log_.info("ICE Transport state: ".concat(i,", DTLS Transport state: ").concat(o)),n.target.connectionState===lu&&this.emitConnectionStateChangedEvent(Ny),n.target.connectionState===My||n.target.connectionState===jh){var c="".concat(this.isUplink_?"uplink":"downlink"," ICE/DTLS Transport connection ").concat(n.target.connectionState,". ICE Transport state: ").concat(i,", DTLS Transport state: ").concat(o),a=new Y({message:c,code:Q.ICE_TRANSPORT_ERROR});Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Ky,error:a}),this.emitConnectionStateChangedEvent(dn),this.isErrorObserved_||this.emitter_.emit(it.ERROR,a)}n.target.connectionState!==Uy&&n.target.connectionState!==mA||(this.logSelectedCandidate(),Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:Ky}),this.emitConnectionStateChangedEvent(mn))}},{key:"emitConnectionStateChangedEvent",value:function(n){n!==this.currentState_&&(this.currentState_===Ly&&n===Ny||(J.emit(Nf,{client:this.client_,connection:this,prevState:this.currentState_,state:n}),this.emitter_.emit(it.CONNECTION_STATE_CHANGED,{prevState:this.currentState_,state:n}),this.currentState_=n))}},{key:"hitTest",value:function(n){return(n===0||n==="0")&&this.isUplink_||n===this.tinyId_}},{key:"addEventInternal",value:function(n,i){var o=this.client_.getUserId(),c={eventId:n,eventDesc:i,timestamp:ln(),userId:o,tinyId:this.client_.getTinyId()};this.isUplink_||(c.remoteUserId=this.userId_,c.remoteTinyId=this.tinyId_),gn(o,c)}},{key:"getPeerConnection",value:function(){return this.peerConnection_}},{key:"getClient",value:function(){return this.client_}},{key:"getUserId",value:function(){return this.userId_}},{key:"getTinyId",value:function(){return this.tinyId_}},{key:"logSelectedCandidate",value:(t=b(regeneratorRuntime.mark(function n(){var i,o,c,a,u,l,h;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.peerConnection_){f.next=2;break}return f.abrupt("return");case 2:return f.next=4,this.peerConnection_.getStats();case 4:i=f.sent,o=Ge(i),f.prev=6,o.s();case 8:if((c=o.n()).done){f.next=18;break}if((a=Xe(c.value,2))[0],u=a[1],!Qf(u)){f.next=16;break}return l=i.get(u.localCandidateId),h=i.get(u.remoteCandidateId),l&&this.log_.info("local candidate: ".concat(l.candidateType," ").concat(l.protocol,":").concat(l.ip||l.address,":").concat(l.port," ").concat(l.networkType||""," ").concat(l.candidateType==="relay"?"relayProtocol:"+l.relayProtocol:"")),h&&this.log_.info("remote candidate: ".concat(h.candidateType," ").concat(h.protocol,":").concat(h.ip||h.address,":").concat(h.port)),f.abrupt("break",18);case 16:f.next=8;break;case 18:f.next=23;break;case 20:f.prev=20,f.t0=f.catch(6),o.e(f.t0);case 23:return f.prev=23,o.f(),f.finish(23);case 26:case"end":return f.stop()}},n,this,[[6,20,23,26]])})),function(){return t.apply(this,arguments)})},{key:"getCurrentState",value:function(){return this.currentState_}},{key:"waitForPeerConnectionConnected",value:function(){var n=this;return this.waitForPeerConnectionConnectedPromise_||(this.waitForPeerConnectionConnectedPromise_=new Promise(function(i,o){if(n.currentState_===mn)return i();var c=-1,a=function u(l){l.state===mn&&(clearTimeout(c),n.emitter_.off(it.CONNECTION_STATE_CHANGED,u,n),i())};c=setTimeout(function(){n.emitter_.off(it.CONNECTION_STATE_CHANGED,a,n);var u=new Y({code:Q.API_CALL_TIMEOUT,message:"connection timeout"});o(u)},1e4),n.emitter_.on(it.CONNECTION_STATE_CHANGED,a,n)}),this.waitForPeerConnectionConnectedPromise_=this.waitForPeerConnectionConnectedPromise_.then(function(i){return n.waitForPeerConnectionConnectedPromise_=null,i}).catch(function(i){throw n.waitForPeerConnectionConnectedPromise_=null,i})),this.waitForPeerConnectionConnectedPromise_}},{key:"getReconnectionCount",value:function(){return this.reconnectionCount_}},{key:"startReconnection",value:function(){this.isReconnecting_=!0,this.emitConnectionStateChangedEvent(Ly),this.reconnect(),this.addEventInternal(this.isUplink_?K2:X2,"".concat(this.isUplink_?"uplink":"downlink","-connection is reconnecting"))}},{key:"stopReconnection",value:function(){this.log_.info("stop reconnection"),this.isReconnecting_=!1,this.reconnectionCount_=0,this.clearReconnectionTimer(),this.signalChannel_.off(Cs,this.reconnect,this)}},{key:"on",value:function(n,i,o){this.emitter_.on(n,i,o)}},{key:"off",value:function(n,i,o){this.emitter_.off(n,i,o)}},{key:"setDelay",value:function(n){var i=n.audioDelay,o=n.videoDelay;this.delay_={audioDelay:i,videoDelay:o}}},{key:"getDelay",value:function(){return this.delay_}},{key:"isH264",get:function(){var n,i;return!((n=this.peerConnection_)===null||n===void 0||(i=n.remoteDescription)===null||i===void 0||!i.sdp.includes("H264"))}}]),e}(),nL=new(function(){function e(){w(this,e),this.set_=new Set,J.on(Su,this.add,this),J.on(Qo,this.add,this),J.on(Yo,this.delete,this),J.on(ku,this.delete,this)}return P(e,[{key:"add",value:function(t){var n=t.client,i=t.roomId;if(n.getMode()!=="rtc"){var o=this.getKey(n.getUserId(),i||n.getRoomId(),n.getSDKAppId(),n.getUseStringRoomId());this.set_.add(o)}}},{key:"delete",value:function(t){var n=t.client;if(n.getMode()!=="rtc"){var i=this.getKey(n.getUserId(),n.getRoomId(),n.getSDKAppId(),n.getUseStringRoomId());this.set_.delete(i)}}},{key:"getKey",value:function(t,n,i,o){return"".concat(i,"_").concat(n,"_").concat(t,"_").concat(o)}},{key:"isJoined",value:function(t){var n=t.userId,i=t.roomId,o=t.sdkAppId,c=t.client;return c.getMode()!=="rtc"&&this.set_.has(this.getKey(n,i,o,c.getUseStringRoomId()))}}]),e}());function a1(e,t,n,i){if(this.useStringRoomId_){if(!(Jt(e)&&/^[A-Za-z\d\s!#$%&()+\-:;<=.>?@[\]^_{}|~,]{1,64}$/.test(e)))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:ex,data:t,link:{className:i,fnName:n}})})}else if(!(xr(e)&&/^[1-9]\d*$/.test(String(e))&&e<4294967295))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:tx,data:t,link:{className:i,fnName:n}})})}function s1(e,t,n,i){if(!/^[A-Za-z\d_-]*$/.test(e))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:_x,data:t,link:{className:i,fnName:n}})})}var c1,Ku,bn={TRTC:{createClient:{name:"clientConfig",required:!0,type:ui,properties:{sdkAppId:{required:!0,type:Rt,allowEmpty:!1},userId:{required:!0,type:Ct,allowEmpty:!1},userSig:{required:!0,type:Ct,allowEmpty:!1},mode:{required:!0,type:Ct,values:["rtc","live"]},useStringRoomId:{type:An},autoSubscribe:{type:An},enableAutoPlayDialog:{type:An},streamId:{type:Ct},userDefineRecordId:{type:Ct},pureAudioPushMode:{type:Rt,values:[1,2]},enableSEI:{type:An}}},createStream:{name:"streamConfig",required:!0,type:ui,properties:{userId:{type:Ct},audio:{type:An},video:{type:An},screen:{type:An},screenAudio:{type:An},microphoneId:{type:Ct},cameraId:{type:Ct},facingMode:{type:[Ct,ui]},audioSource:{instanceOf:window.MediaStreamTrack},videoSource:{instanceOf:window.MediaStreamTrack}},validate:function(e){if(!fe(e.screen)&&e.screen&&fe(e.audio)&&(e.audio=!1),!(fe(e.audio)&&fe(e.video)||fe(e.audioSource)&&fe(e.videoSource)))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:eP})});if(!fe(e.screen)&&e.screen===!0&&e.video===!0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:tP})});if(e.audio&&e.screenAudio)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:nP})});if(e.screen!==!0&&e.screenAudio===!0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:rP})});if(!fe(e.screen)&&e.screen===!0&&!this.isScreenShareSupported())throw new Y({code:Q.INVALID_OPERATION,message:Z({key:aP})})}}},CLIENT:{join:{name:"options",required:!0,properties:{roomId:{required:!0,type:[Rt,Ct],allowEmpty:!1,validate:a1},role:{type:[Ct],values:["anchor","audience"]},privateMapKey:{type:[Ct]}},validate:function(e){if(this.isJoined_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:ZA})});if(this.checkDestroy(),nL.isJoined({userId:this.userId_,roomId:e.roomId,sdkAppId:this.sdkAppId_,client:this}))throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Bx,data:this.userId_})})}},publish:{name:"stream",required:!0,instanceOf:Gh,validate:function(e){if(!this.isJoined_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:ox})});if(this.mode_==="live"&&this.role_==="audience")throw new Y({code:Q.INVALID_OPERATION,message:Z({key:sx})});if(this.localStream_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:ux})});if(!e.getIsReadyToPublish())throw new Y({code:Q.INVALID_OPERATION,message:Z({key:cx})});if(this.notPublishWithoutH264Supported_)throw new Y({code:Q.NOT_SUPPORTED_H264,message:Z({key:_0})})}},unpublish:{name:"stream",required:!0,instanceOf:Gh,validate:function(e){if(e!==this.localStream_){if(this.localStream_)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:ax})});this.log_.warn("Client currently has no published stream, please call publish() first.")}}},subscribe:[{name:"stream",required:!0,instanceOf:Jh,validate:function(e){if(!e.getConnection())throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Kh})});if(this.notSubscribeWithoutH264Supported_)throw new Y({code:Q.NOT_SUPPORTED_H264,message:Z({key:y0})})}},{name:"options",type:ui,properties:{audio:{type:An},video:{type:An}},validate:function(e){var t=e.audio,n=e.video;if(!(fe(t)||fe(n)||t||n))throw new Y({code:Q.INVALID_OPERATION,message:Z({key:hP})})}}],unsubscribe:{name:"stream",required:!0,instanceOf:Jh,validate:function(e){if(!e.getConnection())throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Kh})})}},switchRole:{name:"role",required:!0,values:["anchor","audience"],validate:function(){if(this.mode_!=="live")throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:dx})});if(!this.isJoined_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:hx})})}},startPublishCDNStream:{name:"options",required:!1,properties:{streamId:{type:Ct,validate:s1},appId:{type:Rt,allowEmpty:!1},bizId:{type:Rt,allowEmpty:!1},url:{type:Ct,allowEmpty:!1}},validate:function(){if(this.isDestroyed_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Yh,data:{funName:"startPublishCDNStream"}})})}},startMixTranscode:{name:"config",required:!0,type:ui,properties:{mode:{type:Ct,values:["preset-layout","manual"]},streamId:{type:Ct,validate:s1},videoWidth:{type:Rt,notLessThanZero:!0},videoHeight:{type:Rt,notLessThanZero:!0},videoBitrate:{type:Rt,notLessThanZero:!0,allowEmpty:!1},videoFramerate:{type:Rt,validate:function(e,t,n,i){if(e<=0||e>30)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Gx,link:{className:i,fnName:n}})})}},videoGop:{type:Rt,validate:function(e,t,n,i){if(e<1||e>8)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Jx,link:{className:i,fnName:n}})})}},audioSampleRate:{type:Rt,notLessThanZero:!0},audioBitrate:{type:Rt,validate:function(e,t,n,i){if(e<32||e>192)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:qx,link:{className:i,fnName:n}})})}},audioChannels:{type:Rt,values:[1,2]},backgroundColor:{type:Rt},backgroundImage:{type:Ct},mixUsers:{required:!0,type:bA,arrayItem:{require:!0,type:ui,properties:{userId:{required:!0,type:Ct},roomId:{type:[Ct,Rt],validate:a1},pureAudio:{type:An},width:{type:Rt,notLessThanZero:!0},height:{type:Rt,notLessThanZero:!0},locationX:{type:Rt,notLessThanZero:!0},locationY:{type:Rt,notLessThanZero:!0},zOrder:{type:Rt},streamType:{type:Ct,values:["main","auxiliary"]},renderMode:{type:Rt,values:[0,1,2,4]}}}}},validate:function(e,t,n,i,o){var c=0,a=0,u=e.mixUsers,l=[];if(u.forEach(function(h,f){if(l.push(h.userId),!h.pureAudio){if(!h.zOrder||h.zOrder<1||h>15)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Kx,data:"config.mixUsers[".concat(f,"].zOrder"),link:{className:i,fnName:n}})});h.width+h.locationX>c&&(c=h.width+h.locationX),h.height+h.locationY>a&&(a=h.height+h.locationY)}}),l.indexOf(this.getUserId())<0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Qx,link:{className:i,fnName:n}})});if(e.videoWidth<c||e.videoHeight<a)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Yx,link:{className:i,fnName:n}})})}},sendSEIMessage:[{name:"buffer",required:!0,instanceOf:ArrayBuffer,validate:function(e){if(!Kf)throw new Y({code:Q.NOT_SUPPORTED,message:Z({key:S0})});if(!this.enableSEI_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:fP})});if(e.byteLength>1e3)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:mP,data:e.byteLength})});if(e.byteLength===0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:pP})});if(!this.uplinkConnection_)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:gP})});if(!this.localStream_.hasVideo())throw new Y({code:Q.INVALID_OPERATION,message:Z({key:vP})});var t=this.uplinkConnection_.isH264;if(!t)throw new Y({code:Q.NOT_SUPPORTED,message:Z({key:S0,data:t})})}},{name:"options",type:ui,properties:{seiPayloadType:{type:Rt,values:[5,243]}}}]},LOCAL_STREAM:{switchDevice:[{name:"type",required:!0,type:Ct,values:[Pe,Ue]},{name:"deviceId",required:!0,type:Ct,validate:function(){if(this.screen_&&!this.audio_||this.audioSource_||this.videoSource_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Cx})});if(this.publishState_===bs)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Rx})})}}],setAudioCaptureVolume:{name:"volume",type:Rt}},STREAM:{play:[{name:"elementId",required:!0,type:[Ct,"HTMLDivElement"],validate:function(e,t,n){if(Jt(e)){var i=document.getElementById(e);if(!i)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Xx,data:{key:t,fnName:n}})});if(!(i instanceof HTMLDivElement))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Zx,data:{key:t,fnName:n,type:hi(i)}})})}}},{name:"options",type:ui,properties:{objectFit:{type:Ct,values:["contain","cover","fill"]},muted:{type:An},mirror:{type:An}}}]}};function Qu(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i,o,c){var a=c.value;return c.value=function(){for(var u=arguments.length,l=new Array(u),h=0;h<u;h++)l[h]=arguments[h];return u1.call(this,t,l,o,this.name_),a.apply(this,l)},c}}function gr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i,o,c){var a=c.value;return c.value=b(regeneratorRuntime.mark(function u(){var l,h,f,m=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:for(l=m.length,h=new Array(l),f=0;f<l;f++)h[f]=m[f];return u1.call(this,t,h,o,this.name_),g.abrupt("return",a.apply(this,h));case 3:case"end":return g.stop()}},u,this)})),c}}function u1(e,t,n,i){try{for(var o=0;o<e.length;o++)Mp.call(this,{rule:e[o],value:t[o],key:e[o].name,fnName:n,className:i})}catch(c){throw ye.error(c),c}}function Mp(e){var t=this,n=e.rule,i=e.value,o=e.key,c=e.fnName,a=e.className;if(fe(i)){if(n.required)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:LA,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})})}else{if(Array.isArray(n.type)){if(!n.type.map(function(m){return m.toLowerCase()}).includes(hi(i)))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:l0,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})})}else if(!fe(n.type)&&hi(i)!==n.type)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:l0,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})});if(n.allowEmpty===!1){var u=xr(i)&&(i===0||Number.isNaN(i)),l=Jt(i)&&i.trim()==="";if(u||l)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:MA,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})})}if(n.notLessThanZero&&xr(i)&&i<0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Wx,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})});if(Jt(n.instanceOf)){if(!i||i.name_!==n.instanceOf)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:d0,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})})}else if(hr(n.instanceOf)&&!(i instanceof n.instanceOf))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:d0,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})});if(n.values&&!n.values.includes(i))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:UA,data:{key:o,rule:n,fnName:c,value:i},link:{className:a,fnName:c}})});var h=n.properties;Gi(h)&&hi(i)==="object"&&Object.keys(h).forEach(function(m){Mp.call(t,{rule:h[m],value:i&&i[m],key:"".concat(o,".").concat(m),fnName:c,className:a})});var f=n.arrayItem;Gi(f)&&E0(i)&&i.forEach(function(m,g){Mp.call(t,{rule:f,value:m,key:"".concat(o,"[").concat(g,"]"),fnName:c,className:a})}),hr(n.validate)&&n.validate.call(this,i,o,c,a,this)}}Me({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var l1=(c1=gr.apply(void 0,Ke(bn.STREAM.play)),ze((Ku=function(){function e(a){w(this,e),this.name_=RA,this.userId_=a.userId,this.isRemote_=a.isRemote,this.type_=a.type,this.log_=ye.createLogger({id:"s".concat(a.seq?a.seq:"","|").concat(this.userId_),userId:fe(a.client)?void 0:a.client.getUserId(),sdkAppId:fe(a.client)?void 0:a.client.getSDKAppId(),isLocal:!this.isRemote_,type:this.isRemote_?this.type_:""}),this.client_=null,fe(a.client)||(this.client_=a.client),this.mediaStream_=null,this.div_=null,this.isPlaying_=!1,this.connection_=null,this.audioPlayer_=null,this.videoPlayer_=null,this.muted_=!1,this.objectFit_="cover",this.mirror_=!1,this.id_=Ib(),this.audioOutputDeviceId_=0,this.audioVolume_=1,this.emitter_=P0(new mi,this.name_),this.connectionState_=dn,this.installEvents(),fe(a.mirror)||this.log_.warn('TRTC.createStream "mirror" option was deprecated since v4.12.1\uFF0Cplease use localStream.play to set up preview mirror. refer to '.concat(Wo,"/en/LocalStream.html#play. TRTC.createStream \u63A5\u53E3\u7684 mirror \u9009\u9879\u4ECE v4.12.1 \u5F00\u59CB\u88AB\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 localStream.play \u8BBE\u7F6E\u672C\u5730\u6D41\u9884\u89C8\u955C\u50CF\uFF0C\u53C2\u8003\u6587\u6863\uFF1A").concat(Wo,"/zh-cn/LocalStream.html#play\u3002"))}var t,n,i,o,c;return P(e,[{key:"installEvents",value:function(){J.on(ws,this.restartPlayback,this)}},{key:"uninstallEvents",value:function(){J.off(ws,this.restartPlayback,this)}},{key:"getType",value:function(){return this.type_}},{key:"getLogger",value:function(){return this.log_}},{key:"isSubscribed",get:function(){return this.type_===St&&this.connection_.isMainStreamSubscribed||this.type_===Nt&&this.connection_.isAuxStreamSubscribed}},{key:"isMainVideoSubscribed",get:function(){var a=this.getSubscribedState();return this.type_===St&&a&&a.video}},{key:"isMainAudioSubscribed",get:function(){var a=this.getSubscribedState();return this.type_===St&&a&&a.audio}},{key:"isAuxVideoSubscribed",get:function(){var a=this.getSubscribedState();return this.type_===Nt&&a&&a.auxiliary}},{key:"isSmallVideoSubscribed",get:function(){var a=this.getSubscribedState();return this.type_===St&&a&&a.smallVideo}},{key:"emitConnectionStateChanged",value:function(a){a.state!==this.connectionState_&&(a.state!==dn&&this.isRemote_&&!this.isSubscribed||(this.emitter_.emit(ID,a),this.connectionState_=a.state))}},{key:"setConnection",value:function(a){this.connection_!==a&&(a instanceof Lp?(this.connection_!==null&&this.connection_.off(it.CONNECTION_STATE_CHANGED,this.emitConnectionStateChanged,this),a.on(it.CONNECTION_STATE_CHANGED,this.emitConnectionStateChanged,this)):a===null&&this.connection_.off(it.CONNECTION_STATE_CHANGED,this.emitConnectionStateChanged,this),this.connection_=a)}},{key:"getConnection",value:function(){return this.connection_}},{key:"play",value:(c=b(regeneratorRuntime.mark(function a(u,l){var h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.log_.info("stream ".concat(this.isPlaying_?"update":"start to"," play with elementId: ").concat(u," and options: ").concat(JSON.stringify(l),".")),!this.isPlaying_){g.next=9;break}return l&&!fe(l.muted)&&(this.muted_=l.muted),l&&!fe(l.objectFit)&&(this.objectFit_=l.objectFit),this.isScreenShare()?this.mirror_=!1:l&&!fe(l.mirror)&&(this.mirror_=l.mirror),this.audioPlayer_&&this.audioPlayer_.setMuted(this.muted_),this.videoPlayer_&&(this.videoPlayer_.setObjectFit(this.objectFit_),this.videoPlayer_.setMirror(this.mirror_)),this.elementId_!==u&&(h=u,Jt(u)&&(h=document.getElementById(u)),h.appendChild(this.div_),this.elementId_=u),g.abrupt("return");case 9:return this.isPlaying_=!0,(f=document.createElement("div")).setAttribute("id","player_".concat(this.id_)),f.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),m=u,Jt(u)&&(m=document.getElementById(u)),m.appendChild(f),this.elementId_=u,this.div_=f,this.isRemote_||(this.muted_=!0),l&&!fe(l.muted)&&(this.muted_=l.muted),this.isScreenShare()&&(this.objectFit_="contain"),l&&!fe(l.objectFit)&&(this.objectFit_=l.objectFit),this.isScreenShare()?this.mirror_=!1:(this.isRemote_||(this.mirror_=!0),l&&!fe(l.mirror)&&(this.mirror_=l.mirror)),J.emit(Rf,{stream:this}),g.next=26,Promise.all([this.playAudio(),this.playVideo()]);case 26:J.emit(jP,{stream:this});case 27:case"end":return g.stop()}},a,this)})),function(a,u){return c.apply(this,arguments)})},{key:"playAudio",value:(o=b(regeneratorRuntime.mark(function a(){var u,l,h=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.hasAudio()&&(!this.isRemote_||this.isMainAudioSubscribed)){f.next=2;break}return f.abrupt("return");case 2:if(u=this.getAudioTrack(),this.audioPlayer_||!u){f.next=17;break}return this.log_.info("stream - create AudioPlayer and play"),this.audioPlayer_=new sO({stream:this,track:u,gainedTrack:(l=this.gain_)===null||l===void 0?void 0:l.audioTrack,div:this.div_,muted:this.muted_,outputDeviceId:this.audioOutputDeviceId_,volume:this.audioVolume_}),this.audioPlayer_.on(_n,function(m){var g={type:Pe,state:m.state,reason:m.reason};J.emit(tb,p({stream:h},g)),h.emitter_.emit(Ob,g)}),f.prev=7,f.next=10,this.audioPlayer_.play();case 10:f.next=17;break;case 12:throw f.prev=12,f.t0=f.catch(7),this.client_&&this.client_.getEnableAutoPlayDialog()&&new pS,this.emitter_.emit(Xf,f.t0),f.t0;case 17:case"end":return f.stop()}},a,this,[[7,12]])})),function(){return o.apply(this,arguments)})},{key:"playVideo",value:(i=b(regeneratorRuntime.mark(function a(){var u,l=this;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.hasVideo()&&(!this.isRemote_||this.isMainVideoSubscribed||this.isAuxVideoSubscribed||this.isSmallVideoSubscribed)){h.next=2;break}return h.abrupt("return");case 2:if(u=this.getVideoTrack(),this.videoPlayer_||!u){h.next=18;break}return J.emit(xf,{stream:this}),this.log_.info("stream - create VideoPlayer and play"),this.videoPlayer_=new mS({stream:this,track:u,div:this.div_,muted:this.muted_,objectFit:this.objectFit_,mirror:this.mirror_}),this.videoPlayer_.on(_n,function(f){var m={type:Ue,state:f.state,reason:f.reason};J.emit(tb,p({stream:l},m)),l.emitter_.emit(Ob,m)}),h.prev=8,h.next=11,this.videoPlayer_.play();case 11:h.next=18;break;case 13:throw h.prev=13,h.t0=h.catch(8),this.client_&&this.client_.getEnableAutoPlayDialog()&&new pS,this.emitter_.emit(Xf,h.t0),h.t0;case 18:case"end":return h.stop()}},a,this,[[8,13]])})),function(){return i.apply(this,arguments)})},{key:"stopAudio",value:function(){this.audioPlayer_&&(this.log_.info("stream - stop AudioPlayer"),this.audioPlayer_.stop(),this.audioPlayer_=null)}},{key:"stopVideo",value:function(){this.videoPlayer_&&(this.log_.info("stream - stop VideoPlayer"),this.videoPlayer_.stop(),this.videoPlayer_=null)}},{key:"restartPlayback",value:function(){this.audioPlayer_&&!this.audioPlayer_.isPlaying&&this.restartAudio(),this.videoPlayer_&&!this.videoPlayer_.isPlaying&&this.restartVideo()}},{key:"restartAudio",value:function(){this.isPlaying_&&(this.stopAudio(),this.playAudio().catch(function(a){}))}},{key:"restartVideo",value:function(){this.isPlaying_&&(this.stopVideo(),this.playVideo().catch(function(a){}))}},{key:"stop",value:function(){this.isPlaying_&&(this.isPlaying_=!1,this.stopAudio(),this.stopVideo(),this.div_.parentNode.removeChild(this.div_))}},{key:"resume",value:(n=b(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.isPlaying_){u.next=2;break}return u.abrupt("return");case 2:if(this.log_.info("stream - resume"),!this.audioPlayer_){u.next=6;break}return u.next=6,this.audioPlayer_.resume();case 6:if(!this.videoPlayer_){u.next=9;break}return u.next=9,this.videoPlayer_.resume();case 9:case"end":return u.stop()}},a,this)})),function(){return n.apply(this,arguments)})},{key:"close",value:function(){this.isPlaying_&&this.stop(),this.isRemote_||(this.mediaStream_&&(this.mediaStream_.preventEvent=1,this.mediaStream_.getTracks().forEach(function(a){a.stop()}),this.mediaStream_=null),this.uninstallEvents())}},{key:"muteAudio",value:function(){return this.addRemoteEvent(!0,Pe),this.doEnableTrack(Pe,!1)}},{key:"muteVideo",value:function(){return this.addRemoteEvent(!0,Ue),this.doEnableTrack(Ue,!1)}},{key:"unmuteAudio",value:function(){return this.addRemoteEvent(!1,Pe),this.doEnableTrack(Pe,!0)}},{key:"unmuteVideo",value:function(){return this.addRemoteEvent(!1,Ue),this.doEnableTrack(Ue,!0)}},{key:"addRemoteEvent",value:function(a,u){if(this.isRemote_&&this.client_){var l=this.client_.getUserId(),h="".concat(a?pn:lr," remote ").concat(u);gn(l,{eventId:u===Pe?a?U2:F2:a?M2:V2,eventDesc:h,timestamp:new Date().getTime(),userId:l,tinyId:this.client_.getTinyId(),remoteUserId:this.userId_,remoteTinyId:this.connection_.getTinyId()})}}},{key:"doEnableTrack",value:function(a,u){var l=!1;return a===Pe?this.mediaStream_.getAudioTracks().forEach(function(h){l=!0,h.enabled=u}):this.mediaStream_.getVideoTracks().forEach(function(h){l=!0,h.enabled=u}),l}},{key:"getId",value:function(){return this.id_}},{key:"getUserId",value:function(){return this.userId_}},{key:"getTinyId",value:function(){return this.connection_?this.connection_.getTinyId():""}},{key:"isPlaying",value:function(){return this.isPlaying_}},{key:"setAudioOutput",value:(t=b(regeneratorRuntime.mark(function a(u){return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.audioOutputDeviceId_=u,!this.audioPlayer_){l.next=4;break}return l.next=4,this.audioPlayer_.setSinkId(u);case 4:case"end":return l.stop()}},a,this)})),function(a){return t.apply(this,arguments)})},{key:"setAudioVolume",value:function(a){this.audioVolume_=a,this.log_.info("setAudioVolume to ".concat(a)),this.audioPlayer_&&this.audioPlayer_.setVolume(a)}},{key:"getAudioLevel",value:function(){var a=0;return this.audioPlayer_&&(a=this.audioPlayer_.getAudioLevel()),a}},{key:"getInternalAudioLevel",value:function(){var a=0;return this.audioPlayer_&&(a=this.audioPlayer_.getInternalAudioLevel()),a}},{key:"hasAudio",value:function(){if(this.isRemote_){if(!this.connection_)return!1;var a=this.connection_.getTrackState();return this.type_===St&&a.audio}return!!this.getAudioTrack()}},{key:"hasVideo",value:function(){if(this.isRemote_){if(!this.connection_)return!1;var a=this.connection_.getTrackState();return this.type_===Nt?a.auxiliary:a.video}return!!this.getVideoTrack()}},{key:"getSubscribedState",value:function(){return this.isRemote_&&this.connection_?this.connection_.getSubscribeState():null}},{key:"getAudioTrack",value:function(){var a=null;if(this.mediaStream_){var u=this.mediaStream_.getAudioTracks();u.length>0&&(a=u[0])}return a}},{key:"getVideoTrack",value:function(){var a=null;if(this.mediaStream_){var u=this.mediaStream_.getVideoTracks();u.length>0&&(a=u[0])}return a}},{key:"getVideoFrame",value:function(){return this.videoPlayer_?this.videoPlayer_.getVideoFrame():null}},{key:"getMediaStream",value:function(){return this.mediaStream_}},{key:"setMediaStream",value:function(a){a!==this.mediaStream_&&(this.mediaStream_&&this.mediaStream_.getTracks().forEach(function(u){return u.stop()}),this.mediaStream_=a)}},{key:"updateVideoPlayingState",value:function(a){this.isPlaying_&&(a?(this.log_.info("playing state updated, play video"),this.playVideo().catch(function(u){})):(this.log_.info("playing state updated, stop video"),this.stopVideo()))}},{key:"updateAudioPlayingState",value:function(a){this.isPlaying_&&(a?(this.log_.info("playing state updated, play audio"),this.playAudio().catch(function(u){})):(this.log_.info("playing state updated, stop audio"),this.stopAudio()))}},{key:"on",value:function(a,u,l){this.emitter_.on(a,u,l)}},{key:"off",value:function(a,u,l){a==="*"?this.emitter_.removeAllListeners():this.emitter_.off(a,u,l)}},{key:"isRemote",value:function(){return this.isRemote_}},{key:"isScreenShare",value:function(){return!this.isRemote_&&this.screen_||this.isRemote_&&this.getType()===ur}},{key:"getDiv",value:function(){return this.div_}},{key:"getObjectFit",value:function(){return this.objectFit_}},{key:"getMuted",value:function(){return this.muted_}},{key:"getClient",value:function(){return this.client_}}]),e}()).prototype,"play",[c1],Object.getOwnPropertyDescriptor(Ku.prototype,"play"),Ku.prototype),Ku),Up=function(e){$(n,e);var t=Ye(n);function n(i){var o;w(this,n);var c={isRemote:!0,type:i.type},a=p(p({},i),c);return(o=t.call(this,a)).name_=Jh,o.isStreamAddedEventEmitted_=!1,o.isAbleToCallSubscription_=!0,o}return P(n,[{key:"installEvents",value:function(){Ae(W(n.prototype),"installEvents",this).call(this),J.on(Dr,this.handleStreamSubscribed,this),J.on(Or,this.handleStreamUnsubscribed,this)}},{key:"uninstallEvents",value:function(){Ae(W(n.prototype),"uninstallEvents",this).call(this),J.off(Dr,this.handleStreamSubscribed,this),J.off(Or,this.handleStreamUnsubscribed,this)}},{key:"handleStreamSubscribed",value:function(i){i.client===this.client_&&i.stream===this&&this.connection_.getCurrentState()===mn&&this.emitConnectionStateChanged({prevState:dn,state:mn})}},{key:"handleStreamUnsubscribed",value:function(i){i.client===this.client_&&i.stream===this&&this.emitConnectionStateChanged({prevState:mn,state:dn})}},{key:"getType",value:function(){return Ae(W(n.prototype),"getType",this).call(this)}},{key:"getIsAbleToCallSubscription",value:function(){return this.isAbleToCallSubscription_}},{key:"setIsAbleToCallSubscription",value:function(i){this.isAbleToCallSubscription_=i}},{key:"setIsStreamAddedEventEmitted",value:function(i){this.isStreamAddedEventEmitted_=i}},{key:"getIsStreamAddedEventEmitted",value:function(){return this.isStreamAddedEventEmitted_}},{key:"getAudioTrack",value:function(){return this.connection_&&this.connection_.getTrackState().audio?Ae(W(n.prototype),"getAudioTrack",this).call(this):null}},{key:"getVideoTrack",value:function(){if(!this.connection_)return null;var i=this.connection_.getTrackState();return(this.type_!==St||i.video)&&(this.type_!==Nt||i.auxiliary)?Ae(W(n.prototype),"getVideoTrack",this).call(this):null}},{key:"close",value:function(){Ae(W(n.prototype),"close",this).call(this)}}]),n}(l1),rL=function(){function e(o){w(this,e),this.client_=o.client,this.subscribedStreams_=new Map,this.unsubscribedStreams_=new Map,this.subscriptedOptions_=new Map,this.autoRecoveryFlags_=new Map}var t,n,i;return P(e,[{key:"isEnabled",get:function(){return this.client_.getEnv()!=="webrtc"}},{key:"recover",value:(i=b(regeneratorRuntime.mark(function o(c){var a,u,l;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=c.getUserId(),u=c.getType(),this.hasAutoRecoveryFlag(a,u)){h.next=5;break}return h.abrupt("return");case 5:if(l=this.getUnsubscribedStream(a,u)?"unsubscribe":"subscribe",h.prev=6,ye.warn("recover() try to recover subscription [".concat(l,"][").concat(a,"][").concat(u,"]")),l!=="subscribe"){h.next=13;break}return h.next=11,this.recoverSubscription(a,c);case 11:h.next=15;break;case 13:return h.next=15,this.recoverUnsubscription(a,c);case 15:Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:Xy}),ye.warn("recover() recover successfully [".concat(l,"][").concat(a,"][").concat(u,"]")),h.next=23;break;case 19:h.prev=19,h.t0=h.catch(6),ye.error("recover() recover failed [".concat(l,"][").concat(a,"][").concat(u,"]"),h.t0),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Xy,error:h.t0});case 23:this.deleteAutoRecoveryFlag(a,u);case 24:case"end":return h.stop()}},o,this,[[6,19]])})),function(o){return i.apply(this,arguments)})},{key:"recoverSubscription",value:(n=b(regeneratorRuntime.mark(function o(c,a){var u,l,h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u=this.getOptions(c,a.getType()),l=this.getSubscribedStream(c,a.getType()),u&&l){g.next=4;break}return g.abrupt("return");case 4:h=this.getStreamMuteState(l),f=h.isAudioMuted,m=h.isVideoMuted,this.mergeStream(l,a),this.recoverPlayingState(l),f&&l.doEnableTrack(Pe,!1),m&&l.doEnableTrack(Ue,!1);case 9:case"end":return g.stop()}},o,this)})),function(o,c){return n.apply(this,arguments)})},{key:"recoverUnsubscription",value:(t=b(regeneratorRuntime.mark(function o(c,a){var u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(u=this.getUnsubscribedStream(c,a.getType())){l.next=3;break}return l.abrupt("return");case 3:this.mergeStream(u,a);case 4:case"end":return l.stop()}},o,this)})),function(o,c){return t.apply(this,arguments)})},{key:"getStreamMuteState",value:function(o){var c={isAudioMuted:!1,isVideoMuted:!1},a=o.getMediaStream();return a&&(c.isAudioMuted=a.getAudioTracks().map(function(u){return u.enabled}).includes(!1),c.isVideoMuted=a.getVideoTracks().map(function(u){return u.enabled}).includes(!1)),c}},{key:"recoverPlayingState",value:function(o){var c=o.isPlaying(),a=o.getDiv();if(c&&a){var u=a.parentNode;o.stop(),o.play(u,{objectFit:o.getObjectFit(),muted:o.getMuted()})}}},{key:"mergeStream",value:function(o,c){var a=c.getConnection(),u=c.getMediaStream();o.setConnection(a),a.setRemoteStream(u.id,o),o.setMediaStream(u),o.updateAudioPlayingState(c.hasAudio()),o.updateVideoPlayingState(c.hasVideo())}},{key:"addSubscriptionRecord",value:function(o,c,a){var u=c.getType();if(this.subscribedStreams_.has(o))this.subscribedStreams_.get(o).set(u,c);else{var l=new Map;l.set(c.getType(),c),this.subscribedStreams_.set(o,l)}if(this.subscriptedOptions_.has(o))this.subscriptedOptions_.get(o).set(u,a);else{var h=new Map;h.set(c.getType(),a),this.subscriptedOptions_.set(o,h)}this.deleteUnsubscriptionRecord(o,u)}},{key:"addUnsubscriptionRecord",value:function(o,c){if(this.unsubscribedStreams_.has(o))this.unsubscribedStreams_.get(o).set(c.getType(),c);else{var a=new Map;a.set(c.getType(),c),this.unsubscribedStreams_.set(o,a)}this.deleteSubscriptionRecord(o,c.getType())}},{key:"getSubscribedStream",value:function(o,c){return this.subscribedStreams_.has(o)&&this.subscribedStreams_.get(o).has(c)?this.subscribedStreams_.get(o).get(c):null}},{key:"getOptions",value:function(o,c){return this.subscriptedOptions_.has(o)&&this.subscriptedOptions_.get(o).has(c)?this.subscriptedOptions_.get(o).get(c):null}},{key:"getUnsubscribedStream",value:function(o,c){return this.unsubscribedStreams_.has(o)&&this.unsubscribedStreams_.get(o).has(c)?this.unsubscribedStreams_.get(o).get(c):null}},{key:"deleteSubscriptionRecord",value:function(o,c){this.subscribedStreams_.has(o)&&this.subscribedStreams_.get(o).delete(c),this.subscriptedOptions_.has(o)&&this.subscriptedOptions_.get(o).delete(c)}},{key:"deleteUnsubscriptionRecord",value:function(o,c){this.unsubscribedStreams_.has(o)&&this.unsubscribedStreams_.get(o).delete(c)}},{key:"markAllStream",value:function(){for(var o=0,c=Ke(this.subscribedStreams_.entries());o<c.length;o++)for(var a=Xe(c[o],2),u=a[0],l=0,h=Ke(a[1].entries());l<h.length;l++){var f=Xe(h[l],1)[0];this.setAutoRecoveryFlag(u,f)}for(var m=0,g=Ke(this.unsubscribedStreams_.entries());m<g.length;m++)for(var v=Xe(g[m],2),I=v[0],S=0,y=Ke(v[1].entries());S<y.length;S++){var E=Xe(y[S],1)[0];this.setAutoRecoveryFlag(I,E)}}},{key:"setAutoRecoveryFlag",value:function(o,c){if(ye.info("setAutoRecoveryFlag() mark [".concat(o,"][").concat(c,"]")),this.autoRecoveryFlags_.has(o))this.autoRecoveryFlags_.get(o).set(c);else{var a=new Map;a.set(c),this.autoRecoveryFlags_.set(o,a)}}},{key:"hasAutoRecoveryFlag",value:function(o,c){return!!this.isEnabled&&this.autoRecoveryFlags_.has(o)&&this.autoRecoveryFlags_.get(o).has(c)}},{key:"deleteAutoRecoveryFlag",value:function(o,c){this.autoRecoveryFlags_.has(o)&&this.autoRecoveryFlags_.get(o).delete(c)}},{key:"delete",value:function(o){this.unsubscribedStreams_.delete(o),this.subscribedStreams_.delete(o),this.subscriptedOptions_.delete(o),this.autoRecoveryFlags_.delete(o)}}]),e}();Me({target:"String",proto:!0,forced:u0("small")},{small:function(){return c0(this,"small","","")}});var iL=function(){function e(t){w(this,e),this.player_=t,this.canvas_=document.createElement(YR),this.canvasCtx_=this.canvas_.getContext("2d")}return P(e,[{key:"setCanvasRect",value:function(t,n){this.canvas_.width=t,this.canvas_.height=n}},{key:"drawVideoToCanvas",value:function(){var t=this.player_.getElement();this.canvasCtx_.drawImage(t,0,0,this.canvas_.width,this.canvas_.height)}},{key:"generateVideoTrackFromCanvasCapture",value:function(t){return this.canvas_.captureStream(t).getVideoTracks()[0]}},{key:"generateStreamFromTrack",value:function(t){var n=new MediaStream;return n.addTrack(t),n}},{key:"destroy",value:function(){this.player_.stop(),this.canvas_=null,this.canvasCtx_=null}},{key:"canvas",get:function(){return this.canvas_}},{key:"canvasCtx",get:function(){return this.canvasCtx_}},{key:"canDrawVideoToCanvas",get:function(){if(this.player_){var t=this.player_.getElement();if(t)return t.readyState===t.HAVE_ENOUGH_DATA}return!1}}]),e}(),oL=new Blob(["let width,height,offscreen,ctx;onmessage=function(e){const{action,data}=e.data;switch(action){case'render':offscreen=data.canvas;width=offscreen.width;height=offscreen.height;ctx=offscreen.getContext('2d');draw(data.readable,data.writable);break}};function draw(readable,writable){const transformer=new TransformStream({async transform(cameraFrame,controller){ctx.drawImage(cameraFrame,0,0,width,height);const frame=new VideoFrame(offscreen,{timestamp:cameraFrame.timestamp});cameraFrame.close();controller.enqueue(frame)}});readable.pipeThrough(transformer).pipeTo(writable)}"],{type:"application/javascript"}),aL=function(){function e(t){w(this,e);var n=t.videoTrack;this.width=void 0,this.height=void 0,this.canvas=null,this.offscreen=null,this.smallGenerator=new MediaStreamTrackGenerator({kind:"video"}),this.smallWritable=this.smallGenerator.writable,this.bigProcessor=new MediaStreamTrackProcessor({track:n}),this.bigReadable=this.bigProcessor.readable,this.initWorker()}return P(e,[{key:"initWorker",value:function(){try{this.worker=new Worker(URL.createObjectURL(oL)),ye.info("init worker processor success")}catch(t){ye.warn("init worker processor failed. ".concat(t.error))}}},{key:"setCanvasRect",value:function(t,n){this.width=t,this.height=n,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n,this.offscreen=this.canvas.transferControlToOffscreen(),this.worker.postMessage({action:"render",data:{canvas:this.offscreen,readable:this.bigReadable,writable:this.smallWritable}},[this.offscreen,this.bigReadable,this.smallWritable])}},{key:"generatorVideoTrack",value:function(){var t=new MediaStream([this.smallGenerator]);return t==null?void 0:t.getTracks()[0]}},{key:"destroy",value:function(){this.worker.terminate()}}]),e}(),sL=function(){function e(n){w(this,e),this.localStream_=n,this.player_=null,this.processor_=null,this.initOffscreenSuccess_=!1}var t;return P(e,[{key:"initialize",value:(t=b(regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(c=void 0,a=void 0,u=void 0,!(((c=window)===null||c===void 0?void 0:c.OffscreenCanvas)&&((a=window)===null||a===void 0?void 0:a.MediaStreamTrackProcessor)&&((u=window)===null||u===void 0?void 0:u.MediaStreamTrackGenerator)&&((i=navigator)===null||i===void 0?void 0:i.hardwareConcurrency)>=6)){o.next=13;break}return o.prev=1,o.next=4,this.initOffscreen();case 4:this.initOffscreenSuccess_=!0,ye.info("Initialize VideoGenerator successfully!"),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(1),this.initCanvas();case 11:o.next=14;break;case 13:this.initCanvas();case 14:case"end":return o.stop()}var c,a,u},n,this,[[1,8]])})),function(){return t.apply(this,arguments)})},{key:"generateSmallVideoTrack",value:function(n){var i,o=this.getSmallVideoProfile(n);return this.initOffscreenSuccess_?(this.processor_.setCanvasRect(o.width,o.height),i=this.processor_.generatorVideoTrack()):(this.processor_.setCanvasRect(o.width,o.height),this.player_.setRect({width:o.width,height:o.height}),i=this.processor_.generateVideoTrackFromCanvasCapture(o.frameRate),this.interval_=zt.setInterval(this.render.bind(this),Math.ceil(1e3/o.frameRate))),i}},{key:"render",value:function(){this.processor_.canDrawVideoToCanvas&&this.processor_.drawVideoToCanvas()}},{key:"destroy",value:function(){zt.clearInterval(this.interval_),this.processor_&&this.processor_.destroy()}},{key:"initOffscreen",value:function(){this.processor_=new aL({videoTrack:this.localStream_.getVideoTrack()})}},{key:"initCanvas",value:function(){this.player_=new mS({stream:this.localStream_,track:this.localStream_.getVideoTrack(),muted:!0,objectFit:"cover",mirror:!1}),this.player_.play().then(function(){ye.info("VideoGenerator: play local video success")}).catch(function(){ye.error("VideoGenerator: Failed to play local video")}),this.processor_=new iL(this.player_)}},{key:"getSmallVideoProfile",value:function(n){var i,o=this.localStream_.getVideoTrack(),c=this.localStream_.getVideoProfile(),a=o.getSettings(),u=a&&a.width&&a.height?{width:a.width,height:a.height}:c,l=u.width*u.height,h=n.width*n.height;return ye.info("big stream resolution: ".concat(u.height,"*").concat(u.width," small stream resolution: ").concat(n.height,"*").concat(n.width," ")),l>h?i=l/h:(ye.warn("Small stream resolution is larger than big stream, which is invalid. big: ".concat(u.width," * ").concat(u.height," small: ").concat(n.width," * ").concat(n.height)),i=l/19200),{width:parseInt(u.width/Math.sqrt(i)),height:parseInt(u.height/Math.sqrt(i)),frameRate:n.frameRate}}}]),e}(),d1={voiceActivityDetection:!1},cL=function(e){$(I,e);var t,n,i,o,c,a,u,l,h,f,m,g,v=Ye(I);function I(S){var y;return w(this,I),(y=v.call(this,S)).localStream_=null,y.exchangeSDPTimeout_=-1,y.smallGenerator_=null,y.isSDPExchanging_=!1,y.ssrc_={audio:0,video:0,small:0},y.canvasTrack_=null,y}return P(I,[{key:"initialize",value:function(){Ae(W(I.prototype),"initialize",this).call(this),this.installEvents()}},{key:"reset",value:function(){this.closePeerConnection(),this.uninstallEvents(),this.clearExchangeSDPTimeout(),this.canvasTrack_=null,this.localStream_&&this.localStream_.clearCanvas()}},{key:"close",value:function(){Ae(W(I.prototype),"close",this).call(this),this.reset(),this.emitConnectionStateChangedEvent(dn),this.smallGenerator_&&(this.smallGenerator_.destroy(),this.smallGenerator_=null)}},{key:"installEvents",value:function(){this.emitter_.on(it.ERROR,this.handleError,this),this.emitter_.on(it.CONNECTION_STATE_CHANGED,this.handleConnectionStateChange,this)}},{key:"uninstallEvents",value:function(){this.emitter_.off(it.ERROR,this.handleError,this),this.emitter_.off(it.CONNECTION_STATE_CHANGED,this.handleConnectionStateChange,this)}},{key:"publish",value:(g=b(regeneratorRuntime.mark(function S(y){var E,C,x,U,G;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(this.localStream_=y,E=y.getMediaStream(),this.log_.info("is publishing stream: ".concat(y.getId())),C=this.localStream_.getAudioTrack(),x=this.localStream_.getVideoTrack(),C&&(U=this.localStream_.getGainedTrack(),this.peerConnection_.addTrack(U||C,E)),!x){H.next=14;break}if((su||au)&&C0(x)?(this.canvasTrack_=this.localStream_.genCanvasTrack(x),this.peerConnection_.addTrack(this.canvasTrack_,E)):this.peerConnection_.addTrack(x,E),!this.client_.getIsEnableSmallStream()){H.next=14;break}return this.smallGenerator_=new sL(this.localStream_),H.next=12,this.smallGenerator_.initialize();case 12:G=this.smallGenerator_.generateSmallVideoTrack(this.client_.smallStreamConfig_),this.peerConnection_.addTrack(G,E);case 14:return H.next=16,this.connect();case 16:return H.abrupt("return",y);case 17:case"end":return H.stop()}},S,this)})),function(S){return g.apply(this,arguments)})},{key:"updateMediaSettings",value:function(S){var y=this,E=this.getMediaSettings(S);this.signalChannel_.sendWaitForResponse({command:E2,data:E,responseCommand:kt.UPDATE_CONSTRAINT_CONFIG_RES}).then(function(C){C.data.code!==0&&y.log_.warn(C.data.message)}).catch(this.log_.warn)}},{key:"getMediaSettings",value:function(S){var y=this,E=this.client_.getSystemResult().detail,C=E.isH264EncodeSupported,x=E.isVp8EncodeSupported,U="";C?U="H264":x&&(U="VP8");var G={videoCodec:U,videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0};return oa?S.getTracks().forEach(function(H){var V=H.getSettings();if(H.kind===Pe){var j=1;V.channelCount&&(j=V.channelCount),G.audioChannel=j,G.audioBps=1e3*y.localStream_.getAudioBitrate(),G.audioFs=V.sampleRate}else H.kind===Ue&&(y.client_.getIsEnableSmallStream()&&(G.smallVideoWidth=y.client_.smallStreamConfig.width,G.smallVideoHeight=y.client_.smallStreamConfig.height,G.smallVideoFps=y.client_.smallStreamConfig.framerate,G.smallVideoBps=1e3*y.client_.smallStreamConfig.bitrate),G.videoWidth=V.width,G.videoHeight=V.height,G.videoFps=V.frameRate,G.videoBps=1e3*y.localStream_.getVideoBitrate())}):G=this.getMediaSettingsFromProfile(G),this.log_.info("updateMediaSettings: "+JSON.stringify(G)),G}},{key:"getMediaSettingsFromProfile",value:function(S){var y=this.localStream_;if(y){if(y.getAudioTrack()){var E=y.getAudioProfile();S.audioChannel=E.channelCount,S.audioBps=1e3*E.bitrate,S.audioFs=E.sampleRate}if(y.getVideoTrack()){var C=y.getVideoProfile();S.videoWidth=C.width,S.videoHeight=C.height,S.videoFps=C.frameRate,S.videoBps=1e3*C.bitrate}}return S}},{key:"addTrack",value:(m=b(regeneratorRuntime.mark(function S(y){var E,C,x;return regeneratorRuntime.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!this.peerConnection_){U.next=19;break}if(y.kind===Ue&&(su||au)&&C0(y)&&(y=this.canvasTrack_=this.localStream_.genCanvasTrack(y)),this.log_.info("is adding ".concat(y.kind," track to current published local stream")),!(Ab()&&this.peerConnection_.getTransceivers().findIndex(function(G){return G.direction==="stopped"})>=0)){U.next=7;break}return this.log_.warn("transceiver is stopping, negotiate sdp first"),U.next=7,this.updateOffer(Wi,y);case 7:if(!(E=this.peerConnection_.getSenders().find(function(G){return G.track&&G.track.kind===y.kind}))){U.next=14;break}return this.log_.warn("sender already exists, remove sender first"),C=E.track,this.removeSender(E),U.next=14,this.updateOffer(Wi,C);case 14:return x=this.localStream_.getMediaStream(),this.peerConnection_.addTrack(y,x),U.next=18,this.updateOffer(li,y);case 18:gn(this.userId_,{eventId:y.kind===Pe?_b:vb,eventDesc:"add ".concat(y.kind," track to current published stream"),timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_});case 19:case"end":return U.stop()}},S,this)})),function(S){return m.apply(this,arguments)})},{key:"isNeedToResetOfferOrder",value:function(){if(this.sdpSemantics_==="plan-b"||!this.peerConnection_||!this.peerConnection_.localDescription)return!1;for(var S=this.peerConnection_.localDescription.sdp,y=Lr(S),E=0;E<y.media.length;E++)if(y.media[E].mid===0&&y.media[E].type===Ue)return!0;return!1}},{key:"removeSender",value:function(S){var y=null;Ab()&&(y=this.peerConnection_.getTransceivers().find(function(E){return E.sender&&E.sender.track===S.track})),this.peerConnection_.removeTrack(S),y&&hr(y.stop)&&(this.log_.info("stop transceiver"),y.stop())}},{key:"removeTrack",value:(f=b(regeneratorRuntime.mark(function S(y){var E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!this.peerConnection_||!Cu()){x.next=15;break}if(y.kind===Ue&&(su||au)&&this.canvasTrack_&&(y=this.canvasTrack_,this.localStream_.clearCanvas()),this.log_.info("is removing ".concat(y.kind," track from current published local stream")),y.kind!==Ue||!this.isNeedToResetOfferOrder()){x.next=10;break}return this.reset(),this.initialize(),(E=this.localStream_.getMediaStream())===null||E===void 0||E.removeTrack(y),x.next=9,this.publish(this.localStream_);case 9:return x.abrupt("return");case 10:return(C=this.peerConnection_.getSenders().find(function(U){return U.track===y}))&&this.removeSender(C),x.next=14,this.updateOffer(Wi,y);case 14:gn(this.userId_,{eventId:y.kind===Pe?bb:yb,eventDesc:"remove ".concat(y.kind," track from current published stream"),timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_});case 15:case"end":return x.stop()}},S,this)})),function(S){return f.apply(this,arguments)})},{key:"replaceTrack",value:(h=b(regeneratorRuntime.mark(function S(y){var E,C=this;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(y.kind!==Ue||!su&&!au||!this.canvasTrack_){x.next=2;break}return x.abrupt("return");case 2:if(xb()&&Cu()){x.next=4;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:oP})});case 4:if(this.peerConnection_){x.next=6;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Qh})});case 6:if((E=this.peerConnection_.getSenders()).length!==0){x.next=9;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Qh})});case 9:E.forEach(function(U){U.track&&U.track.kind===y.kind&&(C.log_.info("is replacing ".concat(y.kind," track to current published local stream")),U.replaceTrack(y))}),gn(this.userId_,{eventId:y.kind===Pe?L2:N2,eventDesc:"replace ".concat(y.kind," track from current published stream"),timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_});case 11:case"end":return x.stop()}},S,this)})),function(S){return h.apply(this,arguments)})},{key:"setBandwidth",value:(l=b(regeneratorRuntime.mark(function S(y,E,C){var x,U;return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(this.isUplink_){G.next=2;break}return G.abrupt("return",C);case 2:if(qf()){G.next=4;break}return G.abrupt("return",E===Ue?this.updateVideoBandwidthRestriction(C,y):this.updateAudioBandwidthRestriction(C,y));case 4:if(!(x=this.peerConnection_.getSenders().find(function(H){return H.track&&H.track.kind===E}))){G.next=20;break}return(U=x.getParameters()).encodings&&U.encodings.length!==0||(U.encodings=[{}]),y==="unlimited"?delete U.encodings[0].maxBitrate:U.encodings[0].maxBitrate=1e3*y,G.prev=9,G.next=12,x.setParameters(U);case 12:return this.log_.info(E+" bandwidth was set to "+y+" kbps"),G.abrupt("return",C);case 16:return G.prev=16,G.t0=G.catch(9),this.log_.info("failed to set bandwidth by setting maxBitrate: "+G.t0),G.abrupt("return",E===Ue?this.updateVideoBandwidthRestriction(C,y):this.updateAudioBandwidthRestriction(C,y));case 20:return G.abrupt("return",C);case 21:case"end":return G.stop()}},S,this,[[9,16]])})),function(S,y,E){return l.apply(this,arguments)})},{key:"setSmallStreamBandwidth",value:(u=b(regeneratorRuntime.mark(function S(y,E){var C,x;return regeneratorRuntime.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(this.isUplink_){U.next=2;break}return U.abrupt("return",E);case 2:if(qf()){U.next=4;break}return U.abrupt("return",this.updateSmallVideoBandwidthRestriction(E,y));case 4:if(!(C=this.peerConnection_.getSenders().filter(function(G){return G.track&&G.track.kind===Ue})[1])){U.next=20;break}return(x=C.getParameters()).encodings&&x.encodings.length!==0||(x.encodings=[{}]),y==="unlimited"?delete x.encodings[0].maxBitrate:x.encodings[0].maxBitrate=1e3*y,U.prev=9,U.next=12,C.setParameters(x);case 12:return this.log_.info("small stream bandwidth was set to "+y+" kbps"),U.abrupt("return",E);case 16:return U.prev=16,U.t0=U.catch(9),this.log_.info("failed to set small stream bandwidth by setting maxBitrate: "+U.t0),U.abrupt("return",this.updateSmallVideoBandwidthRestriction(E,y));case 20:return U.abrupt("return",E);case 21:case"end":return U.stop()}},S,this,[[9,16]])})),function(S,y){return u.apply(this,arguments)})},{key:"updateVideoBandwidthRestriction",value:function(S,y){var E="AS";return Rr&&(E="TIAS",y*=1e3),S=S.indexOf("b="+E+":")===-1?S.replace(/m=video (.*)\r\nc=IN (.*)\r\n/,`m=video $1\r
c=IN $2\r
b=`+E+":"+y+`\r
`):S.replace(new RegExp("b="+E+`:.*\r
`),"b="+E+":"+y+`\r
`)}},{key:"updateAudioBandwidthRestriction",value:function(S,y){var E="AS";return Rr&&(E="TIAS",y*=1e3),S=S.replace(/m=audio (.*)\r\nc=IN (.*)\r\n/,`m=audio $1\r
c=IN $2\r
b=`+E+":"+y+`\r
`)}},{key:"updateSmallVideoBandwidthRestriction",value:function(S,y){var E="AS";Rr&&(E="TIAS",y*=1e3);var C=/m=video (.*)\r\nc=IN (.*)\r\n/g,x=[],U=C.exec(S);for(x.push(U);U!==null;)U=C.exec(S),x.push(U);var G=x[x.length-2],H=S.slice(0,G.index),V=S.slice(G.index);return S=S.indexOf("b="+E+":")===-1?H+(V=V.replace(/m=video (.*)\r\nc=IN (.*)\r\n/,`m=video $1\r
c=IN $2\r
b=`+E+":"+y+`\r
`)):H+(V=V.replace(new RegExp("b="+E+`:.*\r
`),"b="+E+":"+y+`\r
`))}},{key:"removeBandwidthRestriction",value:function(S){return S.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}},{key:"removeVideoOrientation",value:function(S){return S.replace(/urn:3gpp:video-orientation/,"")}},{key:"connect",value:(a=b(regeneratorRuntime.mark(function S(){return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,y.next=3,this.exchangeSDP();case 3:return y.next=5,this.waitForPeerConnectionConnected();case 5:y.next=11;break;case 7:throw y.prev=7,y.t0=y.catch(0),this.closePeerConnection(!0),y.t0;case 11:case"end":return y.stop()}},S,this,[[0,7]])})),function(){return a.apply(this,arguments)})},{key:"exchangeSDP",value:(c=b(regeneratorRuntime.mark(function S(){return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,this.isSDPExchanging_=!0,y.next=4,this.createOffer();case 4:return this.log_.info("createOffer success, sending offer to remote server"),y.next=7,this.doExchangeSDP();case 7:this.isSDPExchanging_=!1,y.next=14;break;case 10:throw y.prev=10,y.t0=y.catch(0),this.isSDPExchanging_=!1,y.t0;case 14:case"end":return y.stop()}},S,this,[[0,10]])})),function(){return c.apply(this,arguments)})},{key:"createOffer",value:(o=b(regeneratorRuntime.mark(function S(){var y;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.prev=0,E.next=3,this.peerConnection_.createOffer(d1);case 3:return y=E.sent,E.next=6,this.peerConnection_.setLocalDescription(y);case 6:this.updateSSRC(y.sdp),Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:du,kind:"offer"}),E.next=14;break;case 10:throw E.prev=10,E.t0=E.catch(0),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:du,kind:"offer",error:E.t0}),E.t0;case 14:case"end":return E.stop()}},S,this,[[0,10]])})),function(){return o.apply(this,arguments)})},{key:"doExchangeSDP",value:function(){var S=this;return new Promise(function(y,E){S.exchangeSDPTimeout_=setTimeout(function(){S.signalChannel_.off(kt.PUBLISH_RESULT,C),S.clearExchangeSDPTimeout();var G=new Y({code:Q.API_CALL_TIMEOUT,message:Z({key:HA})});E(G)},5e3);var C=function(){var G=b(regeneratorRuntime.mark(function H(V){var j,q,K;return regeneratorRuntime.wrap(function(De){for(;;)switch(De.prev=De.next){case 0:if(De.prev=0,S.clearExchangeSDPTimeout(),j=V.data,q=j.code,K=j.message,q!==0){De.next=9;break}return De.next=6,S.acceptAnswer(V.data.data);case 6:y(),De.next=10;break;case 9:S.checkPublishResultCode(q,K);case 10:De.next=15;break;case 12:De.prev=12,De.t0=De.catch(0),E(De.t0);case 15:case"end":return De.stop()}},H,null,[[0,12]])}));return function(H){return G.apply(this,arguments)}}(),x=S.getMediaSettings(S.localStream_.getMediaStream()),U={type:S.peerConnection_.localDescription.type,sdp:S.removeVideoOrientation(S.peerConnection_.localDescription.sdp),screen:S.localStream_.hasScreenTrack(),constraintConfig:x};S.signalChannel_.once(kt.PUBLISH_RESULT,C),S.log_.debug("sending sdp offer: "+U.sdp),S.signalChannel_.send(p2,U)})}},{key:"setSDPDirection",value:function(S,y){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"all",C=Lr(S);return C.media.forEach(function(x){E!=="all"&&x.type!==E||(x.direction=y)}),ta(C)}},{key:"updateOffer",value:(i=b(regeneratorRuntime.mark(function S(y,E){var C,x,U,G,H,V,j;return regeneratorRuntime.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.prev=0,q.next=3,this.peerConnection_.createOffer(d1);case 3:return C=q.sent,Rr&&(C.sdp=this.setSDPDirection(C.sdp,"sendrecv")),q.next=7,this.peerConnection_.setLocalDescription(C);case 7:return x=this.getMediaSettings(this.localStream_.getMediaStream()),U={action:y,trackId:E.id,kind:E.kind===Ue?"bigVideo":E.kind,type:"offer",sdp:this.peerConnection_.localDescription.sdp,constraintConfig:x},this.log_.info("createOffer success, sending updated offer to remote server"),this.log_.debug("updatedOffer: "+U.sdp),q.next=13,this.signalChannel_.sendWaitForResponse({command:u2,data:U,responseCommand:kt.UPDATE_OFFER_RESULT,timeout:1e4,commandDesc:"update offer"});case 13:return G=q.sent,H=G.data,V=H.code,j=H.message,V!==0&&this.checkPublishResultCode(V,j),q.next=18,this.acceptAnswer(G.data.data);case 18:this.updateSSRC(C.sdp),Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:du,kind:"offer"}),q.next=27;break;case 22:throw q.prev=22,q.t0=q.catch(0),this.log_.error(q.t0),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:du,kind:"offer",error:q.t0}),q.t0;case 27:case"end":return q.stop()}},S,this,[[0,22]])})),function(S,y){return i.apply(this,arguments)})},{key:"acceptAnswer",value:(n=b(regeneratorRuntime.mark(function S(y){var E,C,x,U,G;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return E=this.localStream_.getVideoBitrate(),C=this.localStream_.getAudioBitrate(),H.prev=2,x=this.removeVideoOrientation(y.sdp),H.next=6,this.setBandwidth(E,Ue,x);case 6:return x=H.sent,H.next=9,this.setBandwidth(C,Pe,x);case 9:if(x=H.sent,!this.client_.getIsEnableSmallStream()){H.next=15;break}return U=this.client_.smallStreamConfig,H.next=14,this.setSmallStreamBandwidth(U.bitrate,x);case 14:x=H.sent;case 15:return G={type:y.type,sdp:x},H.next=18,this.peerConnection_.setRemoteDescription(G);case 18:this.sei_&&this.sei_.handleEncodedStreams(),this.log_.debug("accepted answer: "+x),Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:qy,kind:"answer"}),H.next=28;break;case 23:throw H.prev=23,H.t0=H.catch(2),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:qy,kind:"answer",error:H.t0}),this.log_.error("failed to accept remote answer "+H.t0),H.t0;case 28:case"end":return H.stop()}},S,this,[[2,23]])})),function(S){return n.apply(this,arguments)})},{key:"sendMutedFlag",value:function(S){var y={audio:S.audio,bigVideo:S.video,auxVideo:S.auxVideo};this.log_.info("send muted state: ".concat(JSON.stringify(y))),this.signalChannel_.send(f2,y)}},{key:"getIsReconnecting",value:function(){return this.isReconnecting_}},{key:"reconnect",value:(t=b(regeneratorRuntime.mark(function S(){var y,E,C=this;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.reconnectionTimer_===-1){x.next=3;break}return this.log_.warn("reconnect() uplink is reconnecting, ignore current reconnection"),x.abrupt("return");case 3:if(!(this.reconnectionCount_>=30)){x.next=12;break}return this.log_.warn("SDK has tried reconnect uplink for ".concat(30," times, but all failed, please check your network")),this.stopReconnection(),y=new Y({code:Q.UPLINK_RECONNECTION_FAILED,message:Z({key:WA})}),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Wy,error:y}),this.addEventInternal(Y2,"uplink-connection reconnect fail"),this.emitConnectionStateChangedEvent(dn),this.emitter_.emit(it.ERROR,y),x.abrupt("return");case 12:if(this.signalChannel_.getCurrentState()===Eu){x.next=16;break}return this.log_.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this.signalChannel_.once(Cs,this.reconnect,this),x.abrupt("return");case 16:if(this.reconnectionCount_++,x.prev=17,this.log_.warn("reconnect() try to reconnect uplink [".concat(this.reconnectionCount_,"/").concat(30,"]")),E=Zh(this.reconnectionCount_),this.reconnectionTimer_=setTimeout(function(){C.log_.warn("reconnect() uplink reconnect timeout(".concat(E/1e3,"s), try again")),C.clearReconnectionTimer(),C.reconnect()},E),!(this.isSDPExchanging_||this.peerConnection_&&this.peerConnection_.connectionState===lu)){x.next=23;break}return x.abrupt("return");case 23:return x.next=25,this.signalChannel_.sendWaitForResponse({command:gb,responseCommand:kt.UNPUBLISH_RESULT,enableLog:!1});case 25:return this.reset(),this.initialize(),x.next=29,this.publish(this.localStream_);case 29:Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:Wy}),this.log_.warn("reconnect() uplink reconnect successfully"),this.addEventInternal(Q2,"uplink-connection reconnect success"),this.stopReconnection(),this.localStream_.syncMuteState(),x.next=38;break;case 36:x.prev=36,x.t0=x.catch(17);case 38:case"end":return x.stop()}},S,this,[[17,36]])})),function(){return t.apply(this,arguments)})},{key:"clearExchangeSDPTimeout",value:function(){this.exchangeSDPTimeout_!==-1&&(clearTimeout(this.exchangeSDPTimeout_),this.exchangeSDPTimeout_=-1)}},{key:"clearReconnectionTimer",value:function(){this.reconnectionTimer_!==-1&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"handleError",value:function(S){S.getCode()===Q.ICE_TRANSPORT_ERROR&&(this.isFirstConnection_&&(this.isFirstConnection_=!1,Se.logFailedEvent({userId:this.client_.getUserId(),eventType:zy,error:S})),this.isReconnecting_||this.startReconnection())}},{key:"handleConnectionStateChange",value:function(S){S.state===mn&&this.isFirstConnection_&&(this.isFirstConnection_=!1,Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:zy}),this.addEventInternal(z2,"uplink-connection is connected"))}},{key:"updateSSRC",value:function(S){var y=this;try{var E=0;Lr(S).media.forEach(function(C){if(C.type===Pe){var x=C.ssrcs[0];x&&(y.ssrc_.audio=x.id)}else{var U=C.ssrcs[0];switch(E+=1){case 1:U&&(y.ssrc_.video=U.id);break;case 2:U&&(y.ssrc_.small=U.id)}}})}catch{}}},{key:"getLocalStreamVideoTrackId",value:function(){if(this.peerConnection_){var S=this.peerConnection_.getSenders().filter(function(E){return E.track&&E.track.kind===Ue});if(S[0])return S[0].track.id}if(this.localStream_){var y=this.localStream_.getVideoTrack();if(y)return y.id}return""}},{key:"getSSRC",value:function(){return this.ssrc_}},{key:"checkPublishResultCode",value:function(S,y){if(S!==0)throw S===1028?(this.log_.error(di.NOT_SUPPORTED_H264ENCODE),new Y({code:Q.NOT_SUPPORTED_H264,message:Z({key:_0})})):new Y({code:Q.UNKNOWN,message:Z({key:b0,data:{signalResponse:kt.PUBLISH_RESULT,code:S,message:y}})})}},{key:"getLocalStream",value:function(){return this.localStream_}},{key:"sendSEI",value:function(S,y){this.sei_.push(S,y)}}]),I}(Lp),uL=function(e){$(h,e);var t,n,i,o,c,a,u,l=Ye(h);function h(f){var m;return w(this,h),(m=l.call(this,f)).remoteStreams_=new Map,m.autoSubscribe=f.autoSubscribe,m.trackState_={audio:f.trackState.audio,video:f.trackState.video,auxiliary:f.trackState.auxiliary,smallVideo:f.trackState.smallVideo},m.ssrc_={audio:0,video:0,auxiliary:0},m.subscribeState_={audio:f.autoSubscribe,video:f.autoSubscribe,auxiliary:f.autoSubscribe,smallVideo:!1},m.isSDPExchanging_=!1,m.installEvents(),m}return P(h,[{key:"isMainStreamSubscribed",get:function(){return(this.subscribeState_.audio||this.subscribeState_.video||this.subscribeState_.smallVideo)&&(this.trackState_.audio||this.trackState_.video||this.trackState_.smallVideo)}},{key:"isAuxStreamSubscribed",get:function(){return this.subscribeState_.auxiliary&&this.trackState_.auxiliary}},{key:"isSmallStreamSubscribed",get:function(){return this.subscribeState_.smallVideo&&this.trackState_.smallVideo}},{key:"isBigStreamSubscribed",get:function(){return this.subscribeState_.video&&this.trackState_.video}},{key:"isStreamUnpublished",value:function(f){return f.getType()===Et?!this.trackState_.audio&&!this.trackState_.video:!this.trackState_.auxiliary}},{key:"initialize",value:function(){Ae(W(h.prototype),"initialize",this).call(this),this.peerConnection_.ontrack=this.onTrack.bind(this)}},{key:"close",value:function(){var f=this;Ae(W(h.prototype),"close",this).call(this),this.trackState_.audio=!1,this.trackState_.video=!1,this.trackState_.auxiliary=!1,this.emitConnectionStateChangedEvent(dn),this.remoteStreams_.forEach(function(m){var g=m;g.setConnection(null),g.uninstallEvents(),g.getIsStreamAddedEventEmitted()&&f.emitter_.emit(it.STREAM_REMOVED,{stream:g})}),this.remoteStreams_.clear(),this.uninstallEvents()}},{key:"installEvents",value:function(){var f=this;J.on(Vn,this.onRemoteStreamUpdate,this),this.emitter_.on(it.ERROR,function(m){m.getCode()===Q.ICE_TRANSPORT_ERROR&&(f.isFirstConnection_&&(f.isFirstConnection_=!1,Se.logFailedEvent({userId:f.client_.getUserId(),eventType:Gy,error:m})),f.isReconnecting_||f.startReconnection())}),this.emitter_.on(it.CONNECTION_STATE_CHANGED,function(m){m.state===mn&&f.isFirstConnection_&&(f.isFirstConnection_=!1,Se.logSuccessEvent({userId:f.client_.getUserId(),eventType:Gy}),f.addEventInternal(W2,"downlink-connection is connected"))})}},{key:"uninstallEvents",value:function(){J.removeListener(Vn,this.onRemoteStreamUpdate,this)}},{key:"onRemoteStreamUpdate",value:function(f){if(this.hitTest(f.tinyId)&&f.client===this.client_){this.updateTrackState(f.action,f.kind);var m=f.kind===ur?_s:dr,g=this.remoteStreams_.get(m);if(!g)return;f.action===li?this.handleRemoteAddTrack(f.kind,g):this.handleRemoteRemoveTrack(f.kind,g)}}},{key:"handleRemoteAddTrack",value:function(f,m){this.log_.info("remote add ".concat(f," track")),f===Pe?m.updateAudioPlayingState(this.subscribeState_.audio):m.updateVideoPlayingState(f===ur?this.subscribeState_.auxiliary:this.subscribeState_.video||this.subscribeState_.smallVideo),m.getIsStreamAddedEventEmitted()?this.emitter_.emit(it.STREAM_UPDATED,{stream:m}):(this.emitter_.emit(it.STREAM_ADDED,{stream:m}),this.currentState_===mn&&m.emitConnectionStateChanged({prevState:dn,state:mn}))}},{key:"handleRemoteRemoveTrack",value:function(f,m){m.getIsStreamAddedEventEmitted()&&(this.log_.info("remote remove ".concat(f," track")),f===ur||!this.trackState_.audio&&!this.trackState_.video?(this.log_.info("remote stream ".concat(m.getType()," removed")),this.currentState_===mn&&m.emitConnectionStateChanged({prevState:mn,state:dn}),this.emitter_.emit(it.STREAM_REMOVED,{stream:m})):(f===Pe?m.updateAudioPlayingState(!1):(f!==cu||this.isSmallStreamSubscribed)&&m.updateVideoPlayingState(!1),this.emitter_.emit(it.STREAM_UPDATED,{stream:m})))}},{key:"updateTrackState",value:function(f,m){var g=f===li;switch(m){case Pe:this.trackState_.audio=g;break;case Ue:this.trackState_.video=g;break;case ur:this.trackState_.auxiliary=g;break;case cu:this.trackState_.smallVideo=g}this.log_.info("trackState updated: ".concat(JSON.stringify(this.trackState_)))}},{key:"onTrack",value:function(f){var m=f.streams[0],g=f.track;if(this.log_.info("ontrack() kind: ".concat(g.kind," id: ").concat(g.id," streamId: ").concat(m.id)),this.sdpSemantics_==="unified-plan"){var v=function(C){var x=Wf.parse(C),U={audio:[],video:[]};return x.media.forEach(function(G){if(G.ssrcs){var H=G.ssrcs[0].id>>16&255;if(G.type===Pe)U.audio.push(dr);else if(G.type==Ue){var V=H===hA?dr:_s;U.video.push(V)}}}),U}(this.peerConnection_.remoteDescription.sdp);if(g.kind===Pe){if(v.audio.length===0||m.id!==dr)return void this.log_.debug("skip this invalid audio track")}else if(v.video.indexOf(m.id)===-1)return void this.log_.debug("skip this invalid video track: ".concat(g.id,"  msid: ").concat(m.id))}Se.logEvent({eventType:"ontrack",kind:g.kind});var I=!1,S=this.remoteStreams_.get(m.id),y=m.id===dr?St:Nt;if(fe(S)&&((S=new Up({type:y,userId:this.userId_,client:this.client_})).setConnection(this),this.remoteStreams_.set(m.id,S),I=!0),S.setMediaStream(m),g.kind===Pe?S.updateAudioPlayingState(this.subscribeState_.audio):y===St?S.updateVideoPlayingState(this.subscribeState_.video||this.subscribeState_.smallVideo):S.updateVideoPlayingState(this.subscribeState_.auxiliary),(y!==Nt||this.trackState_.auxiliary)&&(y!==St||this.trackState_.audio||this.trackState_.video)){var E=this.client_.getSubscriptionManager();E&&E.hasAutoRecoveryFlag(this.userId_,y)||(I?this.emitter_.emit(it.STREAM_ADDED,{stream:S}):this.emitter_.emit(it.STREAM_UPDATED,{stream:S}))}}},{key:"addRRTRLine",value:function(f){var m=f.split(`\r
`),g=new Map;m.forEach(function(C,x){/^a=rtcp-fb:/.test(C)&&m[x+1]&&!/^a=rtcp-fb:/.test(m[x+1])&&g.set(x+1,C.match(/^a=rtcp-fb:\d+/)[0]+" rrtr")});for(var v=Ke(g),I=0;I<v.length;I++){var S=Xe(v[I],2),y=S[0],E=S[1];m.splice(y+I,0,E)}return m.join(`\r
`)}},{key:"addSPSDescription",value:function(f){var m=Lr(f);return m.media.forEach(function(g){g.type===Ue&&g.fmtp.forEach(function(v){v.config+=";sps-pps-idr-in-keyframe=1"})}),ta(m)}},{key:"removeSDESDescription",value:function(f){var m=["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"],g=Lr(f);return g.media.forEach(function(v){v.ext=v.ext.filter(function(I){return!m.includes(I.uri)})}),ta(g)}},{key:"isSubscriptionStateNotChanged",value:function(f,m){return f.getType()===St?(m==null?void 0:m.audio)===this.subscribeState_.audio&&(m==null?void 0:m.video)===this.subscribeState_.video&&this.isSubscribeSmall(m):f.getType()===Nt?!fe(m.video)&&this.subscribeState_.auxiliary===m.video:void 0}},{key:"isSubscribeSmall",value:function(f){return fe(f.smallVideo)&&!this.subscribeState_.smallVideo}},{key:"subscribe",value:(u=b(regeneratorRuntime.mark(function f(m,g){var v,I,S,y,E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(x.prev=0,S=g.emitEvent,y=S===void 0||S,E=m.getType(),((v=this.peerConnection_)===null||v===void 0?void 0:v.connectionState)!==fA&&((I=this.peerConnection_)===null||I===void 0?void 0:I.connectionState)!==lu){x.next=6;break}return x.next=6,this.waitForPeerConnectionConnected();case 6:if(!this.isSubscriptionStateNotChanged(m,g)){x.next=13;break}if(this.peerConnection_){x.next=11;break}return this.initialize(),x.next=11,this.connect();case 11:return y&&fe(g.smallVideo)&&this.emitter_.emit(it.STREAM_SUBSCRIBED,{stream:m,result:!0}),x.abrupt("return",m);case 13:if(E===Et?(fe(g.audio)||(this.subscribeState_.audio=g.audio),fe(g.video)||(this.subscribeState_.video=g.video),this.subscribeState_.smallVideo=(g==null?void 0:g.smallVideo)||!1,this.addEventInternal(this.subscribeState_.audio?Sb:zf,this.subscribeState_.audio?"subscribe audio":"unsubscribe audio"),this.addEventInternal(this.subscribeState_.video?Sb:zf,this.subscribeState_.video?"subscribe video":"unsubscribe video"),this.addEventInternal(this.subscribeState_.smallVideo?tD:nD,this.subscribeState_.smallVideo?"subscribe smallVideo":"unsubscribe smallVideo")):fe(g.video)||(this.subscribeState_.auxiliary=g.video),this.log_.info("subscribe ".concat(E," stream with options ").concat(JSON.stringify(g)," current state: ").concat(JSON.stringify(this.subscribeState_))),!this.peerConnection_&&!this.isSDPExchanging_){x.next=23;break}return C=$h,this.isMainStreamSubscribed||this.isAuxStreamSubscribed||(C=Hh),x.next=20,this.sendSubscription(C);case 20:E===Et?(m.updateAudioPlayingState(this.subscribeState_.audio),m.updateVideoPlayingState(this.subscribeState_.video||this.subscribeState_.smallVideo)):m.updateVideoPlayingState(this.subscribeState_.auxiliary),x.next=26;break;case 23:return this.initialize(),x.next=26,this.connect();case 26:return y&&fe(g.smallVideo)&&this.emitter_.emit(it.STREAM_SUBSCRIBED,{stream:m,result:!0}),x.abrupt("return",m);case 30:if(x.prev=30,x.t0=x.catch(0),!this.isStreamUnpublished(m)){x.next=34;break}throw new Y({code:Q.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId_," unpublished stream")});case 34:throw x.t0;case 35:case"end":return x.stop()}},f,this,[[0,30]])})),function(f,m){return u.apply(this,arguments)})},{key:"unsubscribe",value:(a=b(regeneratorRuntime.mark(function f(m){var g,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if((g=m.getType())!==Et){S.next=10;break}if(this.isMainStreamSubscribed){S.next=5;break}return this.log_.info("main stream already unsubscribed"),S.abrupt("return",m);case 5:this.subscribeState_.audio=!1,this.subscribeState_.video=!1,this.subscribeState_.smallVideo=!1,S.next=14;break;case 10:if(this.isAuxStreamSubscribed){S.next=13;break}return this.log_.info("auxiliary stream already unsubscribed"),S.abrupt("return",m);case 13:this.subscribeState_.auxiliary=!1;case 14:return v=Hh,(g===St&&this.isAuxStreamSubscribed||g===Nt&&this.isMainStreamSubscribed)&&(v=$h),this.log_.info("unsubscribe ".concat(g," stream with ").concat(JSON.stringify(this.subscribeState_))),S.next=19,this.sendSubscription(v);case 19:return m.updateVideoPlayingState(!1),m.updateAudioPlayingState(!1),v===Hh&&((I=m.getMediaStream())&&I.getTracks().forEach(function(y){return I.removeTrack(y)}),this.closePeerConnection(),this.emitConnectionStateChangedEvent(dn)),this.addEventInternal(zf,"unsubscribe audio"),this.addEventInternal(P2,"unsubscribe video"),S.abrupt("return",m);case 25:case"end":return S.stop()}},f,this)})),function(f){return a.apply(this,arguments)})},{key:"sendSubscription",value:function(f){var m=this,g={srcTinyId:this.tinyId_,srcUserId:this.userId_},v=g2,I=kt.UNSUBSCRIBE_RESULT;return f===$h&&(g={audio:this.subscribeState_.audio,bigVideo:this.subscribeState_.video,auxVideo:this.subscribeState_.auxiliary,smallVideo:this.subscribeState_.smallVideo,srcTinyId:this.tinyId_},v=v2,I=kt.SUBSCRIBE_CHANGE_RESULT),this.signalChannel_.sendWaitForResponse({command:v,data:g,responseCommand:I,timeout:1e4}).then(function(S){var y=S.data;if(y.code!==0){var E=new Y({code:y.code,message:Z({key:BA,data:{type:f,message:y.message}})});throw m.log_.error(E),E}})}},{key:"connect",value:(c=b(regeneratorRuntime.mark(function f(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,this.exchangeSDP();case 3:return m.next=5,this.waitForPeerConnectionConnected();case 5:m.next=11;break;case 7:throw m.prev=7,m.t0=m.catch(0),this.closePeerConnection(!0),m.t0;case 11:case"end":return m.stop()}},f,this,[[0,7]])})),function(){return c.apply(this,arguments)})},{key:"exchangeSDP",value:(o=b(regeneratorRuntime.mark(function f(){var m,g,v,I,S,y;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.prev=0,this.isSDPExchanging_=!0,E.next=4,this.createOffer();case 4:return this.log_.info("createOffer success, sending offer to remote server"),m=this.peerConnection_.localDescription,g=m.type,v=m.sdp,I={type:g,sdp:v,srcUserId:this.userId_,srcTinyId:this.tinyId_,audio:this.subscribeState_.audio,bigVideo:this.subscribeState_.video,auxVideo:this.subscribeState_.auxiliary,smallVideo:this.subscribeState_.smallVideo},J.emit(Lf,{client:this.client_,connection:this,userId:this.userId_,tinyId:this.tinyId_,role:zo,subscribeState:this.subscribeState_,trackState:this.trackState_}),E.next=10,this.signalChannel_.sendWaitForResponse({command:m2,commandDesc:"exchange sdp",data:I,responseCommand:kt.SUBSCRIBE_RESULT});case 10:if(S=E.sent,this.peerConnection_){E.next=15;break}throw y=new Y({code:Q.INVALID_OPERATION,message:Z({key:dP})}),this.log_.warn(y),y;case 15:return E.next=17,this.onSubscribeResult(S);case 17:this.isSDPExchanging_=!1,E.next=24;break;case 20:throw E.prev=20,E.t0=E.catch(0),this.isSDPExchanging_=!1,E.t0;case 24:case"end":return E.stop()}},f,this,[[0,20]])})),function(){return o.apply(this,arguments)})},{key:"createOffer",value:(i=b(regeneratorRuntime.mark(function f(){var m,g;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return m={voiceActivityDetection:!1},"RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype&&this.sdpSemantics_==="unified-plan"?(this.peerConnection_.addTransceiver(Pe,{direction:"recvonly"}),this.peerConnection_.addTransceiver(Ue,{direction:"recvonly"}),this.peerConnection_.addTransceiver(Ue,{direction:"recvonly"})):(m.offerToReceiveAudio=!0,m.offerToReceiveVideo=!0),v.next=4,this.peerConnection_.createOffer(m);case 4:return g=v.sent,v.next=7,Eb();case 7:return v.sent.isH264DecodeSupported||(this.log_.warn("remove h264 desc from sdp"),g.sdp=hD(g.sdp)),g.sdp=this.addRRTRLine(g.sdp),g.sdp=this.addSPSDescription(g.sdp),g.sdp=dD(g.sdp),this.sdpSemantics_==="unified-plan"&&(g.sdp=this.removeSDESDescription(g.sdp)),v.next=16,this.peerConnection_.setLocalDescription(g);case 16:case"end":return v.stop()}},f,this)})),function(){return i.apply(this,arguments)})},{key:"onSubscribeResult",value:(n=b(regeneratorRuntime.mark(function f(m){var g,v,I,S,y,E,C,x=this;return regeneratorRuntime.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g=m&&m.data||{},v=g.code,I=g.message,S=I===void 0?"":I,y=m&&m.data&&m.data.data||{},E=y.type,C=y.sdp,v!==77393){U.next=5;break}throw this.log_.error(di.NOT_SUPPORTED_H264DECODE),new Y({code:Q.NOT_SUPPORTED_H264,message:Z({key:y0})});case 5:if(U.prev=5,v===0){U.next=8;break}throw new Y({code:v,message:Z({key:zA,data:{errMsg:S}})});case 8:return this.log_.debug("accept remote answer: "+C),U.next=11,this.peerConnection_.setRemoteDescription({type:E,sdp:C});case 11:this.sei_&&(this.sei_.handleEncodedStreams(),this.sei_.onSEIMessage=function(G){x.emitter_.emit(it.SEI_MESSAGE,p(p({},G),{},{userId:x.userId_}))}),this.updateSSRC(C),U.next=19;break;case 15:throw U.prev=15,U.t0=U.catch(5),this.log_.error(U.t0),U.t0;case 19:case"end":return U.stop()}},f,this,[[5,15]])})),function(f){return n.apply(this,arguments)})},{key:"updateSSRC",value:function(f){var m=this;try{Lr(f).media.forEach(function(g){if(g.type===Pe){var v=g.ssrcs.find(function(y){return y.value.includes(dr)});v&&(m.ssrc_.audio=v.id)}else{var I=g.ssrcs.find(function(y){return y.value.includes(dr)}),S=g.ssrcs.find(function(y){return y.value.includes(_s)});I&&(m.ssrc_.video=I.id),S&&(m.ssrc_.auxiliary=S.id)}})}catch{}}},{key:"setRemoteStream",value:function(f,m){this.remoteStreams_.set(f,m)}},{key:"getSubscribeState",value:function(){return this.subscribeState_}},{key:"getTrackState",value:function(){return this.trackState_}},{key:"getSSRC",value:function(){return this.ssrc_}},{key:"getMainStream",value:function(){return this.remoteStreams_.get(dr)}},{key:"getAuxStream",value:function(){return this.remoteStreams_.get(_s)}},{key:"getMainStreamVideoTrackId",value:function(){var f=this.getMainStream();if(f){var m=f.getVideoTrack();if(m)return m.id}return""}},{key:"getAuxStreamVideoTrackId",value:function(){var f=this.getAuxStream();if(f){var m=f.getVideoTrack();if(m)return m.id}return""}},{key:"reconnect",value:(t=b(regeneratorRuntime.mark(function f(){var m,g,v=this;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(this.reconnectionTimer_===-1){I.next=3;break}return this.log_.warn("reconnect() downlink is reconnecting, ignore current reconnection"),I.abrupt("return");case 3:if(!(this.reconnectionCount_>=30)){I.next=12;break}return this.log_.warn("SDK has tried reconnect downlink [".concat(this.userId_,"] for ").concat(30," times, but all failed, please check your network")),this.stopReconnection(),m=new Y({code:Q.DOWNLINK_RECONNECTION_FAILED,message:Z({key:$A})}),Se.logFailedEvent({userId:this.client_.getUserId(),eventType:Jy,error:m}),this.addEventInternal(eD,"downlink-connection reconnect fail"),this.emitConnectionStateChangedEvent(dn),this.emitter_.emit(it.ERROR,m),I.abrupt("return");case 12:if(this.signalChannel_.getCurrentState()===Eu){I.next=16;break}return this.log_.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this.signalChannel_.once(Cs,this.reconnect,this),I.abrupt("return");case 16:if(this.reconnectionCount_++,this.log_.warn("reconnect() try to reconnect downlink [".concat(this.reconnectionCount_,"/").concat(30,"]")),g=Zh(this.reconnectionCount_),this.reconnectionTimer_=setTimeout(function(){v.log_.warn("reconnect() downlink [".concat(v.userId_,"] reconnect timeout(").concat(g/1e3,"s), try again")),v.clearReconnectionTimer(),v.reconnect()},g),!(this.isSDPExchanging_||this.peerConnection_&&this.peerConnection_.connectionState===lu)){I.next=22;break}return I.abrupt("return");case 22:return I.prev=22,this.closePeerConnection(),this.initialize(),I.next=27,this.connect();case 27:this.stopReconnection(),this.log_.warn("reconnect() downlink reconnect successfully"),Se.logSuccessEvent({userId:this.client_.getUserId(),eventType:Jy}),this.addEventInternal(Z2,"downlink-connection reconnect success"),this.recoverSubscription(),I.next=36;break;case 34:I.prev=34,I.t0=I.catch(22);case 36:case"end":return I.stop()}},f,this,[[22,34]])})),function(){return t.apply(this,arguments)})},{key:"recoverSubscription",value:function(){var f=this,m=this.client_.getSubscriptionManager();m&&Ke(this.remoteStreams_.values()).forEach(function(g){m.hasAutoRecoveryFlag(f.userId_,g.getType())&&m.recover(g)})}},{key:"getIsReconnecting",value:function(){return this.isReconnecting_}},{key:"getSubscribedMainStream",value:function(){var f=null;return this.isMainStreamSubscribed&&(f=this.remoteStreams_.get(dr)),f}},{key:"clearReconnectionTimer",value:function(){this.reconnectionTimer_!==-1&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"startReconnection",value:function(){var f=this.client_.getSubscriptionManager();if(f){var m,g=Ge(this.remoteStreams_.values());try{for(g.s();!(m=g.n()).done;){var v=m.value,I=v.getType();(I===St&&(this.trackState_.audio||this.trackState_.video)||I===Nt&&this.trackState_.auxiliary)&&f.setAutoRecoveryFlag(this.userId_,v.getType())}}catch(S){g.e(S)}finally{g.f()}}Ae(W(h.prototype),"startReconnection",this).call(this)}},{key:"getCurrentState",value:function(){return this.currentState_}},{key:"hasMainStream",value:function(){return this.trackState_.video||this.trackState_.audio||this.trackState_.smallVideo}},{key:"hasAuxStream",value:function(){return this.trackState_.auxiliary}}]),h}(Lp),Yu=function(){function e(){w(this,e),this.startTime=0,this.endTime=0,this.start()}return P(e,[{key:"start",value:function(){this.startTime===0&&(this.startTime=qt())}},{key:"stop",value:function(){this.endTime===0&&(this.endTime=qt())}},{key:"getDuration",value:function(){return this.endTime===0?qt()-this.startTime:this.endTime-this.startTime}}]),e}(),lL=function(){function e(o){w(this,e),this.client_=o.client,this.intervalId_=-1,this.statsCalculator_=o.stats,this.prevStats_=null,this.renderFreezeMap_=new Map,this.remoteStreamMap_=new Map,this.dataFreezeMap_=new Map,this.monitorFreezeData_=new Map}var t,n,i;return P(e,[{key:"installEvents",value:function(){J.on(xf,this.handlePlayVideoStart,this),J.on(Ts,this.onVideoTrackMuted,this),J.on(Cf,this.onVideoTrackUnmuted,this),J.on(Is,this.handleStreamStopped,this),J.on(Or,this.handleStreamStopped,this),J.on(ks,this.handleVideoPlaying,this)}},{key:"uninstallEvents",value:function(){J.off(xf,this.handlePlayVideoStart,this),J.off(Ts,this.onVideoTrackMuted,this),J.off(Cf,this.onVideoTrackUnmuted,this),J.off(Is,this.handleStreamStopped,this),J.off(Or,this.handleStreamStopped,this),J.off(ks,this.handleVideoPlaying,this)}},{key:"start",value:function(){var o=this;this.intervalId_===-1&&(this.installEvents(),this.intervalId_=zt.setInterval(b(regeneratorRuntime.mark(function c(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o.detectFPS();case 3:a.next=7;break;case 5:a.prev=5,a.t0=a.catch(0);case 7:case"end":return a.stop()}},c,null,[[0,5]])})),1e3))}},{key:"stop",value:function(){this.intervalId_!==-1&&(this.uninstallEvents(),zt.clearInterval(this.intervalId_),this.intervalId_=-1,this.renderFreezeMap_.clear(),this.dataFreezeMap_.clear(),this.remoteStreamMap_.clear())}},{key:"onVideoTrackMuted",value:function(o){var c=o.stream;if(c.getClient()===this.client_&&c.isRemote()){var a=c.userId_,u=c.type_,l="".concat(a,"_").concat(u),h=this.dataFreezeMap_.get(l),f=new Yu;h?h.durationItemList.push(f):this.dataFreezeMap_.set(l,{userId:a,type:u,durationItemList:[f],isFreezing:function(){var m=this.durationItemList[this.durationItemList.length-1];return m&&m.endTime===0}})}}},{key:"onVideoTrackUnmuted",value:function(o){var c=o.stream;if(c.getClient()===this.client_&&c.isRemote()){var a=c.userId_,u=c.type_,l="".concat(a,"_").concat(u);this.stopDataFreeze({key:l,userId:a,type:u})}}},{key:"handleStreamStopped",value:function(o){var c=o.client,a=o.stream;if(c===this.client_){var u=a.getUserId(),l=a.getType(),h="".concat(u,"_").concat(l);this.stopDataFreeze({key:h,userId:u,type:l})}}},{key:"stopDataFreeze",value:function(o){var c=o.key,a=o.userId,u=o.type,l=this.dataFreezeMap_.get(c);if(l&&l.isFreezing()){var h=l.durationItemList[l.durationItemList.length-1];h.stop();var f=h.getDuration();f>500?(Se.logEvent({eventType:"videoFrozenCount",delta:f}),this.monitorFreezeData_.set(c,{userId:a,type:u,duration:f})):l.durationItemList.pop()}}},{key:"getTotalDuration",value:function(o){return o.reduce(function(c,a){var u=a.getDuration();return c+Math.min(u,5e3)},0)}},{key:"getStats",value:(i=b(regeneratorRuntime.mark(function o(){var c,a,u,l,h,f,m,g,v,I,S;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:c=this.client_.getConnections(),a={},u=Ge(c),y.prev=3,u.s();case 5:if((l=u.n()).done){y.next=20;break}if(h=Xe(l.value,2),f=h[0],(m=h[1]).getPeerConnection()){y.next=9;break}return y.abrupt("continue",18);case 9:return g=m.getSubscribeState(),v=m.getTrackState(),y.next=13,this.statsCalculator_.getReceiverStats(m);case 13:I=y.sent,(S={userId:I.userId,tinyId:f,hasVideo:v.video&&g.video,hasAuxiliary:v.auxiliary&&g.auxiliary,video:{framesDecoded:0},auxiliary:{framesDecoded:0}}).hasVideo&&(S.video.framesDecoded=I.video.framesDecoded),S.hasAuxiliary&&(S.auxiliary.framesDecoded=I.auxiliary.framesDecoded),a[I.userId]=S;case 18:y.next=5;break;case 20:y.next=25;break;case 22:y.prev=22,y.t0=y.catch(3),u.e(y.t0);case 25:return y.prev=25,u.f(),y.finish(25);case 28:return y.abrupt("return",a);case 29:case"end":return y.stop()}},o,this,[[3,22,25,28]])})),function(){return i.apply(this,arguments)})},{key:"detectFPS",value:(n=b(regeneratorRuntime.mark(function o(){var c,a,u,l,h,f;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.getStats();case 2:if(c=m.sent,this.prevStats_){m.next=6;break}return this.prevStats_=c,m.abrupt("return");case 6:m.t0=regeneratorRuntime.keys(c);case 7:if((m.t1=m.t0()).done){m.next=17;break}if(a=m.t1.value,this.prevStats_[a]){m.next=11;break}return m.abrupt("continue",7);case 11:u=c[a].tinyId,l=this.client_.getMutedStates(),c[a].hasVideo&&this.prevStats_[a].hasVideo&&l.has(u)&&!l.get(u).videoMuted&&(h=c[a].video.framesDecoded-this.prevStats_[a].video.framesDecoded,this.handleRenderFreeze({userId:a,type:St,fps:h})),c[a].hasAuxiliary&&this.prevStats_[a].hasAuxiliary&&(f=c[a].auxiliary.framesDecoded-this.prevStats_[a].auxiliary.framesDecoded,this.handleRenderFreeze({userId:a,type:Nt,fps:f})),m.next=7;break;case 17:this.prevStats_=c;case 18:case"end":return m.stop()}},o,this)})),function(){return n.apply(this,arguments)})},{key:"handleRenderFreeze",value:(t=b(regeneratorRuntime.mark(function o(c){var a,u,l,h,f,m,g,v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:a=c.userId,u=c.fps,l=c.type,h="".concat(a,"_").concat(l),f=this.renderFreezeMap_.get(h),u<=2?(m=qt(),f&&!f.isFreeze&&(f.freezeTimeline.push({startTime:m,endTime:void 0}),f.isFreeze=!0),f||this.renderFreezeMap_.set(h,{userId:a,type:l,isFreeze:!0,freezeTimeline:[{startTime:m,endTime:void 0}],renderFreezeTotal:0})):f&&f.isFreeze&&(f.isFreeze=!1,(g=f.freezeTimeline.pop()).endTime=qt(),v=g.endTime-g.startTime,f.freezeTimeline.push(g),f.renderFreezeTotal+=Math.min(5e3,v));case 4:case"end":return I.stop()}},o,this)})),function(o){return t.apply(this,arguments)})},{key:"handlePlayVideoStart",value:function(o){var c=o.stream;if(c.getClient()===this.client_&&c.isRemote()&&c.hasVideo()){var a="".concat(c.getUserId(),"_").concat(c.getType());this.remoteStreamMap_.has(a)?this.remoteStreamMap_.get(a).remoteStream=c:this.remoteStreamMap_.set(a,{isPlayingFired:!1,remoteStream:c})}}},{key:"handleVideoPlaying",value:function(o){var c=o.stream;if(c.isRemote()&&c.getClient()===this.client_){var a="".concat(c.getUserId(),"_").concat(c.getType());this.remoteStreamMap_.has(a)&&(this.remoteStreamMap_.get(a).isPlayingFired=!0)}}},{key:"getDataFreezeDuration",value:function(o){var c={dataFreeze:0,count:0},a=this.dataFreezeMap_.get(o);if(a){if(a.isFreezing()){var u=a.durationItemList[a.durationItemList.length-1];u.stop(),u.getDuration()<500&&a.durationItemList.pop()}c.dataFreeze=this.getTotalDuration(a.durationItemList),c.count=a.durationItemList.length}return c}},{key:"getRenderFreezeDuration",value:function(o){var c=this.renderFreezeMap_.get(o),a=0,u=0;if(c)if(c.isFreeze){var l=qt()-c.freezeTimeline[c.freezeTimeline.length-1].startTime;a=c.renderFreezeTotal+Math.min(l,5e3),u=c.freezeTimeline.length}else a=c.renderFreezeTotal;return{renderFreeze:a,count:u}}},{key:"getMonitorFreeze",value:function(){return this.monitorFreezeData_}},{key:"isBlackStream",value:function(o){return!!this.remoteStreamMap_.has(o)&&!this.remoteStreamMap_.get(o).isPlayingFired}},{key:"resetMonitor",value:function(){this.monitorFreezeData_.clear()}}]),e}(),Vp=P(function e(t){w(this,e),this.userId=t.userId,this.tinyId=t.tinyId,this.role=t.role===zo?"anchor":"audience"}),Xu=Ie(function(e){(function(t){function n(y,E){var C=(65535&y)+(65535&E);return(y>>16)+(E>>16)+(C>>16)<<16|65535&C}function i(y,E,C,x,U,G){return n((H=n(n(E,y),n(x,G)))<<(V=U)|H>>>32-V,C);var H,V}function o(y,E,C,x,U,G,H){return i(E&C|~E&x,y,E,U,G,H)}function c(y,E,C,x,U,G,H){return i(E&x|C&~x,y,E,U,G,H)}function a(y,E,C,x,U,G,H){return i(E^C^x,y,E,U,G,H)}function u(y,E,C,x,U,G,H){return i(C^(E|~x),y,E,U,G,H)}function l(y,E){var C,x,U,G,H;y[E>>5]|=128<<E%32,y[14+(E+64>>>9<<4)]=E;var V=1732584193,j=-271733879,q=-1732584194,K=271733878;for(C=0;C<y.length;C+=16)x=V,U=j,G=q,H=K,V=o(V,j,q,K,y[C],7,-680876936),K=o(K,V,j,q,y[C+1],12,-389564586),q=o(q,K,V,j,y[C+2],17,606105819),j=o(j,q,K,V,y[C+3],22,-1044525330),V=o(V,j,q,K,y[C+4],7,-176418897),K=o(K,V,j,q,y[C+5],12,1200080426),q=o(q,K,V,j,y[C+6],17,-1473231341),j=o(j,q,K,V,y[C+7],22,-45705983),V=o(V,j,q,K,y[C+8],7,1770035416),K=o(K,V,j,q,y[C+9],12,-1958414417),q=o(q,K,V,j,y[C+10],17,-42063),j=o(j,q,K,V,y[C+11],22,-1990404162),V=o(V,j,q,K,y[C+12],7,1804603682),K=o(K,V,j,q,y[C+13],12,-40341101),q=o(q,K,V,j,y[C+14],17,-1502002290),V=c(V,j=o(j,q,K,V,y[C+15],22,1236535329),q,K,y[C+1],5,-165796510),K=c(K,V,j,q,y[C+6],9,-1069501632),q=c(q,K,V,j,y[C+11],14,643717713),j=c(j,q,K,V,y[C],20,-373897302),V=c(V,j,q,K,y[C+5],5,-701558691),K=c(K,V,j,q,y[C+10],9,38016083),q=c(q,K,V,j,y[C+15],14,-660478335),j=c(j,q,K,V,y[C+4],20,-405537848),V=c(V,j,q,K,y[C+9],5,568446438),K=c(K,V,j,q,y[C+14],9,-1019803690),q=c(q,K,V,j,y[C+3],14,-187363961),j=c(j,q,K,V,y[C+8],20,1163531501),V=c(V,j,q,K,y[C+13],5,-1444681467),K=c(K,V,j,q,y[C+2],9,-51403784),q=c(q,K,V,j,y[C+7],14,1735328473),V=a(V,j=c(j,q,K,V,y[C+12],20,-1926607734),q,K,y[C+5],4,-378558),K=a(K,V,j,q,y[C+8],11,-2022574463),q=a(q,K,V,j,y[C+11],16,1839030562),j=a(j,q,K,V,y[C+14],23,-35309556),V=a(V,j,q,K,y[C+1],4,-1530992060),K=a(K,V,j,q,y[C+4],11,1272893353),q=a(q,K,V,j,y[C+7],16,-155497632),j=a(j,q,K,V,y[C+10],23,-1094730640),V=a(V,j,q,K,y[C+13],4,681279174),K=a(K,V,j,q,y[C],11,-358537222),q=a(q,K,V,j,y[C+3],16,-722521979),j=a(j,q,K,V,y[C+6],23,76029189),V=a(V,j,q,K,y[C+9],4,-640364487),K=a(K,V,j,q,y[C+12],11,-421815835),q=a(q,K,V,j,y[C+15],16,530742520),V=u(V,j=a(j,q,K,V,y[C+2],23,-995338651),q,K,y[C],6,-198630844),K=u(K,V,j,q,y[C+7],10,1126891415),q=u(q,K,V,j,y[C+14],15,-1416354905),j=u(j,q,K,V,y[C+5],21,-57434055),V=u(V,j,q,K,y[C+12],6,1700485571),K=u(K,V,j,q,y[C+3],10,-1894986606),q=u(q,K,V,j,y[C+10],15,-1051523),j=u(j,q,K,V,y[C+1],21,-2054922799),V=u(V,j,q,K,y[C+8],6,1873313359),K=u(K,V,j,q,y[C+15],10,-30611744),q=u(q,K,V,j,y[C+6],15,-1560198380),j=u(j,q,K,V,y[C+13],21,1309151649),V=u(V,j,q,K,y[C+4],6,-145523070),K=u(K,V,j,q,y[C+11],10,-1120210379),q=u(q,K,V,j,y[C+2],15,718787259),j=u(j,q,K,V,y[C+9],21,-343485551),V=n(V,x),j=n(j,U),q=n(q,G),K=n(K,H);return[V,j,q,K]}function h(y){var E,C="",x=32*y.length;for(E=0;E<x;E+=8)C+=String.fromCharCode(y[E>>5]>>>E%32&255);return C}function f(y){var E,C=[];for(C[(y.length>>2)-1]=void 0,E=0;E<C.length;E+=1)C[E]=0;var x=8*y.length;for(E=0;E<x;E+=8)C[E>>5]|=(255&y.charCodeAt(E/8))<<E%32;return C}function m(y){var E,C,x="";for(C=0;C<y.length;C+=1)E=y.charCodeAt(C),x+="0123456789abcdef".charAt(E>>>4&15)+"0123456789abcdef".charAt(15&E);return x}function g(y){return unescape(encodeURIComponent(y))}function v(y){return function(E){return h(l(f(E),8*E.length))}(g(y))}function I(y,E){return function(C,x){var U,G,H=f(C),V=[],j=[];for(V[15]=j[15]=void 0,H.length>16&&(H=l(H,8*C.length)),U=0;U<16;U+=1)V[U]=909522486^H[U],j[U]=1549556828^H[U];return G=l(V.concat(f(x)),512+8*x.length),h(l(j.concat(G),640))}(g(y),g(E))}function S(y,E,C){return E?C?I(E,y):m(I(E,y)):C?v(y):m(v(y))}e.exports?e.exports=S:t.md5=S})(ft)}),dL=function(){function e(c){w(this,e),this.client_=c.client,this.signalChannel_=c.signalChannel,this.log_=ye.createLogger({id:"mix|"+this.client_.getUserId(),userId:c.client.getUserId(),sdkAppId:c.client.getSDKAppId()}),this.isMixing_=!1,this.config_=null,this.data_=null,this.remoteStreamMap_=new Map,this.installEvents()}var t,n,i,o;return P(e,[{key:"isPresetLayoutMode",get:function(){return this.config_&&this.config_.mode===zh.PRESET_LAYOUT}},{key:"installEvents",value:function(){J.on(Dr,this.onStreamSubscribed,this),J.on(Or,this.onStreamUnsubscribed,this),this.client_.on("stream-removed",this.onStreamRemoved,this)}},{key:"uninstallEvents",value:function(){J.off(Dr,this.onStreamSubscribed,this),J.off(Or,this.onStreamUnsubscribed,this),this.client_.off("stream-removed",this.onStreamRemoved,this)}},{key:"reset",value:function(){this.uninstallEvents(),this.isMixing_=!1,this.config_=null}},{key:"onStreamSubscribed",value:function(c){var a=c.client,u=c.stream;a===this.client_&&(this.remoteStreamMap_.set(u.getId(),{remoteStream:u,isUsed:!1}),this.isMixing_&&this.hasAvailablePlaceHolder()&&this.startMixTranscode(this.config_))}},{key:"onStreamUnsubscribed",value:function(c){var a=c.client,u=c.stream;a===this.client_&&this.onStreamRemoved({stream:u})}},{key:"onStreamRemoved",value:function(c){var a=c.stream;if(this.remoteStreamMap_.has(a.getId())){var u=this.remoteStreamMap_.get(a.getId()).isUsed;this.remoteStreamMap_.delete(a.getId()),this.isMixing_&&this.isPresetLayoutMode&&u&&this.startMixTranscode(this.config_)}}},{key:"startMixTranscode",value:(o=b(regeneratorRuntime.mark(function c(a){var u,l,h;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(f.prev=0,this.resetIsUsedFlag(),this.config_=a,u=this.getInputParam(a,this.remoteStreamMap_),l=this.getOutputParam(a),h=this.getOutputSessionId({config:a,roomId:this.client_.getRoomId(),userId:this.client_.getUserId()}),!this.isMixing_||!this.data_||h===this.data_.outputSessionId){f.next=10;break}return this.log_.info("startMixTranscode() streamId changed, stop mixing before start"),f.next=10,this.doStopMixTranscode();case 10:return f.next=12,this.doStartMixTranscode({outputSessionId:h,inputParam:u,outputParam:l});case 12:f.next=18;break;case 14:throw f.prev=14,f.t0=f.catch(0),this.resetIsUsedFlag(),f.t0;case 18:case"end":return f.stop()}},c,this,[[0,14]])})),function(c){return o.apply(this,arguments)})},{key:"doStartMixTranscode",value:(i=b(regeneratorRuntime.mark(function c(a){var u,l,h,f,m,g,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return u=a.outputSessionId,l=a.inputParam,h=a.outputParam,f={roomId:String(this.client_.getRoomId()),mcuRequestTime:Date.now(),outputSessionId:u,inputParam:l,outputParam:h},this.data_=f,this.log_.info("startMixTranscode: ".concat(JSON.stringify(f))),this.isMixing_=!0,S.prev=5,S.next=8,this.signalChannel_.sendWaitForResponse({command:k2,data:f,timeout:5e3,responseCommand:kt.START_MIX_TRANSCODE_RES,commandDesc:"startMixTranscode"});case 8:if(m=S.sent,g=m.data,v=g.code,I=g.message,v===0){S.next=15;break}throw v===-102083&&(I="Please enable relayed-push in ".concat("https://console.cloud.tencent.com/trtc"," and try later, refer to ").concat(qh,"tutorial-26-advanced-publish-cdn-stream.html")),this.log_.error("startMixTranscode failed, errCode: ".concat(v," errMsg: ").concat(I)),this.isMixing_=!1,new Y({code:Q.START_MIX_TRANSCODE_FAILED,message:Z({key:Hx,data:{message:I},link:{className:"Client",fnName:"startMixTranscode"}})});case 15:S.next=21;break;case 17:throw S.prev=17,S.t0=S.catch(5),this.isMixing_=!1,S.t0;case 21:case"end":return S.stop()}},c,this,[[5,17]])})),function(c){return i.apply(this,arguments)})},{key:"reStartMixTranscode",value:function(){this.isMixing_&&this.startMixTranscode(this.config_)}},{key:"stopMixTranscode",value:(n=b(regeneratorRuntime.mark(function c(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.isMixing_){a.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:zx})});case 2:return a.next=4,this.doStopMixTranscode();case 4:this.resetIsUsedFlag();case 5:case"end":return a.stop()}},c,this)})),function(){return n.apply(this,arguments)})},{key:"doStopMixTranscode",value:(t=b(regeneratorRuntime.mark(function c(){var a,u,l,h,f;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return a={mcuRequestTime:Date.now(),outputSessionId:this.data_.outputSessionId,streamType:this.data_.outputParam.streamType},this.log_.info("stopMixTranscode: ".concat(JSON.stringify(a))),m.next=4,this.signalChannel_.sendWaitForResponse({command:I2,data:a,timeout:5e3,responseCommand:kt.STOP_MIX_TRANSCODE_RES,commandDesc:"stopMixTranscode"});case 4:if(u=m.sent,l=u.data,h=l.code,f=l.message,h!==0){m.next=10;break}this.isMixing_=!1,m.next=12;break;case 10:throw this.log_.error("stopMixTranscode failed, errCode: ".concat(h," errMsg: ").concat(f)),new Y({code:Q.STOP_MIX_TRANSCODE_FAILED,message:Z({key:$x,data:{message:f},link:{className:"Client",fnName:"stopMixTranscode"}})});case 12:case"end":return m.stop()}},c,this)})),function(){return t.apply(this,arguments)})},{key:"getOutputSessionId",value:function(c){var a=c.config,u=c.userId,l=c.roomId;return Jt(a.streamId)&&a.streamId.length>0?a.streamId:Xu("".concat(l,"_").concat(u,"_main"))}},{key:"getInputParam",value:function(c,a){var u=this,l=c.mixUsers.map(function(h){return{userId:h.userId,roomId:String(h.roomId||u.client_.getRoomId()),width:h.width||0,height:h.height||0,locationX:h.locationX||0,locationY:h.locationY||0,zOrder:h.zOrder,streamType:fe(h.streamType)||h.streamType!==Nt?0:1,inputType:h.pureAudio?o0.IT_PURE_AUDIO:o0.IT_AUDIO_VIDEO,renderMode:h.renderMode||0}});return c.mode===zh.PRESET_LAYOUT&&(l.forEach(function(h){if(h.userId===i0.REMOTE){var f=Ke(a.values()).find(function(m){return!m.isUsed});f&&(h.userId=f.remoteStream.getUserId(),h.streamType=f.remoteStream.getType()===Nt?1:0,f.isUsed=!0)}}),l=l.filter(function(h){return h.userId!==i0.REMOTE})),l}},{key:"getOutputParam",value:function(c){var a=c.streamId||"";return{streamId:a,streamType:a.length>0?1:0,width:fe(c.videoWidth)?640:c.videoWidth,height:fe(c.videoHeight)?480:c.videoHeight,videoBps:c.videoBitrate||0,fps:c.videoFramerate||15,gop:c.videoGOP||2,audioSampleRate:c.audioSampleRate||48e3,audioBps:c.audioBitrate||64,audioChannels:c.audioChannels||1,backgroundColor:c.backgroundColor||0,backgroundImg:c.backgroundImage||"",extraInfo:"",videoCodec:2,audioCodec:0}}},{key:"hasAvailablePlaceHolder",value:function(){return!!this.isPresetLayoutMode&&this.data_.inputParam.length!==this.config_.mixUsers.length}},{key:"resetIsUsedFlag",value:function(){this.remoteStreamMap_.forEach(function(c){return c.isUsed=!1})}}]),e}(),hL=function(){function e(a){w(this,e),this.client_=a.client,this.signalChannel_=a.signalChannel,this.isPublishingTencentCDN_=!1,this.publishTencentStreamRetryCount_=0,this.publishTencentStreamId_=void 0,this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1}var t,n,i,o,c;return P(e,[{key:"setSignalChannel",value:function(a){this.signalChannel_=a.signalChannel}},{key:"getIsPublishingTencentCDN",value:function(){return this.isPublishingTencentCDN_}},{key:"getIsPublishingGivenCDN",value:function(){return this.isPublishingGivenCDN_}},{key:"generatePublishCDNStreamId",value:function(a){if(!a){var u="".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main");return/^[A-Za-z\d_-]*$/.test(u)||(u=Xu(u)),"".concat(this.client_.getSDKAppId(),"_").concat(u)}return a}},{key:"startPublishTencentCDN",value:(c=b(regeneratorRuntime.mark(function a(u){var l,h;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.isPublishingTencentCDN_=!0,this.publishTencentStreamId_=u.streamId,this.client_.isJoined_){f.next=4;break}return f.abrupt("return");case 4:return l=this.generatePublishCDNStreamId(u.streamId),h={requestTime:Date.now(),sessionId:Xu("".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main")),streamId:l,streamType:0},this.publishTencentStreamRetryCount_=0,f.next=9,this.doStartPublishTencentCDN(h);case 9:case"end":return f.stop()}},a,this)})),function(a){return c.apply(this,arguments)})},{key:"doStartPublishTencentCDN",value:(o=b(regeneratorRuntime.mark(function a(u){var l,h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,ye.info("startPublishTencentCDN: "+JSON.stringify(u)),g.next=4,this.signalChannel_.sendWaitForResponseWithRetry({command:_2,data:u,timeout:2e3,responseCommand:kt.START_PUBLISH_TENCENT_CDN_RES,commandDesc:"startPublishCDNStream",retries:2});case 4:if(l=g.sent,h=l.data,f=h.code,m=h.message,f===0){g.next=12;break}throw this.publishTencentStreamId_=void 0,this.isPublishingTencentCDN_=!1,f===-102083&&(m="Please enable relayed-push in ".concat("https://console.cloud.tencent.com/trtc"," and try later, refer to ").concat(qh,"tutorial-26-advanced-publish-cdn-stream.html")),ye.error("startPublishTencentCDN failed, errCode: ".concat(f,", errMsg: ").concat(m)),new Y({code:Q.START_PUBLISH_CDN_FAILED,message:Z({key:f0,data:{message:m},link:{className:"Client",fnName:"startPublishCDNStream"}})});case 12:g.next=19;break;case 14:throw g.prev=14,g.t0=g.catch(0),this.publishTencentStreamId_=void 0,this.isPublishingTencentCDN_=!1,g.t0;case 19:case"end":return g.stop()}},a,this,[[0,14]])})),function(a){return o.apply(this,arguments)})},{key:"stopPublishTencentCDN",value:(i=b(regeneratorRuntime.mark(function a(){var u,l,h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u={requestTime:Date.now(),sessionId:Xu("".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main"))},ye.info("stopPublishTencentCDN: "+JSON.stringify(u)),g.next=4,this.signalChannel_.sendWaitForResponse({command:y2,data:u,timeout:5e3,responseCommand:kt.STOP_PUBLISH_TENCENT_CDN_RES,commandDesc:"stopPublishCDNStream"});case 4:if(l=g.sent,h=l.data,f=h.code,m=h.message,f!==0){g.next=11;break}this.publishTencentStreamId_=void 0,this.isPublishingTencentCDN_=!1,g.next=19;break;case 11:if(f!==-102069){g.next=17;break}ye.warn("stopPublishTencentCDN failed, can not stopPublishTencentCDN in auto relayed-push mode"),this.publishTencentStreamId_=void 0,this.isPublishingTencentCDN_=!1,g.next=19;break;case 17:throw ye.error("stopPublishTencentCDN failed, errCode: ".concat(f," errMsg: ").concat(m)),new Y({code:Q.STOP_PUBLISH_CDN_FAILED,message:Z({key:p0,data:{message:m},link:{className:"Client",fnName:"stopPublishCDNStream"}})});case 19:case"end":return g.stop()}},a,this)})),function(){return i.apply(this,arguments)})},{key:"startPublishGivenCDN",value:(n=b(regeneratorRuntime.mark(function a(u){var l,h,f,m,g;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(l={pushRequestTime:Date.now(),pushAppId:u.appId,pushBizId:u.bizId,pushCdnUrl:u.url,pushStreamType:Et,pushStreamId:this.publishTencentStreamId_},ye.info("startPublishGivenCDN: "+JSON.stringify(l)),this.publishGivenCDNData_=l,this.isPublishingGivenCDN_=!0,this.client_.isJoined_){v.next=6;break}return v.abrupt("return");case 6:return v.prev=6,v.next=9,this.signalChannel_.sendWaitForResponse({command:b2,data:l,timeout:5e3,responseCommand:kt.START_PUBLISH_GIVEN_CDN_RES,commandDesc:"startPublishCDNStream"});case 9:if(h=v.sent,f=h.data,m=f.code,g=f.message,m===0){v.next=16;break}throw ye.error("startPublishGivenCDN failed, errCode: ".concat(m,", errMsg: ").concat(g)),this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1,new Y({code:Q.START_PUBLISH_CDN_FAILED,message:Z({key:f0,data:{message:g},link:{className:"Client",fnName:"startPublishCDNStream"}})});case 16:v.next=23;break;case 18:throw v.prev=18,v.t0=v.catch(6),this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1,v.t0;case 23:case"end":return v.stop()}},a,this,[[6,18]])})),function(a){return n.apply(this,arguments)})},{key:"stopPublishGivenCDN",value:(t=b(regeneratorRuntime.mark(function a(){var u,l,h,f,m,g,v,I,S,y;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return u=this.publishGivenCDNData_,l=u.pushAppId,h=u.pushBizId,f=u.pushCdnUrl,m=u.pushStreamType,g={pushRequestTime:Date.now(),pushAppId:l,pushBizId:h,pushCdnUrl:f,pushStreamType:m},ye.info("stopPublishGivenCDN: "+JSON.stringify(g)),E.next=5,this.signalChannel_.sendWaitForResponse({command:S2,data:g,timeout:5e3,responseCommand:kt.STOP_PUBLISH_GIVEN_CDN_RES,commandDesc:"stopPublishCDNStream"});case 5:if(v=E.sent,I=v.data,S=I.code,y=I.message,S!==0){E.next=12;break}this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1,E.next=14;break;case 12:throw ye.error("stopPublishGivenCDN failed, errCode: ".concat(S," errMsg: ").concat(y)),new Y({code:Q.STOP_PUBLISH_CDN_FAILED,message:Z({key:p0,data:{message:y},link:{className:"Client",fnName:"stopPublishCDNStream"}})});case 14:case"end":return E.stop()}},a,this)})),function(){return t.apply(this,arguments)})},{key:"handleCDNConfigForJoinData",value:function(a){var u,l=a;if(this.isPublishingTencentCDN_){var h={};Jt(l)&&(h=JSON.parse(l)),h.Str_uc_params||(h.Str_uc_params={}),h.Str_uc_params.userdefine_streamid_main=this.generatePublishCDNStreamId(this.publishTencentStreamId_),l=JSON.stringify(h)}if(this.isPublishingGivenCDN_){var f=this.publishGivenCDNData_,m=f.pushAppId,g=f.pushBizId,v=f.pushCdnUrl,I=f.pushStreamType,S=f.pushStreamId;u={pushRequestTime:Date.now(),pushAppId:m,pushBizId:g,pushCdnUrl:v,pushStreamType:I,pushStreamId:S}}return{bussinessInfo:l,pushUserCdnInfo:u}}},{key:"reset",value:function(){this.isPublishingTencentCDN_=!1,this.publishTencentStreamRetryCount_=0,this.publishTencentStreamId_=void 0,this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1}}]),e}(),fL=function(){function e(t){w(this,e),this.client_=t.client,this.durationMap_=new Map,this.installEvents()}return P(e,[{key:"installEvents",value:function(){J.on(Dr,this.handleSubscribed,this),J.on(Vn,this.handleStreamTrackUpdated,this),J.on(Or,this.handleStreamStopped,this),J.on(Is,this.handleStreamStopped,this)}},{key:"uninstallEvents",value:function(){J.off(Dr,this.handleSubscribed,this),J.off(Vn,this.handleStreamTrackUpdated,this),J.off(Or,this.handleStreamStopped,this),J.off(Is,this.handleStreamStopped,this)}},{key:"handleSubscribed",value:function(t){var n=t.client,i=t.stream;if(n===this.client_){var o=i.getUserId(),c=i.getType(),a="".concat(o,"_").concat(c);if(i.hasAudio())if(i.isMainAudioSubscribed){var u=new Yu,l=this.durationMap_.get(a);l?this.isRecording(l.audio)||l.audio.push(u):this.durationMap_.set(a,{userId:o,type:c,audio:[u],video:[]})}else this.stopDurationItem(a,Pe);if(i.hasVideo())if(c===St&&i.isMainVideoSubscribed||c===Nt&&i.isAuxVideoSubscribed){var h=new Yu,f=this.durationMap_.get(a);f?this.isRecording(f.video)||f.video.push(h):this.durationMap_.set(a,{userId:o,type:c,audio:[],video:[h]})}else this.stopDurationItem(a,Ue)}}},{key:"handleStreamStopped",value:function(t){var n=t.client,i=t.stream;if(this.clientHitTest(n)){var o=i.getUserId(),c=i.getType(),a="".concat(o,"_").concat(c);this.stopDurationItem(a,Pe),this.stopDurationItem(a,Ue)}}},{key:"handleStreamTrackUpdated",value:function(t){var n=t.client,i=t.userId,o=t.tinyId,c=t.kind,a=t.action;if(this.clientHitTest(n)&&this.client_.getConnections().has(o)){var u=c===ur?c:St,l="".concat(i,"_").concat(u);if(a===li){var h=this.client_.getConnections().get(o).getSubscribeState();if(c===Pe&&!h.audio||c===Ue&&!h.video||c===ur&&!h.auxiliary)return;var f=new Yu,m=this.durationMap_.get(l);m?(c!==Pe||this.isRecording(m.audio)||m.audio.push(f),c===Pe||this.isRecording(m.video)||m.video.push(f)):this.durationMap_.set(l,{userId:i,type:u,audio:c===Pe?[f]:[],video:c===Pe?[]:[f]})}else this.stopDurationItem(l,c===Pe?Pe:Ue)}}},{key:"isRecording",value:function(t){return t.findIndex(function(n){return n.endTime===0})>=0}},{key:"stopDurationItem",value:function(t,n){if(this.durationMap_.has(t)){var i=this.durationMap_.get(t)[n].find(function(o){return o.endTime===0});i&&i.stop()}}},{key:"clientHitTest",value:function(t){return this.client_===t}},{key:"getDuration",value:function(t,n){return this.durationMap_.has(t)?this.durationMap_.get(t)[n].reduce(function(i,o){return i+o.getDuration()},0):0}},{key:"getDurationMap",value:function(){return this.durationMap_}},{key:"reset",value:function(){this.durationMap_.clear()}},{key:"destroy",value:function(){this.client_=null,this.uninstallEvents()}}]),e}(),pL=Pv.f,mL=he(function(){return!Object.getOwnPropertyNames(1)});Me({target:"Object",stat:!0,forced:mL},{getOwnPropertyNames:pL});var gL={msg_user_info:0,uint32_video_avg_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_avg_bitrate:0,uint32_video_block_time:0,uint32_video_play_time:0,uint32_audio_block_time:0,uint32_audio_play_time:0,uint32_audio_play_db:0,uint32_avg_down_loss:0,uint32_stream_type:0,uint32_video_render_first:0,uint32_video_block_count:0,uint32_audio_block_count:0,uint32_audio_bitrate:0,uint32_video_black_screen_subjective:0,uint32_audio_recv_bitrate:0,uint32_video_external_block_time:0},Fp=P(function e(t){w(this,e),this.str_identifier=String(t.userId),this.uint64_tinyid=Number(t.tinyId),this.uint32_role=t.role}),vL=function(){function e(o){var c=this;w(this,e),this.frameWorkType_=o.frameWorkType||30,this.client_=o.client,this.keyPrefix_="key_point",this.storageKey_="".concat(this.keyPrefix_,"_").concat(this.client_.getUserId()),this.log_=ye.createLogger({id:"kpm|"+this.client_.getUserId(),userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId()}),this.upload=Xo({retryFunction:this.upload,settings:{timeout:500,retries:3},onError:function(a,u){return u()}}),Object.getOwnPropertyNames(this.__proto__).forEach(function(a){a.startsWith("handle")&&hr(c[a])&&(c[a]=function(u){var l=u.fn,h=u.context;return b(regeneratorRuntime.mark(function f(){var m,g,v,I=arguments;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:for(S.prev=0,m=I.length,g=new Array(m),v=0;v<m;v++)g[v]=I[v];return S.next=4,l.apply(h||this,g);case 4:return S.abrupt("return",S.sent);case 7:S.prev=7,S.t0=S.catch(0),ye.error("".concat(l.name,"() error observed ")+S.t0);case 10:case"end":return S.stop()}},f,this,[[0,7]])}))}({fn:c[a],context:c}))}),this.initData(),this.installEvents(),this.intervalId_=zt.setInterval(this.setStorage.bind(this),2e4)}var t,n,i;return P(e,[{key:"initData",value:function(){this.firstPublishedUserList_=[],this.networkQuality_={totalUplinkRTT:0,totalUplinkLoss:0,count:0,totalDownlinkRTTAndLossMap:new Map},this.basicInfo={string_sdk_version:"4.14.1",uint32_os_type:15,string_device_name:"",string_http_user_agent:navigator.userAgent,string_os_version:"",uint32_avg_rtt:0,uint32_avg_up_loss:0,uint32_scene:this.client_.getMode()==="live"?1:0,uint32_joining_duration:0,uint32_networkType:Wh[Xh()],uint32_framework:this.frameWorkType_},this.pathJoinRoom_={uint64_start_time:0,uint64_init_audio_start_time:0,uint64_init_audio_end_time:0,uint64_init_camera_start_time:0,uint64_init_camera_end_time:0,uint64_send_request_acc_ip_cmd_start_time:0,uint64_send_request_acc_ip_cmd_end_time:0,uint64_send_request_enter_room_cmd_start_time:0,uint64_send_request_enter_room_cmd_end_time:0,uint64_send_first_video_frame_time:0,uint64_recv_userlist_time:0,uint64_end_time:0,int32_init_audio_ret:0,int32_init_camera_ret:0,int32_send_request_acc_ip_cmd_ret:0,int32_send_request_enter_room_cmd_ret:0,int32_end_ret:0},this.pathLeaveRoom_={uint64_start_time:0,uint64_send_request_exit_room_cmd_start_time:0,uint64_send_request_exit_room_cmd_end_time:0,uint64_end_time:0,int32_send_request_exit_room_cmd_ret:0,int32_end_ret:0},this.pathMainVideoMap_=new Map,this.pathMainAudioMap_=new Map,this.pathAuxiliaryMap_=new Map,this.localStreamStats_={totalVideoBitrate:0,totalVideoFPS:0,totalVideoHeight:0,totalVideoWidth:0,totalAudioLevel:0,videoCount:0,audioLevelCount:0,publishStartTime:0,statsToReport:{uint32_audio_capture_db:0,uint32_video_big_capture_fps:0,uint32_video_big_bitrate:0,uint32_video_big_resolution:0}},this.remoteStreamStatsMap_=new Map}},{key:"installEvents",value:function(){J.on(Su,this.handleJoinStart,this),J.on(_f,this.handleWSStart,this),J.on(Iu,this.handleWSEnd,this),J.on(df,this.handleJoinSendCMD,this),J.on(hf,this.handleJoinReceivedCMDResponce,this),J.on(Qo,this.handleJoinSuccess,this),J.on(Yo,this.handleJoinFailed,this),J.on(gf,this.handleReceivedPublishUserList,this),J.on(Nf,this.handleConnectionStateChanged,this),J.on(ff,this.handleLeaveStart,this),J.on(ku,this.handleLeaveSuccess,this),J.on(pf,this.handleLeaveSendCMD,this),J.on(Lf,this.handleSendSubscribeCMD,this),J.on(ks,this.handleVideoPlaying,this),J.on(Sf,this.handleAudioPlaying,this),J.on(Mf,this.handleNetworkQuality,this),J.on(mf,this.handleHeartbeatStats,this),J.on(Tu,this.handleRemoteStreamAdded,this),J.on(kf,this.handleRemoteStreamSubscribeStart,this),J.on(Dr,this.handleRemoteStreamSubscribed,this),J.on(Af,this.handleVideoLoadedData,this),J.on(Rf,this.handlePlayStream,this),J.on(vf,this.handlePublishStart,this),J.on(Tf,this.handleLocalStreamInitStart,this),J.on(wf,this.handleLocalStreamInitEnd,this),J.on(Ef,this.handleLocalStreamInitFailed,this)}},{key:"uninstallEvents",value:function(){J.off(Su,this.handleJoinStart,this),J.off(_f,this.handleWSStart,this),J.off(Iu,this.handleWSEnd,this),J.off(df,this.handleJoinSendCMD,this),J.off(hf,this.handleJoinReceivedCMDResponce,this),J.off(gf,this.handleReceivedPublishUserList,this),J.off(Nf,this.handleConnectionStateChanged,this),J.off(ff,this.handleLeaveStart,this),J.off(ku,this.handleLeaveSuccess,this),J.off(Qo,this.handleJoinSuccess,this),J.off(Yo,this.handleJoinFailed,this),J.off(pf,this.handleLeaveSendCMD,this),J.off(Lf,this.handleSendSubscribeCMD,this),J.off(ks,this.handleVideoPlaying,this),J.off(Sf,this.handleAudioPlaying,this),J.off(Mf,this.handleNetworkQuality,this),J.off(mf,this.handleHeartbeatStats,this),J.off(Tu,this.handleRemoteStreamAdded,this),J.off(kf,this.handleRemoteStreamSubscribeStart,this),J.off(Dr,this.handleRemoteStreamSubscribed,this),J.off(Af,this.handleVideoLoadedData,this),J.off(Rf,this.handlePlayStream,this),J.off(vf,this.handlePublishStart,this),J.off(Tf,this.handleLocalStreamInitStart,this),J.off(wf,this.handleLocalStreamInitEnd,this),J.off(Ef,this.handleLocalStreamInitFailed,this)}},{key:"destroy",value:function(){this.uninstallEvents(),zt.clearInterval(this.intervalId_),this.client_=null}},{key:"handleJoinStart",value:function(o){this.hitTest(o.client)&&this.pathJoinRoom_.uint64_start_time===0&&(this.pathJoinRoom_.uint64_start_time=Date.now(),this.checkStorage())}},{key:"handleWSStart",value:function(o){var c=o.client;this.hitTest(c)&&this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_start_time===0&&(this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_start_time=Date.now())}},{key:"handleWSEnd",value:function(o){var c=o.client,a=o.error;this.hitTest(c)&&this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_end_time===0&&(this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_end_time=Date.now(),a&&(this.pathJoinRoom_.int32_send_request_acc_ip_cmd_ret=a instanceof Y?Number(a.getExtraCode()||a.getCode()):Q.UNKNOWN,this.pathJoinRoom_.int32_end_ret=2))}},{key:"handleJoinSendCMD",value:function(o){this.hitTest(o.client)&&this.pathJoinRoom_.uint64_send_request_enter_room_cmd_start_time===0&&(this.pathJoinRoom_.uint64_send_request_enter_room_cmd_start_time=Date.now())}},{key:"handleJoinReceivedCMDResponce",value:function(o){this.hitTest(o.client)&&this.pathJoinRoom_.uint64_send_request_enter_room_cmd_end_time===0&&(this.pathJoinRoom_.uint64_send_request_enter_room_cmd_end_time=Date.now(),this.pathJoinRoom_.int32_send_request_enter_room_cmd_ret=o.code,o.code!==0&&(this.pathJoinRoom_.int32_end_ret=3))}},{key:"handleJoinSuccess",value:function(o){this.hitTest(o.client)&&this.pathJoinRoom_.uint64_end_time===0&&(this.pathJoinRoom_.uint64_end_time=Date.now(),this.pathJoinRoom_.int32_end_ret=0)}},{key:"handleJoinFailed",value:function(o){var c=o.client;this.hitTest(c)&&(this.pathJoinRoom_.uint64_end_time=Date.now(),this.pathJoinRoom_.int32_end_ret===0&&(this.pathJoinRoom_.int32_end_ret=3),this.prepareReport(),this.report())}},{key:"handleReceivedPublishUserList",value:function(o){this.hitTest(o.client)&&this.pathJoinRoom_.uint64_recv_userlist_time===0&&(this.pathJoinRoom_.uint64_recv_userlist_time=Date.now(),this.firstPublishedUserList_=o.data.data&&o.data.data.userList||[])}},{key:"handleConnectionStateChanged",value:function(o){var c=o.client,a=o.state,u=o.connection;if(this.hitTest(c)&&a===mn){this.client_.getUplinkConnection()===u&&this.pathJoinRoom_.uint64_send_first_video_frame_time===0&&this.localStreamStats_.publishStartTime>this.pathJoinRoom_.uint64_end_time&&this.localStreamStats_.publishStartTime-this.pathJoinRoom_.uint64_end_time<=100&&(this.pathJoinRoom_.uint64_send_first_video_frame_time=Date.now());var l=this.pathMainVideoMap_.get("".concat(u.getUserId(),"_").concat(St));l&&l.statsToReport.uint64_pc_connected_time===0&&(l.statsToReport.uint64_pc_connected_time=Date.now())}}},{key:"handleLeaveStart",value:function(o){this.hitTest(o.client)&&(this.pathLeaveRoom_.uint64_start_time=Date.now())}},{key:"handleLeaveSuccess",value:function(o){this.hitTest(o.client)&&this.pathLeaveRoom_.uint64_end_time===0&&(this.pathLeaveRoom_.uint64_end_time=Date.now(),this.pathJoinRoom_.uint64_end_time!==0?this.basicInfo.uint32_joining_duration=this.pathLeaveRoom_.uint64_end_time-this.pathJoinRoom_.uint64_end_time:this.log_.warn("pathJoinRoom endTime is 0"),this.report())}},{key:"handleLeaveSendCMD",value:function(o){this.hitTest(o.client)&&(this.pathLeaveRoom_.uint64_send_request_exit_room_cmd_start_time=Date.now(),this.pathLeaveRoom_.uint64_send_request_exit_room_cmd_end_time=Date.now())}},{key:"handleRemoteStreamAdded",value:function(o){var c=o.client,a=o.stream;if(this.hitTest(c)){var u=a.getUserId(),l=a.getType(),h="".concat(u,"_").concat(l),f=this.remoteStreamStatsMap_.get(h);if(f)f.stream=a;else{var m={userId:u,totalVideoFPS:0,totalVideoBitrate:0,totalAudioLevel:0,totalAudioBitrate:0,totalLoss:0,audioCount:0,audioLevelCount:0,videoCount:0,networkQualityCount:0,streamAddedTime:Date.now(),subscribeStartTime:0,subscribedTime:0,playStreamTime:0,statsToReport:p({},gL),stream:a};m.statsToReport.msg_user_info=new Fp({userId:u,tinyId:a.getTinyId(),role:zo}),m.statsToReport.uint32_stream_type=l===St?2:7,this.remoteStreamStatsMap_.set(h,m)}}}},{key:"handleRemoteStreamSubscribeStart",value:function(o){var c=o.client,a=o.stream;if(this.hitTest(c)){var u=a.getUserId(),l=a.getType(),h="".concat(u,"_").concat(l),f=this.remoteStreamStatsMap_.get(h);f&&f.subscribeStartTime===0&&(f.subscribeStartTime=Date.now())}}},{key:"handleSendSubscribeCMD",value:function(o){if(this.hitTest(o.client)){var c=new Fp(o),a=Date.now(),u="".concat(o.userId,"_").concat(St);o.trackState.video&&o.subscribeState.video&&!this.pathMainVideoMap_.has(u)&&this.pathMainVideoMap_.set(u,{statsToReport:{msg_user_info:c,uint64_start_enter_time:this.pathJoinRoom_.uint64_start_time,uint64_render_first_frame_time:0,uint64_combine_first_frame_time:0,uint64_pc_connected_time:0},userId:o.userId,sendSubscribeCMDTime:a}),o.trackState.audio&&o.subscribeState.audio&&!this.pathMainAudioMap_.has(u)&&this.pathMainAudioMap_.set(u,{statsToReport:{msg_user_info:c,uint64_start_enter_time:this.pathJoinRoom_.uint64_start_time,uint64_play_first_frame_time:0},userId:o.userId,sendSubscribeCMDTime:a});var l="".concat(o.userId,"_").concat(Nt);o.trackState.auxiliary&&o.subscribeState.auxiliary&&!this.pathAuxiliaryMap_.has(l)&&this.pathAuxiliaryMap_.set(l,{sendSubscribeCMDTime:a})}}},{key:"handleRemoteStreamSubscribed",value:function(o){var c=o.client,a=o.stream;if(this.hitTest(c)){var u=a.getUserId(),l=a.getType(),h="".concat(u,"_").concat(l),f=this.remoteStreamStatsMap_.get(h);f&&f.subscribedTime===0&&(f.subscribedTime=Date.now(),f.stream=a)}}},{key:"handlePlayStream",value:function(o){var c=o.stream;if(c.isRemote()&&c.getConnection()&&this.hitTest(c.getConnection().getClient())){var a=c.getConnection().getUserId(),u="".concat(a,"_").concat(c.getType());if(this.remoteStreamStatsMap_.has(u)){var l=this.remoteStreamStatsMap_.get(u);l.playStreamTime===0&&(l.playStreamTime=Date.now())}}}},{key:"handleVideoLoadedData",value:function(o){var c=o.stream;if(c.isRemote()&&c.getConnection()&&this.hitTest(c.getConnection().getClient())){var a=c.getConnection().getUserId(),u="".concat(a,"_").concat(c.getType());if(this.pathMainVideoMap_.has(u)){var l=this.pathMainVideoMap_.get(u);l.statsToReport.uint64_combine_first_frame_time===0&&(l.statsToReport.uint64_combine_first_frame_time=Date.now())}}}},{key:"handleVideoPlaying",value:function(o){var c=o.stream;if(c.isRemote()&&c.getConnection()&&this.hitTest(c.getConnection().getClient())){var a=c.getConnection().getUserId(),u="".concat(a,"_").concat(c.getType()),l=Date.now();if(this.pathMainVideoMap_.has(u)){var h=this.pathMainVideoMap_.get(u);if(h.statsToReport.uint64_render_first_frame_time===0&&(h.statsToReport.uint64_render_first_frame_time=l),this.remoteStreamStatsMap_.has(u)){var f=this.remoteStreamStatsMap_.get(u),m=f.statsToReport,g=f.playStreamTime,v=f.subscribedTime;m.uint32_video_render_first===0&&g-v<=100&&(m.uint32_video_render_first=l-h.sendSubscribeCMDTime)}}if(c.getType()===Nt&&this.pathAuxiliaryMap_.has(u)&&this.remoteStreamStatsMap_.has(u)){var I=this.remoteStreamStatsMap_.get(u),S=I.statsToReport,y=I.playStreamTime,E=I.subscribedTime;S.uint32_video_render_first===0&&y-E<=100&&(S.uint32_video_render_first=l-this.pathAuxiliaryMap_.get(u).sendSubscribeCMDTime)}}}},{key:"handleAudioPlaying",value:function(o){if(o.stream.isRemote()&&o.stream.getConnection()&&this.hitTest(o.stream.getConnection().getClient())){var c=o.stream.getConnection().getUserId(),a="".concat(c,"_").concat(o.stream.getType());if(this.pathMainAudioMap_.has(a)){var u=this.pathMainAudioMap_.get(a);u.statsToReport.uint64_play_first_frame_time===0&&(u.statsToReport.uint64_play_first_frame_time=Date.now())}}}},{key:"handleNetworkQuality",value:function(o){var c=this;this.hitTest(o.client)&&(this.networkQuality_.totalUplinkLoss+=o.uplinkLoss,this.networkQuality_.totalUplinkRTT+=o.uplinkRTT,this.networkQuality_.count++,o.downlinkLossAndRTTMap.forEach(function(a){var u=a.rtt,l=a.loss,h=a.userId,f=c.networkQuality_.totalDownlinkRTTAndLossMap.get(h);f?(f.totalRTT+=u,f.totalLoss+=l,f.count++):c.networkQuality_.totalDownlinkRTTAndLossMap.set(h,{totalRTT:u,totalLoss:l,count:1})}))}},{key:"handleHeartbeatStats",value:function(o){var c=this;if(this.hitTest(o.client)){var a=o.stats,u=a.msg_up_stream_info,l=a.msg_down_stream_info;if(u.msg_video_status[0]){var h=u.msg_video_status[0],f=h.uint32_video_codec_bitrate,m=h.uint32_video_enc_fps,g=h.uint32_video_width,v=h.uint32_video_height;this.localStreamStats_.totalVideoBitrate+=f,this.localStreamStats_.totalVideoFPS+=m,this.localStreamStats_.totalVideoWidth+=g,this.localStreamStats_.totalVideoHeight+=v,this.localStreamStats_.videoCount++}var I=u.msg_audio_status.audioLevel;Math.floor(100*I)>0&&(this.localStreamStats_.totalAudioLevel+=I,this.localStreamStats_.audioLevelCount++),l.forEach(function(S){var y=S.msg_user_info,E=S.msg_audio_status,C=S.msg_video_status,x=y.str_identifier;if(C.forEach(function(H){var V=H.uint32_video_stream_type===2,j=H.uint32_video_stream_type===7,q="".concat(x,"_").concat(V?St:Nt);if(c.remoteStreamStatsMap_.has(q)){var K=c.remoteStreamStatsMap_.get(q);(V&&K.stream.isMainVideoSubscribed||j&&K.stream.isAuxVideoSubscribed)&&(K.totalVideoFPS+=H.uint32_video_receive_fps,K.totalVideoBitrate+=H.uint32_video_codec_bitrate,K.videoCount++,K.statsToReport.uint32_video_width===0&&(K.statsToReport.uint32_video_width=H.uint32_video_width),K.statsToReport.uint32_video_height===0&&(K.statsToReport.uint32_video_height=H.uint32_video_height))}}),E){var U="".concat(x,"_").concat(St);if(c.remoteStreamStatsMap_.has(U)){var G=c.remoteStreamStatsMap_.get(U);G.stream.isMainAudioSubscribed&&(G.totalAudioBitrate+=E.uint32_audio_codec_bitrate,G.audioCount++,Math.floor(100*E.audioLevel)>0&&(G.totalAudioLevel+=E.audioLevel,G.audioLevelCount++))}}})}}},{key:"handlePublishStart",value:function(o){var c=o.client;this.hitTest(c)&&this.localStreamStats_.publishStartTime===0&&(this.localStreamStats_.publishStartTime=Date.now())}},{key:"handleLocalStreamInitStart",value:function(o){var c=o.audio,a=o.video;c&&this.pathJoinRoom_.uint64_init_audio_start_time===0&&(this.pathJoinRoom_.uint64_init_audio_start_time=Date.now()),a&&this.pathJoinRoom_.uint64_init_camera_start_time===0&&(this.pathJoinRoom_.uint64_init_camera_start_time=Date.now())}},{key:"handleLocalStreamInitEnd",value:function(o){var c=o.audio,a=o.video;c&&this.pathJoinRoom_.uint64_init_audio_end_time===0&&(this.pathJoinRoom_.uint64_init_audio_end_time=Date.now()),a&&this.pathJoinRoom_.uint64_init_camera_end_time===0&&(this.pathJoinRoom_.uint64_init_camera_end_time=Date.now())}},{key:"handleLocalStreamInitFailed",value:function(o){var c=o.audio,a=o.video,u=o.error,l=u instanceof Y?u.getExtraCode()||u.getCode():{NotFoundError:1,NotAllowedError:2,NotReadableError:3,OverConstrainedError:4,AbortError:5}[u.name]||Q.UNKNOWN;c&&this.pathJoinRoom_.uint64_init_audio_end_time===0&&(this.pathJoinRoom_.int32_init_audio_ret=l,this.pathJoinRoom_.uint64_init_audio_end_time=Date.now()),a&&this.pathJoinRoom_.uint64_init_camera_end_time===0&&(this.pathJoinRoom_.int32_init_camera_ret=l,this.pathJoinRoom_.uint64_init_camera_end_time=Date.now())}},{key:"hasVideoFlag",value:function(o){return this.firstPublishedUserList_.findIndex(function(c){return c.userId===o&&1&c.flag})>=0}},{key:"hasAudioFlag",value:function(o){return this.firstPublishedUserList_.findIndex(function(c){return c.userId===o&&8&c.flag})>=0}},{key:"hasAuxFlag",value:function(o){return this.firstPublishedUserList_.findIndex(function(c){return c.userId===o&&4&c.flag})>=0}},{key:"hitTest",value:function(o){return o===this.client_}},{key:"checkStorage",value:(i=b(regeneratorRuntime.mark(function o(){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!(c=na.getItem(this.storageKey_))){a.next=6;break}return a.next=5,this.upload(c);case 5:na.deleteItem(this.storageKey_);case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),this.log_.warn(a.t0);case 11:case"end":return a.stop()}},o,this,[[0,8]])})),function(){return i.apply(this,arguments)})},{key:"setStorage",value:function(){this.prepareReport();var o=this.getReportData();o.msg_path_enter_room.uint64_start_time!==0&&na.setItem(this.storageKey_,o)}},{key:"prepareReport",value:function(){var o=this;if(this.networkQuality_.count>0&&(this.basicInfo.uint32_avg_rtt=Math.floor(this.networkQuality_.totalUplinkRTT/this.networkQuality_.count),this.basicInfo.uint32_avg_up_loss=Math.floor(this.networkQuality_.totalUplinkLoss/this.networkQuality_.count)),this.localStreamStats_.videoCount>0){this.localStreamStats_.statsToReport.uint32_video_big_capture_fps=Math.floor(this.localStreamStats_.totalVideoFPS/this.localStreamStats_.videoCount),this.localStreamStats_.statsToReport.uint32_video_big_bitrate=Math.floor(this.localStreamStats_.totalVideoBitrate/this.localStreamStats_.videoCount);var c=Math.floor(this.localStreamStats_.totalVideoWidth/this.localStreamStats_.videoCount),a=Math.floor(this.localStreamStats_.totalVideoHeight/this.localStreamStats_.videoCount);this.localStreamStats_.statsToReport.uint32_video_big_resolution=c<<16|a}this.localStreamStats_.audioLevelCount>0&&(this.localStreamStats_.statsToReport.uint32_audio_capture_db=Math.floor(this.localStreamStats_.totalAudioLevel/this.localStreamStats_.audioLevelCount*100)),this.remoteStreamStatsMap_.forEach(function(u,l){var h=u.userId;if(o.networkQuality_.totalDownlinkRTTAndLossMap.has(h)){var f=o.networkQuality_.totalDownlinkRTTAndLossMap.get(h),m=f.totalLoss,g=f.count;u.statsToReport.uint32_avg_down_loss=Math.floor(m/g)}u.videoCount>0&&(u.statsToReport.uint32_video_avg_fps=Math.floor(u.totalVideoFPS/u.videoCount),u.statsToReport.uint32_video_avg_bitrate=Math.floor(u.totalVideoBitrate/u.videoCount)),u.audioCount>0&&(u.statsToReport.uint32_audio_recv_bitrate=u.statsToReport.uint32_audio_bitrate=Math.floor(u.totalAudioBitrate/u.audioCount)),u.audioLevelCount>0&&(u.statsToReport.uint32_audio_play_db=Math.floor(u.totalAudioLevel/u.audioLevelCount*100));var v=o.client_.getCallDurationCalculator();v&&(u.statsToReport.uint32_audio_play_time=v.getDuration(l,Pe),u.statsToReport.uint32_video_play_time=v.getDuration(l,Ue)),u.statsToReport.uint32_video_render_first=Math.min(u.statsToReport.uint32_video_render_first,5e3);var I=o.client_.getBadCaseDetector();if(I){var S=I.getDataFreezeDuration(l),y=S.dataFreeze,E=S.count,C=I.getRenderFreezeDuration(l).renderFreeze;u.statsToReport.uint32_video_block_count=E,u.statsToReport.uint32_video_block_time=Math.min(y,u.statsToReport.uint32_video_play_time),u.statsToReport.uint32_video_external_block_time=Math.min(C,u.statsToReport.uint32_video_play_time),I.isBlackStream(l)&&u.statsToReport.uint32_video_avg_fps===0?u.statsToReport.uint32_video_black_screen_subjective=1:u.statsToReport.uint32_video_black_screen_subjective=0}(u.subscribeStartTime===0||u.subscribeStartTime-u.streamAddedTime>100||u.playStreamTime===0)&&(o.pathMainAudioMap_.delete(l),o.pathMainVideoMap_.delete(l),u.statsToReport.uint32_video_render_first=0)}),this.pathMainAudioMap_.forEach(function(u,l){o.hasAudioFlag(u.userId)?u.statsToReport.uint64_play_first_frame_time-u.statsToReport.uint64_start_enter_time>5e3&&(u.statsToReport.uint64_play_first_frame_time=u.statsToReport.uint64_start_enter_time+5e3):o.pathMainAudioMap_.delete(l)}),this.pathMainVideoMap_.forEach(function(u,l){o.hasVideoFlag(u.userId)?u.statsToReport.uint64_render_first_frame_time-u.statsToReport.uint64_start_enter_time>5e3&&(u.statsToReport.uint64_render_first_frame_time=u.statsToReport.uint64_start_enter_time+5e3):o.pathMainVideoMap_.delete(l)}),this.pathJoinRoom_.uint64_end_time-this.pathJoinRoom_.uint64_start_time>5e3&&(this.pathJoinRoom_.uint64_end_time=this.pathJoinRoom_.uint64_start_time+5e3)}},{key:"getReportData",value:function(){var o=this.client_.getSignalInfo();return{uint32_sdk_app_id:Number(this.client_.getSDKAppId()),msg_user_info:new Fp({userId:this.client_.getUserId(),tinyId:this.client_.getTinyId(),role:this.client_.getRole()==="anchor"?zo:Fh}),msg_basic_info:this.basicInfo,uint32_acc_ip:ef(o.relayIp),uint32_client_ip:ef(o.clientIp,"small"),uint32_acc_port:0,uint64_timestamp:Date.now(),uint32_seq:Math.floor(Math.random()*Math.pow(2,31)),msg_path_enter_room:this.pathJoinRoom_,msg_path_exit_room:this.pathLeaveRoom_,msg_path_recv_video:Ke(this.pathMainVideoMap_.values()).map(function(c){return c.statsToReport}),msg_quality_statistics:Ke(this.remoteStreamStatsMap_.values()).map(function(c){return c.statsToReport}),str_room_name:String(this.client_.getRoomId()),msg_path_recv_audio:Ke(this.pathMainAudioMap_.values()).map(function(c){return c.statsToReport}),uint32_info_client_ip:ef(o.clientIp,"small"),error_code:[],msg_local_statistics:this.localStreamStats_.statsToReport}}},{key:"report",value:(n=b(regeneratorRuntime.mark(function o(){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=this.getReportData(),a.next=4,this.upload(c);case 4:na.deleteItem(this.storageKey_),this.initData(),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),this.log_.warn(a.t0);case 11:case"end":return a.stop()}},o,this,[[0,8]])})),function(){return n.apply(this,arguments)})},{key:"upload",value:(t=b(regeneratorRuntime.mark(function o(c){var a,u,l;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(Ho||c.msg_path_enter_room.uint64_start_time===0||[s0,AA,xA].findIndex(function(f){return f===location.host})>=0)){h.next=2;break}return h.abrupt("return");case 2:return a=Number(this.client_.getSDKAppId()),u=hu(a,cA),h.next=6,bu.post(u,JSON.stringify(c));case 6:if((l=h.sent).data==="ok"){h.next=9;break}throw"key point upload failed: ".concat(l.data);case 9:case"end":return h.stop()}},o,this)})),function(o){return t.apply(this,arguments)})}]),e}();function Fs(){return function(e,t,n){var i=n.value,o=new Set;return n.value=b(regeneratorRuntime.mark(function c(){var a,u,l,h,f=arguments;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!o.has(this)){m.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:NA,data:{name:t}})});case 2:for(m.prev=2,o.add(this),a=f.length,u=new Array(a),l=0;l<a;l++)u[l]=f[l];return m.next=7,i.apply(this,u);case 7:return h=m.sent,o.delete(this),m.abrupt("return",h);case 12:throw m.prev=12,m.t0=m.catch(2),o.delete(this),m.t0;case 16:case"end":return m.stop()}},c,this,[[2,12]])})),n}}function _L(e){return h1.apply(this,arguments)}function h1(){return(h1=b(regeneratorRuntime.mark(function e(t){var n,i,o,c,a,u,l,h,f,m,g,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return n=t.userId,i=t.sdkAppId,o=t.useStringRoomId,c=t.roomId,a=t.userSig,u={delta:0,count:[1,1],msg:[]},S.prev=2,(l=new FormData).append("userId",String(n)),l.append("sdkAppId",String(i)),l.append("isStrGroupId",o),l.append("groupId",String(c)),l.append("sdkVersion","4.14.1"),l.append("userSig",String(a)),h=qt(),S.next=13,bL(l,u,i);case 13:return f=S.sent,u.delta=qt()-h,f1({stat:u,userId:n}),S.abrupt("return",f);case 19:throw S.prev=19,S.t0=S.catch(2),m=E0(S.t0)?S.t0[0]:S.t0,g=xr(m.code)?m.code:0,v="get websocket url failed: ".concat(m.message.includes("timeout")?"timeout":m.message),I=new Y({code:Q.SCHEDULE_FAILED,extraCode:g,message:Z({key:h0,data:{error:v,code:g}})}),ye.error(I),f1({stat:u,userId:n,roomId:c,error:I}),I;case 28:case"end":return S.stop()}},e,null,[[2,19]])}))).apply(this,arguments)}function f1(e){var t=e.stat,n=e.userId,i=e.error;i?Se.logFailedEvent({eventType:n0,error:i,userId:n}):Se.logSuccessEvent({eventType:n0,delta:t.delta,userId:n}),Se.uploadEvent({log:"stat-schedule:"+JSON.stringify(t),userId:n})}function p1(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Et;return t=T0(e)?n===Et?TA:wA:n===Et?kA:IA,"https://".concat(t,"/api/v1/config")}function yL(e,t,n){return new Promise(function(i,o){bu.post(e,t,n).then(function(c){c.data.code===0?i(c.data.data):o({code:c.data.code,message:c.data.msg})}).catch(o)})}var m1=function(e,t){return Xo({retryFunction:yL,settings:{retries:3,timeout:0},onError:t,onRetrying:e})};function bL(e,t,n){return new Promise(function(i,o){var c,a=null;(c=[m1(function(u){return t.count[0]=u+1},function(u,l){t.msg[0]=u.message,a||l()})(p1(n,Et),e,{get timeout(){return 1e3*fu(2+t.count[0])}}),m1(function(u){return t.count[1]=u+1},function(u,l){t.msg[1]=u.message,a||l()})(p1(n,zi),e,{get timeout(){return 1e3*fu(2+t.count[1])}})],new Promise(function(u,l){var h=[];c.forEach(function(f){f.then(u).catch(function(m){h.push(m),h.length===c.length&&l(h)})})})).then(function(u){i(a=u)}).catch(o)})}var g1,v1,_1,y1,b1,S1,k1,I1,T1,w1,E1,C1,R1,A1,x1,ct,SL=new(function(){function e(){w(this,e)}return P(e,[{key:"call",value:function(t,n){return hr(this[t])?this[t](n):Promise.reject(new Y({code:Q.INVALID_PARAMETER,message:Z({key:lP,data:{name:t}})}))}},{key:"updatePrivateMapKey",value:function(t){var n=t.privateMapKey;return t.client.setProperty("privateMapKey",n),Promise.resolve()}}]),e}()),jp,Zu,el,Bp,kL=(g1=Fs(),v1=gr(bn.CLIENT.join),_1=Fs(),y1=Fs(),b1=gr(bn.CLIENT.publish),S1=Fs(),k1=gr(bn.CLIENT.unpublish),I1=gr.apply(void 0,Ke(bn.CLIENT.subscribe)),T1=gr(bn.CLIENT.unsubscribe),w1=Fs(),E1=gr(bn.CLIENT.switchRole),C1=gr(bn.CLIENT.startPublishCDNStream),R1=gr(bn.CLIENT.startMixTranscode),A1=Qu.apply(void 0,Ke(bn.CLIENT.sendSEIMessage)),Zu=(jp={timesInSecond:30,maxSizeInSecond:8e3,getSize:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[0].byteLength}}).timesInSecond,el=jp.maxSizeInSecond,Bp=jp.getSize,x1=function(e,t,n){var i=n.value,o=new Map;return J.on(yf,function(c){var a=c.client;return o.delete(a)}),n.value=function(){var c=o.get(this);c||(c={callCountInSecond:0,timestamp:0,totalSizeInSecond:0},o.set(this,c)),c.timestamp===0?c.timestamp=Date.now():Date.now()-c.timestamp>1e3&&(c.timestamp=Date.now(),c.callCountInSecond=0,c.totalSizeInSecond=0);for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];if(Bp&&(c.totalSizeInSecond+=Bp.apply(void 0,u)),c.timestamp!==0&&Date.now()-c.timestamp<1e3&&(c.callCountInSecond>=Zu||c.totalSizeInSecond>el))throw new Y({code:Q.INVALID_OPERATION,message:Z({key:_P,data:{isTimes:c.callCountInSecond>=Zu,isSize:c.totalSizeInSecond>el,name:t,timesInSecond:Zu,maxSizeInSecond:el}})});return c.callCountInSecond++,i.apply(this,u)},n},ze((ct=function(){function e(R){var T,D;w(this,e),this.name_=CA,this.mode_=R.mode,this.sdpSemantics_="plan-b",fe(R.sdpSemantics)?function(){if(!vD()||fe(window.RTCRtpTransceiver)||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var O=new RTCPeerConnection,M=!1;try{O.addTransceiver(Pe),M=!0}catch{}return O.close(),M}()&&(this.sdpSemantics_="unified-plan"):this.sdpSemantics_=R.sdpSemantics,this.sdkAppId_=R.sdkAppId,this.userId_=R.userId,this.log_=ye.createLogger({id:"c".concat(R.seq,"|").concat(this.userId_),userId:this.userId_,sdkAppId:this.sdkAppId_}),this.userSig_=R.userSig,this.roomId_=0,this.useStringRoomId_=R.useStringRoomId||!1,this.pureAudioPushMode_=null,this.version_=R.version,this.log_.info("using sdpSemantics: "+this.sdpSemantics_),this.signalChannel_=null,this.role_="anchor",this.privateMapKey_="",this.tinyId_=0,this.env_="",this.proxy_=null,this.connections_=new Map,this.mutedStates_=new Map,this.userMap_=new Map,this.syncUserListInterval_=-1,this.localStream_=null,this.uplinkConnection_=null,this.emitter_=P0(new mi,this.name_),this.isJoined_=!1,this.heartbeat_=-1,this.lastHeartBeatTime_=-1,this.stats_=new wD(this),this.joinTimeout_=-1,this.changeBigSmallRecords_=new Map,this.networkQuality_=null,this.badCaseDetector_=null,this.networkType_=Xh(),this.autoSubscribe_=!!fe(R.autoSubscribe)||R.autoSubscribe,this.joinedTimestamp_=0,this.joinOptions_={},this.basis_=(D={browser:$i().name+"/"+$i().version,os:Yf(),displayResolution:_D(),isScreenShareSupported:Cb(),isWebRTCSupported:Gf(),isGetUserMediaSupported:yD(),isWebAudioSupported:bD(),isWebSocketsSupported:"WebSocket"in window&&window.WebSocket.CLOSING===2,isWebCodecSupported:(T={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1},fe(window.AudioDecoder)||(T.AudioDecoder=!0),fe(window.AudioEncoder)||(T.AudioEncoder=!0),fe(window.VideoDecoder)||(T.VideoDecoder=!0),fe(window.VideoEncoder)||(T.VideoEncoder=!0),fe(window.ImageDecoder)||(T.ImageDecoder=!0),T),isMediaSessionSupported:"mediaSession"in navigator&&!fe(navigator.mediaSession.setActionHandler),isWebTransportSupported:!fe(window.WebTransport)},navigator.userAgent.includes("miniProgram")&&(D.browser="mini/".concat(D.browser)),D),this.initBussinessInfo_(R),this.publishedCDN_=!1,this.publishCDNData_=null,this.mixedMCU_=!1,this.mixTranscodeData_=null,this.checkSystemResult_=null,this.enableAudioVolumeEvaluation_=!1,this.audioVolumeIntervalId_=null,this.mixTranscodeManager_=null,this.publishCDNManager_=new hL({client:this}),this.keyPointManager_=new vL({client:this,frameWorkType:R.frameWorkType}),this.getUserList=Xo({retryFunction:this.getUserList,settings:{retries:3},onError:function(O,M){return M()}}),this.isPublishing_=!1,this.isEnableSmallStream_=!1,this.smallStreamConfig_={bitrate:100,frameRate:15,height:120,width:160},this.turnServers_=[],this.iceTransportPolicy_=R.iceTransportPolicy,this.schedule_={domains:null,iceServers:null,iceTransportPolicy:null},this.enableAutoPlayDialog_=!!fe(R.enableAutoPlayDialog)||R.enableAutoPlayDialog,this.signalInfo_={},this.enableSEI_=!fe(R.enableSEI)&&R.enableSEI,this.isDestroyed_=!1}var t,n,i,o,c,a,u,l,h,f,m,g,v,I,S,y,E,C,x,U,G,H,V,j,q,K,De;return P(e,[{key:"initBussinessInfo_",value:function(R){this.bussinessInfo_=R.bussinessInfo;var T={};if(Jt(R.bussinessInfo)&&(T=JSON.parse(R.bussinessInfo)),!fe(R.pureAudioPushMode)){if(!Number.isInteger(Number(R.pureAudioPushMode)))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:qA})});this.pureAudioPushMode_=R.pureAudioPushMode,T.Str_uc_params||(T.Str_uc_params={}),T.Str_uc_params.pure_audio_push_mod=this.pureAudioPushMode_}if(!fe(R.streamId)){if(!(Jt(R.streamId)&&String(R.streamId)&&String(R.streamId).length<=64))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:KA})});T.Str_uc_params||(T.Str_uc_params={}),T.Str_uc_params.userdefine_streamid_main=R.streamId}if(!fe(R.userDefineRecordId)){if(R.userDefineRecordId.match(/^[A-Za-z0-9_-]{1,64}$/gi)===null)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:QA})});T.Str_uc_params||(T.Str_uc_params={}),T.Str_uc_params.userdefine_record_id=R.userDefineRecordId}if(!fe(R.userDefinePushArgs)){if(!(Jt(R.userDefinePushArgs)&&String(R.userDefinePushArgs)&&String(R.userDefinePushArgs).length<=256))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:YA})});T.Str_uc_params||(T.Str_uc_params={}),T.Str_uc_params.userdefine_push_args=R.userDefinePushArgs}ea(T)||(this.bussinessInfo_=JSON.stringify(T))}},{key:"setProxyServer",value:function(R){if(this.log_.info("set proxy server: ".concat(JSON.stringify(R))),Jt(R)){if(!R.startsWith("wss://"))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:XA})});this.proxy_=R}else if(Gi(R)){var T=R.websocketProxy,D=R.loggerProxy;T&&(this.proxy_=T),D&&uA(D)}}},{key:"schedule",value:(De=b(regeneratorRuntime.mark(function R(T){var D;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,_L({userId:this.userId_,sdkAppId:this.sdkAppId_,roomId:T,useStringRoomId:this.useStringRoomId_,version:this.version_,userSig:this.userSig_});case 2:(D=O.sent)&&(this.log_.info("schedule: ".concat(JSON.stringify(D))),this.schedule_=p(p({},this.schedule_),D),J.emit(eb,this.schedule_));case 4:case"end":return O.stop()}},R,this)})),function(R){return De.apply(this,arguments)})},{key:"getSignalChannelUrl",value:function(){var R={mainUrl:"",backupUrl:""},T=I0();return T?R.mainUrl=R.backupUrl="wss://".concat(T,".rtc.qq.com"):this.proxy_?R.mainUrl=R.backupUrl=this.proxy_:Array.isArray(this.schedule_.domains)&&this.schedule_.domains.length>0&&(R.mainUrl=R.backupUrl="wss://".concat(this.schedule_.domains[0]),this.schedule_.domains[1]&&(R.backupUrl="wss://".concat(this.schedule_.domains[1]))),R}},{key:"getUserId",value:function(){return this.userId_}},{key:"getUserSig",value:function(){return this.userSig_}},{key:"getRole",value:function(){return this.role_}},{key:"getSignalInfo",value:function(){return this.signalInfo_}},{key:"getRoomId",value:function(){return this.roomId_}},{key:"getSDKAppId",value:function(){return this.sdkAppId_}},{key:"getTinyId",value:function(){return this.tinyId_}},{key:"setTurnServer",value:function(R){this.log_.info("set turn server: "+JSON.stringify(R));var T=[];Array.isArray(R)?R.forEach(function(D){return T.push(R0(D))}):Gi(R)&&T.push(R0(R)),this.turnServers_=T}},{key:"getIceTransportPolicy",value:function(){return this.iceTransportPolicy_||this.schedule_.iceTransportPolicy||"all"}},{key:"initialize",value:function(){var R=this;this.log_.info("setup signal channel");var T=this.getSignalChannelUrl(),D=T.mainUrl,O=T.backupUrl;return this.signalChannel_=new oD({sdkAppId:this.sdkAppId_,userId:this.userId_,userSig:this.userSig_,url:D,backupUrl:O,client:this}),this.networkQuality_||(this.networkQuality_=new ED({connections:this.connections_,signalChannel:this.signalChannel_,userId:this.userId_,client:this}),this.networkQuality_.on(dt.NETWORK_QUALITY,function(M){R.emitter_.emit(dt.NETWORK_QUALITY,M)})),this.deviceDetector_||(this.deviceDetector_=new CD({client:this})),this.subscriptionManager_||(this.subscriptionManager_=new rL({client:this})),this.badCaseDetector_||(this.badCaseDetector_=new lL({client:this,stats:this.stats_})),this.callDurationCalculator_||(this.callDurationCalculator_=new fL({client:this})),this.mixTranscodeManager_||(this.mixTranscodeManager_=new dL({client:this,signalChannel:this.signalChannel_})),this.publishCDNManager_&&this.publishCDNManager_.setSignalChannel({signalChannel:this.signalChannel_}),this.signalChannel_.on(Bf,function(M){R.log_.info("SignalChannel state changed from ".concat(M.prevState," to ").concat(M.state)),R.emitter_.emit(dt.CONNECTION_STATE_CHANGED,M)}),this.signalChannel_.on(Hf,function(M){R.reset(),R.emitter_.emit(dt.ERROR,M)}),this.signalChannel_.once(fb,function(M){R.tinyId_=M.signalInfo.tinyId,J.emit(Iu,{client:R})}),this.signalChannel_.on(kt.PEER_JOIN,this.onPeerJoin,this),this.signalChannel_.on(kt.PEER_LEAVE,this.onPeerLeave,this),this.signalChannel_.on(kt.UPDATE_REMOTE_MUTE_STAT,function(M){Date.now()-R.lastHeartBeatTime_>=1e4&&R.doHeartbeat(),J.emit(gf,{client:R,data:M.data}),R.onPublishedUserList(M.data),R.onUpdateRemoteMuteStat(M.data)}),this.signalChannel_.on(kt.CLIENT_BANNED,function(M){var F,re=M.data.data.reason;if(Se.uploadEvent({log:"stat-banned:".concat(re),userId:R.userId_}),re===ZR)F="you got banned by the admin";else if(re===eA)F="duplicated userId joining the room";else if(re===nA)F="the room has been disbanded by the admin",re=re.replace("_","-");else if(re===tA)return R.log_.warn("".concat(re," last heart beat time: ").concat(R.lastHeartBeatTime_," interval: ").concat(Date.now()-R.lastHeartBeatTime_,", visibility: ").concat(document.visibilityState)),void R.reJoin();R.log_[re==="kick"?"error":"info"]("user was banned because of [".concat(re,"]")),R.reset(),R.emitter_.emit(dt.CLIENT_BANNED,{reason:re,message:Z({key:mx,data:{message:F,reason:re}})||re})}),J.emit(_f,{client:this}),this.signalChannel_.connect()}},{key:"preJoin",value:(K=b(regeneratorRuntime.mark(function R(T){var D,O,M,F;return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return this.joinOptions_=T,re.next=3,Jf();case 3:if(this.checkSystemResult_=re.sent,this.checkDestroy(),(D=I0())||(D=uu,this.proxy_&&(this.proxy_.startsWith(rA)?D=oA:this.proxy_.startsWith(iA)&&(D=aA))),this.env_=D,Se.setConfig({env:D,sdkAppId:this.sdkAppId_,userId:this.userId_,roomId:T.roomId}),this.uploadTrtcStats(),O=this.checkSystemResult_.detail,M=O.isH264EncodeSupported,F=O.isVp8EncodeSupported,Gf()&&(M||F)){re.next=13;break}throw new Y({code:Q.NOT_SUPPORTED,message:Z({key:v0})});case 13:case"end":return re.stop()}},R,this)})),function(R){return K.apply(this,arguments)})},{key:"join",value:(q=b(regeneratorRuntime.mark(function R(T){var D,O=this;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return D=qt(),J.emit(Su,{client:this,roomId:T.roomId}),gn(this.userId_,{eventId:j2,eventDesc:"joining room",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),M.next=5,this.preJoin(T);case 5:return M.abrupt("return",new Promise(function(){var F=b(regeneratorRuntime.mark(function re(pe,ve){return regeneratorRuntime.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(O.joinReject_=ve,se.prev=1,O.proxy_||O.schedule_.domains){se.next=5;break}return se.next=5,O.schedule(T.roomId);case 5:return O.checkDestroy(),se.next=8,O.initialize(T);case 8:return se.next=10,O.doJoin(T);case 10:O.signalInfo_=O.signalChannel_.getSignalInfo(),J.emit(Qo,{client:O}),O.joinedTimestamp_=qt(),Se.logSuccessEvent({userId:O.userId_,eventType:gA,delta:O.joinedTimestamp_-D}),Se.logSuccessEvent({userId:O.userId_,eventType:Vy}),Se.uploadEvent({log:"stat-autoplay-dialog:".concat(O.enableAutoPlayDialog_),userId:O.userId_}),Se.uploadEvent({log:"stat-conv-".concat(Ho,"-").concat(location.hostname),userId:O.userId_}),pe(),se.next=26;break;case 20:se.prev=20,se.t0=se.catch(1),J.emit(Yo,{client:O,error:se.t0}),Se.logFailedEvent({userId:O.userId_,eventType:Vy,error:se.t0}),O.reset(),ve(se.t0);case 26:O.joinReject_=null;case 27:case"end":return se.stop()}},re,null,[[1,20]])}));return function(re,pe){return F.apply(this,arguments)}}()));case 6:case"end":return M.stop()}},R,this)})),function(R){return q.apply(this,arguments)})},{key:"checkDestroy",value:function(){if(this.isDestroyed_)throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Yh,data:{funName:"join"}})})}},{key:"uploadTrtcStats",value:(j=b(regeneratorRuntime.mark(function R(){var T,D,O,M,F,re,pe,ve,se,Ne,_e,Je,$e;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return Re.prev=0,Re.next=3,vt.getMicrophones();case 3:O=Re.sent,T=O&&O.length,Re.next=9;break;case 7:Re.prev=7,Re.t0=Re.catch(0);case 9:return Re.prev=9,Re.next=12,vt.getCameras();case 12:M=Re.sent,D=M&&M.length,Re.next=18;break;case 16:Re.prev=16,Re.t1=Re.catch(9);case 18:F={microphone:T,camera:D},re=this.checkSystemResult_.detail,pe=re.isH264EncodeSupported,ve=re.isVp8EncodeSupported,se=re.isH264DecodeSupported,Ne=re.isVp8DecodeSupported,_e={webRTC:this.basis_.isWebRTCSupported,getUserMedia:this.basis_.isGetUserMediaSupported,webSocket:this.basis_.isWebSocketsSupported,screenShare:this.basis_.isScreenShareSupported,webAudio:this.basis_.isWebAudioSupported,h264Encode:pe,h264Decode:se,vp8Encode:ve,vp8Decode:Ne},Je={browser:this.basis_.browser,os:this.basis_.os,trtc:_e,devices:F},$e={isWebCodecSupported:this.basis_.isWebCodecSupported,isMediaSessionSupported:this.basis_.isMediaSessionSupported,isWebTransportSupported:this.basis_.isWebTransportSupported},Se.uploadEvent({log:"trtcstats-"+JSON.stringify(Je),userId:this.userId_}),this.log_.info("TrtcStats-"+JSON.stringify(Je)),Se.uploadEvent({log:"trtcadvancedstats-"+JSON.stringify($e),userId:this.userId_});case 26:case"end":return Re.stop()}},R,this,[[0,7],[9,16]])})),function(){return j.apply(this,arguments)})},{key:"doJoin",value:function(R){var T=this;return new Promise(function(D,O){T.roomId_=R.roomId,fe(R.role)||(T.role_=R.role),fe(R.privateMapKey)||(T.privateMapKey_=R.privateMapKey),T.log_.info("Join() => joining room: ".concat(R.roomId," useStringRoomId: ").concat(T.useStringRoomId_," mode: ").concat(T.mode_," role: ").concat(T.role_));var M={roomId:String(R.roomId),useStringRoomId:T.useStringRoomId_,privateMapKey:T.privateMapKey_,trtcRole:T.role_==="anchor"?zo:Fh,trtcScene:T.mode_==="live"?dA:lA,sdpSemantics:T.sdpSemantics_,version:SP(T.version_),ua:navigator&&navigator.userAgent||"",autoSubscribe:T.autoSubscribe_,terminalType:Bi?4:Sh?2:bh?3:Ey?12:wy?5:Cy?13:1,netType:Wh[Xh()],bussinessInfo:T.bussinessInfo_};if(T.publishCDNManager_){var F=T.publishCDNManager_.handleCDNConfigForJoinData(T.bussinessInfo_),re=F.bussinessInfo,pe=F.pushUserCdnInfo;Object.assign(M,{bussinessInfo:re,pushUserCdnInfo:pe})}T.log_.debug("join room signal data: ".concat(JSON.stringify(M))),T.joinTimeout_=setTimeout(function(){T.log_.error("join room timeout observed"),O(new Y({code:Q.JOIN_ROOM_FAILED,message:Z({key:nx})}))},5e3),J.emit(df,{client:T}),T.signalChannel_.once(pb,function(ve){T.clearJoinTimeout(),J.emit(Iu,{client:T,error:ve}),O(ve)}),T.signalChannel_.send(l2,M),T.signalChannel_.once(kt.JOIN_ROOM_RESULT,function(ve){T.clearJoinTimeout();var se=ve.data,Ne=se.code,_e=se.message,Je=se.data;T.onPublishedUserList({data:{userList:Je.publishers}}),J.emit(hf,{client:T,code:Ne}),Ne===0?(T.isJoined_=!0,T.log_.info("Join room success, start heartbeat"),T.startHeartbeat(),T.badCaseDetector_&&T.badCaseDetector_.start(),T.syncUserList(),T.startSyncUserListInterval(),D()):(T.log_.error("Join room failed result: "+Ne+" error: "+_e),O(new Y({code:Q.JOIN_ROOM_FAILED,extraCode:Ne,message:Z({key:h0,data:{error:_e,code:Ne}})})))})})}},{key:"reJoin",value:(V=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(this.isJoined_){T.next=3;break}return this.log_.warn("reJoin abort"),T.abrupt("return");case 3:return this.isJoined_=!1,T.prev=4,this.log_.warn("reJoin pending: ".concat(this.joinOptions_.roomId)),this.subscriptionManager_&&this.subscriptionManager_.markAllStream(),this.signalChannel_.close(),T.next=10,this.signalChannel_.connect();case 10:return T.next=12,this.doJoin(p(p({},this.joinOptions_),{},{role:this.role_,privateMapKey:this.privateMapKey_}));case 12:this.log_.warn("reJoin success"),Se.logSuccessEvent({userId:this.userId_,eventType:Fy}),this.checkConnectionsToReconnect(),this.republish(),this.mixTranscodeManager_&&this.mixTranscodeManager_.reStartMixTranscode(),T.next=25;break;case 19:T.prev=19,T.t0=T.catch(4),this.log_.warn("reJoin fail "+T.t0),this.reset(),Se.logFailedEvent({userId:this.userId_,eventType:Fy,error:T.t0}),this.emitter_.emit(dt.ERROR,new Y({code:Q.JOIN_ROOM_FAILED,message:Z({key:rx,data:{roomId:this.joinOptions_.roomId}})}));case 25:case"end":return T.stop()}},R,this,[[4,19]])})),function(){return V.apply(this,arguments)})},{key:"republish",value:function(){var R=this;if(this.uplinkConnection_&&this.localStream_&&!this.uplinkConnection_.getIsReconnecting()){this.log_.warn("republish pending");var T=this.localStream_;this.doUnpublish(T).then(function(){return R.publish(T)}).then(function(){return R.log_.warn("republish success")}).catch(function(D){return R.log_.warn("republish fail "+D)})}}},{key:"leave",value:(H=b(regeneratorRuntime.mark(function R(){var T;return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return J.emit(ff,{client:this}),gn(this.userId_,{eventId:B2,eventDesc:"leaving room",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),D.prev=2,D.next=5,this.doHeartbeat();case 5:D.next=9;break;case 7:D.prev=7,D.t0=D.catch(2);case 9:this.doLeave(),J.emit(ku,{client:this}),Se.logSuccessEvent({userId:this.userId_,eventType:vA}),T=Math.floor((qt()-this.joinedTimestamp_)/1e3),Se.logSuccessEvent({userId:this.userId_,eventType:_A,delta:T});case 14:case"end":return D.stop()}},R,this,[[2,7]])})),function(){return H.apply(this,arguments)})},{key:"doLeave",value:function(){this.isJoined_&&(J.emit(pf,{client:this}),this.log_.info("leave() => leaving room"),this.signalChannel_.send(d2),this.reset())}},{key:"clearNetworkQuality",value:function(){this.networkQuality_&&(this.networkQuality_.stop(),this.networkQuality_=null)}},{key:"closeConnections",value:function(){var R=this;this.connections_.forEach(function(T){R.closeDownLink(T.getTinyId())})}},{key:"clearJoinTimeout",value:function(){clearTimeout(this.joinTimeout_),this.joinTimeout_=-1}},{key:"destroy",value:function(){var R,T,D;if(this.isJoined_)throw this.log_.warn(di.INVALID_DESTROY),new Y({code:Q.INVALID_OPERATION,message:Z({key:ix})});this.isDestroyed_||(this.log_.info("destroy client"),this.joinReject_&&(this.joinReject_(new Y({code:Q.INVALID_OPERATION,message:Z({key:Yh,data:{funName:"join"}})})),this.clearJoinTimeout(),this.reset()),this.off("*"),(R=this.callDurationCalculator_)===null||R===void 0||R.destroy(),(T=this.keyPointManager_)===null||T===void 0||T.destroy(),(D=this.deviceDetector_)===null||D===void 0||D.destroy(),this.callDurationCalculator_=null,this.keyPointManager_=null,this.deviceDetector_=null,this.badCaseDetector_=null,this.publishCDNManager_=null,this.isDestroyed_=!0,J.emit(yf,{client:this}))}},{key:"reset",value:function(){this.keyPointManager_&&this.keyPointManager_.prepareReport(),this.mixTranscodeManager_&&(this.mixTranscodeManager_.reset(),this.mixTranscodeManager_=null),this.publishCDNManager_&&this.publishCDNManager_.reset(),this.userMap_.clear(),this.stopSyncUserListInterval(),this.stopHeartbeat(),this.closeConnections(),this.mutedStates_.clear(),this.clearNetworkQuality(),this.badCaseDetector_&&this.callDurationCalculator_&&this.uploadAllCallStats(),this.closeUplink(),this.isJoined_=!1,this.signalChannel_&&(this.log_.info("destroying SignalChannel"),this.signalChannel_.close(),this.signalChannel_=null)}},{key:"startSyncUserListInterval",value:function(){this.syncUserListInterval_===-1&&(this.syncUserListInterval_=zt.setInterval(this.syncUserList.bind(this),1e4))}},{key:"stopSyncUserListInterval",value:function(){zt.clearInterval(this.syncUserListInterval_),this.syncUserListInterval_=-1}},{key:"syncUserList",value:(G=b(regeneratorRuntime.mark(function R(){var T,D=this;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,this.getUserList();case 3:T=O.sent,this.userMap_.size!==0&&this.userMap_.forEach(function(M){T.findIndex(function(F){return F.userId===M.userId})<0&&(D.log_.info("peer leave detected: ".concat(M.userId)),D.cleanUser({userId:M.userId,tinyId:M.tinyId}))}),T.forEach(function(M){var F=M.userId;D.userMap_.has(F)||F===D.userId_||(D.userMap_.set(F,M),D.emitter_.emit(dt.PEER_JOIN,{userId:F}))}),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(0),this.log_.warn("sync user list failed: "+O.t0);case 11:case"end":return O.stop()}},R,this,[[0,8]])})),function(){return G.apply(this,arguments)})},{key:"getUserList",value:function(){var R=this;return new Promise(function(T,D){R.signalChannel_.send(T2),R.signalChannel_.once(kt.USER_LIST_RES,function(O){var M=O.data,F=M.code,re=M.message;if(F!==0){var pe=Z({key:b0,data:{signalResponse:kt.USER_LIST_RES,code:F,message:re}});D(pe)}else{var ve=(O.data.data&&O.data.data.userList||[]).map(function(se){var Ne=se.userId,_e=se.srcTinyId,Je=se.role;return new Vp({userId:Ne,tinyId:_e,role:Je})});T(ve)}}),setTimeout(D,2e3)})}},{key:"publish",value:(U=b(regeneratorRuntime.mark(function R(T){var D,O,M,F,re=this;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return T.setPublishState(bs),this.isPublishing_=!0,D=qt(),J.emit(vf,{client:this,stream:T}),this.log_.info("publish() => publishing local stream"),O=new cL({userId:this.userId_,tinyId:this.tinyId_,client:this,isUplink:!0,signalChannel:this.signalChannel_,enableSEI:this.enableSEI_}),T.setConnection(O),O.initialize(),O.on(it.ERROR,function(ve){var se=ve.getCode();se!==Q.ICE_TRANSPORT_ERROR&&(se===Q.UPLINK_RECONNECTION_FAILED&&re.closeUplink(),re.emitter_.emit(dt.ERROR,ve))}),pe.prev=9,pe.next=12,O.publish(T);case 12:this.localStream_=pe.sent,this.localStream_.getBeautyStatus()&&this.log_.info("beauty stream is published successfully"),this.log_.info("local stream is published successfully"),this.isPublishing_=!1,T.setPublishState(SA),this.uplinkConnection_=O,M=qt(),F=M-D,Se.logSuccessEvent({userId:this.userId_,eventType:jy}),Se.logSuccessEvent({userId:this.userId_,eventType:yA,delta:F}),T.hasAudio()&&gn(this.userId_,{eventId:_b,eventDesc:"publish audio track",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),T.hasVideo()&&gn(this.userId_,{eventId:vb,eventDesc:"publish video track",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),this.networkQuality_&&this.networkQuality_.setUplinkConnection(this.uplinkConnection_),this.deviceDetector_&&this.deviceDetector_.setLocalStream(this.localStream_),J.emit(If,{localStream:this.localStream_,client:this}),this.notPublishWithoutH264Supported_=!1,pe.next=39;break;case 30:throw pe.prev=30,pe.t0=pe.catch(9),pe.t0 instanceof Y&&pe.t0.getCode()===Q.NOT_SUPPORTED_H264&&(this.notPublishWithoutH264Supported_=!0),T.setPublishState(a0),O.close(),this.log_.error("failed to publish stream "+pe.t0),this.isPublishing_=!1,Se.logFailedEvent({userId:this.userId_,eventType:jy,error:pe.t0}),pe.t0;case 39:case"end":return pe.stop()}},R,this,[[9,30]])})),function(R){return U.apply(this,arguments)})},{key:"unpublish",value:(x=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(this.localStream_){T.next=2;break}return T.abrupt("return");case 2:return this.log_.info("unpublish() => unpublishing local stream"),T.prev=3,T.next=6,this.doUnpublish();case 6:Se.logSuccessEvent({userId:this.userId_,eventType:By}),T.next=13;break;case 9:throw T.prev=9,T.t0=T.catch(3),Se.logFailedEvent({userId:this.userId_,eventType:By,error:T.t0}),T.t0;case 13:case"end":return T.stop()}},R,this,[[3,9]])})),function(){return x.apply(this,arguments)})},{key:"doUnpublish",value:function(){var R=this;return this.signalChannel_.sendWaitForResponse({command:gb,commandDesc:"unpublish",responseCommand:kt.UNPUBLISH_RESULT}).then(function(){R.closeUplink()}).catch(function(){R.closeUplink()})}},{key:"closeUplink",value:function(){this.uplinkConnection_&&(this.uplinkConnection_.getIsReconnecting()&&this.uplinkConnection_.stopReconnection(),this.uplinkConnection_.close(),this.uplinkConnection_=null,this.networkQuality_&&this.networkQuality_.setUplinkConnection(null),this.localStream_.hasAudio()&&gn(this.userId_,{eventId:bb,eventDesc:"unpublish audio track",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),this.localStream_.hasVideo()&&gn(this.userId_,{eventId:yb,eventDesc:"unpublish video track",timestamp:ln(),userId:this.userId_,tinyId:this.tinyId_}),this.localStream_.setClient(null),this.localStream_.setConnection(null),this.localStream_=null,this.deviceDetector_&&this.deviceDetector_.setLocalStream(null))}},{key:"closeDownLink",value:function(R){var T=this.connections_.get(R);T&&(T.getIsReconnecting()&&T.stopReconnection(),this.subscriptionManager_&&this.subscriptionManager_.delete(T.getUserId()),T.close(),this.connections_.delete(R),this.mutedStates_.delete(R))}},{key:"subscribe",value:(C=b(regeneratorRuntime.mark(function R(T,D){var O,M,F;return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return this.log_.info("subscribe() => subscribe to [".concat(T.getUserId(),"] ").concat(T.getType()," stream with options: ").concat(JSON.stringify(D))),fe(D)&&(D={audio:!0,video:!0}),fe(D.video)&&(D.video=!0),fe(D.audio)&&(D.audio=!0),re.prev=4,O=T.getConnection(),J.emit(kf,{client:this,stream:T}),re.next=9,O.subscribe(T,D);case 9:this.subscriptionManager_&&this.subscriptionManager_.addSubscriptionRecord(T.getUserId(),T,D),this.notSubscribeWithoutH264Supported_=!1,Se.logSuccessEvent({userId:this.userId_,eventType:Hy}),re.next=22;break;case 14:throw re.prev=14,re.t0=re.catch(4),(M=re.t0 instanceof Y?re.t0.getCode():Q.UNKNOWN)===Q.NOT_SUPPORTED_H264&&(this.notSubscribeWithoutH264Supported_=!0),F=new Y({code:M,message:Z({key:lx,data:{message:re.t0.message,stream:T}})}),Se.logFailedEvent({userId:this.userId_,eventType:Hy,error:F}),this.log_.error(F),F;case 22:case"end":return re.stop()}},R,this,[[4,14]])})),function(R,T){return C.apply(this,arguments)})},{key:"unsubscribe",value:(E=b(regeneratorRuntime.mark(function R(T){var D;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return this.log_.info("unsubscribe() => unsubscribe to [".concat(T.getUserId(),"] ").concat(T.getType()," stream")),O.prev=1,D=T.getConnection(),O.next=5,D.unsubscribe(T);case 5:this.subscriptionManager_&&this.subscriptionManager_.addUnsubscriptionRecord(T.getUserId(),T),J.emit(Or,{client:this,stream:T}),Se.logSuccessEvent({userId:this.userId_,eventType:$y}),O.next=14;break;case 10:throw O.prev=10,O.t0=O.catch(1),Se.logFailedEvent({userId:this.userId_,eventType:$y,error:O.t0}),O.t0;case 14:case"end":return O.stop()}},R,this,[[1,10]])})),function(R){return E.apply(this,arguments)})},{key:"switchRole",value:(y=b(regeneratorRuntime.mark(function R(T){return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(this.role_!==T){D.next=2;break}return D.abrupt("return");case 2:if(T!=="audience"||!this.localStream_){D.next=5;break}return D.next=5,this.unpublish(this.localStream_);case 5:return this.log_.info("switchRole() => switch role to: "+T),D.next=8,this.doSwitchRole(T);case 8:case"end":return D.stop()}},R,this)})),function(R){return y.apply(this,arguments)})},{key:"doSwitchRole",value:function(R){var T=this,D={command:w2,data:{role:R==="anchor"?zo:Fh,privateMapKey:this.privateMapKey_},responseCommand:kt.SWITCH_ROLE_RES};return this.log_.info("switchRole signal data: "+JSON.stringify(D.data)),this.signalChannel_.sendWaitForResponse(D).then(function(O){var M=O.data,F=M.code,re=M.message;if(F!==0)throw new Y({code:Q.SWITCH_ROLE_FAILED,message:Z({key:px,data:{errMsg:re,errCode:F}})});T.role_=R}).catch(function(O){throw O instanceof Y&&O.getCode()===Q.API_CALL_TIMEOUT&&(O=new Y({code:Q.SWITCH_ROLE_FAILED,message:Z({key:fx})})),T.log_.error(O),O})}},{key:"on",value:function(R,T,D){this.emitter_.on(R,T,D)}},{key:"off",value:function(R,T,D){R==="*"?this.emitter_.removeAllListeners():this.emitter_.off(R,T,D)}},{key:"getRemoteMutedState",value:function(){var R=this,T=[];return this.mutedStates_.forEach(function(D,O,M){var F=R.connections_.get(O);F&&T.push(p({userId:F.getUserId()},D))}),T}},{key:"getTransportStats",value:(S=b(regeneratorRuntime.mark(function R(){var T,D,O,M,F,re,pe;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(T={rtt:0,downlinksRTT:{}},!this.uplinkConnection_){ve.next=6;break}return ve.next=4,this.stats_.getSenderStats(this.uplinkConnection_);case 4:D=ve.sent,T.rtt=D.rtt;case 6:O=Ge(this.connections_),ve.prev=7,O.s();case 9:if((M=O.n()).done){ve.next=17;break}return(F=Xe(M.value,2))[0],re=F[1],ve.next=13,this.stats_.getReceiverStats(re);case 13:pe=ve.sent,T.downlinksRTT[pe.userId]=pe.rtt;case 15:ve.next=9;break;case 17:ve.next=22;break;case 19:ve.prev=19,ve.t0=ve.catch(7),O.e(ve.t0);case 22:return ve.prev=22,O.f(),ve.finish(22);case 25:return ve.abrupt("return",T);case 26:case"end":return ve.stop()}},R,this,[[7,19,22,25]])})),function(){return S.apply(this,arguments)})},{key:"getLocalAudioStats",value:(I=b(regeneratorRuntime.mark(function R(){var T,D;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if((T={})[this.userId_]={bytesSent:0,packetsSent:0},!this.uplinkConnection_){O.next=7;break}return O.next=5,this.stats_.getSenderStats(this.uplinkConnection_);case 5:D=O.sent,T[this.userId_]={bytesSent:D.audio.bytesSent,packetsSent:D.audio.packetsSent};case 7:return O.abrupt("return",T);case 8:case"end":return O.stop()}},R,this)})),function(){return I.apply(this,arguments)})},{key:"getLocalVideoStats",value:(v=b(regeneratorRuntime.mark(function R(){var T,D;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if((T={})[this.userId_]={bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0},!this.uplinkConnection_){O.next=7;break}return O.next=5,this.stats_.getSenderStats(this.uplinkConnection_);case 5:D=O.sent,T[this.userId_]={bytesSent:D.video.bytesSent,packetsSent:D.video.packetsSent,framesEncoded:D.video.framesEncoded,framesSent:D.video.framesSent,frameWidth:D.video.frameWidth,frameHeight:D.video.frameHeight};case 7:return O.abrupt("return",T);case 8:case"end":return O.stop()}},R,this)})),function(){return v.apply(this,arguments)})},{key:"getRemoteAudioStats",value:(g=b(regeneratorRuntime.mark(function R(){var T,D,O,M,F,re,pe,ve;return regeneratorRuntime.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:T={},D=Ge(this.connections_),se.prev=2,D.s();case 4:if((O=D.n()).done){se.next=13;break}return(M=Xe(O.value,2))[0],F=M[1],re=F.getDelay(),pe=re.audioDelay,se.next=9,this.stats_.getReceiverStats(F);case 9:(ve=se.sent).hasAudio&&(T[ve.userId]={bytesReceived:ve.audio.bytesReceived,packetsReceived:ve.audio.packetsReceived,packetsLost:ve.audio.packetsLost,end2EndDelay:pe});case 11:se.next=4;break;case 13:se.next=18;break;case 15:se.prev=15,se.t0=se.catch(2),D.e(se.t0);case 18:return se.prev=18,D.f(),se.finish(18);case 21:return se.abrupt("return",T);case 22:case"end":return se.stop()}},R,this,[[2,15,18,21]])})),function(){return g.apply(this,arguments)})},{key:"getRemoteVideoStats",value:(m=b(regeneratorRuntime.mark(function R(){var T,D,O,M,F,re,pe,ve,se,Ne=arguments;return regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:T=Ne.length>0&&Ne[0]!==void 0?Ne[0]:St,D={},O=Ge(this.connections_),_e.prev=3,O.s();case 5:if((M=O.n()).done){_e.next=15;break}return(F=Xe(M.value,2))[0],re=F[1],_e.next=9,this.stats_.getReceiverStats(re);case 9:pe=_e.sent,ve=re.getDelay(),se=ve.videoDelay,T===St&&pe.hasVideo&&(D[pe.userId]={bytesReceived:pe.video.bytesReceived,packetsReceived:pe.video.packetsReceived,packetsLost:pe.video.packetsLost,framesDecoded:pe.video.framesDecoded,frameWidth:pe.video.frameWidth,frameHeight:pe.video.frameHeight,end2EndDelay:se}),T===Nt&&pe.hasAuxiliary&&(D[pe.userId]={bytesReceived:pe.auxiliary.bytesReceived,packetsReceived:pe.auxiliary.packetsReceived,packetsLost:pe.auxiliary.packetsLost,framesDecoded:pe.auxiliary.framesDecoded,frameWidth:pe.auxiliary.frameWidth,frameHeight:pe.auxiliary.frameHeight,end2EndDelay:se});case 13:_e.next=5;break;case 15:_e.next=20;break;case 17:_e.prev=17,_e.t0=_e.catch(3),O.e(_e.t0);case 20:return _e.prev=20,O.f(),_e.finish(20);case 23:return _e.abrupt("return",D);case 24:case"end":return _e.stop()}},R,this,[[3,17,20,23]])})),function(){return m.apply(this,arguments)})},{key:"getSdpSemantics",value:function(){return this.sdpSemantics_}},{key:"getIceServers",value:function(){return this.turnServers_.length===0&&this.schedule_.iceServers?this.schedule_.iceServers:this.turnServers_}},{key:"getConnections",value:function(){return this.connections_}},{key:"getMutedStates",value:function(){return this.mutedStates_}},{key:"startHeartbeat",value:function(){this.heartbeat_===-1&&(this.log_.info("startHeartbeat..."),this.heartbeat_=zt.setInterval(this.doHeartbeat.bind(this),2e3))}},{key:"stopHeartbeat",value:function(){this.heartbeat_!==-1&&(this.log_.info("stopHeartbeat"),zt.clearInterval(this.heartbeat_),this.heartbeat_=-1,this.lastHeartBeatTime_=-1)}},{key:"doHeartbeat",value:(f=b(regeneratorRuntime.mark(function R(){var T,D,O,M,F;return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return T=this.badCaseDetector_.getMonitorFreeze(),re.next=3,this.stats_.getStatsReport({uplinkConnection:this.uplinkConnection_,downlinkConnections:this.connections_,freezeMap:T});case 3:if(D=re.sent,J.emit(mf,{client:this,stats:D}),this.badCaseDetector_.resetMonitor(),this.signalChannel_){re.next=8;break}return re.abrupt("return");case 8:O=this.signalChannel_.isConnected()?rD(this.userId_):[],M=p(p({str_sdk_version:this.version_,uint64_datetime:new Date().getTime(),msg_user_info:{str_identifier:this.userId_,uint64_tinyid:this.tinyId_},msg_device_info:{uint32_terminal_type:15,str_device_name:navigator.platform,str_os_version:"",uint32_net_type:Wh[this.networkType_]}},D),{},{msg_event_msg:O}),this.signalChannel_.send(h2,M),F=Date.now(),this.lastHeartBeatTime_>0&&F-this.lastHeartBeatTime_>1e4&&this.log_.warn("heartbeat took ".concat(F-this.lastHeartBeatTime_)),this.lastHeartBeatTime_=F,!this.isRelayChanged_&&this.isRelayMaybeFailed()&&(this.reJoin(),this.isRelayChanged_=!0);case 15:case"end":return re.stop()}},R,this)})),function(){return f.apply(this,arguments)})},{key:"onRemoteStreamAdded",value:function(R){var T=R.content,D=T.userId,O=T.tinyId,M=T.audio,F=T.bigVideo,re=T.auxVideo,pe=T.smallVideo;if(D!==null){this.userMap_.has(D)||(this.userMap_.set(D,new Vp({userId:D,tinyId:O,role:"anchor"})),this.emitter_.emit(dt.PEER_JOIN,{userId:D}));var ve=this.connections_.get(O);if(ve){if(ve.getIsReconnecting())return;this.log_.warn("duplicated stream-added observed, rebuild the connection"),ve.close(),this.connections_.delete(O)}var se={audio:M,video:F,auxiliary:re,smallVideo:pe};this.log_.info("remote peer [".concat(D,"] published stream. trackState: ").concat(JSON.stringify(se))),this.createDownlinkConnection({userId:D,tinyId:O,trackState:se})}else this.log_.warn("received null userId on stream added")}},{key:"createDownlinkConnection",value:function(R){var T=this,D=R.userId,O=R.tinyId,M=R.trackState,F=new uL({userId:D,tinyId:O,client:this,isUplink:!1,signalChannel:this.signalChannel_,autoSubscribe:this.autoSubscribe_,trackState:M,enableSEI:this.enableSEI_});this.connections_.set(O,F),this.installDownlinkEvents(F,D,O),this.autoSubscribe_?(F.initialize(),F.connect().catch(function(){!F.getMainStream()&&F.hasMainStream()&&T.initRemoteStream({type:St,userId:D,downlinkConnection:F}),!F.getAuxStream()&&F.hasAuxStream()&&T.initRemoteStream({type:Nt,userId:D,downlinkConnection:F})})):(F.hasMainStream()&&this.initRemoteStream({type:St,userId:D,downlinkConnection:F}),F.hasAuxStream()&&this.initRemoteStream({type:Nt,userId:D,downlinkConnection:F}))}},{key:"initRemoteStream",value:function(R){var T=R.type,D=R.userId,O=R.downlinkConnection,M=new Up({type:T,userId:D,client:this});M.setConnection(O),O.setRemoteStream(T===St?dr:_s,M),M.setIsStreamAddedEventEmitted(!0),J.emit(Tu,{client:this,stream:M}),this.emitter_.emit(dt.STREAM_ADDED,{stream:M})}},{key:"installDownlinkEvents",value:function(R,T,D){var O=this;R.on(it.SEI_MESSAGE,function(M){O.emitter_.emit(dt.SEI_MESSAGE,M)}),R.on(it.STREAM_ADDED,function(M){M.stream.setIsStreamAddedEventEmitted(!0),J.emit(Tu,{client:O,stream:M.stream}),O.emitter_.emit(dt.STREAM_ADDED,{stream:M.stream})}),R.on(it.STREAM_REMOVED,function(M){O.changeBigSmallRecords_.delete(M.stream.getUserId()),M.stream.stop(),M.stream.setIsStreamAddedEventEmitted(!1),O.subscriptionManager_&&O.subscriptionManager_.deleteAutoRecoveryFlag(M.stream.getUserId(),M.stream.getType()),J.emit(Is,{client:O,stream:M.stream}),O.emitter_.emit(dt.STREAM_REMOVED,{stream:M.stream})}),R.on(it.STREAM_UPDATED,function(M){J.emit(BP,{client:O,stream:M.stream}),O.emitter_.emit(dt.STREAM_UPDATED,{stream:M.stream})}),R.on(it.STREAM_SUBSCRIBED,function(M){J.emit(Dr,{client:O,stream:M.stream}),O.emitter_.emit(dt.STREAM_SUBSCRIBED,{stream:M.stream})}),R.on(it.ERROR,function(M){var F=M.getCode();F!==Q.ICE_TRANSPORT_ERROR&&(F===Q.DOWNLINK_RECONNECTION_FAILED&&O.closeDownLink(D),O.emitter_.emit(dt.ERROR,M))})}},{key:"onPeerJoin",value:function(R){var T=R.data.data,D=T.srcTinyId,O=T.userId,M=T.role;this.userMap_.has(O)||(this.userMap_.set(O,new Vp({userId:O,tinyId:D,role:M})),this.emitter_.emit(dt.PEER_JOIN,{userId:O}))}},{key:"onPeerLeave",value:function(R){var T=R.data.data,D=T.srcTinyId,O=T.userId,M=T.reason,F=M===void 0?0:M;this.log_.info("peer leave [".concat(O,"]: ").concat(PA[F])),this.cleanUser({userId:O,tinyId:D})}},{key:"cleanUser",value:function(R){var T=R.userId,D=R.tinyId;this.userMap_.delete(T),this.closeDownLink(D),this.emitter_.emit(dt.PEER_LEAVE,{userId:T})}},{key:"onPublishedUserList",value:function(R){var T=this;try{var D=R.data.userList.map(function(O){return O.userId});this.connections_.forEach(function(O){var M=O.getUserId(),F=O.getTinyId();D.findIndex(function(re){return re===M})<0&&(T.log_.info("peer unpublished detected [".concat(M,"]")),T.closeDownLink(F))}),R.data.userList.forEach(function(O){var M=O.userId,F=O.srcTinyId,re=O.flag;if(M!==T.userId_){var pe=!!(1&re),ve=!!(8&re),se=!!(4&re),Ne=!!(2&re),_e=T.connections_.get(F);if(T.changeBigSmallRecords_.has(M)&&T.checkSubscribeBigSmallVideo(_e,Ne),_e){var Je=_e.getTrackState(),$e=Je.audio,Re=Je.video,nt=Je.auxiliary,At=Je.smallVideo;!Re&&pe&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:li,kind:Ue}),!$e&&ve&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:li,kind:Pe}),!nt&&se&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:li,kind:ur}),!At&&Ne&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:li,kind:cu}),Re&&!pe&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:Wi,kind:Ue}),$e&&!ve&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:Wi,kind:Pe}),nt&&!se&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:Wi,kind:ur}),At&&!Ne&&J.emit(Vn,{client:T,tinyId:F,userId:M,action:Wi,kind:cu})}else T.log_.info("peer published detected [".concat(M,"]")),T.onRemoteStreamAdded({content:{audio:ve,bigVideo:pe,auxVideo:se,smallVideo:Ne,userId:M,tinyId:F}})}})}catch{}}},{key:"onUpdateRemoteMuteStat",value:function(R){var T=this,D=R.data;(D&&D.userList||[]).forEach(function(O){var M=O.srcTinyId,F=O.userId;if(M!==0&&M!==T.tinyId_){var re=T.connections_.get(M);if(re){var pe=re.getMainStream();if(pe&&pe.getIsStreamAddedEventEmitted()){var ve=!!(1&O.flag),se=!!(8&O.flag),Ne=!!(2&O.flag),_e=!!(64&O.flag),Je=!!(16&O.flag),$e=T.mutedStates_.get(M);if($e===void 0)return T.mutedStates_.set(M,{hasAudio:se,hasVideo:ve,hasSmall:Ne,audioMuted:_e,videoMuted:Je}),ve?Je?T.emitter_.emit(dt.MUTE_VIDEO,{userId:F}):T.emitter_.emit(dt.UNMUTE_VIDEO,{userId:F}):T.emitter_.emit(dt.MUTE_VIDEO,{userId:F}),void(se?_e?T.emitter_.emit(dt.MUTE_AUDIO,{userId:F}):T.emitter_.emit(dt.UNMUTE_AUDIO,{userId:F}):T.emitter_.emit(dt.MUTE_AUDIO,{userId:F}));var Re=!_e&&se;(!$e.audioMuted&&$e.hasAudio)!==Re&&(Re?T.emitter_.emit(dt.UNMUTE_AUDIO,{userId:F}):T.emitter_.emit(dt.MUTE_AUDIO,{userId:F}));var nt=!Je&&ve;(!$e.videoMuted&&$e.hasVideo)!==nt&&(nt?T.emitter_.emit(dt.UNMUTE_VIDEO,{userId:F}):T.emitter_.emit(dt.MUTE_VIDEO,{userId:F})),T.mutedStates_.set(M,{hasAudio:se,hasVideo:ve,hasSmall:Ne,audioMuted:_e,videoMuted:Je})}}else T.mutedStates_.delete(M)}})}},{key:"getEnv",value:function(){return this.env_}},{key:"getSubscriptionManager",value:function(){return this.subscriptionManager_}},{key:"startPublishCDNStream",value:(h=b(regeneratorRuntime.mark(function R(){var T,D=arguments;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(T=D.length>0&&D[0]!==void 0?D[0]:{},this.log_.info("startPublishCDNStream params: ".concat(JSON.stringify(T),"; isJoined: ").concat(this.isJoined_,"; isPublished: ").concat(!!this.localStream_)),this.localStream_){O.next=4;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:gx})});case 4:return O.next=6,this.publishCDNManager_.startPublishTencentCDN(T);case 6:if(!(T.appId&&T.bizId&&T.url)){O.next=9;break}return O.next=9,this.publishCDNManager_.startPublishGivenCDN(T);case 9:case"end":return O.stop()}},R,this)})),function(){return h.apply(this,arguments)})},{key:"stopPublishCDNStream",value:(l=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(this.publishCDNManager_.getIsPublishingTencentCDN()){T.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:vx})});case 2:return this.log_.info("stopPublishCDNStream"),T.next=5,this.publishCDNManager_.stopPublishTencentCDN();case 5:if(!this.publishCDNManager_.getIsPublishingGivenCDN()){T.next=8;break}return T.next=8,this.publishCDNManager_.stopPublishGivenCDN();case 8:case"end":return T.stop()}},R,this)})),function(){return l.apply(this,arguments)})},{key:"startMixTranscode",value:(u=b(regeneratorRuntime.mark(function R(T){return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(this.isJoined_&&this.mixTranscodeManager_){D.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:yx})});case 2:return fe(T.mode)&&(T.mode=zh.MANUAL),D.prev=3,this.log_.info("startMixTranscode with config ".concat(JSON.stringify(T))),Se.uploadEvent({log:"mix-transcode-mode:".concat(T.mode),userId:this.userId_}),D.next=8,this.mixTranscodeManager_.startMixTranscode(T);case 8:Se.logSuccessEvent({userId:this.userId_,eventType:Zy}),D.next=15;break;case 11:throw D.prev=11,D.t0=D.catch(3),Se.logFailedEvent({userId:this.userId_,eventType:Zy,error:D.t0}),D.t0;case 15:case"end":return D.stop()}},R,this,[[3,11]])})),function(R){return u.apply(this,arguments)})},{key:"stopMixTranscode",value:(a=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(this.isJoined_&&this.mixTranscodeManager_){T.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:bx})});case 2:return T.prev=2,T.next=5,this.mixTranscodeManager_.stopMixTranscode();case 5:Se.logSuccessEvent({userId:this.userId_,eventType:e0}),T.next=12;break;case 8:throw T.prev=8,T.t0=T.catch(2),Se.logFailedEvent({userId:this.userId_,eventType:e0,error:T.t0}),T.t0;case 12:case"end":return T.stop()}},R,this,[[2,8]])})),function(){return a.apply(this,arguments)})},{key:"getSystemResult",value:function(){return this.checkSystemResult_}},{key:"enableAudioVolumeEvaluation",value:function(){var R=this,T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,D=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!xr(T))throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Sx})});if(this.log_.info("enableAudioVolumeEvaluation with interval: "+T),T<=0)return this.enableAudioVolumeEvaluation_=!1,zt.clearInterval(this.audioVolumeIntervalId_),void(this.audioVolumeIntervalId_=null);T=Math.floor(Math.max(T,16)),J.emit(bf,{interval:T}),this.audioVolumeIntervalId_&&(zt.clearInterval(this.audioVolumeIntervalId_),this.audioVolumeIntervalId_=null),this.enableAudioVolumeEvaluation_=!0,this.audioVolumeIntervalId_=zt.setInterval(function(){var O=[];if(R.localStream_){var M=Math.floor(100*R.localStream_.getAudioLevel());O.push({userId:R.userId_,audioVolume:M,stream:R.localStream_})}R.connections_.forEach(function(F){var re=F.getSubscribedMainStream();if(re){var pe=Math.floor(100*re.getAudioLevel());O.push({userId:F.getUserId(),audioVolume:pe,stream:re})}}),R.emitter_.emit(dt.AUDIO_VOLUME,{result:O})},T,D)}},{key:"callExperimentalAPI",value:function(R,T){return SL.call(R,p({client:this},T))}},{key:"setProperty",value:function(R,T){var D="".concat(R,"_");fe(this[D])||(this[D]=T)}},{key:"uploadAllCallStats",value:function(){var R=this;this.callDurationCalculator_.getDurationMap().forEach(function(T,D){var O={userId:T.userId,type:T.type,duration:R.callDurationCalculator_.getDuration(D,Ue),dataFreeze:R.badCaseDetector_.getDataFreezeDuration(D).dataFreeze,renderFreeze:R.badCaseDetector_.getRenderFreezeDuration(D).renderFreeze};Se.uploadEvent({log:"callStats-"+JSON.stringify(O),userId:R.userId_})}),this.badCaseDetector_.stop(),this.callDurationCalculator_.reset()}},{key:"enableSmallStream",value:(c=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!this.isPublished()&&!this.isPublishing_){T.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:kx})});case 2:if(!Db()){T.next=7;break}this.setIsEnableSmallStream(!0),this.log_.info("SmallStream successfully enabled"),T.next=8;break;case 7:throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Tx})});case 8:case"end":return T.stop()}},R,this)})),function(){return c.apply(this,arguments)})},{key:"disableSmallStream",value:(o=b(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!this.isPublished()&&!this.isPublishing_){T.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Ix})});case 2:this.setIsEnableSmallStream(!1),this.log_.info("SmallStream successfully disabled");case 4:case"end":return T.stop()}},R,this)})),function(){return o.apply(this,arguments)})},{key:"setSmallStreamProfile",value:function(R){var T=this;R&&R.framerate&&(R.frameRate=R.framerate),Object.keys(this.smallStreamConfig_).forEach(function(pe){R[pe]&&(T.smallStreamConfig_[pe]=R[pe])}),this.log_.info("setSmallStreamProfile: bitrate=".concat(this.smallStreamConfig_.bitrate,", frameRate=").concat(this.smallStreamConfig_.frameRate,", height=").concat(this.smallStreamConfig_.height,", width=").concat(this.smallStreamConfig_.width));var D=this.smallStreamConfig_,O=D.width,M=D.height,F=D.bitrate,re=D.frameRate;if(O<0||M<0||F<0||re<0)throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:wx})})}},{key:"setRemoteVideoStreamType",value:(i=b(regeneratorRuntime.mark(function R(T,D){return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:O.t0=D,O.next=O.t0==="big"||O.t0==="small"?3:6;break;case 3:return O.next=5,this.changeVideoType(T,D);case 5:case 6:return O.abrupt("break",7);case 7:case"end":return O.stop()}},R,this)})),function(R,T){return i.apply(this,arguments)})},{key:"changeVideoType",value:(n=b(regeneratorRuntime.mark(function R(T,D){var O,M;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(T instanceof Up){F.next=2;break}throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Ex})});case 2:if(T.getConnection()){F.next=4;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Kh})});case 4:O=T.getUserId(),M={stream:T,options:{video:D==="big",smallVideo:D==="small"},isSubscribing:!1,reSubscribeCount:10},this.changeBigSmallRecords_.set(O,M),this.log_.info("set [".concat(O,"] ").concat(T.getType()," stream video prefer type: ").concat(D));case 9:case"end":return F.stop()}},R,this)})),function(R,T){return n.apply(this,arguments)})},{key:"checkSubscribeBigSmallVideo",value:(t=b(regeneratorRuntime.mark(function R(T,D){var O,M,F,re,pe,ve,se,Ne,_e,Je,$e;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(T.isBigStreamSubscribed||T.isSmallStreamSubscribed){Re.next=2;break}return Re.abrupt("return");case 2:if(O=T.getUserId(),M=this.changeBigSmallRecords_.get(O)||{},F=T.getSubscribeState(),re=F.video,pe=F.smallVideo,ve=M.stream,se=M.options,Ne=M.isSubscribing,_e=M.reSubscribeCount,!(se.video&&re||se.smallVideo&&pe&&D)){Re.next=8;break}return Re.abrupt("return");case 8:if(!Ne){Re.next=10;break}return Re.abrupt("return");case 10:if(Je={video:se.video,smallVideo:se.smallVideo},!(D&&T.isBigStreamSubscribed||T.isSmallStreamSubscribed)){Re.next=30;break}if(Re.prev=12,!(se&&ve&&!Ne&&_e>=1)){Re.next=23;break}return M.isSubscribing=!0,M.reSubscribeCount=_e-1,$e=ve.getConnection(),!D&&$e.isSmallStreamSubscribed&&(Je={video:!0,smallVideo:!1}),Re.next=20,$e==null?void 0:$e.subscribe(ve,Je);case 20:this.log_.info("change [".concat(O,"] to ").concat(Je.smallVideo?"small":"big"," video successfully. count ").concat(10-M.reSubscribeCount,".")),M.isSubscribing=!1,M.reSubscribeCount=10;case 23:Re.next=30;break;case 25:Re.prev=25,Re.t0=Re.catch(12),this.log_.info("change [".concat(O,"] to ").concat(Je.smallVideo?"small":"big"," video failed. count ").concat(10-M.reSubscribeCount,".")),M.isSubscribing=!1,_e===0&&this.changeBigSmallRecords_.delete(O);case 30:case"end":return Re.stop()}},R,this,[[12,25]])})),function(R,T){return t.apply(this,arguments)})},{key:"setIsEnableSmallStream",value:function(R){this.isEnableSmallStream_=R}},{key:"getIsEnableSmallStream",value:function(){return this.isEnableSmallStream_}},{key:"smallStreamConfig",get:function(){return this.smallStreamConfig_}},{key:"isPublished",value:function(){return!!this.localStream_}},{key:"getUplinkConnection",value:function(){return this.uplinkConnection_}},{key:"getLocalStream",value:function(){return this.localStream_}},{key:"getMode",value:function(){return this.mode_}},{key:"getBadCaseDetector",value:function(){return this.badCaseDetector_}},{key:"getCallDurationCalculator",value:function(){return this.callDurationCalculator_}},{key:"getIsJoined",value:function(){return this.isJoined_}},{key:"getAllConnections",value:function(){var R=Ke(this.connections_.values());return this.uplinkConnection_&&R.push(this.uplinkConnection_),R}},{key:"isRelayMaybeFailed",value:function(){var R=this.getAllConnections();if(R.length===0)return!1;for(var T=0;T<R.length;T++)if(R[T].getReconnectionCount()<6)return!1;return!0}},{key:"getUseStringRoomId",value:function(){return this.useStringRoomId_}},{key:"checkConnectionsToReconnect",value:function(){var R=this;this.getAllConnections().forEach(function(T){if(!T.getIsReconnecting()){var D=T.getPeerConnection();D&&D.connectionState===jh&&(R.log_.warn("[".concat(T.getUserId(),"] pc is closed but not reconnect")),T.startReconnection())}})}},{key:"getEnableAutoPlayDialog",value:function(){return this.enableAutoPlayDialog_}},{key:"sendSEIMessage",value:function(R,T){this.uplinkConnection_.sendSEI(R,T)}}]),e}()).prototype,"join",[g1,v1],Object.getOwnPropertyDescriptor(ct.prototype,"join"),ct.prototype),ze(ct.prototype,"leave",[_1],Object.getOwnPropertyDescriptor(ct.prototype,"leave"),ct.prototype),ze(ct.prototype,"publish",[y1,b1],Object.getOwnPropertyDescriptor(ct.prototype,"publish"),ct.prototype),ze(ct.prototype,"unpublish",[S1,k1],Object.getOwnPropertyDescriptor(ct.prototype,"unpublish"),ct.prototype),ze(ct.prototype,"subscribe",[I1],Object.getOwnPropertyDescriptor(ct.prototype,"subscribe"),ct.prototype),ze(ct.prototype,"unsubscribe",[T1],Object.getOwnPropertyDescriptor(ct.prototype,"unsubscribe"),ct.prototype),ze(ct.prototype,"switchRole",[w1,E1],Object.getOwnPropertyDescriptor(ct.prototype,"switchRole"),ct.prototype),ze(ct.prototype,"startPublishCDNStream",[C1],Object.getOwnPropertyDescriptor(ct.prototype,"startPublishCDNStream"),ct.prototype),ze(ct.prototype,"startMixTranscode",[R1],Object.getOwnPropertyDescriptor(ct.prototype,"startMixTranscode"),ct.prototype),ze(ct.prototype,"sendSEIMessage",[A1,x1],Object.getOwnPropertyDescriptor(ct.prototype,"sendSEIMessage"),ct.prototype),ct),Hp=Xo({retryFunction:function(){var e=b(regeneratorRuntime.mark(function t(n){var i,o,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!ra()){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,IL(n);case 4:if(i=a.sent,ye.info("getUserMedia with constraints: "+JSON.stringify(i)),!i.audio){a.next=11;break}return a.next=9,vt.getMicrophones();case 9:o=a.sent,ye.info("microphones: ".concat(JSON.stringify(o)));case 11:if(!i.video){a.next=16;break}return a.next=14,vt.getCameras();case 14:c=a.sent,ye.info("cameras: ".concat(JSON.stringify(c)));case 16:return a.prev=16,a.next=19,navigator.mediaDevices.getUserMedia(i);case 19:return a.abrupt("return",a.sent);case 22:if(a.prev=22,a.t0=a.catch(16),a.t0.name!=="NotFoundError"){a.next=29;break}if(!c||c.length!==0){a.next=27;break}throw new Y({code:Q.DEVICE_NOT_FOUND,message:Z({key:cP})});case 27:if(!o||o.length!==0){a.next=29;break}throw new Y({code:Q.DEVICE_NOT_FOUND,message:Z({key:sP})});case 29:throw new Y({code:Q.INITIALIZE_FAILED,name:a.t0.name,message:a.t0.message,constraint:a.t0.constraint});case 30:case"end":return a.stop()}},t,null,[[16,22]])}));return function(t){return e.apply(this,arguments)}}(),settings:{retries:3,timeout:500},onError:function(e,t,n){e.name==="NotReadableError"?t():n(e)},onRetrying:function(e){ye.warn("getUserMedia NotReadableError observed, retrying [".concat(e,"/3]"))}});function IL(e){return P1.apply(this,arguments)}function P1(){return(P1=b(regeneratorRuntime.mark(function e(t){var n,i,o,c,a,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(n={echoCancellation:t.echoCancellation,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression},t.audio){l.next=5;break}n=!1,l.next=15;break;case 5:if(ea(t.microphoneId)){l.next=9;break}n=p({deviceId:{exact:t.microphoneId},sampleRate:t.sampleRate,channelCount:t.channelCount},n),l.next=15;break;case 9:return n=p({sampleRate:t.sampleRate,channelCount:t.channelCount},n),l.next=12,vt.getMicrophones();case 12:i=l.sent,(o=i.filter(function(h){return h.deviceId.length>0})).length>0&&(n.deviceId={exact:o[0].deviceId});case 15:return c={},a={ideal:t.width,max:t.width},u={ideal:t.height,max:t.height},c=!fe(t.facingMode)&&t.video?{facingMode:t.facingMode,width:a,height:u,frameRate:t.frameRate}:!ea(t.cameraId)&&t.video?{deviceId:{exact:t.cameraId},width:a,height:u,frameRate:t.frameRate}:!!t.video&&(!!fe(t.width)||{width:a,height:u,frameRate:t.frameRate}),l.abrupt("return",{audio:n,video:c});case 20:case"end":return l.stop()}},e)}))).apply(this,arguments)}var TL=function(){var e=b(regeneratorRuntime.mark(function t(n){var i,o,c,a,u,l,h,f,m;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!ra()){g.next=2;break}return g.abrupt("return");case 2:if(i=null,!(ou&&GR<74||Bo)){g.next=27;break}return o=$p(n),ye.info("getDisplayMedia with constraints: "+JSON.stringify(o)),g.next=8,navigator.mediaDevices.getDisplayMedia(o);case 8:if(c=g.sent,!n.screenAudio){g.next=14;break}return ye.warn("Your browser not support capture system audio"),g.abrupt("return",c);case 14:if(!n.audio){g.next=24;break}return a=D1(n),ye.info("getUserMedia with constraints: "+JSON.stringify(a)),g.next=19,navigator.mediaDevices.getUserMedia(a);case 19:return i=g.sent,c.addTrack(i.getAudioTracks()[0]),g.abrupt("return",c);case 24:return g.abrupt("return",c);case 25:g.next=53;break;case 27:if(!n.screenAudio){g.next=37;break}return n.audioConstraints={echoCancellation:!0,noiseSuppression:!0,sampleRate:44100},u=$p(n),ye.info("getDisplayMedia with constraints: "+JSON.stringify(u)),g.next=33,navigator.mediaDevices.getDisplayMedia(u);case 33:return l=g.sent,g.abrupt("return",l);case 37:return h=$p(n),ye.info("getDisplayMedia with constraints: "+JSON.stringify(h)),g.next=41,navigator.mediaDevices.getDisplayMedia(h);case 41:if(f=g.sent,!n.audio){g.next=52;break}return m=D1(n),ye.info("getUserMedia with constraints: "+JSON.stringify(m)),g.next=47,navigator.mediaDevices.getUserMedia(m);case 47:return i=g.sent,f.addTrack(i.getAudioTracks()[0]),g.abrupt("return",f);case 52:return g.abrupt("return",f);case 53:case"end":return g.stop()}},t)}));return function(t){return e.apply(this,arguments)}}();function D1(e){var t={echoCancellation:e.echoCancellation,autoGainControl:e.autoGainControl,noiseSuppression:e.noiseSuppression,sampleRate:e.sampleRate,channelCount:e.channelCount};return fe(e.microphoneId)||(t.deviceId={exact:e.microphoneId}),{audio:t,video:!1}}function $p(e){var t={},n={width:{ideal:e.width,max:e.width},height:{ideal:e.height,max:e.height},frameRate:e.frameRate};return fe(e.screenSource)||(n.displaySurface=e.screenSource),t.video=n,fe(e.audioConstraints)||(t.audio=e.audioConstraints),t}var O1,N1,Zi,L1,M1,eo,zp=new Map([["120p",{width:160,height:120,frameRate:15,bitrate:200}],["120p_2",{width:160,height:120,frameRate:15,bitrate:100}],["180p",{width:320,height:180,frameRate:15,bitrate:350}],["180p_2",{width:320,height:180,frameRate:15,bitrate:150}],["240p",{width:320,height:240,frameRate:15,bitrate:400}],["240p_2",{width:320,height:240,frameRate:15,bitrate:200}],["360p",{width:640,height:360,frameRate:15,bitrate:800}],["360p_2",{width:640,height:360,frameRate:15,bitrate:400}],["480p",{width:640,height:480,frameRate:15,bitrate:900}],["480p_2",{width:640,height:480,frameRate:15,bitrate:500}],["720p",{width:1280,height:720,frameRate:15,bitrate:1500}],["1080p",{width:1920,height:1080,frameRate:15,bitrate:2e3}],["1440p",{width:2560,height:1440,frameRate:30,bitrate:4860}],["4K",{width:3840,height:2160,frameRate:30,bitrate:9e3}]]),Wp=new Map([["480p",{width:640,height:480,frameRate:5,bitrate:900}],["480p_2",{width:640,height:480,frameRate:30,bitrate:1e3}],["720p",{width:1280,height:720,frameRate:5,bitrate:1200}],["720p_2",{width:1280,height:720,frameRate:30,bitrate:3e3}],["1080p",{width:1920,height:1080,frameRate:5,bitrate:1600}],["1080p_2",{width:1920,height:1080,frameRate:30,bitrate:4e3}]]),U1=new Map([["standard",{sampleRate:48e3,channelCount:1,bitrate:40}],["standard-stereo",{sampleRate:48e3,channelCount:2,bitrate:64}],["high",{sampleRate:48e3,channelCount:1,bitrate:128}],["high-stereo",{sampleRate:48e3,channelCount:2,bitrate:192}]]),wL=(O1=gr.apply(void 0,Ke(bn.LOCAL_STREAM.switchDevice)),N1=Qu(bn.LOCAL_STREAM.setAudioCaptureVolume),ze((Zi=function(e){$(g,e);var t,n,i,o,c,a,u,l,h,f,m=Ye(g);function g(v){var I;w(this,g);var S=p(p({},v),{isRemote:!1,type:"local"});return(I=m.call(this,S)).name_=Gh,I.client_=null,I.video_=v.video,I.audio_=v.audio,I.cameraId_=v.cameraId,I.cameraGroupId_="",I.facingMode_=v.facingMode,I.microphoneId_=v.microphoneId,I.microphoneGroupId_="",I.videoSource_=v.videoSource,I.audioSource_=v.audioSource,I.screen_=v.screen,I.screenSource_=v.screenSource,I.screenAudio_=v.screenAudio,I.audioProfile_={echoCancellation:!!fe(v.echoCancellation)||v.echoCancellation,autoGainControl:!!fe(v.autoGainControl)||v.autoGainControl,noiseSuppression:!!fe(v.noiseSuppression)||v.noiseSuppression,sampleRate:48e3,channelCount:1,bitrate:40},I.videoProfile_=zp.get("480p_2"),I.screenProfile_=Wp.get("1080p"),I.videoSetting_=null,I.muteState_={video:!1,audio:!1,auxVideo:!1},I.beautyStatus_=!1,I.recoverCaptureCount_=0,I.initState(),I.canvas_=null,I.canvasInterval_=-1,I.gain_={audioTrack:null,source:null,gainNode:null},I.captureVolume_=100,I.log_.info("stream created: "+I.id_),I}return P(g,[{key:"initState",value:function(){this.isAddingTrack_=!1,this.isRemovingTrack_=!1,this.setIsReadyToPublish(!1),this.setPublishState(a0)}},{key:"installEvents",value:function(){Ae(W(g.prototype),"installEvents",this).call(this),J.on(If,this.onStreamPublished,this),J.on(Pf,this.onVideoTrackStopped,this),J.on(Ts,this.onVideoTrackStopped,this),J.on(Of,this.onAudioTrackStopped,this),J.on(Df,this.onAudioTrackStopped,this)}},{key:"uninstallEvents",value:function(){Ae(W(g.prototype),"uninstallEvents",this).call(this),J.off(If,this.onStreamPublished,this),J.off(Pf,this.onVideoTrackStopped,this),J.off(Ts,this.onVideoTrackStopped,this),J.off(Of,this.onAudioTrackStopped,this),J.off(Df,this.onAudioTrackStopped,this)}},{key:"initialize",value:function(){var v=this;return new Promise(function(I,S){if(ia())S(new Y({code:Q.INVALID_OPERATION,message:Z({key:g0})}));else{if(fe(v.audio_)){var y=new MediaStream;return fe(v.audioSource_)||(y.addTrack(v.audioSource_),v.updateAudioPlayingState(!0)),fe(v.videoSource_)||(y.addTrack(v.videoSource_),v.updateVideoPlayingState(!0)),v.setMediaStream(y),Se.logSuccessEvent({userId:v.client_?v.client_.getUserId():v.userId_,eventType:ys,kind:"custom"}),v.setIsReadyToPublish(!0),I()}v.screen_?(v.log_.info("initialize stream audio: "+v.audio_+" screenAudio: "+v.screenAudio_+" screen: "+v.screen_),TL({audio:v.audio_,screenAudio:v.screenAudio_,microphoneId:v.microphoneId_,screenSource:v.screenSource_,width:v.screenProfile_.width,height:v.screenProfile_.height,frameRate:v.screenProfile_.frameRate,sampleRate:v.audioProfile_.sampleRate,channelCount:v.audioProfile_.channelCount,autoGainControl:v.audioProfile_.autoGainControl,noiseSuppression:v.audioProfile_.noiseSuppression,echoCancellation:v.audioProfile_.echoCancellation}).then(function(E){v.setMediaStream(E),v.updateAudioPlayingState(v.audio_||v.screenAudio_),v.updateVideoPlayingState(!0);var C=v.getVideoTrack();return v.listenForScreenSharingStopped(C),v.setVideoContentHint(xy),v.updateDeviceIdInUse(),v.setIsReadyToPublish(!0),v.log_.info(JSON.stringify(C.getSettings())),Se.logSuccessEvent({userId:v.client_?v.client_.getUserId():v.userId_,eventType:ys,kind:"getDisplayMedia"}),I()}).catch(function(E){Se.logFailedEvent({userId:v.client_?v.client_.getUserId():v.userId_,eventType:ys,kind:"getDisplayMedia",error:E}),v.log_.error("getDisplayMedia error observed "+E),S(E instanceof Y?E:new Y({code:Q.INITIALIZE_FAILED,name:E.name,message:E.message}))})):(J.emit(Tf,{stream:v,audio:v.audio_,video:v.video_}),v.log_.info("initialize stream audio: "+v.audio_+" video: "+v.video_),Hp({audio:v.audio_,video:v.video_,facingMode:v.facingMode_,cameraId:v.cameraId_,microphoneId:v.microphoneId_,width:v.videoProfile_.width,height:v.videoProfile_.height,frameRate:v.videoProfile_.frameRate,sampleRate:v.audioProfile_.sampleRate,channelCount:v.audioProfile_.channelCount,autoGainControl:v.audioProfile_.autoGainControl,noiseSuppression:v.audioProfile_.noiseSuppression,echoCancellation:v.audioProfile_.echoCancellation}).then(function(E){J.emit(wf,{stream:v,audio:v.audio_,video:v.video_}),v.setMediaStream(E);var C=v.getVideoTrack();return C&&(oa&&(v.videoSetting_=C.getSettings()),SD&&v.log_.info("video capabilities: "+JSON.stringify(C.getCapabilities()))),v.updateAudioPlayingState(v.audio_),v.updateVideoPlayingState(v.video_),v.updateDeviceIdInUse(),v.log_.info("gotStream hasAudio: "+v.hasAudio()+" hasVideo: "+v.hasVideo()),v.setIsReadyToPublish(!0),Se.logSuccessEvent({userId:v.client_?v.client_.getUserId():v.userId_,eventType:ys,kind:"getUserMedia"}),I()}).catch(function(E){J.emit(Ef,{stream:v,audio:v.audio_,video:v.video_,error:E}),Se.logFailedEvent({userId:v.client_?v.client_.getUserId():v.userId_,eventType:ys,kind:"getUserMedia",error:E}),v.log_.error("getUserMedia error observed "+E),S(E)}))}})}},{key:"listenForScreenSharingStopped",value:function(v){var I=this;v.addEventListener("ended",function(S){I.log_.info("screen sharing was stopped because the video track is ended"),I.emitter_.emit(kD)})}},{key:"muteAudio",value:function(){var v=Ae(W(g.prototype),"muteAudio",this).call(this);return v&&(this.log_.info("localStream mute audio"),this.sendMutedFlag(Pe,!0)),v}},{key:"muteVideo",value:function(){var v=Ae(W(g.prototype),"muteVideo",this).call(this);return v&&(this.log_.info("localStream mute video"),this.sendMutedFlag(Ue,!0)),v}},{key:"unmuteAudio",value:function(){var v=Ae(W(g.prototype),"unmuteAudio",this).call(this);return v&&(this.log_.info("localStream unmute audio"),this.sendMutedFlag(Pe,!1)),v}},{key:"unmuteVideo",value:function(){var v=Ae(W(g.prototype),"unmuteVideo",this).call(this);return v&&(this.log_.info("localStream unmute video"),this.sendMutedFlag(Ue,!1)),v}},{key:"sendMutedFlag",value:function(v,I){this.setMuteState(v,I);var S=this.getConnection();if(S){S.sendMutedFlag(this.muteState_);var y=S.getUserId(),E=S.getTinyId(),C="".concat(I?pn:lr," local ").concat(v," track");gn(y,{eventId:v===Pe?I?C2:A2:I?R2:x2,eventDesc:C,timestamp:ln(),userId:y,tinyId:E})}}},{key:"setMuteState",value:function(v,I){this.muteState_[v]=I,this.log_.info("set ".concat(v," muted state: [").concat(I?"mute":"unmute","]"))}},{key:"setAudioProfile",value:function(v){var I;_(v)==="object"?I=v:(I=U1.get(v))===void 0&&(I=U1.get("standard")),this.log_.info("setAudioProfile: "+JSON.stringify(I)),this.audioProfile_=p(p({},this.audioProfile_),I)}},{key:"setVideoProfile",value:(f=b(regeneratorRuntime.mark(function v(I){var S,y,E;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!this.connection_||qf()){C.next=2;break}throw new Y({code:Q.NOT_SUPPORTED,message:Z({key:iP})});case 2:if(Gi(I)?S=p(p({},this.videoProfile_),I):Jt(I)&&(S=zp.get(I),fe(S)&&(S=zp.get("480p_2"))),S&&S.width*S.height>921600&&KR&&(S.width=1280,S.height=720,this.log_.warn("reset to 1280 * 720 on iOS 13~14")),this.log_.info("setVideoProfile "+JSON.stringify(S)),!(y=this.getVideoTrack())){C.next=9;break}return C.next=9,y.applyConstraints(S);case 9:if(E=this.videoProfile_.bitrate!==S.bitrate,this.videoProfile_=S,!E||!this.connection_){C.next=15;break}return C.next=14,this.connection_.setBandwidth(S.bitrate,Ue);case 14:this.connection_.updateMediaSettings(this.mediaStream_);case 15:case"end":return C.stop()}},v,this)})),function(v){return f.apply(this,arguments)})},{key:"getVideoBitrate",value:function(){return this.screen_?this.screenProfile_.bitrate:this.videoProfile_.bitrate}},{key:"getAudioBitrate",value:function(){return this.audioProfile_.bitrate}},{key:"setScreenProfile",value:function(v){var I=v;Jt(v)&&(I=Wp.get(v)||Wp.get("1080p")),this.log_.info("setScreenProfile "+JSON.stringify(v)),this.screenProfile_=I}},{key:"getVideoProfile",value:function(){return this.screen_?this.screenProfile_:this.videoProfile_}},{key:"getAudioProfile",value:function(){return this.audioProfile_}},{key:"setVideoContentHint",value:function(v){var I=this.getVideoTrack();I&&"contentHint"in I&&(this.log_.info("set video track contentHint to: "+v),I.contentHint=v,I.contentHint!==v&&this.log_.warn("Invalid video track contentHint: "+v))}},{key:"switchDevice",value:(h=b(regeneratorRuntime.mark(function v(I,S){var y,E,C,x,U,G,H,V,j,q,K,De,R,T,D,O,M;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(y=I===Pe)){F.next=8;break}if(this.microphoneId_!==S){F.next=4;break}return F.abrupt("return");case 4:this.microphoneId_=S,this.audio_=!0,F.next=12;break;case 8:if(this.cameraId_!==S){F.next=10;break}return F.abrupt("return");case 10:S===Ry||S===Ay?this.facingMode_=S:this.cameraId_=S,this.video_=!0;case 12:if(this.getMediaStream()){F.next=14;break}return F.abrupt("return");case 14:return this.setIsReadyToPublish(!1),this.log_.info("switchDevice "+I+" to: "+S),y||((E=this.getVideoTrack())&&E.stop(),Oh&&(C=this.getAudioTrack())&&(this.log_.info("stop audio track first in huawei env"),C.stop())),y&&(x=this.getAudioTrack(),U=this.getMicrophoneTrackMixed(),x&&x.stop(),U&&U.stop()),F.next=20,Hp({audio:this.audio_&&I===Pe||Oh,video:this.video_&&I===Ue,facingMode:S===Ry||S===Ay?S:void 0,cameraId:this.cameraId_,microphoneId:this.microphoneId_,width:this.videoProfile_.width,height:this.videoProfile_.height,frameRate:this.videoProfile_.frameRate,sampleRate:this.audioProfile_.sampleRate,channelCount:this.audioProfile_.channelCount});case 20:if(G=F.sent,H=null,!y){F.next=27;break}(V=G.getAudioTracks()[0])&&this.isAudioTrackMixed()?(j=this.getAudioTrack(),q=vt.AudioMixerPlugin.getAudioTrackMap(),K=vt.AudioMixerPlugin.mix({targetTrack:V,sourceList:q.get(j.id).sourceList,trackList:q.get(j.id).trackList}),H=K):H=V,F.next=36;break;case 27:if(!(H=G.getVideoTracks()[0])||!this.isVideoTrackBeautified()){F.next=32;break}return F.next=31,this.generateBeautyTrack(H);case 31:H=F.sent;case 32:if(!(De=G.getAudioTracks()[0])||!Oh){F.next=36;break}return F.next=36,this.replaceTrack_(De);case 36:return F.next=38,this.replaceTrack_(H);case 38:this.updateDeviceIdInUse(),(R=this.getConnection())&&(T=R.getUserId(),D=R.getTinyId(),O=D2,M="switch camera",y&&(O=O2,M="switch microphone"),gn(T,{eventId:O,eventDesc:M,timestamp:ln(),userId:T,tinyId:D})),this.log_.info("switch ".concat(y?"microphone":"camera"," success ")),this.setIsReadyToPublish(!0);case 43:case"end":return F.stop()}},v,this)})),function(v,I){return h.apply(this,arguments)})},{key:"addTrack",value:(l=b(regeneratorRuntime.mark(function v(I){var S,y,E;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!this.isAddingTrack_){C.next=2;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:xx})});case 2:if(!this.isRemovingTrack_){C.next=4;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Px})});case 4:if(this.publishState_!==bs){C.next=6;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Dx})});case 6:if(S=this.getMediaStream()){C.next=9;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:m0})});case 9:if(!(I.kind===Pe&&S.getAudioTracks().length>0||I.kind===Ue&&S.getVideoTracks().length>0)){C.next=11;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Ox})});case 11:if(I.kind===Ue&&oa&&(y=I.getSettings(),!this.videoSetting_||y.width===this.videoSetting_.width&&y.height===this.videoSetting_.height||this.log_.warn("video resolution of the track (".concat(y.width," x ").concat(y.height,") shall be kept the same as the previous: ").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,". It may cause abnormal Cloud Recording."))),C.prev=12,this.isAddingTrack_=!0,this.keepMuteState(I),S.addTrack(I),!(E=this.getConnection())){C.next=20;break}return C.next=20,E.addTrack(I);case 20:I.kind===Pe?(this.audio_=!0,this.updateAudioPlayingState(!0)):(this.video_=!0,this.updateVideoPlayingState(!0)),this.isAddingTrack_=!1,C.next=29;break;case 24:throw C.prev=24,C.t0=C.catch(12),S.removeTrack(I),this.isAddingTrack_=!1,C.t0;case 29:case"end":return C.stop()}},v,this,[[12,24]])})),function(v){return l.apply(this,arguments)})},{key:"removeTrack",value:(u=b(regeneratorRuntime.mark(function v(I){var S,y;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(I.kind!==Pe){E.next=2;break}throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Nx})});case 2:if(!this.isAddingTrack_){E.next=4;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Lx})});case 4:if(!this.isRemovingTrack_){E.next=6;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Mx})});case 6:if(this.publishState_!==bs){E.next=8;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Ux})});case 8:if(S=this.getMediaStream()){E.next=11;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:m0})});case 11:if(S.getTracks().indexOf(I)!==-1){E.next=13;break}throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:Vx})});case 13:if(S.getTracks().length!==1){E.next=15;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Fx})});case 15:if(E.prev=15,this.isRemovingTrack_=!0,!(y=this.getConnection())){E.next=21;break}return E.next=21,y.removeTrack(I);case 21:S.removeTrack(I),I.kind===Pe?(this.audio_=!1,this.updateAudioPlayingState(!1)):(this.video_=!1,this.updateVideoPlayingState(!1)),this.isRemovingTrack_=!1,E.next=30;break;case 26:throw E.prev=26,E.t0=E.catch(15),this.isRemovingTrack_=!1,E.t0;case 30:case"end":return E.stop()}},v,this,[[15,26]])})),function(v){return u.apply(this,arguments)})},{key:"replaceTrack",value:(a=b(regeneratorRuntime.mark(function v(I){var S,y,E;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(S=this.getMediaStream()){C.next=3;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Ax})});case 3:if(this.publishState_!==bs){C.next=5;break}throw new Y({code:Q.INVALID_OPERATION,message:Z({key:Qh})});case 5:if(!(I.kind===Pe&&S.getAudioTracks().length<=0||I.kind===Ue&&S.getVideoTracks().length<=0)){C.next=7;break}throw new Y({code:Q.INVALID_PARAMETER,message:Z({key:jx,data:I})});case 7:if(I.kind===Ue&&oa&&(y=I.getSettings(),!this.videoSetting_||y.width===this.videoSetting_.width&&y.height===this.videoSetting_.height||this.log_.warn("video resolution of the track (".concat(y.width," x ").concat(y.height,") shall be kept the same as the previous: ").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,". It may cause abnormal Cloud Recording."))),this.keepMuteState(I),I.kind!==Pe){C.next=18;break}if(S.removeTrack(S.getAudioTracks()[0]),S.addTrack(I),Ae(W(g.prototype),"restartAudio",this).call(this),!this.gain_.gainNode){C.next=16;break}return this.reconnectGainNode(I),C.abrupt("return");case 16:C.next=21;break;case 18:S.removeTrack(S.getVideoTracks()[0]),S.addTrack(I),Ae(W(g.prototype),"restartVideo",this).call(this);case 21:if(!(E=this.getConnection())){C.next=25;break}return C.next=25,E.replaceTrack(I);case 25:case"end":return C.stop()}},v,this)})),function(v){return a.apply(this,arguments)})},{key:"updateStream",value:(c=b(regeneratorRuntime.mark(function v(I){var S,y,E,C,x,U,G,H,V,j,q,K,De,R,T;return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(this.mediaStream_){D.next=2;break}return D.abrupt("return");case 2:return this.log_.info("updateStream() try to recover local stream"),D.prev=3,D.next=6,vt.getCameras();case 6:return S=D.sent,D.next=9,vt.getMicrophones();case 9:if(y=D.sent,E=this.audio_&&I.audio,(C=this.video_&&I.video)&&S.length===0&&(C=!1,this.log_.info("updateStream() video flag is true, but no camera detected, set video to false")),E&&y.length===0&&(E=!1,this.log_.info("updateStream() audio flag is true, but no microphone detected, set audio to false")),E!==!1||C!==!1){D.next=17;break}return this.log_.info("updateStream() both audio and video are false, recover stream aborted"),D.abrupt("return");case 17:return x=I&&S.findIndex(function(O){return O.deviceId===I.cameraId})>=0,U=I&&y.findIndex(function(O){return O.deviceId===I.microphoneId})>=0,D.next=21,Hp({audio:E,video:C,cameraId:x?I.cameraId:void 0,microphoneId:U?I.microphoneId:void 0,facingMode:this.facingMode_,width:this.videoProfile_.width,height:this.videoProfile_.height,frameRate:this.videoProfile_.frameRate,sampleRate:this.audioProfile_.sampleRate,channelCount:this.audioProfile_.channelCount});case 21:G=D.sent,H=G.getTracks(),V=0;case 24:if(!(V<H.length)){D.next=49;break}if((j=H[V]).kind!==Pe||!this.isAudioTrackMixed()){D.next=37;break}if(q=this.getAudioTrack(),K=vt.AudioMixerPlugin.getAudioTrackMap(),(De=K.get(q.id)).hasMicrophone){D.next=33;break}return j.stop(),D.abrupt("continue",46);case 33:return R=vt.AudioMixerPlugin.mix({targetTrack:j,sourceList:De.sourceList,trackList:De.trackList}),D.next=36,this.replaceTrack_(R);case 36:return D.abrupt("continue",46);case 37:if(j.kind!==Ue||!this.isVideoTrackBeautified()){D.next=44;break}return D.next=40,this.generateBeautyTrack(j);case 40:return T=D.sent,D.next=43,this.replaceTrack_(T);case 43:return D.abrupt("continue",46);case 44:return D.next=46,this.replaceTrack_(j);case 46:V++,D.next=24;break;case 49:this.updateDeviceIdInUse(),Se.logSuccessEvent({userId:this.client_?this.client_.getUserId():this.userId_,eventType:Yy}),this.log_.info("updateStream() recover local stream successfully"),this.emitter_.emit(TD,{isCamera:I.video,isMicrophone:I.audio,cameraId:this.cameraId_,microphoneId:this.microphoneId_}),D.next=60;break;case 55:D.prev=55,D.t0=D.catch(3),Se.logFailedEvent({userId:this.client_?this.client_.getUserId():this.userId_,eventType:Yy,error:D.t0}),this.log_.error("updateStream() failed to recover local stream, "+D.t0),this.emitter_.emit(Xf,new Y({code:Q.DEVICE_AUTO_RECOVER_FAILED,message:D.t0.message}));case 60:case"end":return D.stop()}},v,this,[[3,55]])})),function(v){return c.apply(this,arguments)})},{key:"replaceTrack_",value:(o=b(regeneratorRuntime.mark(function v(I){var S,y,E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(S=this.mediaStream_.getAudioTracks(),y=this.mediaStream_.getVideoTracks(),!(I.kind===Pe&&S.length<=0||I.kind===Ue&&y.length<=0)){x.next=5;break}return this.log_.info("there is no previous ".concat(I.kind," track, replacement ignored")),x.abrupt("return");case 5:if(this.keepMuteState(I),I.kind!==Pe){x.next=15;break}if(this.mediaStream_.removeTrack(S[0]),this.mediaStream_.addTrack(I),Ae(W(g.prototype),"restartAudio",this).call(this),!this.gain_.gainNode){x.next=13;break}return this.reconnectGainNode(I),x.abrupt("return");case 13:x.next=19;break;case 15:oa&&(E=I.getSettings(),!this.videoSetting_||E.width===this.videoSetting_.width&&E.height===this.videoSetting_.height||this.log_.warn("the resolution of video track to be replaced (".concat(E.width," x ").concat(E.height,") is different from the previous video settings (").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,"). It may cause a cloud recording exception"))),this.mediaStream_.removeTrack(y[0]),this.mediaStream_.addTrack(I),Ae(W(g.prototype),"restartVideo",this).call(this);case 19:if(!(C=this.getConnection())){x.next=23;break}return x.next=23,C.replaceTrack(I);case 23:case"end":return x.stop()}},v,this)})),function(v){return o.apply(this,arguments)})},{key:"updateDeviceIdInUse",value:function(){var v=this;if(!this.mediaStream_)return this.cameraId_="",this.cameraGroupId_="",this.microphoneId_="",void(this.microphoneGroupId_="");oa&&this.mediaStream_.getTracks().forEach(function(y){if(y.kind===Pe&&v.isAudioTrackMixed()){var E=v.getMicrophoneTrackMixed();if(E){var C=E.getSettings(),x=C.deviceId,U=C.groupId;x&&(v.microphoneId_=x,v.microphoneGroupId_=U)}}else if(y.kind===Ue&&v.isVideoTrackBeautified()){var G=v.getBeautyOriginTrack();if(G){var H=G.getSettings(),V=H.deviceId,j=H.groupId;V&&(v.cameraId_=V,v.cameraGroupId_=j)}}else{var q=y.getSettings(),K=q.deviceId,De=q.groupId;K&&(y.kind===Pe?(v.microphoneId_=K,v.microphoneGroupId_=De):y.kind!==Ue||v.screen_||(v.cameraId_=K,v.cameraGroupId_=De))}});var I=this.mediaStream_.getAudioTracks(),S=this.mediaStream_.getVideoTracks();I&&I.length===0&&(this.microphoneId_="",this.microphoneGroupId_=""),S&&S.length===0&&(this.cameraId_="",this.cameraGroupId_="")}},{key:"isAudioTrackMixed",value:function(){if(vt.AudioMixerPlugin){var v=vt.AudioMixerPlugin.getAudioTrackMap(),I=this.getAudioTrack();if(v&&I&&v.has(I.id))return!0}return!1}},{key:"getMicrophoneTrackMixed",value:function(){if(vt.AudioMixerPlugin){var v=vt.AudioMixerPlugin.getAudioTrackMap(),I=this.getAudioTrack();if(v&&I&&v.has(I.id)){var S=v.get(I.id);return S.hasMicrophone?S.microphoneTrack:null}}return null}},{key:"isVideoTrackBeautified",value:function(){if(vt.beautyTrackMap){var v=vt.beautyTrackMap,I=this.getVideoTrack();if(I&&v.has(I.id))return!0}return!1}},{key:"getBeautyOriginTrack",value:function(){if(vt.beautyTrackMap){var v=vt.beautyTrackMap,I=this.getVideoTrack();if(I&&v.has(I.id)){var S=v.get(I.id);if(S.originTrack)return S.originTrack}}return null}},{key:"generateBeautyTrack",value:(i=b(regeneratorRuntime.mark(function v(I){var S,y,E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(S=null,y=this.getVideoTrack(),E=vt.beautyTrackMap.get(y.id),C=E.param,E.type){x.next=8;break}S=E.pluginInstance.generateBeautyTrack(I),x.next=22;break;case 8:x.t0=E.type,x.next=x.t0==="beauty"?11:x.t0==="virtual"?13:x.t0==="mixed"?17:21;break;case 11:return S=E.pluginInstance.generateBeautyTrack(I),x.abrupt("break",22);case 13:return x.next=15,E.pluginInstance.generateVirtualTrack({videoTrack:I,type:C.type,img:C.img});case 15:return S=x.sent,x.abrupt("break",22);case 17:return x.next=19,E.pluginInstance.generateMixedTrack({videoTrack:I,type:C.type,img:C.img});case 19:return S=x.sent,x.abrupt("break",22);case 21:return x.abrupt("break",22);case 22:return E.pluginInstance.deleteSource(y.id),this.log_.info("regenerate beauty track, track id = ".concat(I.id)),x.abrupt("return",S);case 25:case"end":return x.stop()}},v,this)})),function(v){return i.apply(this,arguments)})},{key:"getScreen",value:function(){return this.screen_}},{key:"hasScreenTrack",value:function(){if(this.screen_)return!0;var v=this.getVideoTrack();return!!v&&(v.contentHint===xy||v.contentHint===XR)}},{key:"getVideo",value:function(){return this.video_}},{key:"getAudio",value:function(){return this.audio_}},{key:"getCameraId",value:function(){return this.cameraId_}},{key:"getMicrophoneId",value:function(){return this.microphoneId_}},{key:"getMicrophoneGroupId",value:function(){return this.microphoneGroupId_}},{key:"getIsReadyToPublish",value:function(){return this.isReadyToPublish_}},{key:"setIsReadyToPublish",value:function(v){this.isReadyToPublish_=v}},{key:"setPublishState",value:function(v){this.publishState_=v}},{key:"setBeautyStatus",value:function(v){this.beautyStatus_=!!v}},{key:"getBeautyStatus",value:function(){return this.beautyStatus_}},{key:"onStreamPublished",value:function(v){var I=v.localStream,S=v.client;I===this&&(this.client_=S,this.log_.setUserId(S.getUserId()),this.log_.setSdkAppId(S.getSDKAppId()),this.syncMuteState())}},{key:"syncMuteState",value:function(){var v=this.getAudioTrack(),I=this.getVideoTrack();if(v){var S=!v.enabled;this.setMuteState(Pe,S)}if(I){var y=!I.enabled;this.setMuteState(Ue,y)}this.connection_&&this.connection_.sendMutedFlag(this.muteState_)}},{key:"keepMuteState",value:function(v){v instanceof MediaStreamTrack&&this.muteState_[v.kind]&&(v.enabled=!1,this.log_.warn("prev ".concat(v.kind," track is muted, keep mute state")))}},{key:"onVideoTrackStopped",value:(n=b(regeneratorRuntime.mark(function v(I){var S,y,E,C;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(S=I.stream,y=I.type,!(S!==this||!this.video_||!this.cameraId_||this.recoverCaptureCount_>10||(jo||Bi||Bo)&&y===pn)){x.next=3;break}return x.abrupt("return");case 3:if(!(E=this.getVideoTrack())){x.next=11;break}return C=E.getSettings().deviceId,x.next=8,vt.getCameras();case 8:if(!(x.sent.findIndex(function(U){return U.deviceId===C})<0)){x.next=11;break}return x.abrupt("return");case 11:this.recoverCaptureCount_+=1,Se.uploadEvent({log:"stat-local-video-".concat(y),userId:this.userId_}),this.updateStream({audio:!1,video:!0,cameraId:this.cameraId_});case 14:case"end":return x.stop()}},v,this)})),function(v){return n.apply(this,arguments)})},{key:"onAudioTrackStopped",value:(t=b(regeneratorRuntime.mark(function v(I){var S,y,E,C,x,U;return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(S=I.stream,y=I.type,!(S!==this||!this.audio_||!this.microphoneId_||this.recoverCaptureCount_>10||(jo||Bi||Bo)&&y===pn)){G.next=3;break}return G.abrupt("return");case 3:if(!(E=this.getAudioTrack())){G.next=11;break}return C=E.getSettings(),x=C.groupId,U=C.deviceId,G.next=8,vt.getMicrophones();case 8:if(!(G.sent.findIndex(function(H){return H.deviceId===U&&(fe(x)||x===H.groupId)})<0)){G.next=11;break}return G.abrupt("return");case 11:this.recoverCaptureCount_+=1,Se.uploadEvent({log:"stat-local-audio-".concat(y),userId:this.userId_}),this.updateStream({audio:!0,video:!1,microphoneId:this.microphoneId_});case 14:case"end":return G.stop()}},v,this)})),function(v){return t.apply(this,arguments)})},{key:"setAudioVolume",value:function(v){Ae(W(g.prototype),"setAudioVolume",this).call(this,v)}},{key:"clearCanvas",value:function(){this.canvasInterval_&&(zt.clearInterval(this.canvasInterval_),this.canvasInterval_=-1,this.canvas_=null)}},{key:"genCanvasTrack",value:function(v){var I=this;this.log_.info("gen canvas track");var S=v.getSettings(),y=S.width,E=S.height,C=S.frameRate;this.canvas_=document.createElement("canvas");var x=this.canvas_.getContext("2d");return this.canvas_.width=y,this.canvas_.height=E,this.canvasInterval_=zt.setInterval(function(){if(I.hasVideo()){var U=I.getVideoTrack().getSettings();U.width===I.canvas_.width&&U.height===I.canvas_.height||(I.canvas_.width=U.width,I.canvas_.height=U.height)}I.videoPlayer_&&I.videoPlayer_.element_&&x.drawImage(I.videoPlayer_.element_,0,0,I.canvas_.width,I.canvas_.height)},Math.max(66,Math.floor(1e3/C))),this.canvas_.captureStream().getVideoTracks()[0]}},{key:"setClient",value:function(v){this.client_=v}},{key:"setAudioCaptureVolume",value:function(){var v=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!this.hasAudio()||I<0||!xb())return!1;if(this.captureVolume_===I)return!0;this.captureVolume_=I,this.log_.info("setCaptureVolume "+I),I/=100;var S=x0();if(this.gain_.gainNode)this.gain_.gainNode.gain.value=I;else{var y,E=new MediaStream;E.addTrack(this.getAudioTrack());var C=S.createMediaStreamDestination(),x=S.createMediaStreamSource(E),U=S.createGain();U.gain.value=I,x.connect(U),U.connect(C);var G=C.stream.getAudioTracks()[0],H=function(V){return v.log_.info("gained audio track ".concat(V))};G.onmute=function(){return H("muted")},G.onunmute=function(){return H("unmuted")},G.onended=function(){return H("ended")},this.gain_={source:x,audioTrack:G,gainNode:U},(y=this.connection_)===null||y===void 0||y.replaceTrack(G),Ae(W(g.prototype),"restartAudio",this).call(this)}return!0}},{key:"getGainedTrack",value:function(){return this.gain_.audioTrack}},{key:"reconnectGainNode",value:function(v){this.log_.warn("reconnect gain node");var I=new MediaStream;I.addTrack(v);var S=x0().createMediaStreamSource(I);S.connect(this.gain_.gainNode),this.gain_.source.disconnect(),this.gain_.source=S}},{key:"close",value:function(){var v=this.gain_,I=v.audioTrack,S=v.source,y=v.gainNode;y&&(S.disconnect(),y.disconnect(),I.onmute=null,I.onunmute=null,I.onended=null,I.stop(),this.gain_={source:null,gainNode:null,audioTrack:null}),Ae(W(g.prototype),"close",this).call(this)}}]),g}(l1)).prototype,"switchDevice",[O1],Object.getOwnPropertyDescriptor(Zi.prototype,"switchDevice"),Zi.prototype),ze(Zi.prototype,"setAudioCaptureVolume",[N1],Object.getOwnPropertyDescriptor(Zi.prototype,"setAudioCaptureVolume"),Zi.prototype),Zi),EL=0,CL=0,vt=new(L1=Qu(bn.TRTC.createClient),M1=Qu(bn.TRTC.createStream),ze((eo=function(){function e(){w(this,e),this.name_=EA,this.VERSION="4.14.1",this.Logger={loggerManager:ye,LogLevel:Un,setLogLevel:function(a){ye.setLogLevel(a),a<=1&&yP()},enableUploadLog:function(){ye.enableUploadLog()},disableUploadLog:function(){ye.warn("disableUploadLog"),ye.disableUploadLog()}}}var t,n,i,o,c;return P(e,[{key:"checkSystemRequirements",value:(c=b(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Jf();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a)})),function(){return c.apply(this,arguments)})},{key:"isScreenShareSupported",value:function(){return Cb()}},{key:"isSmallStreamSupported",value:function(){return Db()}},{key:"getDevices",value:(o=b(regeneratorRuntime.mark(function a(){var u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!ia()&&!ra()){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,navigator.mediaDevices.enumerateDevices();case 4:return u=l.sent,l.abrupt("return",u.filter(function(h){return h.kind!==vs||h.deviceId!="communications"}).map(function(h,f){var m=h.label;h.label||(m=h.kind+"_"+f);var g={label:m,deviceId:h.deviceId,kind:h.kind};return h.groupId&&(g.groupId=h.groupId),g}));case 6:case"end":return l.stop()}},a)})),function(){return o.apply(this,arguments)})},{key:"getCameras",value:(i=b(regeneratorRuntime.mark(function a(){var u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!ia()&&!ra()){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,navigator.mediaDevices.enumerateDevices();case 4:return u=l.sent,l.abrupt("return",u.filter(function(h){return h.kind===Vh}).map(function(h,f){var m=h.label;h.label||(m="camera_"+f);var g={label:m,deviceId:h.deviceId,kind:h.kind};return h.groupId&&(g.groupId=h.groupId),g}));case 6:case"end":return l.stop()}},a)})),function(){return i.apply(this,arguments)})},{key:"getMicrophones",value:(n=b(regeneratorRuntime.mark(function a(){var u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!ia()&&!ra()){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,navigator.mediaDevices.enumerateDevices();case 4:return u=l.sent,l.abrupt("return",u.filter(function(h){return h.kind===vs&&h.deviceId!=="communications"}).map(function(h,f){var m=h.label;h.label||(m="microphone_"+f);var g={label:m,deviceId:h.deviceId,kind:h.kind};return h.groupId&&(g.groupId=h.groupId),g}));case 6:case"end":return l.stop()}},a)})),function(){return n.apply(this,arguments)})},{key:"getSpeakers",value:(t=b(regeneratorRuntime.mark(function a(){var u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!ia()&&!ra()){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,navigator.mediaDevices.enumerateDevices();case 4:return u=l.sent,l.abrupt("return",u.filter(function(h){return h.kind==="audiooutput"}).map(function(h,f){var m=h.label;h.label||(m="speaker_"+f);var g={label:m,deviceId:h.deviceId,kind:h.kind};return h.groupId&&(g.groupId=h.groupId),g}));case 6:case"end":return l.stop()}},a)})),function(){return t.apply(this,arguments)})},{key:"createClient",value:function(a){nb&&(nb=!1,ye.getLogLevel()!=vt.Logger.LogLevel.NONE&&(console.info("******************************************************************************"),console.info("*   TRTC Web SDK"),console.info("*   API Document: "+"".concat(qh,"index.html")),console.info("*   Changelog: https://cloud.tencent.com/document/product/647/38958"),console.info("*   Report issues: https://github.com/LiteAVSDK/TRTC_Web/issues"),console.info("******************************************************************************")),ye.info("TRTC Web SDK Version: 4.14.1"),ye.info("UserAgent: "+navigator.userAgent),ye.info("URL of current page: "+location.href));var u={version:this.VERSION},l=new kL(p(p(p({},u),a),{},{seq:++EL}));return J.emit(Z0,{client:l}),l}},{key:"createStream",value:function(a){return new wL(p(p({},a),{},{seq:++CL}))}}]),e}()).prototype,"createClient",[L1],Object.getOwnPropertyDescriptor(eo.prototype,"createClient"),eo.prototype),ze(eo.prototype,"createStream",[M1],Object.getOwnPropertyDescriptor(eo.prototype,"createStream"),eo.prototype),eo);return vt})})(QI);const Sr=QI.exports,_k={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},Ua="^\\s*",Va="\\s*$",so="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",co="([0-9A-Fa-f])",uo="([0-9A-Fa-f]{2})",a4=new RegExp(`${Ua}rgb\\s*\\(${so},${so},${so}\\)${Va}`),s4=new RegExp(`${Ua}rgba\\s*\\(${so},${so},${so},${so}\\)${Va}`),c4=new RegExp(`${Ua}#${co}${co}${co}${Va}`),u4=new RegExp(`${Ua}#${uo}${uo}${uo}${Va}`),l4=new RegExp(`${Ua}#${co}${co}${co}${co}${Va}`),d4=new RegExp(`${Ua}#${uo}${uo}${uo}${uo}${Va}`);function Sn(r){return parseInt(r,16)}function Da(r){try{let s;if(s=u4.exec(r))return[Sn(s[1]),Sn(s[2]),Sn(s[3]),1];if(s=a4.exec(r))return[rn(s[1]),rn(s[5]),rn(s[9]),1];if(s=s4.exec(r))return[rn(s[1]),rn(s[5]),rn(s[9]),Qs(s[13])];if(s=c4.exec(r))return[Sn(s[1]+s[1]),Sn(s[2]+s[2]),Sn(s[3]+s[3]),1];if(s=d4.exec(r))return[Sn(s[1]),Sn(s[2]),Sn(s[3]),Qs(Sn(s[4])/255)];if(s=l4.exec(r))return[Sn(s[1]+s[1]),Sn(s[2]+s[2]),Sn(s[3]+s[3]),Qs(Sn(s[4]+s[4])/255)];if(r in _k)return Da(_k[r]);throw new Error(`[seemly/rgba]: Invalid color value ${r}.`)}catch(s){throw s}}function h4(r){return r>1?1:r<0?0:r}function f4(r,s,d,p){return`rgba(${rn(r)}, ${rn(s)}, ${rn(d)}, ${h4(p)})`}function em(r,s,d,p,_){return rn((r*s*(1-p)+d*p)/_)}function p4(r,s){Array.isArray(r)||(r=Da(r)),Array.isArray(s)||(s=Da(s));const d=r[3],p=s[3],_=Qs(d+p-d*p);return f4(em(r[0],d,s[0],p,_),em(r[1],d,s[1],p,_),em(r[2],d,s[2],p,_),_)}function cl(r,s){const[d,p,_,k=1]=Array.isArray(r)?r:Da(r),{lightness:b=1,alpha:w=1}=s;return m4([d*b,p*b,_*b,k*w])}function Qs(r){const s=Math.round(Number(r)*100)/100;return s>1?1:s<0?0:s}function rn(r){const s=Math.round(Number(r));return s>255?255:s<0?0:s}function m4(r){const[s,d,p]=r;return 3 in r?`rgba(${rn(s)}, ${rn(d)}, ${rn(p)}, ${Qs(r[3])})`:`rgba(${rn(s)}, ${rn(d)}, ${rn(p)}, 1)`}function g4(r=8){return Math.random().toString(16).slice(2,2+r)}function v4(r,s=[],d){const p={};return Object.getOwnPropertyNames(r).forEach(k=>{s.includes(k)||(p[k]=r[k])}),Object.assign(p,d)}const _4=(r,...s)=>typeof r=="function"?r(...s):typeof r=="string"?kr(r):typeof r=="number"?kr(String(r)):null;function YI(r,s){throw new Error(`[naive/${r}]: ${s}`)}function y4(r){let s=0;for(let d=0;d<r.length;++d)r[d]==="&"&&++s;return s}const XI=/\s*,(?![^(]*\))\s*/g,b4=/\s+/g;function S4(r,s){const d=[];return s.split(XI).forEach(p=>{let _=y4(p);if(_){if(_===1){r.forEach(b=>{d.push(p.replace("&",b))});return}}else{r.forEach(b=>{d.push((b&&b+" ")+p)});return}let k=[p];for(;_--;){const b=[];k.forEach(w=>{r.forEach(A=>{b.push(w.replace("&",A))})}),k=b}k.forEach(b=>d.push(b))}),d}function k4(r,s){const d=[];return s.split(XI).forEach(p=>{r.forEach(_=>{d.push((_&&_+" ")+p)})}),d}function I4(r){let s=[""];return r.forEach(d=>{d=d&&d.trim(),d&&(d.includes("&")?s=S4(s,d):s=k4(s,d))}),s.join(", ").replace(b4," ")}function yk(r){if(!r)return;const s=r.parentElement;s&&s.removeChild(r)}function Ml(r){return document.head.querySelector(`style[cssr-id="${r}"]`)}function T4(r){const s=document.createElement("style");return s.setAttribute("cssr-id",r),s}function ul(r){return r?/^\s*@(s|m)/.test(r):!1}const w4=/[A-Z]/g;function ZI(r){return r.replace(w4,s=>"-"+s.toLowerCase())}function E4(r,s="  "){return typeof r=="object"&&r!==null?` {
`+Object.entries(r).map(d=>s+`  ${ZI(d[0])}: ${d[1]};`).join(`
`)+`
`+s+"}":`: ${r};`}function C4(r,s,d){return typeof r=="function"?r({context:s.context,props:d}):r}function bk(r,s,d,p){if(!s)return"";const _=C4(s,d,p);if(!_)return"";if(typeof _=="string")return`${r} {
${_}
}`;const k=Object.keys(_);if(k.length===0)return d.config.keepEmptyBlock?r+` {
}`:"";const b=r?[r+" {"]:[];return k.forEach(w=>{const A=_[w];if(w==="raw"){b.push(`
`+A+`
`);return}w=ZI(w),A!=null&&b.push(`  ${w}${E4(A)}`)}),r&&b.push("}"),b.join(`
`)}function km(r,s,d){!r||r.forEach(p=>{if(Array.isArray(p))km(p,s,d);else if(typeof p=="function"){const _=p(s);Array.isArray(_)?km(_,s,d):_&&d(_)}else p&&d(p)})}function eT(r,s,d,p,_,k){const b=r.$;let w="";if(!b||typeof b=="string")ul(b)?w=b:s.push(b);else if(typeof b=="function"){const N=b({context:p.context,props:_});ul(N)?w=N:s.push(N)}else if(b.before&&b.before(p.context),!b.$||typeof b.$=="string")ul(b.$)?w=b.$:s.push(b.$);else if(b.$){const N=b.$({context:p.context,props:_});ul(N)?w=N:s.push(N)}const A=I4(s),P=bk(A,r.props,p,_);w?(d.push(`${w} {`),k&&P&&k.insertRule(`${w} {
${P}
}
`)):(k&&P&&k.insertRule(P),!k&&P.length&&d.push(P)),r.children&&km(r.children,{context:p.context,props:_},N=>{if(typeof N=="string"){const $=bk(A,{raw:N},p,_);k?k.insertRule($):d.push($)}else eT(N,s,d,p,_,k)}),s.pop(),w&&d.push("}"),b&&b.after&&b.after(p.context)}function tT(r,s,d,p=!1){const _=[];return eT(r,[],_,s,d,p?r.instance.__styleSheet:void 0),p?"":_.join(`

`)}function Im(r){for(var s=0,d,p=0,_=r.length;_>=4;++p,_-=4)d=r.charCodeAt(p)&255|(r.charCodeAt(++p)&255)<<8|(r.charCodeAt(++p)&255)<<16|(r.charCodeAt(++p)&255)<<24,d=(d&65535)*1540483477+((d>>>16)*59797<<16),d^=d>>>24,s=(d&65535)*1540483477+((d>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(_){case 3:s^=(r.charCodeAt(p+2)&255)<<16;case 2:s^=(r.charCodeAt(p+1)&255)<<8;case 1:s^=r.charCodeAt(p)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function R4(r,s,d){const{els:p}=s;if(d===void 0)p.forEach(yk),s.els=[];else{const _=Ml(d);_&&p.includes(_)&&(yk(_),s.els=p.filter(k=>k!==_))}}function Sk(r,s){r.push(s)}function A4(r,s,d,p,_,k,b,w,A){if(k&&!A){if(d===void 0){console.error("[css-render/mount]: `id` is required in `silent` mode.");return}const W=window.__cssrContext;W[d]||(W[d]=!0,tT(s,r,p,k));return}let P;if(d===void 0&&(P=s.render(p),d=Im(P)),A){A.adapter(d,P!=null?P:s.render(p));return}const N=Ml(d);if(N!==null&&!b)return N;const $=N!=null?N:T4(d);if(P===void 0&&(P=s.render(p)),$.textContent=P,N!==null)return N;if(w){const W=document.head.querySelector(`meta[name="${w}"]`);if(W)return document.head.insertBefore($,W),Sk(s.els,$),$}return _?document.head.insertBefore($,document.head.querySelector("style, link")):document.head.appendChild($),Sk(s.els,$),$}function x4(r){return tT(this,this.instance,r)}function P4(r={}){const{id:s,ssr:d,props:p,head:_=!1,silent:k=!1,force:b=!1,anchorMetaName:w}=r;return A4(this.instance,this,s,p,_,k,b,w,d)}function D4(r={}){const{id:s}=r;R4(this.instance,this,s)}const ll=function(r,s,d,p){return{instance:r,$:s,props:d,children:p,els:[],render:x4,mount:P4,unmount:D4}},O4=function(r,s,d,p){return Array.isArray(s)?ll(r,{$:null},null,s):Array.isArray(d)?ll(r,s,null,d):Array.isArray(p)?ll(r,s,d,p):ll(r,s,d,null)};function N4(r={}){let s=null;const d={c:(...p)=>O4(d,...p),use:(p,..._)=>p.install(d,..._),find:Ml,context:{},config:r,get __styleSheet(){if(!s){const p=document.createElement("style");return document.head.appendChild(p),s=document.styleSheets[document.styleSheets.length-1],s}return s}};return d}function L4(r,s){if(r===void 0)return!1;if(s){const{context:{ids:d}}=s;return d.has(r)}return Ml(r)!==null}function M4(r){let s=".",d="__",p="--",_;if(r){let X=r.blockPrefix;X&&(s=X),X=r.elementPrefix,X&&(d=X),X=r.modifierPrefix,X&&(p=X)}const k={install(X){_=X.c;const ce=X.context;ce.bem={},ce.bem.b=null,ce.bem.els=null}};function b(X){let ce,ge;return{before(be){ce=be.bem.b,ge=be.bem.els,be.bem.els=null},after(be){be.bem.b=ce,be.bem.els=ge},$({context:be,props:Ye}){return X=typeof X=="string"?X:X({context:be,props:Ye}),be.bem.b=X,`${(Ye==null?void 0:Ye.bPrefix)||s}${be.bem.b}`}}}function w(X){let ce;return{before(ge){ce=ge.bem.els},after(ge){ge.bem.els=ce},$({context:ge,props:be}){return X=typeof X=="string"?X:X({context:ge,props:be}),ge.bem.els=X.split(",").map(Ye=>Ye.trim()),ge.bem.els.map(Ye=>`${(be==null?void 0:be.bPrefix)||s}${ge.bem.b}${d}${Ye}`).join(", ")}}}function A(X){return{$({context:ce,props:ge}){X=typeof X=="string"?X:X({context:ce,props:ge});const be=X.split(",").map(Ae=>Ae.trim());function Ye(Ae){return be.map(Xe=>`&${(ge==null?void 0:ge.bPrefix)||s}${ce.bem.b}${Ae!==void 0?`${d}${Ae}`:""}${p}${Xe}`).join(", ")}const at=ce.bem.els;return at!==null?Ye(at[0]):Ye()}}}function P(X){return{$({context:ce,props:ge}){X=typeof X=="string"?X:X({context:ce,props:ge});const be=ce.bem.els;return`&:not(${(ge==null?void 0:ge.bPrefix)||s}${ce.bem.b}${be!==null&&be.length>0?`${d}${be[0]}`:""}${p}${X})`}}}return Object.assign(k,{cB:(...X)=>_(b(X[0]),X[1],X[2]),cE:(...X)=>_(w(X[0]),X[1],X[2]),cM:(...X)=>_(A(X[0]),X[1],X[2]),cNotM:(...X)=>_(P(X[0]),X[1],X[2])}),k}function Hr(r,s){return r+(s==="default"?"":s.replace(/^[a-z]/,d=>d.toUpperCase()))}Hr("abc","def");const U4="n",V4=`.${U4}-`,F4="__",j4="--",nT=N4(),rT=M4({blockPrefix:V4,elementPrefix:F4,modifierPrefix:j4});nT.use(rT);const{c:mt,find:kF}=nT,{cB:Aa,cE:In,cM:yr,cNotM:B4}=rT;function H4(){const r=Kt(!1);return hc(()=>{r.value=!0}),Hm(r)}const iT=Symbol("@css-render/vue3-ssr");function $4(r,s){return`<style cssr-id="${r}">
${s}
</style>`}function z4(r,s){const d=Wn(iT,null);if(d===null){console.error("[css-render/vue3-ssr]: no ssr context found.");return}const{styles:p,ids:_}=d;_.has(r)||p!==null&&(_.add(r),p.push($4(r,s)))}const W4=typeof document<"u";function Ul(){if(W4)return;const r=Wn(iT,null);if(r!==null)return{adapter:z4,context:r}}var G4=typeof global=="object"&&global&&global.Object===Object&&global;const oT=G4;var J4=typeof self=="object"&&self&&self.Object===Object&&self,q4=oT||J4||Function("return this")();const Fa=q4;var K4=Fa.Symbol;const Oa=K4;var aT=Object.prototype,Q4=aT.hasOwnProperty,Y4=aT.toString,Hs=Oa?Oa.toStringTag:void 0;function X4(r){var s=Q4.call(r,Hs),d=r[Hs];try{r[Hs]=void 0;var p=!0}catch{}var _=Y4.call(r);return p&&(s?r[Hs]=d:delete r[Hs]),_}var Z4=Object.prototype,e6=Z4.toString;function t6(r){return e6.call(r)}var n6="[object Null]",r6="[object Undefined]",kk=Oa?Oa.toStringTag:void 0;function fc(r){return r==null?r===void 0?r6:n6:kk&&kk in Object(r)?X4(r):t6(r)}function ja(r){return r!=null&&typeof r=="object"}var i6="[object Symbol]";function o6(r){return typeof r=="symbol"||ja(r)&&fc(r)==i6}function a6(r,s){for(var d=-1,p=r==null?0:r.length,_=Array(p);++d<p;)_[d]=s(r[d],d,r);return _}var s6=Array.isArray;const bl=s6;var c6=1/0,Ik=Oa?Oa.prototype:void 0,Tk=Ik?Ik.toString:void 0;function sT(r){if(typeof r=="string")return r;if(bl(r))return a6(r,sT)+"";if(o6(r))return Tk?Tk.call(r):"";var s=r+"";return s=="0"&&1/r==-c6?"-0":s}function mo(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function cT(r){return r}var u6="[object AsyncFunction]",l6="[object Function]",d6="[object GeneratorFunction]",h6="[object Proxy]";function ng(r){if(!mo(r))return!1;var s=fc(r);return s==l6||s==d6||s==u6||s==h6}var f6=Fa["__core-js_shared__"];const tm=f6;var wk=function(){var r=/[^.]+$/.exec(tm&&tm.keys&&tm.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function p6(r){return!!wk&&wk in r}var m6=Function.prototype,g6=m6.toString;function v6(r){if(r!=null){try{return g6.call(r)}catch{}try{return r+""}catch{}}return""}var _6=/[\\^$.*+?()[\]{}|]/g,y6=/^\[object .+?Constructor\]$/,b6=Function.prototype,S6=Object.prototype,k6=b6.toString,I6=S6.hasOwnProperty,T6=RegExp("^"+k6.call(I6).replace(_6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function w6(r){if(!mo(r)||p6(r))return!1;var s=ng(r)?T6:y6;return s.test(v6(r))}function E6(r,s){return r==null?void 0:r[s]}function rg(r,s){var d=E6(r,s);return w6(d)?d:void 0}var Ek=Object.create,C6=function(){function r(){}return function(s){if(!mo(s))return{};if(Ek)return Ek(s);r.prototype=s;var d=new r;return r.prototype=void 0,d}}();const R6=C6;function A6(r,s,d){switch(d.length){case 0:return r.call(s);case 1:return r.call(s,d[0]);case 2:return r.call(s,d[0],d[1]);case 3:return r.call(s,d[0],d[1],d[2])}return r.apply(s,d)}function x6(r,s){var d=-1,p=r.length;for(s||(s=Array(p));++d<p;)s[d]=r[d];return s}var P6=800,D6=16,O6=Date.now;function N6(r){var s=0,d=0;return function(){var p=O6(),_=D6-(p-d);if(d=p,_>0){if(++s>=P6)return arguments[0]}else s=0;return r.apply(void 0,arguments)}}function L6(r){return function(){return r}}var M6=function(){try{var r=rg(Object,"defineProperty");return r({},"",{}),r}catch{}}();const Sl=M6;var U6=Sl?function(r,s){return Sl(r,"toString",{configurable:!0,enumerable:!1,value:L6(s),writable:!0})}:cT;const V6=U6;var F6=N6(V6);const j6=F6;var B6=9007199254740991,H6=/^(?:0|[1-9]\d*)$/;function uT(r,s){var d=typeof r;return s=s==null?B6:s,!!s&&(d=="number"||d!="symbol"&&H6.test(r))&&r>-1&&r%1==0&&r<s}function ig(r,s,d){s=="__proto__"&&Sl?Sl(r,s,{configurable:!0,enumerable:!0,value:d,writable:!0}):r[s]=d}function Vl(r,s){return r===s||r!==r&&s!==s}var $6=Object.prototype,z6=$6.hasOwnProperty;function W6(r,s,d){var p=r[s];(!(z6.call(r,s)&&Vl(p,d))||d===void 0&&!(s in r))&&ig(r,s,d)}function G6(r,s,d,p){var _=!d;d||(d={});for(var k=-1,b=s.length;++k<b;){var w=s[k],A=p?p(d[w],r[w],w,d,r):void 0;A===void 0&&(A=r[w]),_?ig(d,w,A):W6(d,w,A)}return d}var Ck=Math.max;function J6(r,s,d){return s=Ck(s===void 0?r.length-1:s,0),function(){for(var p=arguments,_=-1,k=Ck(p.length-s,0),b=Array(k);++_<k;)b[_]=p[s+_];_=-1;for(var w=Array(s+1);++_<s;)w[_]=p[_];return w[s]=d(b),A6(r,this,w)}}function q6(r,s){return j6(J6(r,s,cT),r+"")}var K6=9007199254740991;function lT(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=K6}function og(r){return r!=null&&lT(r.length)&&!ng(r)}function Q6(r,s,d){if(!mo(d))return!1;var p=typeof s;return(p=="number"?og(d)&&uT(s,d.length):p=="string"&&s in d)?Vl(d[s],r):!1}function Y6(r){return q6(function(s,d){var p=-1,_=d.length,k=_>1?d[_-1]:void 0,b=_>2?d[2]:void 0;for(k=r.length>3&&typeof k=="function"?(_--,k):void 0,b&&Q6(d[0],d[1],b)&&(k=_<3?void 0:k,_=1),s=Object(s);++p<_;){var w=d[p];w&&r(s,w,p,k)}return s})}var X6=Object.prototype;function dT(r){var s=r&&r.constructor,d=typeof s=="function"&&s.prototype||X6;return r===d}function Z6(r,s){for(var d=-1,p=Array(r);++d<r;)p[d]=s(d);return p}var e5="[object Arguments]";function Rk(r){return ja(r)&&fc(r)==e5}var hT=Object.prototype,t5=hT.hasOwnProperty,n5=hT.propertyIsEnumerable,r5=Rk(function(){return arguments}())?Rk:function(r){return ja(r)&&t5.call(r,"callee")&&!n5.call(r,"callee")};const Tm=r5;function i5(){return!1}var fT=typeof Dn=="object"&&Dn&&!Dn.nodeType&&Dn,Ak=fT&&typeof On=="object"&&On&&!On.nodeType&&On,o5=Ak&&Ak.exports===fT,xk=o5?Fa.Buffer:void 0,a5=xk?xk.isBuffer:void 0,s5=a5||i5;const pT=s5;var c5="[object Arguments]",u5="[object Array]",l5="[object Boolean]",d5="[object Date]",h5="[object Error]",f5="[object Function]",p5="[object Map]",m5="[object Number]",g5="[object Object]",v5="[object RegExp]",_5="[object Set]",y5="[object String]",b5="[object WeakMap]",S5="[object ArrayBuffer]",k5="[object DataView]",I5="[object Float32Array]",T5="[object Float64Array]",w5="[object Int8Array]",E5="[object Int16Array]",C5="[object Int32Array]",R5="[object Uint8Array]",A5="[object Uint8ClampedArray]",x5="[object Uint16Array]",P5="[object Uint32Array]",Tt={};Tt[I5]=Tt[T5]=Tt[w5]=Tt[E5]=Tt[C5]=Tt[R5]=Tt[A5]=Tt[x5]=Tt[P5]=!0;Tt[c5]=Tt[u5]=Tt[S5]=Tt[l5]=Tt[k5]=Tt[d5]=Tt[h5]=Tt[f5]=Tt[p5]=Tt[m5]=Tt[g5]=Tt[v5]=Tt[_5]=Tt[y5]=Tt[b5]=!1;function D5(r){return ja(r)&&lT(r.length)&&!!Tt[fc(r)]}function O5(r){return function(s){return r(s)}}var mT=typeof Dn=="object"&&Dn&&!Dn.nodeType&&Dn,Ys=mT&&typeof On=="object"&&On&&!On.nodeType&&On,N5=Ys&&Ys.exports===mT,nm=N5&&oT.process,L5=function(){try{var r=Ys&&Ys.require&&Ys.require("util").types;return r||nm&&nm.binding&&nm.binding("util")}catch{}}();const Pk=L5;var Dk=Pk&&Pk.isTypedArray,M5=Dk?O5(Dk):D5;const gT=M5;var U5=Object.prototype,V5=U5.hasOwnProperty;function F5(r,s){var d=bl(r),p=!d&&Tm(r),_=!d&&!p&&pT(r),k=!d&&!p&&!_&&gT(r),b=d||p||_||k,w=b?Z6(r.length,String):[],A=w.length;for(var P in r)(s||V5.call(r,P))&&!(b&&(P=="length"||_&&(P=="offset"||P=="parent")||k&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||uT(P,A)))&&w.push(P);return w}function j5(r,s){return function(d){return r(s(d))}}function B5(r){var s=[];if(r!=null)for(var d in Object(r))s.push(d);return s}var H5=Object.prototype,$5=H5.hasOwnProperty;function z5(r){if(!mo(r))return B5(r);var s=dT(r),d=[];for(var p in r)p=="constructor"&&(s||!$5.call(r,p))||d.push(p);return d}function vT(r){return og(r)?F5(r,!0):z5(r)}var W5=rg(Object,"create");const lc=W5;function G5(){this.__data__=lc?lc(null):{},this.size=0}function J5(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}var q5="__lodash_hash_undefined__",K5=Object.prototype,Q5=K5.hasOwnProperty;function Y5(r){var s=this.__data__;if(lc){var d=s[r];return d===q5?void 0:d}return Q5.call(s,r)?s[r]:void 0}var X5=Object.prototype,Z5=X5.hasOwnProperty;function eU(r){var s=this.__data__;return lc?s[r]!==void 0:Z5.call(s,r)}var tU="__lodash_hash_undefined__";function nU(r,s){var d=this.__data__;return this.size+=this.has(r)?0:1,d[r]=lc&&s===void 0?tU:s,this}function po(r){var s=-1,d=r==null?0:r.length;for(this.clear();++s<d;){var p=r[s];this.set(p[0],p[1])}}po.prototype.clear=G5;po.prototype.delete=J5;po.prototype.get=Y5;po.prototype.has=eU;po.prototype.set=nU;function rU(){this.__data__=[],this.size=0}function Fl(r,s){for(var d=r.length;d--;)if(Vl(r[d][0],s))return d;return-1}var iU=Array.prototype,oU=iU.splice;function aU(r){var s=this.__data__,d=Fl(s,r);if(d<0)return!1;var p=s.length-1;return d==p?s.pop():oU.call(s,d,1),--this.size,!0}function sU(r){var s=this.__data__,d=Fl(s,r);return d<0?void 0:s[d][1]}function cU(r){return Fl(this.__data__,r)>-1}function uU(r,s){var d=this.__data__,p=Fl(d,r);return p<0?(++this.size,d.push([r,s])):d[p][1]=s,this}function Gr(r){var s=-1,d=r==null?0:r.length;for(this.clear();++s<d;){var p=r[s];this.set(p[0],p[1])}}Gr.prototype.clear=rU;Gr.prototype.delete=aU;Gr.prototype.get=sU;Gr.prototype.has=cU;Gr.prototype.set=uU;var lU=rg(Fa,"Map");const _T=lU;function dU(){this.size=0,this.__data__={hash:new po,map:new(_T||Gr),string:new po}}function hU(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function jl(r,s){var d=r.__data__;return hU(s)?d[typeof s=="string"?"string":"hash"]:d.map}function fU(r){var s=jl(this,r).delete(r);return this.size-=s?1:0,s}function pU(r){return jl(this,r).get(r)}function mU(r){return jl(this,r).has(r)}function gU(r,s){var d=jl(this,r),p=d.size;return d.set(r,s),this.size+=d.size==p?0:1,this}function Ba(r){var s=-1,d=r==null?0:r.length;for(this.clear();++s<d;){var p=r[s];this.set(p[0],p[1])}}Ba.prototype.clear=dU;Ba.prototype.delete=fU;Ba.prototype.get=pU;Ba.prototype.has=mU;Ba.prototype.set=gU;function vU(r){return r==null?"":sT(r)}var _U=j5(Object.getPrototypeOf,Object);const yT=_U;var yU="[object Object]",bU=Function.prototype,SU=Object.prototype,bT=bU.toString,kU=SU.hasOwnProperty,IU=bT.call(Object);function TU(r){if(!ja(r)||fc(r)!=yU)return!1;var s=yT(r);if(s===null)return!0;var d=kU.call(s,"constructor")&&s.constructor;return typeof d=="function"&&d instanceof d&&bT.call(d)==IU}function wU(r,s,d){var p=-1,_=r.length;s<0&&(s=-s>_?0:_+s),d=d>_?_:d,d<0&&(d+=_),_=s>d?0:d-s>>>0,s>>>=0;for(var k=Array(_);++p<_;)k[p]=r[p+s];return k}function EU(r,s,d){var p=r.length;return d=d===void 0?p:d,!s&&d>=p?r:wU(r,s,d)}var CU="\\ud800-\\udfff",RU="\\u0300-\\u036f",AU="\\ufe20-\\ufe2f",xU="\\u20d0-\\u20ff",PU=RU+AU+xU,DU="\\ufe0e\\ufe0f",OU="\\u200d",NU=RegExp("["+OU+CU+PU+DU+"]");function ST(r){return NU.test(r)}function LU(r){return r.split("")}var kT="\\ud800-\\udfff",MU="\\u0300-\\u036f",UU="\\ufe20-\\ufe2f",VU="\\u20d0-\\u20ff",FU=MU+UU+VU,jU="\\ufe0e\\ufe0f",BU="["+kT+"]",wm="["+FU+"]",Em="\\ud83c[\\udffb-\\udfff]",HU="(?:"+wm+"|"+Em+")",IT="[^"+kT+"]",TT="(?:\\ud83c[\\udde6-\\uddff]){2}",wT="[\\ud800-\\udbff][\\udc00-\\udfff]",$U="\\u200d",ET=HU+"?",CT="["+jU+"]?",zU="(?:"+$U+"(?:"+[IT,TT,wT].join("|")+")"+CT+ET+")*",WU=CT+ET+zU,GU="(?:"+[IT+wm+"?",wm,TT,wT,BU].join("|")+")",JU=RegExp(Em+"(?="+Em+")|"+GU+WU,"g");function qU(r){return r.match(JU)||[]}function KU(r){return ST(r)?qU(r):LU(r)}function QU(r){return function(s){s=vU(s);var d=ST(s)?KU(s):void 0,p=d?d[0]:s.charAt(0),_=d?EU(d,1).join(""):s.slice(1);return p[r]()+_}}var YU=QU("toUpperCase");const XU=YU;function ZU(){this.__data__=new Gr,this.size=0}function e8(r){var s=this.__data__,d=s.delete(r);return this.size=s.size,d}function t8(r){return this.__data__.get(r)}function n8(r){return this.__data__.has(r)}var r8=200;function i8(r,s){var d=this.__data__;if(d instanceof Gr){var p=d.__data__;if(!_T||p.length<r8-1)return p.push([r,s]),this.size=++d.size,this;d=this.__data__=new Ba(p)}return d.set(r,s),this.size=d.size,this}function Ha(r){var s=this.__data__=new Gr(r);this.size=s.size}Ha.prototype.clear=ZU;Ha.prototype.delete=e8;Ha.prototype.get=t8;Ha.prototype.has=n8;Ha.prototype.set=i8;var RT=typeof Dn=="object"&&Dn&&!Dn.nodeType&&Dn,Ok=RT&&typeof On=="object"&&On&&!On.nodeType&&On,o8=Ok&&Ok.exports===RT,Nk=o8?Fa.Buffer:void 0,Lk=Nk?Nk.allocUnsafe:void 0;function a8(r,s){if(s)return r.slice();var d=r.length,p=Lk?Lk(d):new r.constructor(d);return r.copy(p),p}var s8=Fa.Uint8Array;const Mk=s8;function c8(r){var s=new r.constructor(r.byteLength);return new Mk(s).set(new Mk(r)),s}function u8(r,s){var d=s?c8(r.buffer):r.buffer;return new r.constructor(d,r.byteOffset,r.length)}function l8(r){return typeof r.constructor=="function"&&!dT(r)?R6(yT(r)):{}}function d8(r){return function(s,d,p){for(var _=-1,k=Object(s),b=p(s),w=b.length;w--;){var A=b[r?w:++_];if(d(k[A],A,k)===!1)break}return s}}var h8=d8();const f8=h8;function Cm(r,s,d){(d!==void 0&&!Vl(r[s],d)||d===void 0&&!(s in r))&&ig(r,s,d)}function p8(r){return ja(r)&&og(r)}function Rm(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}function m8(r){return G6(r,vT(r))}function g8(r,s,d,p,_,k,b){var w=Rm(r,d),A=Rm(s,d),P=b.get(A);if(P){Cm(r,d,P);return}var N=k?k(w,A,d+"",r,s,b):void 0,$=N===void 0;if($){var W=bl(A),de=!W&&pT(A),X=!W&&!de&&gT(A);N=A,W||de||X?bl(w)?N=w:p8(w)?N=x6(w):de?($=!1,N=a8(A,!0)):X?($=!1,N=u8(A,!0)):N=[]:TU(A)||Tm(A)?(N=w,Tm(w)?N=m8(w):(!mo(w)||ng(w))&&(N=l8(A))):$=!1}$&&(b.set(A,N),_(N,A,p,k,b),b.delete(A)),Cm(r,d,N)}function AT(r,s,d,p,_){r!==s&&f8(s,function(k,b){if(_||(_=new Ha),mo(k))g8(r,s,b,d,AT,p,_);else{var w=p?p(Rm(r,b),k,b+"",r,s,_):void 0;w===void 0&&(w=k),Cm(r,b,w)}},vT)}var v8=Y6(function(r,s,d){AT(r,s,d)});const dl=v8,Bl={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:_8,fontFamily:y8,lineHeight:b8}=Bl,xT=mt("body",`
 margin: 0;
 font-size: ${_8};
 font-family: ${y8};
 line-height: ${b8};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[mt("input",`
 font-family: inherit;
 font-size: inherit;
 `)]),pc="n-config-provider",dc="naive-ui-style";function ag(r,s,d,p,_,k){const b=Ul(),w=Wn(pc,null);if(d){const P=()=>{const N=k==null?void 0:k.value;d.mount({id:N===void 0?s:N+s,head:!0,props:{bPrefix:N?`.${N}-`:void 0},anchorMetaName:dc,ssr:b}),w!=null&&w.preflightStyleDisabled||xT.mount({id:"n-global",head:!0,anchorMetaName:dc,ssr:b})};b?P():Ol(P)}return nn(()=>{var P;const{theme:{common:N,self:$,peers:W={}}={},themeOverrides:de={},builtinThemeOverrides:X={}}=_,{common:ce,peers:ge}=de,{common:be=void 0,[r]:{common:Ye=void 0,self:at=void 0,peers:Ae={}}={}}=(w==null?void 0:w.mergedThemeRef.value)||{},{common:Xe=void 0,[r]:Ke={}}=(w==null?void 0:w.mergedThemeOverridesRef.value)||{},{common:yt,peers:He={}}=Ke,Ge=dl({},N||Ye||be||p.common,Xe,yt,ce),ze=dl((P=$||at||p.self)===null||P===void 0?void 0:P(Ge),X,Ke,de);return{common:Ge,self:ze,peers:dl({},p.peers,Ae,W),peerOverrides:dl({},X.peers,He,ge)}})}ag.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const S8="n";function PT(r={},s={defaultBordered:!0}){const d=Wn(pc,null);return{inlineThemeDisabled:d==null?void 0:d.inlineThemeDisabled,mergedRtlRef:d==null?void 0:d.mergedRtlRef,mergedComponentPropsRef:d==null?void 0:d.mergedComponentPropsRef,mergedBreakpointsRef:d==null?void 0:d.mergedBreakpointsRef,mergedBorderedRef:nn(()=>{var p,_;const{bordered:k}=r;return k!==void 0?k:(_=(p=d==null?void 0:d.mergedBorderedRef.value)!==null&&p!==void 0?p:s.defaultBordered)!==null&&_!==void 0?_:!0}),mergedClsPrefixRef:nn(()=>(d==null?void 0:d.mergedClsPrefixRef.value)||S8),namespaceRef:nn(()=>d==null?void 0:d.mergedNamespaceRef.value)}}function sg(r,s,d){if(!s)return;const p=Ul(),_=Wn(pc,null),k=()=>{const b=d==null?void 0:d.value;s.mount({id:b===void 0?r:b+r,head:!0,anchorMetaName:dc,props:{bPrefix:b?`.${b}-`:void 0},ssr:p}),_!=null&&_.preflightStyleDisabled||xT.mount({id:"n-global",head:!0,anchorMetaName:dc,ssr:p})};p?k():Ol(k)}function k8(r,s,d,p){var _;d||YI("useThemeClass","cssVarsRef is not passed");const k=(_=Wn(pc,null))===null||_===void 0?void 0:_.mergedThemeHashRef,b=Kt(""),w=Ul();let A;const P=`__${r}`,N=()=>{let $=P;const W=s?s.value:void 0,de=k==null?void 0:k.value;de&&($+="-"+de),W&&($+="-"+W);const{themeOverrides:X,builtinThemeOverrides:ce}=p;X&&($+="-"+Im(JSON.stringify(X))),ce&&($+="-"+Im(JSON.stringify(ce))),b.value=$,A=()=>{const ge=d.value;let be="";for(const Ye in ge)be+=`${Ye}: ${ge[Ye]};`;mt(`.${$}`,be).mount({id:$,ssr:w}),A=void 0}};return bI(()=>{N()}),{themeClass:b,onRender:()=>{A==null||A()}}}function I8(r,s,d){if(!s)return;const p=Ul(),_=nn(()=>{const{value:b}=s;if(!b)return;const w=b[r];if(!!w)return w}),k=()=>{bI(()=>{const{value:b}=d,w=`${b}${r}Rtl`;if(L4(w,p))return;const{value:A}=_;!A||A.style.mount({id:w,head:!0,anchorMetaName:dc,props:{bPrefix:b?`.${b}-`:void 0},ssr:p})})};return p?k():Ol(k),_}function mc(r,s){return Zt({name:XU(r),setup(){var d;const p=(d=Wn(pc,null))===null||d===void 0?void 0:d.mergedIconsRef;return()=>{var _;const k=(_=p==null?void 0:p.value)===null||_===void 0?void 0:_[r];return k?k():s}}})}const T8=mc("close",xe("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},xe("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},xe("g",{fill:"currentColor","fill-rule":"nonzero"},xe("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),w8=mc("error",xe("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},xe("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},xe("g",{"fill-rule":"nonzero"},xe("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),E8=mc("info",xe("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},xe("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},xe("g",{"fill-rule":"nonzero"},xe("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),C8=mc("success",xe("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},xe("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},xe("g",{"fill-rule":"nonzero"},xe("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),R8=mc("warning",xe("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},xe("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},xe("g",{"fill-rule":"nonzero"},xe("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),DT=Zt({name:"BaseIconSwitchTransition",setup(r,{slots:s}){const d=H4();return()=>xe(Ll,{name:"icon-switch-transition",appear:d.value},s)}}),A8=Zt({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(r,{slots:s}){function d(w){r.width?w.style.maxWidth=`${w.offsetWidth}px`:w.style.maxHeight=`${w.offsetHeight}px`,w.offsetWidth}function p(w){r.width?w.style.maxWidth="0":w.style.maxHeight="0",w.offsetWidth;const{onLeave:A}=r;A&&A()}function _(w){r.width?w.style.maxWidth="":w.style.maxHeight="";const{onAfterLeave:A}=r;A&&A()}function k(w){if(w.style.transition="none",r.width){const A=w.offsetWidth;w.style.maxWidth="0",w.offsetWidth,w.style.transition="",w.style.maxWidth=`${A}px`}else if(r.reverse)w.style.maxHeight=`${w.offsetHeight}px`,w.offsetHeight,w.style.transition="",w.style.maxHeight="0";else{const A=w.offsetHeight;w.style.maxHeight="0",w.offsetWidth,w.style.transition="",w.style.maxHeight=`${A}px`}w.offsetWidth}function b(w){var A;r.width?w.style.maxWidth="":r.reverse||(w.style.maxHeight=""),(A=r.onAfterEnter)===null||A===void 0||A.call(r)}return()=>{const w=r.group?Y3:Ll;return xe(w,{name:r.width?"fade-in-width-expand-transition":"fade-in-height-expand-transition",mode:r.mode,appear:r.appear,onEnter:k,onAfterEnter:b,onBeforeLeave:d,onLeave:p,onAfterLeave:_},s)}}}),x8=Aa("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[mt("svg",`
 height: 1em;
 width: 1em;
 `)]),OT=Zt({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(r){sg("-base-icon",x8,Wm(r,"clsPrefix"))},render(){return xe("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),P8=Aa("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[yr("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),mt("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),B4("disabled",[mt("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),mt("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),mt("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),mt("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),mt("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),yr("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),yr("round",[mt("&::before",`
 border-radius: 50%;
 `)])]),D8=Zt({name:"BaseClose",props:{clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(r){return sg("-base-close",P8,Wm(r,"clsPrefix")),()=>{const{clsPrefix:s,disabled:d,absolute:p,round:_}=r;return xe("button",{type:"button",tabindex:d||!r.focusable?-1:0,"aria-disabled":d,"aria-label":"close",disabled:d,class:[`${s}-base-close`,p&&`${s}-base-close--absolute`,d&&`${s}-base-close--disabled`,_&&`${s}-base-close--round`],onMousedown:k=>{r.focusable||k.preventDefault()},onClick:r.onClick},xe(OT,{clsPrefix:s},{default:()=>xe(T8,null)}))}}}),{cubicBezierEaseInOut:O8}=Bl;function Am({originalTransform:r="",left:s=0,top:d=0,transition:p=`all .3s ${O8} !important`}={}){return[mt("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:r+" scale(0.75)",left:s,top:d,opacity:0}),mt("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${r}`,left:s,top:d,opacity:1}),mt("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:s,top:d,transition:p})]}const N8=mt([mt("@keyframes loading-container-rotate",`
 to {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }
 `),mt("@keyframes loading-layer-rotate",`
 12.5% {
 -webkit-transform: rotate(135deg);
 transform: rotate(135deg);
 }
 25% {
 -webkit-transform: rotate(270deg);
 transform: rotate(270deg);
 }
 37.5% {
 -webkit-transform: rotate(405deg);
 transform: rotate(405deg);
 }
 50% {
 -webkit-transform: rotate(540deg);
 transform: rotate(540deg);
 }
 62.5% {
 -webkit-transform: rotate(675deg);
 transform: rotate(675deg);
 }
 75% {
 -webkit-transform: rotate(810deg);
 transform: rotate(810deg);
 }
 87.5% {
 -webkit-transform: rotate(945deg);
 transform: rotate(945deg);
 }
 100% {
 -webkit-transform: rotate(1080deg);
 transform: rotate(1080deg);
 } 
 `),mt("@keyframes loading-left-spin",`
 from {
 -webkit-transform: rotate(265deg);
 transform: rotate(265deg);
 }
 50% {
 -webkit-transform: rotate(130deg);
 transform: rotate(130deg);
 }
 to {
 -webkit-transform: rotate(265deg);
 transform: rotate(265deg);
 }
 `),mt("@keyframes loading-right-spin",`
 from {
 -webkit-transform: rotate(-265deg);
 transform: rotate(-265deg);
 }
 50% {
 -webkit-transform: rotate(-130deg);
 transform: rotate(-130deg);
 }
 to {
 -webkit-transform: rotate(-265deg);
 transform: rotate(-265deg);
 }
 `),Aa("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[In("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[Am()]),In("container",`
 display: inline-flex;
 position: relative;
 direction: ltr;
 line-height: 0;
 animation: loading-container-rotate 1568.2352941176ms linear infinite;
 font-size: 0;
 letter-spacing: 0;
 white-space: nowrap;
 opacity: 1;
 width: 100%;
 height: 100%;
 `,[In("svg",`
 stroke: var(--n-text-color);
 fill: transparent;
 position: absolute;
 height: 100%;
 overflow: hidden;
 `),In("container-layer",`
 position: absolute;
 width: 100%;
 height: 100%;
 animation: loading-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 `,[In("container-layer-left",`
 display: inline-flex;
 position: relative;
 width: 50%;
 height: 100%;
 overflow: hidden;
 `,[In("svg",`
 animation: loading-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 width: 200%;
 `)]),In("container-layer-patch",`
 position: absolute;
 top: 0;
 left: 47.5%;
 box-sizing: border-box;
 width: 5%;
 height: 100%;
 overflow: hidden;
 `,[In("svg",`
 left: -900%;
 width: 2000%;
 transform: rotate(180deg);
 `)]),In("container-layer-right",`
 display: inline-flex;
 position: relative;
 width: 50%;
 height: 100%;
 overflow: hidden;
 `,[In("svg",`
 animation: loading-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 left: -100%;
 width: 200%;
 `)])])]),In("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[Am({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})])])]),L8=Zt({name:"BaseLoading",props:{clsPrefix:{type:String,required:!0},scale:{type:Number,default:1},radius:{type:Number,default:100},strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0},show:{type:Boolean,default:!0}},setup(r){sg("-base-loading",N8,Wm(r,"clsPrefix"))},render(){const{clsPrefix:r,radius:s,strokeWidth:d,stroke:p,scale:_}=this,k=s/_;return xe("div",{class:`${r}-base-loading`,role:"img","aria-label":"loading"},xe(DT,null,{default:()=>this.show?xe("div",{key:"icon",class:`${r}-base-loading__transition-wrapper`},xe("div",{class:`${r}-base-loading__container`},xe("div",{class:`${r}-base-loading__container-layer`},xe("div",{class:`${r}-base-loading__container-layer-left`},xe("svg",{class:`${r}-base-loading__svg`,viewBox:`0 0 ${2*k} ${2*k}`,xmlns:"http://www.w3.org/2000/svg",style:{color:p}},xe("circle",{fill:"none",stroke:"currentColor","stroke-width":d,"stroke-linecap":"round",cx:k,cy:k,r:s-d/2,"stroke-dasharray":4.91*s,"stroke-dashoffset":2.46*s}))),xe("div",{class:`${r}-base-loading__container-layer-patch`},xe("svg",{class:`${r}-base-loading__svg`,viewBox:`0 0 ${2*k} ${2*k}`,xmlns:"http://www.w3.org/2000/svg",style:{color:p}},xe("circle",{fill:"none",stroke:"currentColor","stroke-width":d,"stroke-linecap":"round",cx:k,cy:k,r:s-d/2,"stroke-dasharray":4.91*s,"stroke-dashoffset":2.46*s}))),xe("div",{class:`${r}-base-loading__container-layer-right`},xe("svg",{class:`${r}-base-loading__svg`,viewBox:`0 0 ${2*k} ${2*k}`,xmlns:"http://www.w3.org/2000/svg",style:{color:p}},xe("circle",{fill:"none",stroke:"currentColor","stroke-width":d,"stroke-linecap":"round",cx:k,cy:k,r:s-d/2,"stroke-dasharray":4.91*s,"stroke-dashoffset":2.46*s})))))):xe("div",{key:"placeholder",class:`${r}-base-loading__placeholder`},this.$slots)}))}}),je={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},M8=Da(je.neutralBase),NT=Da(je.neutralInvertBase),U8="rgba("+NT.slice(0,3).join(", ")+", ";function Uk(r){return U8+String(r)+")"}function tn(r){const s=Array.from(NT);return s[3]=Number(r),p4(M8,s)}const V8=Object.assign(Object.assign({name:"common"},Bl),{baseColor:je.neutralBase,primaryColor:je.primaryDefault,primaryColorHover:je.primaryHover,primaryColorPressed:je.primaryActive,primaryColorSuppl:je.primarySuppl,infoColor:je.infoDefault,infoColorHover:je.infoHover,infoColorPressed:je.infoActive,infoColorSuppl:je.infoSuppl,successColor:je.successDefault,successColorHover:je.successHover,successColorPressed:je.successActive,successColorSuppl:je.successSuppl,warningColor:je.warningDefault,warningColorHover:je.warningHover,warningColorPressed:je.warningActive,warningColorSuppl:je.warningSuppl,errorColor:je.errorDefault,errorColorHover:je.errorHover,errorColorPressed:je.errorActive,errorColorSuppl:je.errorSuppl,textColorBase:je.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:tn(je.alpha4),placeholderColor:tn(je.alpha4),placeholderColorDisabled:tn(je.alpha5),iconColor:tn(je.alpha4),iconColorHover:cl(tn(je.alpha4),{lightness:.75}),iconColorPressed:cl(tn(je.alpha4),{lightness:.9}),iconColorDisabled:tn(je.alpha5),opacity1:je.alpha1,opacity2:je.alpha2,opacity3:je.alpha3,opacity4:je.alpha4,opacity5:je.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:tn(Number(je.alphaClose)),closeIconColorHover:tn(Number(je.alphaClose)),closeIconColorPressed:tn(Number(je.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:tn(je.alpha4),clearColorHover:cl(tn(je.alpha4),{lightness:.75}),clearColorPressed:cl(tn(je.alpha4),{lightness:.9}),scrollbarColor:Uk(je.alphaScrollbar),scrollbarColorHover:Uk(je.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:tn(je.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:je.neutralPopover,tableColor:je.neutralCard,cardColor:je.neutralCard,modalColor:je.neutralModal,bodyColor:je.neutralBody,tagColor:"#eee",avatarColor:tn(je.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:tn(je.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:je.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),F8=V8,{cubicBezierEaseInOut:_r,cubicBezierEaseOut:j8,cubicBezierEaseIn:B8}=Bl;function H8({overflow:r="hidden",duration:s=".3s",originalTransition:d="",leavingDelay:p="0s",foldPadding:_=!1,enterToProps:k=void 0,leaveToProps:b=void 0,reverse:w=!1}={}){const A=w?"leave":"enter",P=w?"enter":"leave";return[mt(`&.fade-in-height-expand-transition-${P}-from,
 &.fade-in-height-expand-transition-${A}-to`,Object.assign(Object.assign({},k),{opacity:1})),mt(`&.fade-in-height-expand-transition-${P}-to,
 &.fade-in-height-expand-transition-${A}-from`,Object.assign(Object.assign({},b),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:_?"0 !important":void 0,paddingBottom:_?"0 !important":void 0})),mt(`&.fade-in-height-expand-transition-${P}-active`,`
 overflow: ${r};
 transition:
 max-height ${s} ${_r} ${p},
 opacity ${s} ${j8} ${p},
 margin-top ${s} ${_r} ${p},
 margin-bottom ${s} ${_r} ${p},
 padding-top ${s} ${_r} ${p},
 padding-bottom ${s} ${_r} ${p}
 ${d?","+d:""}
 `),mt(`&.fade-in-height-expand-transition-${A}-active`,`
 overflow: ${r};
 transition:
 max-height ${s} ${_r},
 opacity ${s} ${B8},
 margin-top ${s} ${_r},
 margin-bottom ${s} ${_r},
 padding-top ${s} ${_r},
 padding-bottom ${s} ${_r}
 ${d?","+d:""}
 `)]}const $8={margin:"0 0 8px 0",padding:"10px 20px",maxWidth:"720px",minWidth:"420px",iconMargin:"0 10px 0 0",closeMargin:"0 0 0 10px",closeSize:"20px",closeIconSize:"16px",iconSize:"20px",fontSize:"14px"},z8=r=>{const{textColor2:s,closeIconColor:d,closeIconColorHover:p,closeIconColorPressed:_,infoColor:k,successColor:b,errorColor:w,warningColor:A,popoverColor:P,boxShadow2:N,primaryColor:$,lineHeight:W,borderRadius:de,closeColorHover:X,closeColorPressed:ce}=r;return Object.assign(Object.assign({},$8),{closeBorderRadius:de,textColor:s,textColorInfo:s,textColorSuccess:s,textColorError:s,textColorWarning:s,textColorLoading:s,color:P,colorInfo:P,colorSuccess:P,colorError:P,colorWarning:P,colorLoading:P,boxShadow:N,boxShadowInfo:N,boxShadowSuccess:N,boxShadowError:N,boxShadowWarning:N,boxShadowLoading:N,iconColor:s,iconColorInfo:k,iconColorSuccess:b,iconColorWarning:A,iconColorError:w,iconColorLoading:$,closeColorHover:X,closeColorPressed:ce,closeIconColor:d,closeIconColorHover:p,closeIconColorPressed:_,closeColorHoverInfo:X,closeColorPressedInfo:ce,closeIconColorInfo:d,closeIconColorHoverInfo:p,closeIconColorPressedInfo:_,closeColorHoverSuccess:X,closeColorPressedSuccess:ce,closeIconColorSuccess:d,closeIconColorHoverSuccess:p,closeIconColorPressedSuccess:_,closeColorHoverError:X,closeColorPressedError:ce,closeIconColorError:d,closeIconColorHoverError:p,closeIconColorPressedError:_,closeColorHoverWarning:X,closeColorPressedWarning:ce,closeIconColorWarning:d,closeIconColorHoverWarning:p,closeIconColorPressedWarning:_,closeColorHoverLoading:X,closeColorPressedLoading:ce,closeIconColorLoading:d,closeIconColorHoverLoading:p,closeIconColorPressedLoading:_,loadingColor:$,lineHeight:W,borderRadius:de})},W8={name:"Message",common:F8,self:z8},G8=W8,LT={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},MT="n-message-api",UT="n-message-provider",J8=mt([Aa("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[H8({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),Aa("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[In("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),In("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(r=>yr(`${r}-type`,[mt("> *",`
 color: var(--n-icon-color-${r});
 transition: color .3s var(--n-bezier);
 `)])),mt("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Am()])]),In("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[mt("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),mt("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),Aa("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[yr("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),yr("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),yr("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),yr("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),yr("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),yr("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),q8={info:()=>xe(E8,null),success:()=>xe(C8,null),warning:()=>xe(R8,null),error:()=>xe(w8,null),default:()=>null},K8=Zt({name:"Message",props:Object.assign(Object.assign({},LT),{render:Function}),setup(r){const{inlineThemeDisabled:s,mergedRtlRef:d}=PT(r),{props:p,mergedClsPrefixRef:_}=Wn(UT),k=I8("Message",d,_),b=ag("Message","-message",J8,G8,p,_),w=nn(()=>{const{type:P}=r,{common:{cubicBezierEaseInOut:N},self:{padding:$,margin:W,maxWidth:de,iconMargin:X,closeMargin:ce,closeSize:ge,iconSize:be,fontSize:Ye,lineHeight:at,borderRadius:Ae,iconColorInfo:Xe,iconColorSuccess:Ke,iconColorWarning:yt,iconColorError:He,iconColorLoading:Ge,closeIconSize:ze,closeBorderRadius:ft,[Hr("textColor",P)]:Ie,[Hr("boxShadow",P)]:rt,[Hr("color",P)]:Mt,[Hr("closeColorHover",P)]:En,[Hr("closeColorPressed",P)]:z,[Hr("closeIconColor",P)]:he,[Hr("closeIconColorPressed",P)]:Te,[Hr("closeIconColorHover",P)]:Bt}}=b.value;return{"--n-bezier":N,"--n-margin":W,"--n-padding":$,"--n-max-width":de,"--n-font-size":Ye,"--n-icon-margin":X,"--n-icon-size":be,"--n-close-icon-size":ze,"--n-close-border-radius":ft,"--n-close-size":ge,"--n-close-margin":ce,"--n-text-color":Ie,"--n-color":Mt,"--n-box-shadow":rt,"--n-icon-color-info":Xe,"--n-icon-color-success":Ke,"--n-icon-color-warning":yt,"--n-icon-color-error":He,"--n-icon-color-loading":Ge,"--n-close-color-hover":En,"--n-close-color-pressed":z,"--n-close-icon-color":he,"--n-close-icon-color-pressed":Te,"--n-close-icon-color-hover":Bt,"--n-line-height":at,"--n-border-radius":Ae}}),A=s?k8("message",nn(()=>r.type[0]),w,{}):void 0;return{mergedClsPrefix:_,rtlEnabled:k,messageProviderProps:p,handleClose(){var P;(P=r.onClose)===null||P===void 0||P.call(r)},cssVars:s?void 0:w,themeClass:A==null?void 0:A.themeClass,onRender:A==null?void 0:A.onRender,placement:p.placement}},render(){const{render:r,type:s,closable:d,content:p,mergedClsPrefix:_,cssVars:k,themeClass:b,onRender:w,icon:A,handleClose:P,showIcon:N}=this;w==null||w();let $;return xe("div",{class:[`${_}-message-wrapper`,b],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},k]},r?r(this.$props):xe("div",{class:[`${_}-message ${_}-message--${s}-type`,this.rtlEnabled&&`${_}-message--rtl`]},($=Q8(A,s,_))&&N?xe("div",{class:`${_}-message__icon ${_}-message__icon--${s}-type`},xe(DT,null,{default:()=>$})):null,xe("div",{class:`${_}-message__content`},_4(p)),d?xe(D8,{clsPrefix:_,class:`${_}-message__close`,onClick:P,absolute:!0}):null))}});function Q8(r,s,d){if(typeof r=="function")return r();{const p=s==="loading"?xe(L8,{clsPrefix:d,strokeWidth:24,scale:.85}):q8[s]();return p?xe(OT,{clsPrefix:d,key:s},{default:()=>p}):null}}const Y8=Zt({name:"MessageEnvironment",props:Object.assign(Object.assign({},LT),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(r){let s=null;const d=Kt(!0);hc(()=>{p()});function p(){const{duration:N}=r;N&&(s=window.setTimeout(b,N))}function _(N){N.currentTarget===N.target&&s!==null&&(window.clearTimeout(s),s=null)}function k(N){N.currentTarget===N.target&&p()}function b(){const{onHide:N}=r;d.value=!1,s&&(window.clearTimeout(s),s=null),N&&N()}function w(){const{onClose:N}=r;N&&N(),b()}function A(){const{onAfterLeave:N,onInternalAfterLeave:$,onAfterHide:W,internalKey:de}=r;N&&N(),$&&$(de),W&&W()}function P(){b()}return{show:d,hide:b,handleClose:w,handleAfterLeave:A,handleMouseleave:k,handleMouseenter:_,deactivate:P}},render(){return xe(A8,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?xe(K8,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),X8=Object.assign(Object.assign({},ag.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerStyle:[String,Object]}),Z8=Zt({name:"MessageProvider",props:X8,setup(r){const{mergedClsPrefixRef:s}=PT(r),d=Kt([]),p=Kt({}),_={create(A,P){return k(A,Object.assign({type:"default"},P))},info(A,P){return k(A,Object.assign(Object.assign({},P),{type:"info"}))},success(A,P){return k(A,Object.assign(Object.assign({},P),{type:"success"}))},warning(A,P){return k(A,Object.assign(Object.assign({},P),{type:"warning"}))},error(A,P){return k(A,Object.assign(Object.assign({},P),{type:"error"}))},loading(A,P){return k(A,Object.assign(Object.assign({},P),{type:"loading"}))},destroyAll:w};fm(UT,{props:r,mergedClsPrefixRef:s}),fm(MT,_);function k(A,P){const N=g4(),$=El(Object.assign(Object.assign({},P),{content:A,key:N,destroy:()=>{var de;(de=p.value[N])===null||de===void 0||de.hide()}})),{max:W}=r;return W&&d.value.length>=W&&d.value.shift(),d.value.push($),$}function b(A){d.value.splice(d.value.findIndex(P=>P.key===A),1),delete p.value[A]}function w(){Object.values(p.value).forEach(A=>{A.hide()})}return Object.assign({mergedClsPrefix:s,messageRefs:p,messageList:d,handleAfterLeave:b},_)},render(){var r,s,d;return xe(Qt,null,(s=(r=this.$slots).default)===null||s===void 0?void 0:s.call(r),this.messageList.length?xe(p3,{to:(d=this.to)!==null&&d!==void 0?d:"body"},xe("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`],key:"message-container",style:this.containerStyle},this.messageList.map(p=>xe(Y8,Object.assign({ref:_=>{_&&(this.messageRefs[p.key]=_)},internalKey:p.key,onInternalAfterLeave:this.handleAfterLeave},v4(p,["destroy"],void 0),{duration:p.duration===void 0?this.duration:p.duration,keepAliveOnHover:p.keepAliveOnHover===void 0?this.keepAliveOnHover:p.keepAliveOnHover,closable:p.closable===void 0?this.closable:p.closable}))))):null)}});function eV(){const r=Wn(MT,null);return r===null&&YI("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),r}const go=(r,s)=>{const d=r.__vccOpts||r;for(const[p,_]of s)d[p]=_;return d},tV={},nV={class:"flex flex-col min-h-100vh"};function rV(r,s){return xt(),Ft("div",nV,[ho(r.$slots,"default")])}const iV=go(tV,[["render",rV]]),oV={},aV={class:"relative top-0 left-0 z-[var(--video-z-index-nav)] w-1/1"},sV={class:"flex flex-wrap justify-center flex-grow flex-shrink-0 margin-0-auto w-1/1"},cV={class:"relative z-[var(--video-z-index-footer)] bg-[var(--video-c-bg)] p-32px-24px b-t-divider"};function uV(r,s){return xt(),Ft(Qt,null,[_t("header",aV,[ho(r.$slots,"header",{},void 0,!0)]),_t("main",sV,[ho(r.$slots,"main",{},void 0,!0)]),_t("footer",cV,[ho(r.$slots,"footer",{},void 0,!0)])],64)}const lV=go(oV,[["render",uV],["__scopeId","data-v-4c7fe4ee"]]);function rm(r,s=1,d=!0){if(/^[#]/.test(r)){const p=dV(r);s===1?r=`rgb(${p.r},${p.g},${p.b})`:r=`rgba(${p.r},${p.g},${p.b},${s})`}else/^rgba/.test(r)?r.search(/.([0-9]\))$/)===-1&&!d&&(r=r.replace(/.?([0-9]\))$/,`${s})`)):/^(rgb)/.test(r)&&s!==1&&(r=r.replace(/^(rgb)/,"rgba"),r=r.replace(/\)$/,`,${s})`));return r}function dV(r){const s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;r=r.replace(s,(p,_,k,b)=>_+_+k+k+b+b);const d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return d?{r:parseInt(d[1],16),g:parseInt(d[2],16),b:parseInt(d[3],16)}:null}function Sa(r){return["primary","secondary","success","danger","warning","dark","light"].includes(r)}const hV={key:1,class:"con-img video-avatar--con-img"},fV=["src","alt"],pV=["title"],mV=Zt({__name:"avatar",props:{badge:{type:[Boolean,String,Number],default:!1},badgeColor:{default:"danger"},size:{default:""},src:{default:""},textColor:{default:"rgb(255, 255, 255)"},icon:{default:"person"},iconPack:{default:"material-icons"},text:{default:""},color:{default:"rgb(195, 195, 195)"}},setup(r){const s=r,d=nn(()=>{const N={};return s.size!==""&&(N[s.size]=!0),Sa(s.color)&&(N[`con-video-avatar-${s.color}`]=!0),N}),p=nn(()=>{const N={width:/[px]/.test(s.size)?s.size:null,height:/[px]/.test(s.size)?s.size:null};return Sa(s.color)||(N.background=rm(s.color)),N}),_=nn(()=>{const N={badgeNumber:typeof s.badge!="boolean"};return Sa(s.badgeColor)&&(N[`dot-count-${s.badgeColor}`]=!0),N}),k=nn(()=>{const N={};return Sa(s.badgeColor)||(N.background=rm(s.badgeColor)),N}),b=nn(()=>{const N={"material-icons":!s.text};return Sa(s.textColor)&&(N[`video-avatar-text-${s.textColor}`]=!0),N}),w=nn(()=>{const N={transform:"",color:""};return N.transform=`translate(-50%,-50%) scale(${P.value})`,Sa(s.textColor)||(N.color=rm(s.textColor)),N}),A=nn(()=>{if(s.text.length<=5)return s.text;const N=/\s/g;let $="";return N.test(s.text)?s.text.split(N).forEach(W=>{$+=W[0].toUpperCase()}):$=s.text[0].toUpperCase(),$.length>5?$[0]:$}),P=nn(()=>{if(!s.text)return 1;const N=A.value.length;return N<=5&&N>1?N/(N*1.5):1});return(N,$)=>(xt(),Ft("div",jI(N.$attrs,{style:Tn(p),class:[Tn(d),"con-video-avatar"]}),[s.badge&&s.badge>0?(xt(),Ft("div",{key:0,style:Zs(Tn(k)),class:ec([Tn(_),"dot-count video-avatar--count"])},tc(typeof s.badge!="boolean"?s.badge:null),7)):_3("",!0),s.src?(xt(),Ft("div",hV,[_t("img",{src:s.src,alt:s.text},null,8,fV)])):(xt(),Ft("span",{key:2,title:s.text,style:Zs(Tn(w)),class:ec([[s.text?"":s.iconPack,s.text?"":s.icon,Tn(b)],"video-avatar--text notranslate"]),translate:"no"},tc(s.text?Tn(A):s.iconPack=="material-icons"?s.icon:""),15,pV))],16))}}),gV=go(mV,[["__scopeId","data-v-341548c3"]]),vV=Zt({__name:"device-detection",setup(r){const s=eV();return Sr.checkSystemRequirements().then(d=>{d.result?(d.detail.isH264DecodeSupported||s.error("\u4E0D\u652F\u6301\u83B7\u53D6\u4ED6\u4EBA\u7684\u89C6\u9891"),d.detail.isH264EncodeSupported||s.error("\u4E0D\u652F\u6301\u5C06\u89C6\u9891\u64AD\u653E\u7ED9\u4ED6\u4EBA\u89C2\u770B")):s.error("\u4E0D\u652F\u6301\u8FDB\u5165\u623F\u95F4")}),(d,p)=>null}});function _V(r,s){let d;return function p(){const _=Math.floor(Math.random()*(s-r+1)+r);return d=_===d&&r!==s?p():_,d}}var yV=/\/+$/,bV=/^\/+/;function SV(r){let s=Object.keys(r).map(d=>[d,r[d]].map(encodeURIComponent).join("=")).join("&");return s?"?"+s:""}function kV(r,s){return r.replace(yV,"")+"/"+s.replace(bV,"")}function IV(r){return Object.keys(r).reduce((s,d)=>(r[d]!=null&&(s[d]=r[d]),s),{})}var im={responseAs:"json",headers:{Accept:"application/json","Content-Type":"application/json"}};function VT(r,s={},d){function p(b,w,A,P={}){let N,$;typeof w=="object"?(N="",$=w,P=A||{}):(N=w,$=A);let W={...im,...k,method:b,...P,headers:IV({...im.headers,...k.headers,...P.headers})},de={...im.query,...k.query,...P.query},{responseAs:X}=W;return N=kV(r,typeof N=="number"?""+N:N||""),N+=SV(de),$&&(W.body=JSON.stringify($)),_(N,W).then(ce=>Promise.all([ce,X==="response"?ce:ce[X]().catch(()=>null)])).then(([ce,ge])=>{if(ce.status>=200&&ce.status<300)return X!=="response"&&ce.status==204?null:ge;let be=new Error(ce.statusText);throw be.response=ce,be.body=ge,be})}const _=typeof fetch<"u"?fetch:d;if(!_)throw new Error("No fetch function exists. Make sure to include a polyfill on Node.js.");const k={query:{},headers:{},...s};return{options:k,post:p.bind(null,"POST"),put:p.bind(null,"PUT"),patch:p.bind(null,"PATCH"),get:(b,w)=>p("GET",b,null,w),delete:(b,w)=>p("DELETE",b,null,w)}}const TV=VT("http://localhost:5566/video/sig/",{responseAs:"text"});function FT(r){return TV.get(r)}function Xs(r){const s=decodeURI(window.location.href.replace(/^[^?]*\?/,"")),d=new RegExp(`(^|&)${r}=([^&#]*)(&|$|)`,"i"),p=s.match(d);return p?p[2]:""}function wV(r){switch(r){case 1:return"\u7F51\u7EDC\u72B6\u51B5\u6781\u4F73";case 2:return"\u7F51\u7EDC\u72B6\u51B5\u8F83\u597D";case 3:return"\u7F51\u7EDC\u72B6\u51B5\u4E00\u822C";case 4:return"\u7F51\u7EDC\u72B6\u51B5\u5DEE";case 5:return"\u7F51\u7EDC\u72B6\u51B5\u6781\u5DEE";case 6:return"\u7F51\u7EDC\u8FDE\u63A5\u5DF2\u65AD\u5F00";default:case 0:return"\u7F51\u7EDC\u72B6\u51B5\u672A\u77E5"}}const EV=Zt({__name:"network-quality",setup(r){const s=_V(1,4294967294),d=Xs("userId"),p=Kt();FT(d).then(A=>{p.value=A});let _=null,k=null,b=null;const w=Kt({uplinkNetworkQualities:[],downlinkNetworkQualities:[],average:{uplinkNetworkQuality:0,downlinkNetworkQuality:0}});return Ra(()=>p.value,()=>{async function A(){_=Sr.createClient({sdkAppId:1400719126,userId:d,userSig:p.value,mode:"rtc"}),b=Sr.createStream({audio:!0,video:!0}),b.setVideoProfile("480p"),await b.initialize(),_.on("network-quality",N=>{const{uplinkNetworkQuality:$}=N;w.value.uplinkNetworkQualities.push($)}),await _.join({roomId:s()}),await _.publish(b)}async function P(){k=Sr.createClient({sdkAppId:1400719126,userId:"elone",userSig:"eJwtzEELgjAYxvHvsnPI9rYpEzpoFh0KiTztZm7Wy0o3k4ii756px*f3wP9Div0peJqOxAQCShbjRm2aHmsc2dzaxszHQ9vSOdQkZpzSiEkG4fSYl8PODC6EAErppD3e-xaGDEBEHOYKXobuIWlz-Y6sPpa*8ruKF8uUKX9ufZLK7bVRa0ikzVWWbVbk*wMuyDEe",mode:"rtc"}),k.on("stream-added",async N=>{await k.subscribe(N.stream,{audio:!0,video:!0}),k.on("network-quality",$=>{const{downlinkNetworkQuality:W}=$;w.value.downlinkNetworkQualities.push(W)})}),await k.join({roomId:8080})}A(),P(),setTimeout(()=>{w.value.uplinkNetworkQualities.length>0&&(w.value.average.uplinkNetworkQuality=Math.ceil(w.value.uplinkNetworkQualities.reduce((N,$)=>N+$,0)/w.value.uplinkNetworkQualities.length)),w.value.downlinkNetworkQualities.length>0&&(w.value.average.downlinkNetworkQuality=Math.ceil(w.value.downlinkNetworkQualities.reduce((N,$)=>N+$,0)/w.value.downlinkNetworkQualities.length)),_.leave(),k.leave(),b.close()},15*1e3)}),(A,P)=>(xt(),Ft("div",null,tc(Tn(wV)(w.value.average.uplinkNetworkQuality)),1))}}),CV={class:"nav-bar"},RV={class:"container"},AV={class:"flex justify-start items-center grow-1"},xV={class:"flex justify-end items-center grow-1"},PV=Zt({__name:"nav-bar",props:{avatarText:{default:"Elone Hoo"}},setup(r){const s=r;return(d,p)=>(xt(),Ft(Qt,null,[wt(vV),_t("div",CV,[_t("div",RV,[_t("div",AV,[_t("nav",null,[wt(gV,{text:s.avatarText.substring(0,1),color:"primary"},null,8,["text"])]),_t("nav",null,tc(s.avatarText),1)]),_t("div",xV,[_t("nav",null,[wt(EV)])])])])],64))}}),DV=go(PV,[["__scopeId","data-v-fcabd23d"]]),OV={},NV={class:"container"},LV={class:"hardware"},MV={class:"operate"},UV={class:"quit"};function VV(r,s){return xt(),Ft("div",NV,[_t("div",LV,[ho(r.$slots,"hardware",{},void 0,!0)]),_t("div",MV,[ho(r.$slots,"operate",{},void 0,!0)]),_t("div",UV,[ho(r.$slots,"quit",{},void 0,!0)])])}const FV=go(OV,[["render",VV],["__scopeId","data-v-f0e11dfb"]]),jV={class:"container"},BV={class:"microphone"},HV=kr(" \u9EA6\u514B\u98CE "),$V={class:"camera"},zV=kr(" \u6444\u50CF\u5934 "),WV=Zt({__name:"hardware",props:{isAudio:{type:Boolean,default:!0},isVideo:{type:Boolean,default:!0}},emits:["microphone","camera"],setup(r,{emit:s}){const d=r;function p(){s("microphone")}function _(){s("camera")}return(k,b)=>(xt(),Ft("div",jV,[_t("div",BV,[d.isAudio?(xt(),Ft("div",{key:0,class:"i-carbon-microphone ma hover:i-carbon-microphone-off",onClick:p})):(xt(),Ft("div",{key:1,class:"i-carbon-microphone-off ma hover:i-carbon-microphone",onClick:p})),HV]),_t("div",$V,[d.isVideo?(xt(),Ft("div",{key:0,class:"i-carbon-video ma hover:i-carbon-video-off",onClick:_})):(xt(),Ft("div",{key:1,class:"i-carbon-video-off ma hover:i-carbon-video",onClick:_})),zV])]))}}),GV=go(WV,[["__scopeId","data-v-ec93e6c4"]]),JV=VT("http://localhost:5566/video/conference/",{responseAs:"json"});function qV(r){return JV.get(r)}const KV=["id"],QV=Zt({__name:"render",setup(r){const s=Xs("roomId"),d=Kt(0),p=Kt();return qV(s).then(_=>{p.value=_,d.value=p.value.length}),(_,k)=>(xt(!0),Ft(Qt,null,qM(d.value,b=>(xt(),Ft("div",{id:`video_${p.value[b-1]}`,class:"bg-dark w-500px h-400px m-1 flex-row"},null,8,KV))),256))}}),cg=r=>(AM("data-v-322ec1e7"),r=r(),xM(),r),YV={class:"container"},XV=kr(" \u5171\u4EAB\u5C4F\u5E55 "),ZV=cg(()=>_t("div",{class:"record"},[_t("div",{class:"i-carbon-recording ma"}),kr(" \u5F55\u5236 ")],-1)),eF={class:"full-screen"},tF=cg(()=>_t("div",{class:"member-management"},[_t("div",{class:"i-carbon-user-multiple ma"}),kr(" \u6210\u5458\u7BA1\u7406 ")],-1)),nF=cg(()=>_t("div",{class:"chat"},[_t("div",{class:"i-carbon-chat ma"}),kr(" \u804A\u5929 ")],-1)),rF=Zt({__name:"operate",props:{isFullscreen:{type:Boolean,default:!1}},emits:["full-screen","share-screen"],setup(r,{emit:s}){function d(){s("full-screen")}function p(){s("share-screen")}return(_,k)=>(xt(),Ft("div",YV,[_t("div",{class:"share-screen"},[_t("div",{onClick:p,class:"i-carbon-screen ma"}),XV]),ZV,_t("div",eF,[r.isFullscreen?(xt(),Ft("div",{key:0,class:"i-carbon-minimize ma",onClick:d})):(xt(),Ft("div",{key:1,class:"i-carbon-maximize ma",onClick:d})),kr(" "+tc(r.isFullscreen?"\u8FD8\u539F":"\u5168\u5C4F"),1)]),tF,nF]))}}),iF=go(rF,[["__scopeId","data-v-322ec1e7"]]);var Vk;const gc=typeof window<"u",oF=r=>typeof r=="string",om=()=>{};gc&&((Vk=window==null?void 0:window.navigator)==null?void 0:Vk.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function aF(r){return typeof r=="function"?r():Tn(r)}function sF(r){return r}function jT(r){return $L()?(zL(r),!0):!1}function cF(r,s=!0){eg()?hc(r):s?r():fI(r)}function BT(r){var s;const d=aF(r);return(s=d==null?void 0:d.$el)!=null?s:d}const uF=gc?window:void 0,lF=gc?window.document:void 0;gc&&window.navigator;gc&&window.location;function dF(...r){let s,d,p,_;if(oF(r[0])?([d,p,_]=r,s=uF):[s,d,p,_]=r,!s)return om;let k=om;const b=Ra(()=>BT(s),A=>{k(),A&&(A.addEventListener(d,p,_),k=()=>{A.removeEventListener(d,p,_),k=om})},{immediate:!0,flush:"post"}),w=()=>{b(),k()};return jT(w),w}function hF(r,s=!1){const d=Kt(),p=()=>d.value=Boolean(r());return p(),cF(p,s),d}const xm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pm="__vueuse_ssr_handlers__";xm[Pm]=xm[Pm]||{};xm[Pm];const Fk=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];function fF(r,s={}){const{document:d=lF,autoExit:p=!1}=s,_=r||(d==null?void 0:d.querySelector("html")),k=Kt(!1);let b=Fk[0];const w=hF(()=>{if(d){for(const ce of Fk)if(ce[1]in d)return b=ce,!0}else return!1;return!1}),[A,P,N,,$]=b;async function W(){!w.value||(d!=null&&d[N]&&await d[P](),k.value=!1)}async function de(){if(!w.value)return;await W();const ce=BT(_);ce&&(await ce[A](),k.value=!0)}async function X(){k.value?await W():await de()}return d&&dF(d,$,()=>{k.value=!!(d!=null&&d[N])},!1),p&&jT(W),{isSupported:w,isFullscreen:k,enter:de,exit:W,toggle:X}}var jk;(function(r){r.UP="UP",r.RIGHT="RIGHT",r.DOWN="DOWN",r.LEFT="LEFT",r.NONE="NONE"})(jk||(jk={}));var pF=Object.defineProperty,Bk=Object.getOwnPropertySymbols,mF=Object.prototype.hasOwnProperty,gF=Object.prototype.propertyIsEnumerable,Hk=(r,s,d)=>s in r?pF(r,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[s]=d,vF=(r,s)=>{for(var d in s||(s={}))mF.call(s,d)&&Hk(r,d,s[d]);if(Bk)for(var d of Bk(s))gF.call(s,d)&&Hk(r,d,s[d]);return r};const _F={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};vF({linear:sF},_F);const yF=Zt({__name:"App",setup(r){const s=Xs("userId"),d=Xs("roomId");Xs("render");const p=Kt();FT(s).then(X=>{p.value=X}),Sr.Logger.setLogLevel(Sr.Logger.LogLevel.WARN);const _=Kt(),k=Kt(),b=Kt(),w=Kt(),A=Kt();Ra(()=>p.value,async()=>{b.value=Sr.createClient({mode:"live",sdkAppId:1400719126,userId:s,userSig:p.value,useStringRoomId:!0,autoSubscribe:!0}),w.value=Sr.createStream({userId:s,audio:!0,video:!0}),b.value.on("stream-added",X=>{const ce=X.stream;b.value.subscribe(ce)}),b.value.on("stream-subscribed",X=>{A.value=X.stream,A.value.on("error",ce=>{ce.getCode()===16451&&A.value.resume()}),A.value.play(`video_${A.value.getUserId()}`)}),await b.value.join({roomId:d,role:"anchor"}),await w.value.initialize(),w.value.play(`video_${s}`),await b.value.publish(w.value),_.value=w.value.hasAudio(),k.value=w.value.hasVideo()});function P(){_.value?(w.value.muteAudio(),_.value=!1):(w.value.unmuteAudio(),_.value=!0)}function N(){k.value?(w.value.muteVideo(),k.value=!1):(w.value.unmuteVideo(),k.value=!0)}const{toggle:$,isFullscreen:W}=fF();async function de(){const X=Sr.createStream({audio:!0,screen:!0,userId:s});try{await X.initialize()}catch(ce){switch(ce.name){case"NotReadableError":return;case"NotAllowedError":ce.message.includes("Permission denied by system");return;default:return}}Sr.createClient({mode:"live",sdkAppId:1400719126,userId:s,userSig:p.value,useStringRoomId:!0})}return(X,ce)=>(xt(),Xm(Tn(Z8),null,{default:Ii(()=>[wt(iV,null,{default:Ii(()=>[wt(lV,null,{header:Ii(()=>[wt(DV,{"avatar-text":Tn(s)},null,8,["avatar-text"])]),main:Ii(()=>[wt(QV)]),footer:Ii(()=>[wt(FV,null,{hardware:Ii(()=>[wt(GV,{"is-audio":_.value,"is-video":k.value,onMicrophone:P,onCamera:N},null,8,["is-audio","is-video"])]),operate:Ii(()=>[wt(iF,{"is-fullscreen":Tn(W),onFullScreen:ce[0]||(ce[0]=ge=>Tn($)()),onShareScreen:ce[1]||(ce[1]=ge=>de())},null,8,["is-fullscreen"])]),_:1})]),_:1})]),_:1})]),_:1}))}});i4(yF).mount("#app")});export default bF();
